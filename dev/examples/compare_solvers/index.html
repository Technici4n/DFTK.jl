<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison of DFT solvers · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/compare_solvers/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../energy_cutoff_smearing/">Energy cutoff smearing</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li class="is-active"><a class="tocitem" href>Comparison of DFT solvers</a><ul class="internal"><li><a class="tocitem" href="#Density-based-self-consistent-field"><span>Density-based self-consistent field</span></a></li><li><a class="tocitem" href="#Potential-based-SCF"><span>Potential-based SCF</span></a></li><li><a class="tocitem" href="#Direct-minimization"><span>Direct minimization</span></a></li></ul></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/compare_solvers.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-of-DFT-solvers"><a class="docs-heading-anchor" href="#Comparison-of-DFT-solvers">Comparison of DFT solvers</a><a id="Comparison-of-DFT-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-DFT-solvers" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/compare_solvers.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/compare_solvers.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compare four different approaches for solving the DFT minimisation problem, namely a density-based SCF, a potential-based SCF, direct minimisation and Newton.</p><p>First we setup our problem</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra

a = 10.26  # Silicon lattice constant in Bohr
lattice = a / 2 * [[0 1 1.];
                   [1 0 1.];
                   [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=[3, 3, 3])

# Convergence we desire
tol = 1e-12
is_converged = DFTK.ScfConvergenceDensity(tol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">#512 (generic function with 1 method)</code></pre><h2 id="Density-based-self-consistent-field"><a class="docs-heading-anchor" href="#Density-based-self-consistent-field">Density-based self-consistent field</a><a id="Density-based-self-consistent-field-1"></a><a class="docs-heading-anchor-permalink" href="#Density-based-self-consistent-field" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scf = self_consistent_field(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3915556370335079 0.3785174208997979 … 0.3446996002702389 0.3785174208997979; 0.3785174208997979 0.36645844064796 … 0.3273572817222917 0.3636495426205883; … ; 0.34469960027023894 0.3273572817222918 … 0.3075192694185542 0.33438053198659884; 0.37851742089979784 0.3636495426205882 … 0.33438053198659884 0.36645844064795996;;; 0.3785174208997979 0.36645844064796 … 0.32735728172229167 0.3636495426205882; 0.36645844064795996 0.35102886341774914 … 0.31119401346062026 0.35191706634923264; … ; 0.3273572817222917 0.31119401346062026 … 0.2982412284122564 0.32142600281512085; 0.3636495426205882 0.3519170663492326 … 0.32142600281512085 0.35191706634923264;;; 0.344699600270239 0.3343805319865989 … 0.2865351537639678 0.3273572817222918; 0.33438053198659884 0.31861604776298935 … 0.2780589188235132 0.32142600281512085; … ; 0.2865351537639678 0.27805891882351325 … 0.2559018577231394 0.27805891882351325; 0.3273572817222917 0.3214260028151208 … 0.27805891882351313 0.31119401346062026;;; … ;;; 0.3048747492890624 0.2830366689624023 … 0.28556433231755113 0.30095737051842464; 0.28303666896240226 0.25898431622275975 … 0.27263300128657997 0.28541419662664047; … ; 0.2855643323175511 0.27263300128658 … 0.27716038913771196 0.28121087378380516; 0.3009573705184245 0.28541419662664036 … 0.28121087378380505 0.2930827262717056;;; 0.34469960027023905 0.3273572817222918 … 0.3075192694185542 0.33438053198659884; 0.3273572817222917 0.31119401346062026 … 0.2982412284122564 0.32142600281512085; … ; 0.30751926941855423 0.2982412284122565 … 0.277160389137712 0.293131191470239; 0.3343805319865988 0.3214260028151208 … 0.29313119147023897 0.3186160477629893;;; 0.3785174208997979 0.3636495426205883 … 0.3343805319865988 0.36645844064796007; 0.36364954262058824 0.35191706634923264 … 0.3214260028151208 0.35191706634923264; … ; 0.3343805319865988 0.32142600281512085 … 0.29313119147023897 0.3186160477629893; 0.36645844064795996 0.3519170663492326 … 0.31861604776298935 0.3510288634177491]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923122299 -0.49665655722571816 … -0.4771919009649017 -0.49665655722571816; -0.49665655722571816 -0.4848182087107514 … -0.4763804457667939 -0.4920413111694433; … ; -0.4771919009649017 -0.4763804457667939 … -0.41228807087391744 -0.45507008155612916; -0.49665655722571816 -0.4920413111694433 … -0.4550700815561291 -0.4848182087107514;;; -0.4966565572257181 -0.4848182087107513 … -0.4763804457667939 -0.4920413111694433; -0.4848182087107513 -0.45837440791486905 … -0.47065601570573307 -0.48617902517563727; … ; -0.4763804457667939 -0.47065601570573307 … -0.4463984364362206 -0.4688943963915341; -0.4920413111694433 -0.48617902517563727 … -0.46889439639153413 -0.4861790251756373;;; -0.4771919009649017 -0.4550700815561291 … -0.4605141234226812 -0.4763804457667939; -0.4550700815561291 -0.4090661824391319 … -0.4567199083211503 -0.4688943963915341; … ; -0.4605141234226813 -0.4567199083211503 … -0.4451449566034978 -0.4567199083211503; -0.4763804457667939 -0.4688943963915341 … -0.4567199083211503 -0.47065601570573307;;; … ;;; -0.44947595084091796 -0.4551499722014993 … -0.37125986261790556 -0.417745715202765; -0.4551499722014994 -0.44880351099772436 … -0.41743801071342024 -0.4441260992987842; … ; -0.37125986261790556 -0.41743801071342024 … -0.2536569832840746 -0.29979809105960187; -0.417745715202765 -0.4441260992987842 … -0.29979809105960187 -0.3610634326480254;;; -0.4771919009649017 -0.4763804457667939 … -0.41228807087391744 -0.4550700815561291; -0.4763804457667939 -0.47065601570573307 … -0.4463984364362206 -0.46889439639153413; … ; -0.41228807087391744 -0.4463984364362206 … -0.2536569832840747 -0.3410633023008422; -0.4550700815561291 -0.46889439639153413 … -0.3410633023008422 -0.4090661824391319;;; -0.4966565572257181 -0.4920413111694433 … -0.4550700815561291 -0.4848182087107513; -0.4920413111694433 -0.48617902517563727 … -0.46889439639153413 -0.48617902517563727; … ; -0.4550700815561291 -0.46889439639153413 … -0.3410633023008421 -0.4090661824391319; -0.4848182087107513 -0.48617902517563727 … -0.4090661824391319 -0.45837440791486905])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392126629006 -0.4868367442771721 … -0.7027113226190882 -0.4868367442771722; -0.4868367442771719 -0.7744303950404341 … -0.41363732843929696 -0.3823307497944713; … ; -0.7027113226190884 -0.4136373284392971 … -2.3967616825880484 -1.2958067581749555; -0.48683674427717183 -0.3823307497944713 … -1.2958067581749557 -0.7744303950404339;;; -0.48683674427717194 -0.7744303950404341 … -0.413637328439297 -0.3823307497944717; -0.7744303950404339 -1.4814477483918647 … -0.3245845694332631 -0.449919396570676; … ; -0.41363732843929707 -0.32458456943326347 … -1.0113572986116937 -0.637327779193174; -0.38233074979447124 -0.44991939657067603 … -0.6373277791931737 -0.4499193965706759;;; -0.7027113226190882 -1.295806758174956 … -0.29820348937555863 -0.4136373284392971; -1.2958067581749557 -2.9196723936538844 … -0.3537295846614402 -0.6373277791931737; … ; -0.29820348937555863 -0.3537295846614407 … -0.4903726081071699 -0.3537295846614406; -0.41363732843929696 -0.6373277791931737 … -0.3537295846614401 -0.3245845694332631;;; … ;;; -1.0166744212557646 -0.5332878143065853 … -3.636138257122857 -1.9987602620506144; -0.5332878143065853 -0.32174124747387683 … -1.4667339407502515 -0.9061938941468748; … ; -3.636138257122857 -1.4667339407502515 … -10.988177824465888 -8.087376168208168; -1.9987602620506142 -0.9061938941468749 … -8.087376168208168 -4.647878371143224;;; -0.7027113226190881 -0.4136373284392969 … -2.396761682588049 -1.2958067581749557; -0.41363732843929685 -0.32458456943326336 … -1.0113572986116937 -0.6373277791931737; … ; -2.396761682588049 -1.0113572986116939 … -11.002806190874994 -6.0773041863940644; -1.2958067581749557 -0.6373277791931736 … -6.077304186394065 -2.9196723936538844;;; -0.486836744277172 -0.38233074979447146 … -1.295806758174956 -0.774430395040434; -0.3823307497944713 -0.44991939657067603 … -0.6373277791931737 -0.449919396570676; … ; -1.295806758174956 -0.6373277791931738 … -6.0773041863940644 -2.919672393653884; -0.7744303950404338 -0.44991939657067587 … -2.9196723936538835 -1.4814477483918647]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3915556370335079 0.3785174208997979 … 0.3446996002702389 0.3785174208997979; 0.3785174208997979 0.36645844064796 … 0.3273572817222917 0.3636495426205883; … ; 0.34469960027023894 0.3273572817222918 … 0.3075192694185542 0.33438053198659884; 0.37851742089979784 0.3636495426205882 … 0.33438053198659884 0.36645844064795996;;; 0.3785174208997979 0.36645844064796 … 0.32735728172229167 0.3636495426205882; 0.36645844064795996 0.35102886341774914 … 0.31119401346062026 0.35191706634923264; … ; 0.3273572817222917 0.31119401346062026 … 0.2982412284122564 0.32142600281512085; 0.3636495426205882 0.3519170663492326 … 0.32142600281512085 0.35191706634923264;;; 0.344699600270239 0.3343805319865989 … 0.2865351537639678 0.3273572817222918; 0.33438053198659884 0.31861604776298935 … 0.2780589188235132 0.32142600281512085; … ; 0.2865351537639678 0.27805891882351325 … 0.2559018577231394 0.27805891882351325; 0.3273572817222917 0.3214260028151208 … 0.27805891882351313 0.31119401346062026;;; … ;;; 0.3048747492890624 0.2830366689624023 … 0.28556433231755113 0.30095737051842464; 0.28303666896240226 0.25898431622275975 … 0.27263300128657997 0.28541419662664047; … ; 0.2855643323175511 0.27263300128658 … 0.27716038913771196 0.28121087378380516; 0.3009573705184245 0.28541419662664036 … 0.28121087378380505 0.2930827262717056;;; 0.34469960027023905 0.3273572817222918 … 0.3075192694185542 0.33438053198659884; 0.3273572817222917 0.31119401346062026 … 0.2982412284122564 0.32142600281512085; … ; 0.30751926941855423 0.2982412284122565 … 0.277160389137712 0.293131191470239; 0.3343805319865988 0.3214260028151208 … 0.29313119147023897 0.3186160477629893;;; 0.3785174208997979 0.3636495426205883 … 0.3343805319865988 0.36645844064796007; 0.36364954262058824 0.35191706634923264 … 0.3214260028151208 0.35191706634923264; … ; 0.3343805319865988 0.32142600281512085 … 0.29313119147023897 0.3186160477629893; 0.36645844064795996 0.3519170663492326 … 0.31861604776298935 0.3510288634177491]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923122299 -0.49665655722571816 … -0.4771919009649017 -0.49665655722571816; -0.49665655722571816 -0.4848182087107514 … -0.4763804457667939 -0.4920413111694433; … ; -0.4771919009649017 -0.4763804457667939 … -0.41228807087391744 -0.45507008155612916; -0.49665655722571816 -0.4920413111694433 … -0.4550700815561291 -0.4848182087107514;;; -0.4966565572257181 -0.4848182087107513 … -0.4763804457667939 -0.4920413111694433; -0.4848182087107513 -0.45837440791486905 … -0.47065601570573307 -0.48617902517563727; … ; -0.4763804457667939 -0.47065601570573307 … -0.4463984364362206 -0.4688943963915341; -0.4920413111694433 -0.48617902517563727 … -0.46889439639153413 -0.4861790251756373;;; -0.4771919009649017 -0.4550700815561291 … -0.4605141234226812 -0.4763804457667939; -0.4550700815561291 -0.4090661824391319 … -0.4567199083211503 -0.4688943963915341; … ; -0.4605141234226813 -0.4567199083211503 … -0.4451449566034978 -0.4567199083211503; -0.4763804457667939 -0.4688943963915341 … -0.4567199083211503 -0.47065601570573307;;; … ;;; -0.44947595084091796 -0.4551499722014993 … -0.37125986261790556 -0.417745715202765; -0.4551499722014994 -0.44880351099772436 … -0.41743801071342024 -0.4441260992987842; … ; -0.37125986261790556 -0.41743801071342024 … -0.2536569832840746 -0.29979809105960187; -0.417745715202765 -0.4441260992987842 … -0.29979809105960187 -0.3610634326480254;;; -0.4771919009649017 -0.4763804457667939 … -0.41228807087391744 -0.4550700815561291; -0.4763804457667939 -0.47065601570573307 … -0.4463984364362206 -0.46889439639153413; … ; -0.41228807087391744 -0.4463984364362206 … -0.2536569832840747 -0.3410633023008422; -0.4550700815561291 -0.46889439639153413 … -0.3410633023008422 -0.4090661824391319;;; -0.4966565572257181 -0.4920413111694433 … -0.4550700815561291 -0.4848182087107513; -0.4920413111694433 -0.48617902517563727 … -0.46889439639153413 -0.48617902517563727; … ; -0.4550700815561291 -0.46889439639153413 … -0.3410633023008421 -0.4090661824391319; -0.4848182087107513 -0.48617902517563727 … -0.4090661824391319 -0.45837440791486905])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392126629006 -0.4868367442771721 … -0.7027113226190882 -0.4868367442771722; -0.4868367442771719 -0.7744303950404341 … -0.41363732843929696 -0.3823307497944713; … ; -0.7027113226190884 -0.4136373284392971 … -2.3967616825880484 -1.2958067581749555; -0.48683674427717183 -0.3823307497944713 … -1.2958067581749557 -0.7744303950404339;;; -0.48683674427717194 -0.7744303950404341 … -0.413637328439297 -0.3823307497944717; -0.7744303950404339 -1.4814477483918647 … -0.3245845694332631 -0.449919396570676; … ; -0.41363732843929707 -0.32458456943326347 … -1.0113572986116937 -0.637327779193174; -0.38233074979447124 -0.44991939657067603 … -0.6373277791931737 -0.4499193965706759;;; -0.7027113226190882 -1.295806758174956 … -0.29820348937555863 -0.4136373284392971; -1.2958067581749557 -2.9196723936538844 … -0.3537295846614402 -0.6373277791931737; … ; -0.29820348937555863 -0.3537295846614407 … -0.4903726081071699 -0.3537295846614406; -0.41363732843929696 -0.6373277791931737 … -0.3537295846614401 -0.3245845694332631;;; … ;;; -1.0166744212557646 -0.5332878143065853 … -3.636138257122857 -1.9987602620506144; -0.5332878143065853 -0.32174124747387683 … -1.4667339407502515 -0.9061938941468748; … ; -3.636138257122857 -1.4667339407502515 … -10.988177824465888 -8.087376168208168; -1.9987602620506142 -0.9061938941468749 … -8.087376168208168 -4.647878371143224;;; -0.7027113226190881 -0.4136373284392969 … -2.396761682588049 -1.2958067581749557; -0.41363732843929685 -0.32458456943326336 … -1.0113572986116937 -0.6373277791931737; … ; -2.396761682588049 -1.0113572986116939 … -11.002806190874994 -6.0773041863940644; -1.2958067581749557 -0.6373277791931736 … -6.077304186394065 -2.9196723936538844;;; -0.486836744277172 -0.38233074979447146 … -1.295806758174956 -0.774430395040434; -0.3823307497944713 -0.44991939657067603 … -0.6373277791931737 -0.449919396570676; … ; -1.295806758174956 -0.6373277791931738 … -6.0773041863940644 -2.919672393653884; -0.7744303950404338 -0.44991939657067587 … -2.9196723936538835 -1.4814477483918647]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3915556370335079 0.3785174208997979 … 0.3446996002702389 0.3785174208997979; 0.3785174208997979 0.36645844064796 … 0.3273572817222917 0.3636495426205883; … ; 0.34469960027023894 0.3273572817222918 … 0.3075192694185542 0.33438053198659884; 0.37851742089979784 0.3636495426205882 … 0.33438053198659884 0.36645844064795996;;; 0.3785174208997979 0.36645844064796 … 0.32735728172229167 0.3636495426205882; 0.36645844064795996 0.35102886341774914 … 0.31119401346062026 0.35191706634923264; … ; 0.3273572817222917 0.31119401346062026 … 0.2982412284122564 0.32142600281512085; 0.3636495426205882 0.3519170663492326 … 0.32142600281512085 0.35191706634923264;;; 0.344699600270239 0.3343805319865989 … 0.2865351537639678 0.3273572817222918; 0.33438053198659884 0.31861604776298935 … 0.2780589188235132 0.32142600281512085; … ; 0.2865351537639678 0.27805891882351325 … 0.2559018577231394 0.27805891882351325; 0.3273572817222917 0.3214260028151208 … 0.27805891882351313 0.31119401346062026;;; … ;;; 0.3048747492890624 0.2830366689624023 … 0.28556433231755113 0.30095737051842464; 0.28303666896240226 0.25898431622275975 … 0.27263300128657997 0.28541419662664047; … ; 0.2855643323175511 0.27263300128658 … 0.27716038913771196 0.28121087378380516; 0.3009573705184245 0.28541419662664036 … 0.28121087378380505 0.2930827262717056;;; 0.34469960027023905 0.3273572817222918 … 0.3075192694185542 0.33438053198659884; 0.3273572817222917 0.31119401346062026 … 0.2982412284122564 0.32142600281512085; … ; 0.30751926941855423 0.2982412284122565 … 0.277160389137712 0.293131191470239; 0.3343805319865988 0.3214260028151208 … 0.29313119147023897 0.3186160477629893;;; 0.3785174208997979 0.3636495426205883 … 0.3343805319865988 0.36645844064796007; 0.36364954262058824 0.35191706634923264 … 0.3214260028151208 0.35191706634923264; … ; 0.3343805319865988 0.32142600281512085 … 0.29313119147023897 0.3186160477629893; 0.36645844064795996 0.3519170663492326 … 0.31861604776298935 0.3510288634177491]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923122299 -0.49665655722571816 … -0.4771919009649017 -0.49665655722571816; -0.49665655722571816 -0.4848182087107514 … -0.4763804457667939 -0.4920413111694433; … ; -0.4771919009649017 -0.4763804457667939 … -0.41228807087391744 -0.45507008155612916; -0.49665655722571816 -0.4920413111694433 … -0.4550700815561291 -0.4848182087107514;;; -0.4966565572257181 -0.4848182087107513 … -0.4763804457667939 -0.4920413111694433; -0.4848182087107513 -0.45837440791486905 … -0.47065601570573307 -0.48617902517563727; … ; -0.4763804457667939 -0.47065601570573307 … -0.4463984364362206 -0.4688943963915341; -0.4920413111694433 -0.48617902517563727 … -0.46889439639153413 -0.4861790251756373;;; -0.4771919009649017 -0.4550700815561291 … -0.4605141234226812 -0.4763804457667939; -0.4550700815561291 -0.4090661824391319 … -0.4567199083211503 -0.4688943963915341; … ; -0.4605141234226813 -0.4567199083211503 … -0.4451449566034978 -0.4567199083211503; -0.4763804457667939 -0.4688943963915341 … -0.4567199083211503 -0.47065601570573307;;; … ;;; -0.44947595084091796 -0.4551499722014993 … -0.37125986261790556 -0.417745715202765; -0.4551499722014994 -0.44880351099772436 … -0.41743801071342024 -0.4441260992987842; … ; -0.37125986261790556 -0.41743801071342024 … -0.2536569832840746 -0.29979809105960187; -0.417745715202765 -0.4441260992987842 … -0.29979809105960187 -0.3610634326480254;;; -0.4771919009649017 -0.4763804457667939 … -0.41228807087391744 -0.4550700815561291; -0.4763804457667939 -0.47065601570573307 … -0.4463984364362206 -0.46889439639153413; … ; -0.41228807087391744 -0.4463984364362206 … -0.2536569832840747 -0.3410633023008422; -0.4550700815561291 -0.46889439639153413 … -0.3410633023008422 -0.4090661824391319;;; -0.4966565572257181 -0.4920413111694433 … -0.4550700815561291 -0.4848182087107513; -0.4920413111694433 -0.48617902517563727 … -0.46889439639153413 -0.48617902517563727; … ; -0.4550700815561291 -0.46889439639153413 … -0.3410633023008421 -0.4090661824391319; -0.4848182087107513 -0.48617902517563727 … -0.4090661824391319 -0.45837440791486905])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392126629006 -0.4868367442771721 … -0.7027113226190882 -0.4868367442771722; -0.4868367442771719 -0.7744303950404341 … -0.41363732843929696 -0.3823307497944713; … ; -0.7027113226190884 -0.4136373284392971 … -2.3967616825880484 -1.2958067581749555; -0.48683674427717183 -0.3823307497944713 … -1.2958067581749557 -0.7744303950404339;;; -0.48683674427717194 -0.7744303950404341 … -0.413637328439297 -0.3823307497944717; -0.7744303950404339 -1.4814477483918647 … -0.3245845694332631 -0.449919396570676; … ; -0.41363732843929707 -0.32458456943326347 … -1.0113572986116937 -0.637327779193174; -0.38233074979447124 -0.44991939657067603 … -0.6373277791931737 -0.4499193965706759;;; -0.7027113226190882 -1.295806758174956 … -0.29820348937555863 -0.4136373284392971; -1.2958067581749557 -2.9196723936538844 … -0.3537295846614402 -0.6373277791931737; … ; -0.29820348937555863 -0.3537295846614407 … -0.4903726081071699 -0.3537295846614406; -0.41363732843929696 -0.6373277791931737 … -0.3537295846614401 -0.3245845694332631;;; … ;;; -1.0166744212557646 -0.5332878143065853 … -3.636138257122857 -1.9987602620506144; -0.5332878143065853 -0.32174124747387683 … -1.4667339407502515 -0.9061938941468748; … ; -3.636138257122857 -1.4667339407502515 … -10.988177824465888 -8.087376168208168; -1.9987602620506142 -0.9061938941468749 … -8.087376168208168 -4.647878371143224;;; -0.7027113226190881 -0.4136373284392969 … -2.396761682588049 -1.2958067581749557; -0.41363732843929685 -0.32458456943326336 … -1.0113572986116937 -0.6373277791931737; … ; -2.396761682588049 -1.0113572986116939 … -11.002806190874994 -6.0773041863940644; -1.2958067581749557 -0.6373277791931736 … -6.077304186394065 -2.9196723936538844;;; -0.486836744277172 -0.38233074979447146 … -1.295806758174956 -0.774430395040434; -0.3823307497944713 -0.44991939657067603 … -0.6373277791931737 -0.449919396570676; … ; -1.295806758174956 -0.6373277791931738 … -6.0773041863940644 -2.919672393653884; -0.7744303950404338 -0.44991939657067587 … -2.9196723936538835 -1.4814477483918647]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3915556370335079 0.3785174208997979 … 0.3446996002702389 0.3785174208997979; 0.3785174208997979 0.36645844064796 … 0.3273572817222917 0.3636495426205883; … ; 0.34469960027023894 0.3273572817222918 … 0.3075192694185542 0.33438053198659884; 0.37851742089979784 0.3636495426205882 … 0.33438053198659884 0.36645844064795996;;; 0.3785174208997979 0.36645844064796 … 0.32735728172229167 0.3636495426205882; 0.36645844064795996 0.35102886341774914 … 0.31119401346062026 0.35191706634923264; … ; 0.3273572817222917 0.31119401346062026 … 0.2982412284122564 0.32142600281512085; 0.3636495426205882 0.3519170663492326 … 0.32142600281512085 0.35191706634923264;;; 0.344699600270239 0.3343805319865989 … 0.2865351537639678 0.3273572817222918; 0.33438053198659884 0.31861604776298935 … 0.2780589188235132 0.32142600281512085; … ; 0.2865351537639678 0.27805891882351325 … 0.2559018577231394 0.27805891882351325; 0.3273572817222917 0.3214260028151208 … 0.27805891882351313 0.31119401346062026;;; … ;;; 0.3048747492890624 0.2830366689624023 … 0.28556433231755113 0.30095737051842464; 0.28303666896240226 0.25898431622275975 … 0.27263300128657997 0.28541419662664047; … ; 0.2855643323175511 0.27263300128658 … 0.27716038913771196 0.28121087378380516; 0.3009573705184245 0.28541419662664036 … 0.28121087378380505 0.2930827262717056;;; 0.34469960027023905 0.3273572817222918 … 0.3075192694185542 0.33438053198659884; 0.3273572817222917 0.31119401346062026 … 0.2982412284122564 0.32142600281512085; … ; 0.30751926941855423 0.2982412284122565 … 0.277160389137712 0.293131191470239; 0.3343805319865988 0.3214260028151208 … 0.29313119147023897 0.3186160477629893;;; 0.3785174208997979 0.3636495426205883 … 0.3343805319865988 0.36645844064796007; 0.36364954262058824 0.35191706634923264 … 0.3214260028151208 0.35191706634923264; … ; 0.3343805319865988 0.32142600281512085 … 0.29313119147023897 0.3186160477629893; 0.36645844064795996 0.3519170663492326 … 0.31861604776298935 0.3510288634177491]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923122299 -0.49665655722571816 … -0.4771919009649017 -0.49665655722571816; -0.49665655722571816 -0.4848182087107514 … -0.4763804457667939 -0.4920413111694433; … ; -0.4771919009649017 -0.4763804457667939 … -0.41228807087391744 -0.45507008155612916; -0.49665655722571816 -0.4920413111694433 … -0.4550700815561291 -0.4848182087107514;;; -0.4966565572257181 -0.4848182087107513 … -0.4763804457667939 -0.4920413111694433; -0.4848182087107513 -0.45837440791486905 … -0.47065601570573307 -0.48617902517563727; … ; -0.4763804457667939 -0.47065601570573307 … -0.4463984364362206 -0.4688943963915341; -0.4920413111694433 -0.48617902517563727 … -0.46889439639153413 -0.4861790251756373;;; -0.4771919009649017 -0.4550700815561291 … -0.4605141234226812 -0.4763804457667939; -0.4550700815561291 -0.4090661824391319 … -0.4567199083211503 -0.4688943963915341; … ; -0.4605141234226813 -0.4567199083211503 … -0.4451449566034978 -0.4567199083211503; -0.4763804457667939 -0.4688943963915341 … -0.4567199083211503 -0.47065601570573307;;; … ;;; -0.44947595084091796 -0.4551499722014993 … -0.37125986261790556 -0.417745715202765; -0.4551499722014994 -0.44880351099772436 … -0.41743801071342024 -0.4441260992987842; … ; -0.37125986261790556 -0.41743801071342024 … -0.2536569832840746 -0.29979809105960187; -0.417745715202765 -0.4441260992987842 … -0.29979809105960187 -0.3610634326480254;;; -0.4771919009649017 -0.4763804457667939 … -0.41228807087391744 -0.4550700815561291; -0.4763804457667939 -0.47065601570573307 … -0.4463984364362206 -0.46889439639153413; … ; -0.41228807087391744 -0.4463984364362206 … -0.2536569832840747 -0.3410633023008422; -0.4550700815561291 -0.46889439639153413 … -0.3410633023008422 -0.4090661824391319;;; -0.4966565572257181 -0.4920413111694433 … -0.4550700815561291 -0.4848182087107513; -0.4920413111694433 -0.48617902517563727 … -0.46889439639153413 -0.48617902517563727; … ; -0.4550700815561291 -0.46889439639153413 … -0.3410633023008421 -0.4090661824391319; -0.4848182087107513 -0.48617902517563727 … -0.4090661824391319 -0.45837440791486905])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392126629006 -0.4868367442771721 … -0.7027113226190882 -0.4868367442771722; -0.4868367442771719 -0.7744303950404341 … -0.41363732843929696 -0.3823307497944713; … ; -0.7027113226190884 -0.4136373284392971 … -2.3967616825880484 -1.2958067581749555; -0.48683674427717183 -0.3823307497944713 … -1.2958067581749557 -0.7744303950404339;;; -0.48683674427717194 -0.7744303950404341 … -0.413637328439297 -0.3823307497944717; -0.7744303950404339 -1.4814477483918647 … -0.3245845694332631 -0.449919396570676; … ; -0.41363732843929707 -0.32458456943326347 … -1.0113572986116937 -0.637327779193174; -0.38233074979447124 -0.44991939657067603 … -0.6373277791931737 -0.4499193965706759;;; -0.7027113226190882 -1.295806758174956 … -0.29820348937555863 -0.4136373284392971; -1.2958067581749557 -2.9196723936538844 … -0.3537295846614402 -0.6373277791931737; … ; -0.29820348937555863 -0.3537295846614407 … -0.4903726081071699 -0.3537295846614406; -0.41363732843929696 -0.6373277791931737 … -0.3537295846614401 -0.3245845694332631;;; … ;;; -1.0166744212557646 -0.5332878143065853 … -3.636138257122857 -1.9987602620506144; -0.5332878143065853 -0.32174124747387683 … -1.4667339407502515 -0.9061938941468748; … ; -3.636138257122857 -1.4667339407502515 … -10.988177824465888 -8.087376168208168; -1.9987602620506142 -0.9061938941468749 … -8.087376168208168 -4.647878371143224;;; -0.7027113226190881 -0.4136373284392969 … -2.396761682588049 -1.2958067581749557; -0.41363732843929685 -0.32458456943326336 … -1.0113572986116937 -0.6373277791931737; … ; -2.396761682588049 -1.0113572986116939 … -11.002806190874994 -6.0773041863940644; -1.2958067581749557 -0.6373277791931736 … -6.077304186394065 -2.9196723936538844;;; -0.486836744277172 -0.38233074979447146 … -1.295806758174956 -0.774430395040434; -0.3823307497944713 -0.44991939657067603 … -0.6373277791931737 -0.449919396570676; … ; -1.295806758174956 -0.6373277791931738 … -6.0773041863940644 -2.919672393653884; -0.7744303950404338 -0.44991939657067587 … -2.9196723936538835 -1.4814477483918647]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729846), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09132316917748297 0.08747419134081162 … 0.07684754935963735 0.08747419134081162; 0.08747419134081162 0.08089966872164647 … 0.07642471016972228 0.08486944834427516; … ; 0.07684754935963735 0.07642471016972228 … 0.04778466667102014 0.06587895342303733; 0.08747419134081162 0.08486944834427516 … 0.06587895342303735 0.08089966872164647;;; 0.08747419134081164 0.08089966872164646 … 0.07642471016972227 0.08486944834427516; 0.08089966872164646 0.06744471469775122 … 0.07348669934705007 0.0816376862901547; … ; 0.07642471016972228 0.07348669934705007 … 0.06188804119996805 0.0725982902844746; 0.08486944834427516 0.0816376862901547 … 0.07259829028447462 0.08163768629015469;;; 0.07684754935963735 0.06587895342303735 … 0.06847203698974318 0.07642471016972227; 0.06587895342303735 0.04657864264981007 … 0.06665759371632445 0.0725982902844746; … ; 0.06847203698974319 0.06665759371632445 … 0.061325153143813024 0.06665759371632445; 0.07642471016972227 0.0725982902844746 … 0.06665759371632445 0.07348669934705006;;; … ;;; 0.06328495229886194 0.06591651445953088 … 0.03394064888051736 0.0498759348599903; 0.0659165144595309 0.06297790960106003 … 0.04975639788527674 0.06087020457146552; … ; 0.03394064888051736 0.04975639788527674 … 0.009696353214072756 0.016831338792590255; 0.0498759348599903 0.06087020457146552 … 0.01683133879259026 0.030985721885049316;;; 0.07684754935963735 0.07642471016972227 … 0.04778466667102014 0.06587895342303735; 0.07642471016972227 0.07348669934705006 … 0.06188804119996806 0.07259829028447462; … ; 0.04778466667102014 0.06188804119996806 … 0.009696353214072759 0.025710010675304543; 0.06587895342303735 0.07259829028447462 … 0.02571001067530454 0.04657864264981007;;; 0.08747419134081164 0.08486944834427516 … 0.06587895342303735 0.08089966872164646; 0.08486944834427516 0.0816376862901547 … 0.07259829028447462 0.0816376862901547; … ; 0.06587895342303735 0.07259829028447462 … 0.02571001067530452 0.04657864264981007; 0.08089966872164646 0.0816376862901547 … 0.04657864264981008 0.06744471469775122;;;;], α = 0.8, eigenvalues = [[-0.16677707596310912, 0.2642777178298722, 0.2642777178298722, 0.26427771782987286, 0.3573203719044849, 0.3573203719044843, 0.3573203719044844], [-0.11613218761087077, 0.07040532320000518, 0.2262481360301835, 0.22624813603018354, 0.336117848945997, 0.3934379776179709, 0.39343797761797084], [-0.09588938143643941, 0.08764319967954248, 0.17312704142738333, 0.17312704142738317, 0.29197248922128594, 0.3377321250728823, 0.5327646516179331], [-0.04505146348598375, 0.022269526239773803, 0.09831189251531192, 0.1844640932211311, 0.32292701516245514, 0.4802469602211288, 0.5024422334929318]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2897120818381765, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.020430522640012442 - 0.9552849100321936im 3.1747000516385145e-16 + 3.1325318771942534e-16im … -1.8322397392856457e-11 + 5.734864901422659e-11im -2.5432681783495084e-12 + 7.946802557037724e-12im; -0.0020588695684205446 - 0.09626807229026568im -0.019219091998345927 + 0.15043120452483946im … -0.22189929488105956 - 0.050187691439407364im 0.18654760253178582 + 0.2954649732740418im; … ; -0.00025218426360603167 - 0.011791564308702518im 0.026821059840996715 - 0.04253589261079904im … -0.03111796193047809 - 0.06030477513002156im 0.05673646944388548 + 0.015391479103051052im; 0.0020588695684216002 + 0.09626807229026449im 0.24336502976219393 - 0.2660046138477642im … -0.034491187050934326 - 0.44668194215545304im 0.28092165900659194 - 0.16864983246616821im], [-0.7846566579501307 + 0.49685941456370014im -0.19550640227385968 + 0.025207462501418875im … 1.0610436173456218e-13 - 3.3733991665427896e-14im -7.06842011852587e-14 - 2.6367527626706616e-13im; -0.05349155662429847 + 0.0338718638772302im 0.008701438842610607 - 0.0011219130973848634im … 8.271777468288696e-14 + 3.7496980867126156e-13im 5.3163055103004575e-12 - 1.403704454044065e-12im; … ; -0.006548333764653168 + 0.004146528609306726im -0.08555046642177093 + 0.011030381354390006im … 0.06673354754727641 - 0.03138024669307464im 0.0740529235047557 + 0.03397486572658536im; 0.09541210633953012 - 0.060416747653673934im 0.08996286689006343 - 0.01159929069982584im … 0.2832544795679371 - 0.13319530839442992im 0.3143220026202681 + 0.14420832195416555im], [-0.6016650108505799 - 0.7140658008334876im 9.777245542381568e-17 - 2.5811643232418637e-16im … -7.959179842562439e-13 + 1.2849541822241767e-13im 5.198854242004689e-10 + 6.793027767090832e-11im; -0.044298342074440056 - 0.05257399140472164im -0.05638643658735918 - 0.009555146218709383im … 0.02475397419033438 + 0.004622293234112378im -0.0031157004005745214 - 0.0007941136967300241im; … ; -0.008937355722335845 - 0.010606998838409258im 3.213040162364921e-16 - 1.3290861056265531e-17im … -4.943643492015997e-13 - 1.909972352915719e-12im -0.024944539326257 - 0.0605724370471547im; 0.0987204975007089 + 0.11716308882058378im -0.28309135050353035 - 0.04797216158751168im … -0.375357197586562 - 0.0700902013205455im -0.057496484645282314 - 0.1418899293997628im], [-0.6050057905209623 + 0.5370935409215702im 4.459601855338649e-16 - 1.9626165327683769e-16im … -0.131490908368057 - 0.13356312473912413im -7.094733096817017e-7 - 1.079604472329776e-6im; -0.28976540845950394 + 0.2572390739138013im -0.5991374225457382 + 0.18342626720677543im … 0.12502856186738182 + 0.12699822587157755im -3.71677362222108e-7 + 3.7065392466832736e-7im; … ; -0.008520566618075192 + 0.007564128091434868im -0.00157163733349697 + 0.00048115767541527597im … -0.011347706744352521 - 0.011526229659904704im 0.004580568912670101 - 0.04404994802135201im; 0.048743515448404696 - 0.04327202767200741im -0.011938180309806729 + 0.003654880782049697im … -0.0949456799869316 - 0.09644043373532879im 0.04867488681444516 - 0.4681243210824017im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596310912, 0.2642777178298722, 0.2642777178298722, 0.26427771782987286, 0.3573203719044849, 0.3573203719044843, 0.3573203719044844], [-0.11613218761087077, 0.07040532320000518, 0.2262481360301835, 0.22624813603018354, 0.336117848945997, 0.3934379776179709, 0.39343797761797084], [-0.09588938143643941, 0.08764319967954248, 0.17312704142738333, 0.17312704142738317, 0.29197248922128594, 0.3377321250728823, 0.5327646516179331], [-0.04505146348598375, 0.022269526239773803, 0.09831189251531192, 0.1844640932211311, 0.32292701516245514, 0.4802469602211288, 0.5024422334929318]], X = [[-0.020430522640012442 - 0.9552849100321936im 3.1747000516385145e-16 + 3.1325318771942534e-16im … -1.8322397392856457e-11 + 5.734864901422659e-11im -2.5432681783495084e-12 + 7.946802557037724e-12im; -0.0020588695684205446 - 0.09626807229026568im -0.019219091998345927 + 0.15043120452483946im … -0.22189929488105956 - 0.050187691439407364im 0.18654760253178582 + 0.2954649732740418im; … ; -0.00025218426360603167 - 0.011791564308702518im 0.026821059840996715 - 0.04253589261079904im … -0.03111796193047809 - 0.06030477513002156im 0.05673646944388548 + 0.015391479103051052im; 0.0020588695684216002 + 0.09626807229026449im 0.24336502976219393 - 0.2660046138477642im … -0.034491187050934326 - 0.44668194215545304im 0.28092165900659194 - 0.16864983246616821im], [-0.7846566579501307 + 0.49685941456370014im -0.19550640227385968 + 0.025207462501418875im … 1.0610436173456218e-13 - 3.3733991665427896e-14im -7.06842011852587e-14 - 2.6367527626706616e-13im; -0.05349155662429847 + 0.0338718638772302im 0.008701438842610607 - 0.0011219130973848634im … 8.271777468288696e-14 + 3.7496980867126156e-13im 5.3163055103004575e-12 - 1.403704454044065e-12im; … ; -0.006548333764653168 + 0.004146528609306726im -0.08555046642177093 + 0.011030381354390006im … 0.06673354754727641 - 0.03138024669307464im 0.0740529235047557 + 0.03397486572658536im; 0.09541210633953012 - 0.060416747653673934im 0.08996286689006343 - 0.01159929069982584im … 0.2832544795679371 - 0.13319530839442992im 0.3143220026202681 + 0.14420832195416555im], [-0.6016650108505799 - 0.7140658008334876im 9.777245542381568e-17 - 2.5811643232418637e-16im … -7.959179842562439e-13 + 1.2849541822241767e-13im 5.198854242004689e-10 + 6.793027767090832e-11im; -0.044298342074440056 - 0.05257399140472164im -0.05638643658735918 - 0.009555146218709383im … 0.02475397419033438 + 0.004622293234112378im -0.0031157004005745214 - 0.0007941136967300241im; … ; -0.008937355722335845 - 0.010606998838409258im 3.213040162364921e-16 - 1.3290861056265531e-17im … -4.943643492015997e-13 - 1.909972352915719e-12im -0.024944539326257 - 0.0605724370471547im; 0.0987204975007089 + 0.11716308882058378im -0.28309135050353035 - 0.04797216158751168im … -0.375357197586562 - 0.0700902013205455im -0.057496484645282314 - 0.1418899293997628im], [-0.6050057905209623 + 0.5370935409215702im 4.459601855338649e-16 - 1.9626165327683769e-16im … -0.131490908368057 - 0.13356312473912413im -7.094733096817017e-7 - 1.079604472329776e-6im; -0.28976540845950394 + 0.2572390739138013im -0.5991374225457382 + 0.18342626720677543im … 0.12502856186738182 + 0.12699822587157755im -3.71677362222108e-7 + 3.7065392466832736e-7im; … ; -0.008520566618075192 + 0.007564128091434868im -0.00157163733349697 + 0.00048115767541527597im … -0.011347706744352521 - 0.011526229659904704im 0.004580568912670101 - 0.04404994802135201im; 0.048743515448404696 - 0.04327202767200741im -0.011938180309806729 + 0.003654880782049697im … -0.0949456799869316 - 0.09644043373532879im 0.04867488681444516 - 0.4681243210824017im]], residual_norms = [[2.7475370563813152e-14, 3.4031820411321714e-14, 2.5245286099662272e-14, 6.102670541933073e-14, 1.1469694600476921e-10, 3.4613237892312993e-9, 4.79699497030571e-10], [3.731520591191661e-14, 6.528268684868394e-14, 8.443507520895913e-14, 6.593975927489512e-14, 4.006956749053407e-13, 3.2399646073610388e-12, 1.2974181060456416e-11], [2.716317892021509e-14, 4.064362291763555e-14, 5.760374382001712e-14, 4.0520142293488e-14, 6.587671589983245e-14, 1.1056568040379574e-11, 7.627476382608369e-8], [1.3223516178311206e-14, 1.2253606432150434e-14, 2.4303545663131374e-14, 4.940342681337332e-14, 1.3640946641901335e-12, 3.4031579936772967e-6, 1.7108542037931716e-6]], iterations = [2, 2, 2, 2], converged = 1, n_matvec = 79)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 1.7279572332316418e-13)</code></pre><h2 id="Potential-based-SCF"><a class="docs-heading-anchor" href="#Potential-based-SCF">Potential-based SCF</a><a id="Potential-based-SCF-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-based-SCF" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scfv = DFTK.scf_potential_mixing(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392126634535 -0.48683674427722534 … -0.7027113226191362 -0.48683674427722545; -0.486836744277225 -0.7744303950404858 … -0.41363732843934115 -0.3823307497945216; … ; -0.7027113226191363 -0.41363732843934126 … -2.3967616825880973 -1.2958067581750043; -0.4868367442772249 -0.3823307497945215 … -1.2958067581750048 -0.7744303950404856;;; -0.4868367442772251 -0.7744303950404859 … -0.4136373284393412 -0.382330749794522; -0.7744303950404856 -1.4814477483919166 … -0.3245845694333045 -0.44991939657072444; … ; -0.4136373284393412 -0.3245845694333047 … -1.0113572986117358 -0.6373277791932178; -0.3823307497945214 -0.44991939657072444 … -0.6373277791932177 -0.44991939657072433;;; -0.7027113226191362 -1.2958067581750048 … -0.29820348937559604 -0.4136373284393414; -1.2958067581750043 -2.9196723936539355 … -0.3537295846614763 -0.6373277791932176; … ; -0.29820348937559593 -0.3537295846614768 … -0.4903726081072031 -0.35372958466147686; -0.4136373284393411 -0.6373277791932176 … -0.3537295846614763 -0.3245845694333044;;; … ;;; -1.016674421255808 -0.5332878143066232 … -3.636138257122908 -1.998760262050662; -0.5332878143066229 -0.32174124747391025 … -1.4667339407502935 -0.9061938941469148; … ; -3.636138257122908 -1.4667339407502933 … -10.988177824465955 -8.087376168208227; -1.9987602620506615 -0.9061938941469148 … -8.087376168208227 -4.647878371143278;;; -0.7027113226191362 -0.41363732843934115 … -2.3967616825880977 -1.2958067581750048; -0.4136373284393409 -0.32458456943330466 … -1.0113572986117356 -0.6373277791932176; … ; -2.3967616825880977 -1.0113572986117358 … -11.002806190875061 -6.07730418639412; -1.2958067581750043 -0.6373277791932175 … -6.07730418639412 -2.9196723936539355;;; -0.4868367442772251 -0.38233074979452186 … -1.2958067581750046 -0.7744303950404859; -0.38233074979452153 -0.44991939657072444 … -0.6373277791932176 -0.44991939657072444; … ; -1.2958067581750046 -0.6373277791932175 … -6.0773041863941195 -2.919672393653935; -0.7744303950404855 -0.4499193965707243 … -2.9196723936539355 -1.4814477483919166])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392126634535 -0.48683674427722534 … -0.7027113226191362 -0.48683674427722545; -0.486836744277225 -0.7744303950404858 … -0.41363732843934115 -0.3823307497945216; … ; -0.7027113226191363 -0.41363732843934126 … -2.3967616825880973 -1.2958067581750043; -0.4868367442772249 -0.3823307497945215 … -1.2958067581750048 -0.7744303950404856;;; -0.4868367442772251 -0.7744303950404859 … -0.4136373284393412 -0.382330749794522; -0.7744303950404856 -1.4814477483919166 … -0.3245845694333045 -0.44991939657072444; … ; -0.4136373284393412 -0.3245845694333047 … -1.0113572986117358 -0.6373277791932178; -0.3823307497945214 -0.44991939657072444 … -0.6373277791932177 -0.44991939657072433;;; -0.7027113226191362 -1.2958067581750048 … -0.29820348937559604 -0.4136373284393414; -1.2958067581750043 -2.9196723936539355 … -0.3537295846614763 -0.6373277791932176; … ; -0.29820348937559593 -0.3537295846614768 … -0.4903726081072031 -0.35372958466147686; -0.4136373284393411 -0.6373277791932176 … -0.3537295846614763 -0.3245845694333044;;; … ;;; -1.016674421255808 -0.5332878143066232 … -3.636138257122908 -1.998760262050662; -0.5332878143066229 -0.32174124747391025 … -1.4667339407502935 -0.9061938941469148; … ; -3.636138257122908 -1.4667339407502933 … -10.988177824465955 -8.087376168208227; -1.9987602620506615 -0.9061938941469148 … -8.087376168208227 -4.647878371143278;;; -0.7027113226191362 -0.41363732843934115 … -2.3967616825880977 -1.2958067581750048; -0.4136373284393409 -0.32458456943330466 … -1.0113572986117356 -0.6373277791932176; … ; -2.3967616825880977 -1.0113572986117358 … -11.002806190875061 -6.07730418639412; -1.2958067581750043 -0.6373277791932175 … -6.07730418639412 -2.9196723936539355;;; -0.4868367442772251 -0.38233074979452186 … -1.2958067581750046 -0.7744303950404859; -0.38233074979452153 -0.44991939657072444 … -0.6373277791932176 -0.44991939657072444; … ; -1.2958067581750046 -0.6373277791932175 … -6.0773041863941195 -2.919672393653935; -0.7744303950404855 -0.4499193965707243 … -2.9196723936539355 -1.4814477483919166]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.06276016291633868 - 0.1399895098158631im 0.023914640571212245 - 0.10600405120776943im … 0.05795678593403358 + 0.007772802266741997im 0.10003794325625401 - 0.050096038849087136im; 0.020725530954793292 - 0.08439321258166678im -0.09958074048207263 - 0.012758923552887451im … 0.1076717704022832 - 0.07499510375323545im 0.12821165873677698 - 0.11214741034654145im; … ; 0.027199161434660068 + 0.04782969335178331im 0.029633473725400636 - 0.028204166159361235im … -0.010227271559894346 + 0.035521478222510644im 0.021221565020404246 + 0.09153714005082825im; 0.06230720486513655 - 0.038851871220802324im 0.05754882733809447 - 0.11693444628717473im … 0.043552672948892875 + 0.1272290890675991im 0.08851681958110233 + 0.10568725529292973im;;; 0.012412417645230668 - 0.07017460089315891im 0.009234464111239097 + 0.011698994936823158im … 0.05737794459582654 - 0.055193708979721604im 0.009394145759350854 - 0.11075752265954533im; -0.06638208401058503 - 0.012725664753588842im -0.047184804132619405 + 0.07345626156704682im … 0.05692660473805701 - 0.0739861455893626im 0.025911507829244132 - 0.05915650062471825im; … ; 0.04213258082760807 + 0.0029524232595468693im 0.04494756665145255 - 0.02072752669648444im … 0.031242620074900043 + 0.04718380365133im 0.049654317015827426 + 0.04634680584194096im; 0.026323806919404613 - 0.04418759005550317im 0.06798717753117631 - 0.03438666790561172im … 0.06833134381351638 + 0.05375094234495485im 0.0502042974430968 + 0.006757049341849595im;;; -0.04423297155098929 - 0.021244291862356997im 0.006920949505636988 + 0.044473408079111904im … 0.012397340685431139 - 0.0445144331139123im -0.031878291837224085 - 0.05659945976417422im; -0.05924912008664204 + 0.03904378545778539im -0.0123383232596036 + 0.06676666843063342im … -0.01151487913493364 - 0.03506556054067489im -0.05618911541103437 - 0.014003552371637272im; … ; 0.0031339274915876143 - 0.0018677792131663205im 0.008121189014808225 - 0.0042692627526966275im … 0.02032990092746014 + 0.015664538017684547im 0.013400519722557958 + 0.0029683353656949733im; -0.02403292688974685 - 0.01346189312505064im 0.006978829638141429 + 0.015155664918586534im … 0.01618547694962833 - 0.0063000962897966795im -0.02204520775444779 - 0.015447813915862137im;;; … ;;; -0.0036284257554700583 + 0.05184781809740364im 0.017413875830027205 + 0.02274227227576044im … -0.06174942584232536 + 0.025605600478639405im -0.06484221458175032 + 0.0578509739770503im; 0.015960313297275798 + 0.017341193441789082im 0.01635122485582039 - 0.00430292702322225im … -0.04434595596153246 + 0.030989400801722515im -0.021131938587731214 + 0.024838656000094148im; … ; -0.0523483209314906 + 0.006837651335675821im -0.015877342728230992 + 0.03093602320646293im … 0.05503297160848035 - 0.13438347159255395im -0.04658068234615176 - 0.0638472709374403im; -0.03721693339461811 + 0.060948997551599694im 0.0007220257712209967 + 0.045741188212847506im … -0.016859875772322893 - 0.060849231203191724im -0.08649437907355784 + 0.017779579810307845im;;; 0.038684288878671695 + 0.04219664384418069im 0.04026898668154438 - 0.02116132293475803im … -0.1547538969387045 + 0.09151913677796512im -0.07244904932289875 + 0.10817956693969602im; 0.05104235292213739 - 0.03891225596088577im -0.0010232544870946614 - 0.033426823491167386im … -0.05352168356450952 + 0.020556215391504214im 0.014830432620178843 + 0.004854922354279112im; … ; -0.08099830702346095 + 0.0832941623852072im -0.015111924911342601 + 0.058038198510104444im … -0.08047900777780297 - 0.13169892862534494im -0.13367072011683362 - 0.02095270371363845im; -0.024366788117986683 + 0.10814819807235618im 0.029651107255025275 + 0.0409246083861807im … -0.13392400350743447 + 0.003209430477791494im -0.1334418742961121 + 0.1189632192212742im;;; 0.08296330859612726 - 0.05575727562937356im 0.01557509095662266 - 0.11718164129581245im … -0.11001506637036515 + 0.07800264608677834im 0.026657547976515674 + 0.04071274026417124im; 0.05552835380792887 - 0.10926765717411363im -0.06652992141539296 - 0.07759175097573712im … 0.011433402812536814 - 0.029455476451011854im 0.0926149681591813 - 0.07075872976686824im; … ; -0.05239201962251554 + 0.0976435526198014im 0.006822319030380867 + 0.03520034857918462im … -0.14249588901448673 - 0.08205432163885074im -0.11047116194082507 + 0.06160897138943214im; 0.05269034472378217 + 0.06184093327666735im 0.03860824098191217 - 0.05614091756973042im … -0.12210143731406471 + 0.10955026544190505im -0.04308515177142827 + 0.15130388198748282im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392126634535 -0.48683674427722534 … -0.7027113226191362 -0.48683674427722545; -0.486836744277225 -0.7744303950404858 … -0.41363732843934115 -0.3823307497945216; … ; -0.7027113226191363 -0.41363732843934126 … -2.3967616825880973 -1.2958067581750043; -0.4868367442772249 -0.3823307497945215 … -1.2958067581750048 -0.7744303950404856;;; -0.4868367442772251 -0.7744303950404859 … -0.4136373284393412 -0.382330749794522; -0.7744303950404856 -1.4814477483919166 … -0.3245845694333045 -0.44991939657072444; … ; -0.4136373284393412 -0.3245845694333047 … -1.0113572986117358 -0.6373277791932178; -0.3823307497945214 -0.44991939657072444 … -0.6373277791932177 -0.44991939657072433;;; -0.7027113226191362 -1.2958067581750048 … -0.29820348937559604 -0.4136373284393414; -1.2958067581750043 -2.9196723936539355 … -0.3537295846614763 -0.6373277791932176; … ; -0.29820348937559593 -0.3537295846614768 … -0.4903726081072031 -0.35372958466147686; -0.4136373284393411 -0.6373277791932176 … -0.3537295846614763 -0.3245845694333044;;; … ;;; -1.016674421255808 -0.5332878143066232 … -3.636138257122908 -1.998760262050662; -0.5332878143066229 -0.32174124747391025 … -1.4667339407502935 -0.9061938941469148; … ; -3.636138257122908 -1.4667339407502933 … -10.988177824465955 -8.087376168208227; -1.9987602620506615 -0.9061938941469148 … -8.087376168208227 -4.647878371143278;;; -0.7027113226191362 -0.41363732843934115 … -2.3967616825880977 -1.2958067581750048; -0.4136373284393409 -0.32458456943330466 … -1.0113572986117356 -0.6373277791932176; … ; -2.3967616825880977 -1.0113572986117358 … -11.002806190875061 -6.07730418639412; -1.2958067581750043 -0.6373277791932175 … -6.07730418639412 -2.9196723936539355;;; -0.4868367442772251 -0.38233074979452186 … -1.2958067581750046 -0.7744303950404859; -0.38233074979452153 -0.44991939657072444 … -0.6373277791932176 -0.44991939657072444; … ; -1.2958067581750046 -0.6373277791932175 … -6.0773041863941195 -2.919672393653935; -0.7744303950404855 -0.4499193965707243 … -2.9196723936539355 -1.4814477483919166])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392126634535 -0.48683674427722534 … -0.7027113226191362 -0.48683674427722545; -0.486836744277225 -0.7744303950404858 … -0.41363732843934115 -0.3823307497945216; … ; -0.7027113226191363 -0.41363732843934126 … -2.3967616825880973 -1.2958067581750043; -0.4868367442772249 -0.3823307497945215 … -1.2958067581750048 -0.7744303950404856;;; -0.4868367442772251 -0.7744303950404859 … -0.4136373284393412 -0.382330749794522; -0.7744303950404856 -1.4814477483919166 … -0.3245845694333045 -0.44991939657072444; … ; -0.4136373284393412 -0.3245845694333047 … -1.0113572986117358 -0.6373277791932178; -0.3823307497945214 -0.44991939657072444 … -0.6373277791932177 -0.44991939657072433;;; -0.7027113226191362 -1.2958067581750048 … -0.29820348937559604 -0.4136373284393414; -1.2958067581750043 -2.9196723936539355 … -0.3537295846614763 -0.6373277791932176; … ; -0.29820348937559593 -0.3537295846614768 … -0.4903726081072031 -0.35372958466147686; -0.4136373284393411 -0.6373277791932176 … -0.3537295846614763 -0.3245845694333044;;; … ;;; -1.016674421255808 -0.5332878143066232 … -3.636138257122908 -1.998760262050662; -0.5332878143066229 -0.32174124747391025 … -1.4667339407502935 -0.9061938941469148; … ; -3.636138257122908 -1.4667339407502933 … -10.988177824465955 -8.087376168208227; -1.9987602620506615 -0.9061938941469148 … -8.087376168208227 -4.647878371143278;;; -0.7027113226191362 -0.41363732843934115 … -2.3967616825880977 -1.2958067581750048; -0.4136373284393409 -0.32458456943330466 … -1.0113572986117356 -0.6373277791932176; … ; -2.3967616825880977 -1.0113572986117358 … -11.002806190875061 -6.07730418639412; -1.2958067581750043 -0.6373277791932175 … -6.07730418639412 -2.9196723936539355;;; -0.4868367442772251 -0.38233074979452186 … -1.2958067581750046 -0.7744303950404859; -0.38233074979452153 -0.44991939657072444 … -0.6373277791932176 -0.44991939657072444; … ; -1.2958067581750046 -0.6373277791932175 … -6.0773041863941195 -2.919672393653935; -0.7744303950404855 -0.4499193965707243 … -2.9196723936539355 -1.4814477483919166]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.012977710882590372 + 0.00521842179248008im 0.010371686647202054 - 0.002690140074694158im … -0.035306905387649856 + 0.003109306078337365im 0.006105773900631061 + 0.0017519532655147474im; 0.0013055894875946199 + 0.00013754594098250024im 0.03659208390902698 - 0.015406284736988622im … -0.02262634330000883 + 0.0062555790136518356im 0.0048581287515135525 + 0.00854167986426272im; … ; 0.00823423625557562 + 0.003477577889672954im -0.07193778266075415 + 0.014306386448289339im … -0.0016805280791430417 + 0.010043283830402283im 0.0222257166373279 + 0.004837406038759403im; 0.007878445566333967 + 0.0032283935331085664im -0.06461510221141209 + 0.019561378963106633im … 0.021840721810327743 - 0.004039297959178786im 0.04289762454906652 - 0.006333391854613132im;;; -0.04838289277936119 + 0.0015469643303175143im -0.020353441996177443 - 0.009824616718627732im … -0.014270592624137064 + 0.006111650945794058im 0.024990809953249704 + 0.004805439778227958im; -0.055676220285271555 + 0.007186710133606391im -0.013805732226054784 - 0.007992706919420101im … -0.005057332572270225 + 0.00937733669818212im -0.0323838363644489 + 0.01249407628540303im; … ; 0.07779626691054693 - 0.00839111944456548im -0.032632517730130525 - 0.00866353648360914im … 0.04780540652370858 + 0.0028050686673201882im 0.10313232392301436 - 0.006666693389468317im; 0.026501026207369507 - 0.020295833911986673im -0.053735161340677066 - 0.015341496428926973im … 0.0456328557690075 - 0.006235558421604491im 0.09259074071926632 - 0.01536470037477009im;;; -0.13098118485751395 + 0.01011604321676881im -0.10582217249981057 + 0.009942907132927932im … -0.012986000191628388 + 0.003417550347477185im -0.06451570096986518 + 0.0016670996376881367im; -0.08487015749178263 + 0.007677354147984943im -0.06873207876342598 + 0.00028967232347095633im … -0.0123902695686801 + 0.004315120176537667im -0.04766856307790513 + 0.006184437991916951im; … ; 0.0094976174637913 - 0.013910711902830223im -0.0445566285899218 - 0.013016452004948784im … 0.044764089941400936 - 0.0033811654380173327im 0.06502934217438269 - 0.009391030868780232im; -0.04970928776243612 - 0.01637744599380613im -0.10385944326026109 - 0.008789986793733646im … 0.04207931449854885 - 0.004424292777226489im 0.022867793166007636 - 0.01076541181311226im;;; … ;;; 0.024445853441649377 + 0.010278160847120611im 0.021708015356231035 + 0.006698204242531551im … -0.0008971172258854366 + 0.010005137443424432im -0.014812986424640334 + 0.01281492382661412im; 0.028784933608301887 + 0.0046093409290935555im 0.01719228181098207 + 0.002470717634413187im … 0.007056570155589547 + 0.006144088053561418im 0.012189790847789088 + 0.0060019984473015705im; … ; 0.0049047448449242685 - 0.0035384063432351807im -0.006663714807426473 - 0.007568770030055804im … 0.059290186498185155 - 0.004400308443801204im 0.002332140657513495 + 0.0013847414944978239im; -0.03344929419847681 + 0.003902706646209941im -0.01747899258062658 + 0.0023533782295429248im … -0.01477114133790949 + 0.002790305882436988im -0.07845783725140021 + 0.009014733298413229im;;; 0.08650656744378775 + 0.013198458348358814im 0.034150102842527605 + 0.01284134038224743im … 0.02242079531351874 + 0.01512447404888988im 0.010256814723104987 + 0.015583791366861912im; 0.022232499615420308 - 0.0019425002601846846im 0.004921143780878413 - 0.0014880788648131407im … 0.00627704654202971 + 0.0046481224238322455im 0.03290964730028868 + 0.004544952137182702im; … ; -0.010492900579070921 - 0.014326813691474913im -0.049218676296206985 - 0.009037639457023633im … 0.032673034452223894 + 0.012614128189590793im -0.0006981123332382307 + 0.00815102479596292im; -0.013299874045174142 + 0.008409823223238539im -0.025295467444765844 + 0.012841942515113839im … -0.007748426967805935 + 0.016268775775201694im -0.025746128151469837 + 0.017430610153557555im;;; 0.019051816464169626 + 0.006740603118688982im -0.03242885215258762 + 0.013695953674358167im … -0.012833045843665764 - 0.00022403798859704956im 0.00305765362922337 + 0.0017578260912438043im; -0.030174746437998334 - 0.011263878055734242im 0.002615464157757901 - 0.013771241221158173im … -0.016993912007457562 + 0.000564930924465122im -0.022583167058763315 - 0.005591923193109825im; … ; -0.04805989447420207 - 0.008428538327897663im -0.10662106130687193 + 0.006397522019360455im … -0.005908996458129485 + 0.013835612935570289im -0.03225825184773372 + 0.0015837877704967642im; -0.038379345250156474 + 0.0078074490940608764im -0.09838007468414467 + 0.029896881845661152im … 0.012173065382239171 + 0.0035169926775604396im -0.030369606630896342 + 0.002798621015559704im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392126634535 -0.48683674427722534 … -0.7027113226191362 -0.48683674427722545; -0.486836744277225 -0.7744303950404858 … -0.41363732843934115 -0.3823307497945216; … ; -0.7027113226191363 -0.41363732843934126 … -2.3967616825880973 -1.2958067581750043; -0.4868367442772249 -0.3823307497945215 … -1.2958067581750048 -0.7744303950404856;;; -0.4868367442772251 -0.7744303950404859 … -0.4136373284393412 -0.382330749794522; -0.7744303950404856 -1.4814477483919166 … -0.3245845694333045 -0.44991939657072444; … ; -0.4136373284393412 -0.3245845694333047 … -1.0113572986117358 -0.6373277791932178; -0.3823307497945214 -0.44991939657072444 … -0.6373277791932177 -0.44991939657072433;;; -0.7027113226191362 -1.2958067581750048 … -0.29820348937559604 -0.4136373284393414; -1.2958067581750043 -2.9196723936539355 … -0.3537295846614763 -0.6373277791932176; … ; -0.29820348937559593 -0.3537295846614768 … -0.4903726081072031 -0.35372958466147686; -0.4136373284393411 -0.6373277791932176 … -0.3537295846614763 -0.3245845694333044;;; … ;;; -1.016674421255808 -0.5332878143066232 … -3.636138257122908 -1.998760262050662; -0.5332878143066229 -0.32174124747391025 … -1.4667339407502935 -0.9061938941469148; … ; -3.636138257122908 -1.4667339407502933 … -10.988177824465955 -8.087376168208227; -1.9987602620506615 -0.9061938941469148 … -8.087376168208227 -4.647878371143278;;; -0.7027113226191362 -0.41363732843934115 … -2.3967616825880977 -1.2958067581750048; -0.4136373284393409 -0.32458456943330466 … -1.0113572986117356 -0.6373277791932176; … ; -2.3967616825880977 -1.0113572986117358 … -11.002806190875061 -6.07730418639412; -1.2958067581750043 -0.6373277791932175 … -6.07730418639412 -2.9196723936539355;;; -0.4868367442772251 -0.38233074979452186 … -1.2958067581750046 -0.7744303950404859; -0.38233074979452153 -0.44991939657072444 … -0.6373277791932176 -0.44991939657072444; … ; -1.2958067581750046 -0.6373277791932175 … -6.0773041863941195 -2.919672393653935; -0.7744303950404855 -0.4499193965707243 … -2.9196723936539355 -1.4814477483919166])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392126634535 -0.48683674427722534 … -0.7027113226191362 -0.48683674427722545; -0.486836744277225 -0.7744303950404858 … -0.41363732843934115 -0.3823307497945216; … ; -0.7027113226191363 -0.41363732843934126 … -2.3967616825880973 -1.2958067581750043; -0.4868367442772249 -0.3823307497945215 … -1.2958067581750048 -0.7744303950404856;;; -0.4868367442772251 -0.7744303950404859 … -0.4136373284393412 -0.382330749794522; -0.7744303950404856 -1.4814477483919166 … -0.3245845694333045 -0.44991939657072444; … ; -0.4136373284393412 -0.3245845694333047 … -1.0113572986117358 -0.6373277791932178; -0.3823307497945214 -0.44991939657072444 … -0.6373277791932177 -0.44991939657072433;;; -0.7027113226191362 -1.2958067581750048 … -0.29820348937559604 -0.4136373284393414; -1.2958067581750043 -2.9196723936539355 … -0.3537295846614763 -0.6373277791932176; … ; -0.29820348937559593 -0.3537295846614768 … -0.4903726081072031 -0.35372958466147686; -0.4136373284393411 -0.6373277791932176 … -0.3537295846614763 -0.3245845694333044;;; … ;;; -1.016674421255808 -0.5332878143066232 … -3.636138257122908 -1.998760262050662; -0.5332878143066229 -0.32174124747391025 … -1.4667339407502935 -0.9061938941469148; … ; -3.636138257122908 -1.4667339407502933 … -10.988177824465955 -8.087376168208227; -1.9987602620506615 -0.9061938941469148 … -8.087376168208227 -4.647878371143278;;; -0.7027113226191362 -0.41363732843934115 … -2.3967616825880977 -1.2958067581750048; -0.4136373284393409 -0.32458456943330466 … -1.0113572986117356 -0.6373277791932176; … ; -2.3967616825880977 -1.0113572986117358 … -11.002806190875061 -6.07730418639412; -1.2958067581750043 -0.6373277791932175 … -6.07730418639412 -2.9196723936539355;;; -0.4868367442772251 -0.38233074979452186 … -1.2958067581750046 -0.7744303950404859; -0.38233074979452153 -0.44991939657072444 … -0.6373277791932176 -0.44991939657072444; … ; -1.2958067581750046 -0.6373277791932175 … -6.0773041863941195 -2.919672393653935; -0.7744303950404855 -0.4499193965707243 … -2.9196723936539355 -1.4814477483919166]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.05835072183503709 - 0.013284168233884576im -0.06042057110947769 - 0.03464487233602996im … -0.019241502671086236 - 0.015559337198830915im -0.04657737290409508 - 0.007045111554252146im; -0.08862302425502709 - 0.03810829296779951im -0.06805389650673667 - 0.04181710708144207im … -0.021323142641324663 - 0.0074288052723027655im -0.06063922765845346 - 0.015655507238235195im; … ; 0.018670293037766725 + 0.025627210811109805im 0.02312792191816586 + 0.024731372105456072im … 0.05635768990617049 + 0.007865197788731232im 0.02979197391220418 + 0.01370535886898169im; 0.010696364394297905 + 0.02374336667357011im 0.009930240524136134 + 0.00769957450273826im … 0.06806972732747443 + 0.011716799894050871im 0.021551360702724294 + 0.016231671029073847im;;; -0.08655876226520194 - 0.03637164731216251im -0.04888689146006227 - 0.04929819042620727im … -0.01954589319145846 + 0.009707113920183042im -0.07199471156935097 - 0.010889166044165177im; -0.0257050883774887 - 0.01137612057993197im -0.0063592543342588905 - 0.019027232675424045im … -0.0009962353756152631 + 0.005651946824166051im -0.0480907738478184 - 0.015007689098152257im; … ; 0.026086894974156005 + 0.03589970659334136im 0.04296320664540945 + 0.03666925934290416im … 0.047182983187754705 + 0.02417423949035679im 0.04613946059757848 + 0.04087619419336229im; -0.011316446318481704 + 0.020447677774675432im 0.002290811000133999 - 0.006802733836617122im … 0.05012717567248827 + 0.04355036946706321im -0.011820673499631626 + 0.02451324754189229im;;; -0.08177974657225842 - 0.08111034915011323im -0.067902918805417 - 0.08220099339098069im … -0.026099449034056345 - 0.005320692470459697im -0.09937722001625851 - 0.06314027309358611im; -0.0064331106128580045 - 0.036283833389227936im -0.03318304832812907 - 0.06351333830610922im … -0.011085152852998659 - 0.009512202640194044im -0.03174477883809233 - 0.0349592498669311im; … ; 0.025883360047566754 + 0.029783030438731296im 0.02456273954736945 + 0.014318706771661388im … 0.032910112871212 + 0.027738250136299582im 0.030309747318673662 + 0.03658286491664126im; -0.033542532378045525 - 0.02501275791499441im -0.02858755966513949 - 0.043783939967024656im … 0.020273694934731343 + 0.030219150027936296im -0.015577780090424103 + 0.013917084919749384im;;; … ;;; 0.06823273898600751 + 0.05852867972950392im 0.017219939579706262 + 0.02691513104096309im … 0.006930844542361066 - 0.003513532450888119im 0.05870983995160181 + 0.032799949433365436im; 0.028031116109315593 + 0.03532352410325045im -0.003374106117867603 + 0.0074250490506395615im … 0.02238062851627043 + 0.015363397031602256im 0.04152697885993957 + 0.03604283963960414im; … ; 0.03739690019545473 + 0.02265136798707991im 0.029974592481144036 + 0.027546277060476448im … -0.06321935662842797 - 0.04024199182601296im -0.01233000721416774 - 0.018152447427433188im; 0.06154412075554738 + 0.04440828475994024im 0.030787053674986124 + 0.03601109824388544im … -0.032507975434735166 - 0.030450147913757112im 0.012967352124447076 - 0.0015107946025401794im;;; 0.08490049406248193 + 0.0829134930379893im -0.005242077839719292 + 0.01474301265026342im … 0.05519027490316536 + 0.035277129137167074im 0.12541606163882152 + 0.08954453950133599im; 0.004761867733886481 + 0.027548579221284543im -0.04623422321187659 - 0.02396801857901348im … 0.02518666903026728 + 0.01930813548208042im 0.04057386673612996 + 0.04315630939527829im; … ; 0.07734894797560093 + 0.0684560662089346im 0.0222674800799718 + 0.03450958087391259im … 0.06425764155923896 + 0.05760981145867656im 0.08102161553085963 + 0.06019637877496824im; 0.0994012783964957 + 0.08444130814207532im 0.010383203038285639 + 0.02829326193492221im … 0.0698807186223904 + 0.0400890954108086im 0.12150625143617802 + 0.07654101483591544im;;; 0.0018633567168914328 + 0.015555007048547894im -0.058604161809953176 - 0.04187338177488996im … 0.026880427461920778 - 0.008410142076231236im 0.045861921499991506 + 0.025921052088445543im; -0.08871680228666169 - 0.045482280287355556im -0.08257398213176045 - 0.0578609563630447im … -0.010660203912583849 - 0.01578149159955485im -0.020947837162667633 - 0.0009898370976429238im; … ; 0.005337146992021832 + 0.013655738022142426im -0.015595239189592394 - 0.0008457125013515768im … 0.06728659214507213 + 0.029647102591079656im 0.06088663993489038 + 0.028715732357359178im; 0.01872052822661867 + 0.020249699557132336im -0.014163421508750301 - 0.006646711248300418im … 0.07040064568276158 + 0.011165771757587732im 0.07249483099842041 + 0.02195749672672994im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392126634535 -0.48683674427722534 … -0.7027113226191362 -0.48683674427722545; -0.486836744277225 -0.7744303950404858 … -0.41363732843934115 -0.3823307497945216; … ; -0.7027113226191363 -0.41363732843934126 … -2.3967616825880973 -1.2958067581750043; -0.4868367442772249 -0.3823307497945215 … -1.2958067581750048 -0.7744303950404856;;; -0.4868367442772251 -0.7744303950404859 … -0.4136373284393412 -0.382330749794522; -0.7744303950404856 -1.4814477483919166 … -0.3245845694333045 -0.44991939657072444; … ; -0.4136373284393412 -0.3245845694333047 … -1.0113572986117358 -0.6373277791932178; -0.3823307497945214 -0.44991939657072444 … -0.6373277791932177 -0.44991939657072433;;; -0.7027113226191362 -1.2958067581750048 … -0.29820348937559604 -0.4136373284393414; -1.2958067581750043 -2.9196723936539355 … -0.3537295846614763 -0.6373277791932176; … ; -0.29820348937559593 -0.3537295846614768 … -0.4903726081072031 -0.35372958466147686; -0.4136373284393411 -0.6373277791932176 … -0.3537295846614763 -0.3245845694333044;;; … ;;; -1.016674421255808 -0.5332878143066232 … -3.636138257122908 -1.998760262050662; -0.5332878143066229 -0.32174124747391025 … -1.4667339407502935 -0.9061938941469148; … ; -3.636138257122908 -1.4667339407502933 … -10.988177824465955 -8.087376168208227; -1.9987602620506615 -0.9061938941469148 … -8.087376168208227 -4.647878371143278;;; -0.7027113226191362 -0.41363732843934115 … -2.3967616825880977 -1.2958067581750048; -0.4136373284393409 -0.32458456943330466 … -1.0113572986117356 -0.6373277791932176; … ; -2.3967616825880977 -1.0113572986117358 … -11.002806190875061 -6.07730418639412; -1.2958067581750043 -0.6373277791932175 … -6.07730418639412 -2.9196723936539355;;; -0.4868367442772251 -0.38233074979452186 … -1.2958067581750046 -0.7744303950404859; -0.38233074979452153 -0.44991939657072444 … -0.6373277791932176 -0.44991939657072444; … ; -1.2958067581750046 -0.6373277791932175 … -6.0773041863941195 -2.919672393653935; -0.7744303950404855 -0.4499193965707243 … -2.9196723936539355 -1.4814477483919166])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392126634535 -0.48683674427722534 … -0.7027113226191362 -0.48683674427722545; -0.486836744277225 -0.7744303950404858 … -0.41363732843934115 -0.3823307497945216; … ; -0.7027113226191363 -0.41363732843934126 … -2.3967616825880973 -1.2958067581750043; -0.4868367442772249 -0.3823307497945215 … -1.2958067581750048 -0.7744303950404856;;; -0.4868367442772251 -0.7744303950404859 … -0.4136373284393412 -0.382330749794522; -0.7744303950404856 -1.4814477483919166 … -0.3245845694333045 -0.44991939657072444; … ; -0.4136373284393412 -0.3245845694333047 … -1.0113572986117358 -0.6373277791932178; -0.3823307497945214 -0.44991939657072444 … -0.6373277791932177 -0.44991939657072433;;; -0.7027113226191362 -1.2958067581750048 … -0.29820348937559604 -0.4136373284393414; -1.2958067581750043 -2.9196723936539355 … -0.3537295846614763 -0.6373277791932176; … ; -0.29820348937559593 -0.3537295846614768 … -0.4903726081072031 -0.35372958466147686; -0.4136373284393411 -0.6373277791932176 … -0.3537295846614763 -0.3245845694333044;;; … ;;; -1.016674421255808 -0.5332878143066232 … -3.636138257122908 -1.998760262050662; -0.5332878143066229 -0.32174124747391025 … -1.4667339407502935 -0.9061938941469148; … ; -3.636138257122908 -1.4667339407502933 … -10.988177824465955 -8.087376168208227; -1.9987602620506615 -0.9061938941469148 … -8.087376168208227 -4.647878371143278;;; -0.7027113226191362 -0.41363732843934115 … -2.3967616825880977 -1.2958067581750048; -0.4136373284393409 -0.32458456943330466 … -1.0113572986117356 -0.6373277791932176; … ; -2.3967616825880977 -1.0113572986117358 … -11.002806190875061 -6.07730418639412; -1.2958067581750043 -0.6373277791932175 … -6.07730418639412 -2.9196723936539355;;; -0.4868367442772251 -0.38233074979452186 … -1.2958067581750046 -0.7744303950404859; -0.38233074979452153 -0.44991939657072444 … -0.6373277791932176 -0.44991939657072444; … ; -1.2958067581750046 -0.6373277791932175 … -6.0773041863941195 -2.919672393653935; -0.7744303950404855 -0.4499193965707243 … -2.9196723936539355 -1.4814477483919166]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.012404897209816787 + 0.006834903529738394im 0.0333810846559034 + 0.01842661693306375im … -0.0033823805604301987 - 0.0018687378740036087im -0.01976188535009942 - 0.01092617086641994im; -0.010365033610495034 - 0.005728846248096671im 0.024510200016359226 + 0.013536076907013904im … 0.001300875846245481 + 0.0007102725315991437im -0.02653395734577719 - 0.014658620074373544im; … ; -0.016503049176410566 - 0.009119644851442118im -0.0015489699745728895 - 0.0008594012325422837im … -0.02526526039842967 - 0.013933985500682002im -0.016100716114052782 - 0.008890074102057133im; 0.002212593273490433 + 0.0012097037010849855im 0.02726274908358782 + 0.015049782093022723im … -0.01953338426705688 - 0.010774000623777378im -0.015973873330216437 - 0.008825970736912284im;;; -0.048075217428123145 - 0.06800108239496766im 0.015446818539711518 - 0.0028199039617107916im … 0.02639786930586868 + 0.02275130142778863im -0.04446078042538956 - 0.05988035637014626im; -0.02646991065465129 - 0.032818912859181704im 0.028435957283787817 + 0.01289698809888703im … 0.012985198722191052 + 0.007360621576586629im -0.06004020441594038 - 0.06329396152295516im; … ; 0.001231741658694273 - 0.004595972947377598im 0.009907599048795394 + 0.0032094588449381074im … 0.03385973890390039 + 0.038537082397703024im 0.036229021828789676 + 0.03269210832838642im; -0.01788559415894761 - 0.03719137128773886im 0.01374113829831939 - 0.006994181610653788im … 0.05335960744554231 + 0.05586582716306211im 0.0021176083285425395 - 0.008181252390416982im;;; -0.0498769566454109 - 0.05681263989116569im 0.018775013966587994 + 0.01942938846757014im … -0.0171501569623427 - 0.027585719524304594im -0.1040321910052808 - 0.11945364055503668im; 0.020599976021592734 + 0.024279555791827043im 0.06537404568202357 + 0.06978154044561696im … -0.04915960741851108 - 0.0560905862202662im -0.08528418085141903 - 0.08760938968802212im; … ; -0.01763644036137054 - 0.02314900152649976im 0.00018207954972304403 - 0.008030803077349933im … 0.02774380677248644 + 0.026252413573491125im 0.014562074406213547 + 0.006016691828638232im; -0.05912142978423523 - 0.07595296756498275im 0.007760490869417264 - 0.0023121522962360145im … 0.01909294972010872 + 0.010834622441779991im -0.042843606889007 - 0.05848387874410976im;;; … ;;; 0.007847735567372028 + 0.0010845517719347726im -0.007853995392254929 - 0.005477065423123362im … 0.03391059894846739 + 0.03672112436552396im 0.04754567032741571 + 0.035845351289292685im; -0.012929188607268528 - 0.01611374817272486im -0.0144015807989639 - 0.009694240641875823im … 0.024152723277309357 + 0.016987636760241048im 0.010857330517227481 - 0.0005446229099774604im; … ; 0.00691808374497709 + 0.004772851764092062im -0.008869143575307763 - 0.008117752620785592im … 0.08829038852115131 + 0.09914586622461981im 0.044100694507204455 + 0.040886604105463534im; -0.0030756422807272717 - 0.00798193097608773im -0.014953461391077737 - 0.01498555066890001im … 0.023990873238478545 + 0.04103623574353592im 0.021857826588167248 + 0.018789334517081886im;;; -0.02638090859910281 - 0.0274561445763616im -0.01270767975492009 - 0.002599937487805783im … 0.014286540777004185 - 0.003081184502292643im 0.0031820243069489067 - 0.01878646844118692im; -0.061668789715399866 - 0.05446747069467903im -0.030398720944366884 - 0.019163206805927854im … -0.013739635633944397 - 0.030013313171215493im -0.03272796000607276 - 0.04593531115333554im; … ; -0.03871275583555242 - 0.03248607588419501im -0.024699020179071676 - 0.016660298314674492im … 0.05222461389526425 + 0.05810518051153368im -0.012812635210254438 - 0.01613382712250683im; -0.05791995076015276 - 0.05396229553987475im -0.023339743725346116 - 0.016459639751577597im … -0.024375504853372924 - 0.026348909456469203im -0.05207126918517503 - 0.06241938676331045im;;; -0.0382575863356981 - 0.023945189934062246im 0.0052454652862050696 + 0.009605987621184177im … -0.045069946229668215 - 0.05501426920264271im -0.037026630458650844 - 0.038649996102908264im; -0.07562681380560726 - 0.058466550026391464im -0.007992430715301767 - 0.0038559804492027186im … -0.03901298151407766 - 0.043780663768513584im -0.05142940009720601 - 0.04104129027209638im; … ; -0.06460010200536695 - 0.05024900565571214im -0.020145573084859064 - 0.01064898866754439im … -0.03466744263008589 - 0.02846013166118351im -0.07735199249662257 - 0.0700068686140768im; -0.05504328063675026 - 0.04174282129872037im -0.0073234705086558365 - 0.0034985782990075145im … -0.07870410498340287 - 0.07875125316298406im -0.09648604444538958 - 0.09471276211467632im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729846), converged = true, ρ = [0.09132316917746466 0.08747419134079484 … 0.07684754935962455 0.08747419134079484; 0.08747419134079484 0.08089966872163172 … 0.07642471016970993 0.08486944834425944; … ; 0.07684754935962454 0.07642471016970993 … 0.04778466667101447 0.06587895342302719; 0.08747419134079484 0.08486944834425944 … 0.0658789534230272 0.08089966872163175;;; 0.08747419134079483 0.08089966872163175 … 0.07642471016970993 0.08486944834425944; 0.08089966872163173 0.06744471469773983 … 0.0734866993470387 0.08163768629014025; … ; 0.07642471016970993 0.0734866993470387 … 0.0618880411999601 0.07259829028446349; 0.08486944834425944 0.08163768629014025 … 0.07259829028446349 0.08163768629014025;;; 0.07684754935962454 0.0658789534230272 … 0.06847203698973367 0.07642471016970993; 0.06587895342302719 0.04657864264980388 … 0.06665759371631559 0.07259829028446349; … ; 0.06847203698973366 0.06665759371631559 … 0.06132515314380609 0.0666575937163156; 0.07642471016970993 0.07259829028446349 … 0.0666575937163156 0.0734866993470387;;; … ;;; 0.06328495229885402 0.06591651445952278 … 0.033940648880515074 0.04987593485998496; 0.06591651445952278 0.06297790960105278 … 0.049756397885272315 0.060870204571458544; … ; 0.03394064888051506 0.049756397885272315 … 0.009696353214073266 0.016831338792590043; 0.04987593485998496 0.060870204571458544 … 0.016831338792590047 0.03098572188504702;;; 0.07684754935962453 0.07642471016970993 … 0.04778466667101448 0.0658789534230272; 0.07642471016970993 0.0734866993470387 … 0.06188804119996009 0.07259829028446349; … ; 0.04778466667101448 0.06188804119996009 … 0.009696353214073266 0.025710010675302594; 0.0658789534230272 0.07259829028446349 … 0.0257100106753026 0.0465786426498039;;; 0.08747419134079482 0.08486944834425945 … 0.0658789534230272 0.08089966872163175; 0.08486944834425944 0.08163768629014023 … 0.07259829028446349 0.08163768629014025; … ; 0.06587895342302719 0.07259829028446349 … 0.02571001067530259 0.046578642649803895; 0.08089966872163175 0.08163768629014025 … 0.04657864264980391 0.06744471469773984;;;;], eigenvalues = [[-0.1667770759630507, 0.26427771782994747, 0.26427771782996484, 0.26427771782997156, 0.3573203719045221, 0.3573203719045264, 0.35732037190453525], [-0.116132187610807, 0.07040532320006565, 0.22624813603026195, 0.226248136030264, 0.3361178489460459, 0.3934379776180098, 0.39343797761801164], [-0.0958893814363756, 0.08764319967962245, 0.1731270414274447, 0.1731270414274533, 0.2919724892213093, 0.3377321250728948, 0.5327646516180635], [-0.045051463485911034, 0.022269526239845697, 0.09831189251535286, 0.18446409322119972, 0.3229270151624746, 0.4802469604443967, 0.5024422335818844]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.28971208183820896, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.3343179789327604 + 0.8951079010671932im 2.264635497334718e-14 - 1.1965456533449306e-13im … 5.941678865535691e-10 + 7.480254215845887e-10im 2.8574352544458525e-10 + 3.5972619591014157e-10im; -0.03369062677103697 + 0.09020378237167505im -0.07021973713140889 + 0.35400492554917906im … -0.18565550821466642 + 0.05887841430311635im -0.1735669018421019 - 0.09755880955466453im; … ; -0.004126655730434497 + 0.011048769082221264im -0.01456738846804736 - 0.003999150192083472im … 0.0011912051726252436 + 0.03400684763245148im 0.018212312953225743 - 0.004196830278516922im; 0.033690626771024225 - 0.09020378237167354im -0.21283769965364602 + 0.3148523586033973im … 0.19547021374866802 + 0.22131448645270974im 0.32362376197610726 + 0.06297983112889322im], [-0.5652902528043426 + 0.7368868833074212im -0.14962742074804247 - 0.12833473596847442im … -2.7530949396401793e-11 - 6.668033420066462e-12im -2.697098694582963e-12 - 5.6354758553294295e-12im; -0.038536926005368795 + 0.05023499902124408im 0.006659494705481511 + 0.0057118173289278im … -7.677688509302282e-12 - 1.8018933100924767e-12im 2.905640954009717e-12 - 4.484126342017094e-13im; … ; -0.004717616567398442 + 0.006149672228990018im -0.06547455983848123 - 0.05615722243633892im … -0.05582737967833324 - 0.05431938669630999im 0.054630124313504363 + 0.05499518736549699im; 0.06873775066683452 - 0.0896034322247157im 0.06885151370645529 + 0.05905361990718765im … -0.23696260705531366 - 0.23056184173117977im 0.23188078557814404 + 0.2334303174179178im], [0.8711014630631152 + 0.3362632811520867im 1.3960881011307832e-14 + 4.7385752031530674e-15im … 7.617154628789215e-11 + 8.801778304018716e-11im -1.741278610710595e-8 - 8.009958467482084e-9im; 0.06413593926253086 + 0.024757806398755834im -0.053738054001458556 - 0.01956917480157414im … -0.01770446701093958 - 0.017907445595206798im -0.008857493614622031 - 0.004890133493469584im; … ; 0.012939664938534415 + 0.0049949797741588526im -4.7388914508360945e-14 - 1.459852167096884e-14im … 1.2584357462154016e-10 + 1.9526010509476146e-10im -0.044583366630756925 - 0.049456043513803456im; -0.1429293182357172 - 0.05517368935849269im -0.269794993289584 - 0.09824816849769438im … 0.26846192239747785 + 0.27153979146931384im -0.1016599937672893 - 0.11442680744088125im], [0.7081853168360556 + 0.39112023123516304im -3.7117615001805e-15 - 2.843441169789271e-15im … 0.1641033360336407 + 0.09056085747017913im 6.089167284645523e-6 + 3.3530804439899177e-6im; 0.3391828819048079 + 0.18732566751638563im 0.5485862222425703 + 0.30276063707458806im … -0.1560374683004033 - 0.086109687118977im -3.194564386037484e-6 - 1.7591018097674516e-6im; … ; 0.009973689945764534 + 0.005508320809703704im 0.001439033108416729 + 0.000794191620225969im … 0.014162266736435813 + 0.007815417107817179im -0.02945188000676832 - 0.033077769759913174im; -0.05705638271957286 - 0.03151139267108874im 0.010930916664798637 + 0.006032691232586754im … 0.11850941872842759 + 0.06540018639130854im -0.31296665503844034 - 0.3515071932404678im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.1667770759630507, 0.26427771782994747, 0.26427771782996484, 0.26427771782997156, 0.3573203719045221, 0.3573203719045264, 0.35732037190453525], [-0.116132187610807, 0.07040532320006565, 0.22624813603026195, 0.226248136030264, 0.3361178489460459, 0.3934379776180098, 0.39343797761801164], [-0.0958893814363756, 0.08764319967962245, 0.1731270414274447, 0.1731270414274533, 0.2919724892213093, 0.3377321250728948, 0.5327646516180635], [-0.045051463485911034, 0.022269526239845697, 0.09831189251535286, 0.18446409322119972, 0.3229270151624746, 0.4802469604443967, 0.5024422335818844]], X = [[-0.3343179789327604 + 0.8951079010671932im 2.264635497334718e-14 - 1.1965456533449306e-13im … 5.941678865535691e-10 + 7.480254215845887e-10im 2.8574352544458525e-10 + 3.5972619591014157e-10im; -0.03369062677103697 + 0.09020378237167505im -0.07021973713140889 + 0.35400492554917906im … -0.18565550821466642 + 0.05887841430311635im -0.1735669018421019 - 0.09755880955466453im; … ; -0.004126655730434497 + 0.011048769082221264im -0.01456738846804736 - 0.003999150192083472im … 0.0011912051726252436 + 0.03400684763245148im 0.018212312953225743 - 0.004196830278516922im; 0.033690626771024225 - 0.09020378237167354im -0.21283769965364602 + 0.3148523586033973im … 0.19547021374866802 + 0.22131448645270974im 0.32362376197610726 + 0.06297983112889322im], [-0.5652902528043426 + 0.7368868833074212im -0.14962742074804247 - 0.12833473596847442im … -2.7530949396401793e-11 - 6.668033420066462e-12im -2.697098694582963e-12 - 5.6354758553294295e-12im; -0.038536926005368795 + 0.05023499902124408im 0.006659494705481511 + 0.0057118173289278im … -7.677688509302282e-12 - 1.8018933100924767e-12im 2.905640954009717e-12 - 4.484126342017094e-13im; … ; -0.004717616567398442 + 0.006149672228990018im -0.06547455983848123 - 0.05615722243633892im … -0.05582737967833324 - 0.05431938669630999im 0.054630124313504363 + 0.05499518736549699im; 0.06873775066683452 - 0.0896034322247157im 0.06885151370645529 + 0.05905361990718765im … -0.23696260705531366 - 0.23056184173117977im 0.23188078557814404 + 0.2334303174179178im], [0.8711014630631152 + 0.3362632811520867im 1.3960881011307832e-14 + 4.7385752031530674e-15im … 7.617154628789215e-11 + 8.801778304018716e-11im -1.741278610710595e-8 - 8.009958467482084e-9im; 0.06413593926253086 + 0.024757806398755834im -0.053738054001458556 - 0.01956917480157414im … -0.01770446701093958 - 0.017907445595206798im -0.008857493614622031 - 0.004890133493469584im; … ; 0.012939664938534415 + 0.0049949797741588526im -4.7388914508360945e-14 - 1.459852167096884e-14im … 1.2584357462154016e-10 + 1.9526010509476146e-10im -0.044583366630756925 - 0.049456043513803456im; -0.1429293182357172 - 0.05517368935849269im -0.269794993289584 - 0.09824816849769438im … 0.26846192239747785 + 0.27153979146931384im -0.1016599937672893 - 0.11442680744088125im], [0.7081853168360556 + 0.39112023123516304im -3.7117615001805e-15 - 2.843441169789271e-15im … 0.1641033360336407 + 0.09056085747017913im 6.089167284645523e-6 + 3.3530804439899177e-6im; 0.3391828819048079 + 0.18732566751638563im 0.5485862222425703 + 0.30276063707458806im … -0.1560374683004033 - 0.086109687118977im -3.194564386037484e-6 - 1.7591018097674516e-6im; … ; 0.009973689945764534 + 0.005508320809703704im 0.001439033108416729 + 0.000794191620225969im … 0.014162266736435813 + 0.007815417107817179im -0.02945188000676832 - 0.033077769759913174im; -0.05705638271957286 - 0.03151139267108874im 0.010930916664798637 + 0.006032691232586754im … 0.11850941872842759 + 0.06540018639130854im -0.31296665503844034 - 0.3515071932404678im]], residual_norms = [[5.75052167945637e-13, 6.346729010551128e-13, 5.233075514239324e-13, 4.841744641100881e-13, 1.0685696638298197e-9, 5.270037256529762e-9, 2.5343645598928875e-9], [1.177763116174111e-13, 5.185617521407655e-13, 2.704672366615995e-13, 1.3520438199579034e-13, 3.1325758113083777e-10, 5.516172008402772e-10, 3.9422603957515857e-10], [1.0866557062724867e-13, 2.842395269774483e-13, 6.466694147985718e-13, 6.214687052031071e-13, 1.0177688260340155e-10, 2.53098161139563e-9, 1.9721425183314403e-7], [1.4926001041137904e-13, 4.631611496987037e-13, 1.1649838770122944e-13, 3.388483351813518e-13, 1.175033711839262e-9, 1.2043078414455443e-5, 6.647021473614653e-6]], iterations = [33, 21, 20, 20], converged = 1, n_matvec = 646)], stage = :finalize, algorithm = &quot;SCF&quot;, occupation_threshold = 1.0e-6)</code></pre><h2 id="Direct-minimization"><a class="docs-heading-anchor" href="#Direct-minimization">Direct minimization</a><a id="Direct-minimization-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-minimization" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_dm = direct_minimization(basis; tol)

# Newton algorithm</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39155563711116104 0.3785174209748359 … 0.34469960033837954 0.3785174209748359; 0.3785174209748359 0.3664584407246045 … 0.32735728177820445 0.3636495426873943; … ; 0.34469960033837954 0.3273572817782044 … 0.3075192694871403 0.33438053205824836; 0.37851742097483587 0.3636495426873943 … 0.33438053205824836 0.3664584407246045;;; 0.3785174209748359 0.3664584407246045 … 0.3273572817782044 0.3636495426873943; 0.3664584407246045 0.3510288634945272 … 0.3111940135086501 0.35191706641470893; … ; 0.3273572817782044 0.3111940135086501 … 0.2982412284760973 0.3214260028769237; 0.36364954268739424 0.35191706641470893 … 0.3214260028769237 0.35191706641470893;;; 0.34469960033837954 0.33438053205824836 … 0.2865351538038493 0.32735728177820445; 0.33438053205824836 0.31861604783277436 … 0.27805891886489636 0.32142600287692374; … ; 0.2865351538038493 0.2780589188648963 … 0.2559018577680054 0.27805891886489625; 0.3273572817782044 0.32142600287692374 … 0.27805891886489625 0.31119401350865006;;; … ;;; 0.30487474934911357 0.2830366690086914 … 0.28556433238265816 0.300957370583466; 0.2830366690086914 0.25898431625491225 … 0.27263300135001683 0.28541419668393814; … ; 0.28556433238265816 0.2726330013500168 … 0.2771603891970547 0.2812108738450954; 0.30095737058346594 0.28541419668393814 … 0.2812108738450954 0.2930827263355356;;; 0.3446996003383796 0.32735728177820445 … 0.30751926948714026 0.3343805320582483; 0.3273572817782045 0.31119401350865006 … 0.2982412284760973 0.32142600287692374; … ; 0.30751926948714026 0.29824122847609724 … 0.27716038919705477 0.2931311915341791; 0.3343805320582483 0.32142600287692374 … 0.2931311915341791 0.31861604783277436;;; 0.3785174209748359 0.36364954268739424 … 0.3343805320582484 0.3664584407246045; 0.36364954268739424 0.35191706641470893 … 0.3214260028769237 0.35191706641470893; … ; 0.33438053205824836 0.32142600287692363 … 0.2931311915341792 0.31861604783277436; 0.36645844072460443 0.35191706641470893 … 0.3186160478327743 0.3510288634945273]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923474311 -0.49665655725940316 … -0.4771919009933798 -0.49665655725940316; -0.49665655725940316 -0.4848182087445084 … -0.47638044578786004 -0.4920413111974583; … ; -0.4771919009933798 -0.47638044578786004 … -0.41228807088992653 -0.45507008158229434; -0.49665655725940316 -0.4920413111974583 … -0.45507008158229434 -0.4848182087445084;;; -0.49665655725940316 -0.4848182087445084 … -0.47638044578786004 -0.49204131119745825; -0.4848182087445084 -0.45837440794254136 … -0.4706560157209865 -0.4861790252033624; … ; -0.47638044578786004 -0.4706560157209865 … -0.44639843646311583 -0.46889439641743297; -0.49204131119745825 -0.4861790252033624 … -0.46889439641743297 -0.4861790252033624;;; -0.4771919009933798 -0.45507008158229434 … -0.4605141234322264 -0.47638044578786004; -0.45507008158229434 -0.40906618245080184 … -0.4567199083334603 -0.46889439641743297; … ; -0.4605141234322264 -0.4567199083334603 … -0.44514495662221887 -0.4567199083334604; -0.47638044578786004 -0.46889439641743297 … -0.4567199083334603 -0.4706560157209865;;; … ;;; -0.44947595086129377 -0.45514997221670905 … -0.3712598626240089 -0.41774571521784964; -0.45514997221670905 -0.44880351100209787 … -0.41743801073914744 -0.4441260993211459; … ; -0.3712598626240089 -0.41743801073914744 … -0.25365698323135544 -0.2997980910332384; -0.41774571521784964 -0.4441260993211459 … -0.2997980910332383 -0.3610634326433731;;; -0.4771919009933798 -0.47638044578786004 … -0.41228807088992653 -0.45507008158229434; -0.47638044578786004 -0.4706560157209865 … -0.44639843646311583 -0.46889439641743297; … ; -0.41228807088992653 -0.44639843646311583 … -0.25365698323135555 -0.34106330228989185; -0.45507008158229434 -0.46889439641743297 … -0.3410633022898918 -0.40906618245080184;;; -0.49665655725940316 -0.49204131119745825 … -0.4550700815822944 -0.4848182087445084; -0.49204131119745825 -0.4861790252033624 … -0.46889439641743297 -0.4861790252033624; … ; -0.45507008158229434 -0.46889439641743297 … -0.3410633022898919 -0.40906618245080184; -0.4848182087445084 -0.4861790252033624 … -0.40906618245080184 -0.45837440794254136])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4129139212238381 -0.4868367442358191 … -0.7027113225794257 -0.4868367442358192; -0.48683674423581885 -0.7744303949975466 … -0.4136373284044504 -0.3823307497556803; … ; -0.7027113225794259 -0.41363732840445067 … -2.3967616825354714 -1.2958067581294714; -0.4868367442358188 -0.3823307497556802 … -1.2958067581294714 -0.7744303949975464;;; -0.48683674423581896 -0.7744303949975466 … -0.41363732840445044 -0.38233074975568054; -0.7744303949975464 -1.4814477483427588 … -0.32458456940048663 -0.44991939653292484; … ; -0.41363732840445055 -0.324584569400487 … -1.0113572985747479 -0.63732777915727; -0.38233074975568015 -0.44991939653292484 … -0.6373277791572698 -0.44991939653292473;;; -0.7027113225794257 -1.2958067581294719 … -0.29820348934522234 -0.4136373284044506; -1.2958067581294714 -2.919672393595769 … -0.35372958463236703 -0.6373277791572697; … ; -0.29820348934522234 -0.3537295846323677 … -0.490372608081025 -0.3537295846323677; -0.41363732840445044 -0.6373277791572697 … -0.35372958463236703 -0.32458456940048674;;; … ;;; -1.0166744212160894 -0.5332878142755061 … -3.636138257063853 -1.9987602620006575; -0.5332878142755059 -0.32174124744609783 … -1.4667339407125422 -0.9061938941119387; … ; -3.636138257063853 -1.4667339407125422 … -10.988177824353826 -8.087376168120514; -1.9987602620006573 -0.9061938941119387 … -8.087376168120514 -4.647878371074742;;; -0.7027113225794257 -0.4136373284044504 … -2.396761682535472 -1.2958067581294717; -0.4136373284044502 -0.32458456940048697 … -1.0113572985747479 -0.6373277791572697; … ; -2.396761682535472 -1.0113572985747483 … -11.002806190762932 -6.077304186319174; -1.2958067581294714 -0.6373277791572696 … -6.077304186319174 -2.919672393595769;;; -0.486836744235819 -0.3823307497556805 … -1.2958067581294714 -0.7744303949975466; -0.38233074975568027 -0.4499193965329249 … -0.6373277791572697 -0.44991939653292484; … ; -1.2958067581294714 -0.6373277791572699 … -6.077304186319173 -2.9196723935957687; -0.7744303949975464 -0.4499193965329247 … -2.9196723935957687 -1.4814477483427588]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.31102461541422355 + 0.05630198348420449im 0.1793649549804255 + 0.1545303622237118im … 0.01502736159055612 + 0.12532036621126869im 0.17936495644055278 + 0.1545303568122642im; 0.13276382028940242 - 0.04785275440332836im -0.030832640800409185 + 0.05292425322752266im … 0.03358232250403967 + 0.07626736135264861im 0.10469620220005474 + 0.033580568532912594im; … ; -0.03177939164381982 - 0.07795569790154006im 0.0047310402623453145 - 0.04903025570511883im … -0.043233524072763714 - 0.007826176271070174im -0.07127971912215036 - 0.0013374012862116882im; 0.1327638155695524 - 0.04785274585755392im 0.10469619703199591 + 0.033580579920309876im … -0.06301458643240374 + 0.034557076509495195im -0.030832639149341416 + 0.05292425328245923im;;; 0.19693026969911775 + 0.003067414276672528im 0.04398631965578858 + 0.11229785947980137im … 0.02670041743756636 + 0.07080613205156182im 0.12340344780742638 + 0.04842596420546606im; -0.010351241951411086 - 0.12368360296234872im -0.16808405901135298 - 0.012832087170024478im … 0.023258416326795373 + 0.019484420526194826im 0.04589829243643153 - 0.06396513681154492im; … ; 0.002847145609153009 - 0.032785731705042766im 0.01772225985318998 - 0.004558424994454124im … -0.021825377903728047 + 0.010805036291740849im -0.021578463467521833 + 0.0006124258649814523im; 0.10981723209233801 - 0.01057731138052858im 0.07674647684638365 + 0.07000481324641783im … -0.011038785725773048 + 0.04638496977137696im 0.03427071721247874 + 0.03629759290217338im;;; 0.03267017874633858 - 0.026810864359107366im -0.028803959542300486 + 0.03236981830821481im … 0.016004533764682846 + 0.010400385797868058im 0.03757529790614039 - 0.022966251272889354im; -0.051387013995017515 - 0.06570564775064512im -0.12011458644542604 - 0.007114894189430045im … 0.008579823497077355 - 0.01767899716823515im 0.001600460821768047 - 0.06260125954099041im; … ; 0.012096873700797381 - 0.006570104024980487im 0.015301227827771576 + 0.011511252698143168im … -0.006580252865461834 + 0.008649501289140167im 0.00019559245006358587 - 0.0004760301366364722im; 0.04257330752156456 - 0.0012604967592759076im 0.02459296148577384 + 0.03725238835169571im … 0.004444714592077987 + 0.017977391340832573im 0.02534515133488959 + 0.00149082192124718im;;; … ;;; -0.005577542390945657 - 0.007944774055321624im 0.006445231276447847 - 0.017866616086085522im … -0.024041892272456136 - 0.017036366776014906im -0.024849278623441204 + 0.004737819335271675im; 0.01043485637044415 - 0.0005401554711738388im 0.010604067535267065 - 0.005736420070740236im … -0.008136011379249812 + 0.002126083745030935im 0.0006660530098789102 + 0.011299092718401484im; … ; -0.014885527019453677 + 0.022728618008409147im -0.00974141445949454 - 0.004845992335162858im … 0.020926174439845992 - 0.0017235760065617061im -0.004151837297733874 + 0.030553672297706405im; -0.026897727905434158 - 0.004158351927018482im -0.007142511632847175 - 0.02261256383030998im … -0.016604660007271836 - 0.02352743256352992im -0.03878518575123446 + 0.007768993730006892im;;; 0.032670181124967265 - 0.026810862821685467im 0.037575300503777796 - 0.02296624910258544im … -0.04323352726166212 - 0.007826174610689535im -0.0288039625654421 + 0.03236982035722699im; 0.04257331094824486 - 0.001260495886571371im 0.025345153965030495 + 0.0014908226279393773im … 0.00042695689398520654 + 0.02846368325566389im 0.024592961119660986 + 0.03725239087870151im; … ; -0.043233525213285634 - 0.007826178927326878im -0.01573388836979431 - 0.04172092278236283im … 0.0036966899852514694 - 0.017003104949227493im -0.04789906083875752 + 0.03883366067866584im; -0.05138701414051816 - 0.06570565268684281im 0.0016004614756062988 - 0.06260126027008041im … -0.07048211500635561 - 0.05924180664024967im -0.12011458942290917 - 0.007114899733274632im;;; 0.1969302747781636 + 0.003067416914629424im 0.12340345072148229 + 0.0484259707508512im … -0.03191933022750605 + 0.05923314514989518im 0.043986320257391305 + 0.11229786092626948im; 0.10981724020929458 - 0.010577316326712747im 0.034270719424132456 + 0.0362975926076818im … 0.020620251507668004 + 0.07150843282108707im 0.07674648011668529 + 0.07000481097002667im; … ; -0.06276751451914853 - 0.07473680561900634im -0.012911925880780824 - 0.07411776222220837im … -0.03938685468046901 - 0.03456574018662688im -0.10140733572779306 + 0.007730491241391163im; -0.010351241102772406 - 0.12368360268309504im 0.04589829164438619 - 0.063965131271804im … -0.11499355138564726 - 0.0512727846075283im -0.16808405751329222 - 0.012832091378666581im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39155563711116104 0.3785174209748359 … 0.34469960033837954 0.3785174209748359; 0.3785174209748359 0.3664584407246045 … 0.32735728177820445 0.3636495426873943; … ; 0.34469960033837954 0.3273572817782044 … 0.3075192694871403 0.33438053205824836; 0.37851742097483587 0.3636495426873943 … 0.33438053205824836 0.3664584407246045;;; 0.3785174209748359 0.3664584407246045 … 0.3273572817782044 0.3636495426873943; 0.3664584407246045 0.3510288634945272 … 0.3111940135086501 0.35191706641470893; … ; 0.3273572817782044 0.3111940135086501 … 0.2982412284760973 0.3214260028769237; 0.36364954268739424 0.35191706641470893 … 0.3214260028769237 0.35191706641470893;;; 0.34469960033837954 0.33438053205824836 … 0.2865351538038493 0.32735728177820445; 0.33438053205824836 0.31861604783277436 … 0.27805891886489636 0.32142600287692374; … ; 0.2865351538038493 0.2780589188648963 … 0.2559018577680054 0.27805891886489625; 0.3273572817782044 0.32142600287692374 … 0.27805891886489625 0.31119401350865006;;; … ;;; 0.30487474934911357 0.2830366690086914 … 0.28556433238265816 0.300957370583466; 0.2830366690086914 0.25898431625491225 … 0.27263300135001683 0.28541419668393814; … ; 0.28556433238265816 0.2726330013500168 … 0.2771603891970547 0.2812108738450954; 0.30095737058346594 0.28541419668393814 … 0.2812108738450954 0.2930827263355356;;; 0.3446996003383796 0.32735728177820445 … 0.30751926948714026 0.3343805320582483; 0.3273572817782045 0.31119401350865006 … 0.2982412284760973 0.32142600287692374; … ; 0.30751926948714026 0.29824122847609724 … 0.27716038919705477 0.2931311915341791; 0.3343805320582483 0.32142600287692374 … 0.2931311915341791 0.31861604783277436;;; 0.3785174209748359 0.36364954268739424 … 0.3343805320582484 0.3664584407246045; 0.36364954268739424 0.35191706641470893 … 0.3214260028769237 0.35191706641470893; … ; 0.33438053205824836 0.32142600287692363 … 0.2931311915341792 0.31861604783277436; 0.36645844072460443 0.35191706641470893 … 0.3186160478327743 0.3510288634945273]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923474311 -0.49665655725940316 … -0.4771919009933798 -0.49665655725940316; -0.49665655725940316 -0.4848182087445084 … -0.47638044578786004 -0.4920413111974583; … ; -0.4771919009933798 -0.47638044578786004 … -0.41228807088992653 -0.45507008158229434; -0.49665655725940316 -0.4920413111974583 … -0.45507008158229434 -0.4848182087445084;;; -0.49665655725940316 -0.4848182087445084 … -0.47638044578786004 -0.49204131119745825; -0.4848182087445084 -0.45837440794254136 … -0.4706560157209865 -0.4861790252033624; … ; -0.47638044578786004 -0.4706560157209865 … -0.44639843646311583 -0.46889439641743297; -0.49204131119745825 -0.4861790252033624 … -0.46889439641743297 -0.4861790252033624;;; -0.4771919009933798 -0.45507008158229434 … -0.4605141234322264 -0.47638044578786004; -0.45507008158229434 -0.40906618245080184 … -0.4567199083334603 -0.46889439641743297; … ; -0.4605141234322264 -0.4567199083334603 … -0.44514495662221887 -0.4567199083334604; -0.47638044578786004 -0.46889439641743297 … -0.4567199083334603 -0.4706560157209865;;; … ;;; -0.44947595086129377 -0.45514997221670905 … -0.3712598626240089 -0.41774571521784964; -0.45514997221670905 -0.44880351100209787 … -0.41743801073914744 -0.4441260993211459; … ; -0.3712598626240089 -0.41743801073914744 … -0.25365698323135544 -0.2997980910332384; -0.41774571521784964 -0.4441260993211459 … -0.2997980910332383 -0.3610634326433731;;; -0.4771919009933798 -0.47638044578786004 … -0.41228807088992653 -0.45507008158229434; -0.47638044578786004 -0.4706560157209865 … -0.44639843646311583 -0.46889439641743297; … ; -0.41228807088992653 -0.44639843646311583 … -0.25365698323135555 -0.34106330228989185; -0.45507008158229434 -0.46889439641743297 … -0.3410633022898918 -0.40906618245080184;;; -0.49665655725940316 -0.49204131119745825 … -0.4550700815822944 -0.4848182087445084; -0.49204131119745825 -0.4861790252033624 … -0.46889439641743297 -0.4861790252033624; … ; -0.45507008158229434 -0.46889439641743297 … -0.3410633022898919 -0.40906618245080184; -0.4848182087445084 -0.4861790252033624 … -0.40906618245080184 -0.45837440794254136])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4129139212238381 -0.4868367442358191 … -0.7027113225794257 -0.4868367442358192; -0.48683674423581885 -0.7744303949975466 … -0.4136373284044504 -0.3823307497556803; … ; -0.7027113225794259 -0.41363732840445067 … -2.3967616825354714 -1.2958067581294714; -0.4868367442358188 -0.3823307497556802 … -1.2958067581294714 -0.7744303949975464;;; -0.48683674423581896 -0.7744303949975466 … -0.41363732840445044 -0.38233074975568054; -0.7744303949975464 -1.4814477483427588 … -0.32458456940048663 -0.44991939653292484; … ; -0.41363732840445055 -0.324584569400487 … -1.0113572985747479 -0.63732777915727; -0.38233074975568015 -0.44991939653292484 … -0.6373277791572698 -0.44991939653292473;;; -0.7027113225794257 -1.2958067581294719 … -0.29820348934522234 -0.4136373284044506; -1.2958067581294714 -2.919672393595769 … -0.35372958463236703 -0.6373277791572697; … ; -0.29820348934522234 -0.3537295846323677 … -0.490372608081025 -0.3537295846323677; -0.41363732840445044 -0.6373277791572697 … -0.35372958463236703 -0.32458456940048674;;; … ;;; -1.0166744212160894 -0.5332878142755061 … -3.636138257063853 -1.9987602620006575; -0.5332878142755059 -0.32174124744609783 … -1.4667339407125422 -0.9061938941119387; … ; -3.636138257063853 -1.4667339407125422 … -10.988177824353826 -8.087376168120514; -1.9987602620006573 -0.9061938941119387 … -8.087376168120514 -4.647878371074742;;; -0.7027113225794257 -0.4136373284044504 … -2.396761682535472 -1.2958067581294717; -0.4136373284044502 -0.32458456940048697 … -1.0113572985747479 -0.6373277791572697; … ; -2.396761682535472 -1.0113572985747483 … -11.002806190762932 -6.077304186319174; -1.2958067581294714 -0.6373277791572696 … -6.077304186319174 -2.919672393595769;;; -0.486836744235819 -0.3823307497556805 … -1.2958067581294714 -0.7744303949975466; -0.38233074975568027 -0.4499193965329249 … -0.6373277791572697 -0.44991939653292484; … ; -1.2958067581294714 -0.6373277791572699 … -6.077304186319173 -2.9196723935957687; -0.7744303949975464 -0.4499193965329247 … -2.9196723935957687 -1.4814477483427588]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.007523723151098982 - 0.02889293561905723im -0.04630498988567569 - 0.07765312467161242im … -0.03534455356993345 - 0.006279462245541505im -0.03213012068210651 - 0.015188948250701377im; 0.004835142148090095 - 0.04064443882093815im -0.03578427849783483 - 0.0286068658198333im … -0.00642153431245514 - 0.014857899339950477im 0.006607306029268411 - 0.028461522151801973im; … ; -0.027842052369203778 + 0.0749776137681802im -0.015090226180267577 + 0.04911564215070422im … -0.005056013069775586 - 0.013659419535109052im -0.03958987796572448 + 0.010504021617444768im; -0.04082599052089783 + 0.08633610235641923im -0.044348786976549634 + 0.02527713133943813im … -0.04997199415954832 + 0.00994463049980733im -0.08335444619908047 + 0.06117567469875792im;;; 0.22916413835401656 + 0.009486936601322013im 0.1811033470864402 - 0.032707152398747864im … -0.01768319146046847 - 0.008460335933236123im 0.09382053686880333 + 0.011044009482588872im; 0.16023508516901647 + 0.033400588856078335im 0.07680784889704932 + 0.028200950885421627im … 0.018458528329770435 - 0.003781999458654731im 0.09265292186272472 + 0.012955033650351338im; … ; -0.031592470700879595 + 0.04389543251570033im 0.006316582942325864 + 0.027092688481779724im … -0.050030737669460104 - 0.009693730807678788im -0.07337441167047677 + 0.009757709685732429im; 0.07910610141887439 + 0.06433002482551073im 0.10069149942048974 + 0.0072912972437000146im … -0.06764801830219573 - 0.006184543448836093im -0.048523407279267766 + 0.02574032459343352im;;; 0.19318927788974152 + 0.0277711368810082im 0.08353180156059457 - 0.015544432332050554im … 0.027183802345297655 + 0.005226545942407353im 0.11747704162171063 + 0.02505132971266503im; 0.04765523904127681 + 0.018769994115895382im -0.09807256999222605 - 0.012282376932392843im … 0.03599206820509395 + 0.008029181555744842im 0.075871018498369 + 0.02164993016200912im; … ; 0.02507078417332989 + 0.021272359067432568im 0.03927379307119657 + 0.009709945138646208im … -0.03005363876206814 - 0.002744317263897349im -0.014512638175214407 + 0.01028246769768367im; 0.12678645871591052 + 0.02962880153684479im 0.10188521882991596 - 0.0014541836539343775im … -0.011743259982127326 + 0.0014101610956701975im 0.049099760592526034 + 0.020945729950584385im;;; … ;;; 0.048902009287491596 + 0.020480128184330454im 0.04103446257386347 + 0.013542011447665352im … -0.02104329287611064 + 0.0014652035554977977im 0.014099911211087019 + 0.013895715401490686im; 0.03243487524742526 + 0.007574364893328835im 0.015745233718501075 + 0.0009163764022565545im … 0.005823166711331682 + 0.007135747571677167im 0.025525336879734628 + 0.010072874020323398im; … ; -0.04095617242140426 - 0.02168034027607922im 0.011274501828207602 + 0.0019577489447961264im … -0.10790915280292614 - 0.044986419159220734im -0.11360834047603205 - 0.05069109520666154im; 0.018471017843009703 + 0.011061648987927527im 0.04201980411366331 + 0.01740324148242059im … -0.07982352844114707 - 0.026808464063897666im -0.05081895854705332 - 0.013153843275842545im;;; 0.12504330600366662 + 0.04445656062270766im 0.04861374428521011 + 0.01251159365702226im … 0.025752993621624795 + 0.023381858559046117im 0.10006885122255035 + 0.047079385823793805im; 0.03647568697798893 - 0.0012880788933927376im -0.006703012255708853 - 0.011741432580726682im … 0.024195160832100895 + 0.010486212229620945im 0.04670579818822182 + 0.008890471680394384im; … ; 0.04623716068775467 + 0.0025663194890465342im 0.06128568189039059 + 0.025519360429263317im … -0.12462566656574192 - 0.07059919415268638im -0.06807982315605232 - 0.06247138153540045im; 0.16135050233226667 + 0.07679297486142696im 0.0952046243560224 + 0.04533117207060905im … -0.03267224758199941 - 0.006093033313015531im 0.076132533743447 + 0.041637722334131676im;;; 0.08774955794657555 + 0.022732987905083477im -0.03308746751678489 - 0.02910121914894859im … 0.043845195741951684 + 0.02929397094490467im 0.10883835896814159 + 0.049883235375463235im; -0.006677556573402792 - 0.03266396628580042im -0.06300928768334105 - 0.036286108401809736im … 0.015977291909219676 - 0.0008299785588900469im 0.02508681832466273 - 0.013667551449356177im; … ; 0.1243585407422641 + 0.062366367340362466im 0.06206480241637453 + 0.05260164449468684im … 0.025855012550691808 - 0.032756663850715614im 0.09035895139926847 - 0.011877068812672519im; 0.17892627991996976 + 0.14414380508132912im 0.06192529966183806 + 0.06067892985976267im … 0.06472343946491477 + 0.03802864634553099im 0.14896904994332377 + 0.10755314431528795im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39155563711116104 0.3785174209748359 … 0.34469960033837954 0.3785174209748359; 0.3785174209748359 0.3664584407246045 … 0.32735728177820445 0.3636495426873943; … ; 0.34469960033837954 0.3273572817782044 … 0.3075192694871403 0.33438053205824836; 0.37851742097483587 0.3636495426873943 … 0.33438053205824836 0.3664584407246045;;; 0.3785174209748359 0.3664584407246045 … 0.3273572817782044 0.3636495426873943; 0.3664584407246045 0.3510288634945272 … 0.3111940135086501 0.35191706641470893; … ; 0.3273572817782044 0.3111940135086501 … 0.2982412284760973 0.3214260028769237; 0.36364954268739424 0.35191706641470893 … 0.3214260028769237 0.35191706641470893;;; 0.34469960033837954 0.33438053205824836 … 0.2865351538038493 0.32735728177820445; 0.33438053205824836 0.31861604783277436 … 0.27805891886489636 0.32142600287692374; … ; 0.2865351538038493 0.2780589188648963 … 0.2559018577680054 0.27805891886489625; 0.3273572817782044 0.32142600287692374 … 0.27805891886489625 0.31119401350865006;;; … ;;; 0.30487474934911357 0.2830366690086914 … 0.28556433238265816 0.300957370583466; 0.2830366690086914 0.25898431625491225 … 0.27263300135001683 0.28541419668393814; … ; 0.28556433238265816 0.2726330013500168 … 0.2771603891970547 0.2812108738450954; 0.30095737058346594 0.28541419668393814 … 0.2812108738450954 0.2930827263355356;;; 0.3446996003383796 0.32735728177820445 … 0.30751926948714026 0.3343805320582483; 0.3273572817782045 0.31119401350865006 … 0.2982412284760973 0.32142600287692374; … ; 0.30751926948714026 0.29824122847609724 … 0.27716038919705477 0.2931311915341791; 0.3343805320582483 0.32142600287692374 … 0.2931311915341791 0.31861604783277436;;; 0.3785174209748359 0.36364954268739424 … 0.3343805320582484 0.3664584407246045; 0.36364954268739424 0.35191706641470893 … 0.3214260028769237 0.35191706641470893; … ; 0.33438053205824836 0.32142600287692363 … 0.2931311915341792 0.31861604783277436; 0.36645844072460443 0.35191706641470893 … 0.3186160478327743 0.3510288634945273]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923474311 -0.49665655725940316 … -0.4771919009933798 -0.49665655725940316; -0.49665655725940316 -0.4848182087445084 … -0.47638044578786004 -0.4920413111974583; … ; -0.4771919009933798 -0.47638044578786004 … -0.41228807088992653 -0.45507008158229434; -0.49665655725940316 -0.4920413111974583 … -0.45507008158229434 -0.4848182087445084;;; -0.49665655725940316 -0.4848182087445084 … -0.47638044578786004 -0.49204131119745825; -0.4848182087445084 -0.45837440794254136 … -0.4706560157209865 -0.4861790252033624; … ; -0.47638044578786004 -0.4706560157209865 … -0.44639843646311583 -0.46889439641743297; -0.49204131119745825 -0.4861790252033624 … -0.46889439641743297 -0.4861790252033624;;; -0.4771919009933798 -0.45507008158229434 … -0.4605141234322264 -0.47638044578786004; -0.45507008158229434 -0.40906618245080184 … -0.4567199083334603 -0.46889439641743297; … ; -0.4605141234322264 -0.4567199083334603 … -0.44514495662221887 -0.4567199083334604; -0.47638044578786004 -0.46889439641743297 … -0.4567199083334603 -0.4706560157209865;;; … ;;; -0.44947595086129377 -0.45514997221670905 … -0.3712598626240089 -0.41774571521784964; -0.45514997221670905 -0.44880351100209787 … -0.41743801073914744 -0.4441260993211459; … ; -0.3712598626240089 -0.41743801073914744 … -0.25365698323135544 -0.2997980910332384; -0.41774571521784964 -0.4441260993211459 … -0.2997980910332383 -0.3610634326433731;;; -0.4771919009933798 -0.47638044578786004 … -0.41228807088992653 -0.45507008158229434; -0.47638044578786004 -0.4706560157209865 … -0.44639843646311583 -0.46889439641743297; … ; -0.41228807088992653 -0.44639843646311583 … -0.25365698323135555 -0.34106330228989185; -0.45507008158229434 -0.46889439641743297 … -0.3410633022898918 -0.40906618245080184;;; -0.49665655725940316 -0.49204131119745825 … -0.4550700815822944 -0.4848182087445084; -0.49204131119745825 -0.4861790252033624 … -0.46889439641743297 -0.4861790252033624; … ; -0.45507008158229434 -0.46889439641743297 … -0.3410633022898919 -0.40906618245080184; -0.4848182087445084 -0.4861790252033624 … -0.40906618245080184 -0.45837440794254136])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4129139212238381 -0.4868367442358191 … -0.7027113225794257 -0.4868367442358192; -0.48683674423581885 -0.7744303949975466 … -0.4136373284044504 -0.3823307497556803; … ; -0.7027113225794259 -0.41363732840445067 … -2.3967616825354714 -1.2958067581294714; -0.4868367442358188 -0.3823307497556802 … -1.2958067581294714 -0.7744303949975464;;; -0.48683674423581896 -0.7744303949975466 … -0.41363732840445044 -0.38233074975568054; -0.7744303949975464 -1.4814477483427588 … -0.32458456940048663 -0.44991939653292484; … ; -0.41363732840445055 -0.324584569400487 … -1.0113572985747479 -0.63732777915727; -0.38233074975568015 -0.44991939653292484 … -0.6373277791572698 -0.44991939653292473;;; -0.7027113225794257 -1.2958067581294719 … -0.29820348934522234 -0.4136373284044506; -1.2958067581294714 -2.919672393595769 … -0.35372958463236703 -0.6373277791572697; … ; -0.29820348934522234 -0.3537295846323677 … -0.490372608081025 -0.3537295846323677; -0.41363732840445044 -0.6373277791572697 … -0.35372958463236703 -0.32458456940048674;;; … ;;; -1.0166744212160894 -0.5332878142755061 … -3.636138257063853 -1.9987602620006575; -0.5332878142755059 -0.32174124744609783 … -1.4667339407125422 -0.9061938941119387; … ; -3.636138257063853 -1.4667339407125422 … -10.988177824353826 -8.087376168120514; -1.9987602620006573 -0.9061938941119387 … -8.087376168120514 -4.647878371074742;;; -0.7027113225794257 -0.4136373284044504 … -2.396761682535472 -1.2958067581294717; -0.4136373284044502 -0.32458456940048697 … -1.0113572985747479 -0.6373277791572697; … ; -2.396761682535472 -1.0113572985747483 … -11.002806190762932 -6.077304186319174; -1.2958067581294714 -0.6373277791572696 … -6.077304186319174 -2.919672393595769;;; -0.486836744235819 -0.3823307497556805 … -1.2958067581294714 -0.7744303949975466; -0.38233074975568027 -0.4499193965329249 … -0.6373277791572697 -0.44991939653292484; … ; -1.2958067581294714 -0.6373277791572699 … -6.077304186319173 -2.9196723935957687; -0.7744303949975464 -0.4499193965329247 … -2.9196723935957687 -1.4814477483427588]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.019359535797702596 + 0.21278578944614818im -0.008115654880642031 + 0.1463575911873399im … -0.07179687135181756 + 0.06346167659847532im -0.10555331260785757 + 0.18290852478244748im; 0.007197740228210154 + 0.10806962481975435im 0.0023698613297911146 + 0.003368177937093551im … -0.044764625688235526 + 0.08965129891241264im -0.04946957810551805 + 0.15848096000280812im; … ; 0.007915356356167531 - 0.13584221261564458im 0.022506492424674934 - 0.07854617619170075im … 0.0019112772673328822 - 0.021007359027770536im -0.03783734897177391 - 0.08219994814454953im; -0.0025958010730169944 - 0.07451537348198559im 0.021860202420553587 - 0.019864359006306696im … -0.03413647136962309 - 0.09145322397594466im -0.07988403605835818 - 0.1135357025422367im;;; 0.02771264220696353 + 0.29033997006875234im -0.007077155066448018 + 0.2040357436597163im … -0.04714385866586655 + 0.0684223177716802im -0.039601081966172694 + 0.21569724687445158im; 0.06142510032912579 + 0.032760065849003615im 0.019363496225587244 - 0.08251165976948394im … -0.021114704153835366 + 0.06559459629092039im 0.010686154110835896 + 0.09329809319947589im; … ; 0.011974613212872612 - 0.07939115645342691im 0.013448937386547979 - 0.020824618434971597im … -0.013765967915401151 - 0.044448275782052384im -0.01834338752265184 - 0.08474250318822435im; 0.01952821780709341 + 0.06785670027560986im 0.0036682942161164866 + 0.11084479634065683im … -0.03711621553164346 - 0.03780494077814286im -0.04192450985620834 - 0.019595538255944005im;;; 0.026395816845322984 + 0.13955265815129336im -0.00768231857596582 + 0.049233553613700756im … -0.010099864970616493 + 0.0461809954977089im 0.010707000248144645 + 0.10515613673316451im; 0.038344372357392416 - 0.06584663789502021im 0.004158641987647557 - 0.16608742389087894im … 0.003064603256901022 + 0.027687623646119423im 0.027558519103150717 + 0.012895315143435986im; … ; 0.00735849868812926 + 0.00252997955855806im 0.0026781180540918956 + 0.028653950214564503im … -0.008399811733359998 - 0.02291917367381087im -0.003080096460981785 - 0.021677008767350528im; 0.012694463802662127 + 0.10018689716870662im -0.005439177554692377 + 0.09539921025663915im … -0.013579161864580589 + 0.004573726132865635im -0.001642504322178716 + 0.045156019078536766im;;; … ;;; 0.00048206389398379955 + 0.011572034471031657im 0.003070002722329268 + 0.009584837473541684im … 0.010559053755151482 - 0.037009765428337726im 0.002083052704639143 - 0.008751454751964104im; -0.0005089475129185597 + 0.018533259907721894im 0.0008899674705881683 + 0.010228238656886372im … 0.0039842852654110115 - 0.009038700584824193im -0.000520438878277608 + 0.011460326363256272im; … ; -0.007686623943661396 + 0.00860976654882277im -0.0032899924055321754 + 0.009149121908984491im … 0.011113518741940973 - 0.04117798176646692im -0.00021226914317553245 - 0.01773623622243273im; -0.0028405193347115524 + 0.0035589159656932955im 0.0017287201674082305 + 0.0058367711525201035im … 0.013899759115593997 - 0.053020435050453396im 0.0016516230023831064 - 0.025036703685198232im;;; -0.002399157620783272 + 0.04308355616585284im 0.005398889340385401 + 0.016227766202191254im … 0.015395070103311035 - 0.03504153776304146im -0.009689223115107445 + 0.031538060408676995im; -0.005586495615250654 + 0.043694442256927354im -0.001051161778105928 + 0.013975529524993334im … -0.0025063282164718963 + 0.014980331410707582im -0.01192945932892204 + 0.05143717983353569im; … ; -0.012687980261838549 + 0.03517430437362397im 0.0018243880690335178 + 0.004152274422504201im … 0.03451910073220023 - 0.03456545934807334im -0.0069671455653973246 + 0.03390420590945986im; -0.001141460104030169 + 0.010166153138400642im 0.009953461037098274 - 0.0032765221651207374im … 0.03905954532390802 - 0.08117598632356186im -0.003110407192470971 - 0.010279367919542686im;;; -0.020924047364723874 + 0.1159612253785053im 0.0012265638910429828 + 0.043140827240031335im … -0.015376625108148962 + 0.007239565901319727im -0.06840600236701065 + 0.11687172924463031im; -0.014021680713598439 + 0.0812659002957003im -0.004935449702331956 + 0.016046991174070206im … -0.02614729869863344 + 0.061069099894220685im -0.04108375018596189 + 0.11854441848728274im; … ; -0.008358764837153742 - 0.01030713729937184im 0.014456507885843935 - 0.04045229459575784im … 0.04154736205760144 + 0.02767949079480917im -0.025553944609486186 + 0.061301431684348026im; 9.625322140635389e-5 - 0.054403949021681344im 0.02147834406085966 - 0.037879119255331425im … 0.033575354949199165 - 0.08653911526151689im -0.03820479794460291 - 0.06544639182924085im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39155563711116104 0.3785174209748359 … 0.34469960033837954 0.3785174209748359; 0.3785174209748359 0.3664584407246045 … 0.32735728177820445 0.3636495426873943; … ; 0.34469960033837954 0.3273572817782044 … 0.3075192694871403 0.33438053205824836; 0.37851742097483587 0.3636495426873943 … 0.33438053205824836 0.3664584407246045;;; 0.3785174209748359 0.3664584407246045 … 0.3273572817782044 0.3636495426873943; 0.3664584407246045 0.3510288634945272 … 0.3111940135086501 0.35191706641470893; … ; 0.3273572817782044 0.3111940135086501 … 0.2982412284760973 0.3214260028769237; 0.36364954268739424 0.35191706641470893 … 0.3214260028769237 0.35191706641470893;;; 0.34469960033837954 0.33438053205824836 … 0.2865351538038493 0.32735728177820445; 0.33438053205824836 0.31861604783277436 … 0.27805891886489636 0.32142600287692374; … ; 0.2865351538038493 0.2780589188648963 … 0.2559018577680054 0.27805891886489625; 0.3273572817782044 0.32142600287692374 … 0.27805891886489625 0.31119401350865006;;; … ;;; 0.30487474934911357 0.2830366690086914 … 0.28556433238265816 0.300957370583466; 0.2830366690086914 0.25898431625491225 … 0.27263300135001683 0.28541419668393814; … ; 0.28556433238265816 0.2726330013500168 … 0.2771603891970547 0.2812108738450954; 0.30095737058346594 0.28541419668393814 … 0.2812108738450954 0.2930827263355356;;; 0.3446996003383796 0.32735728177820445 … 0.30751926948714026 0.3343805320582483; 0.3273572817782045 0.31119401350865006 … 0.2982412284760973 0.32142600287692374; … ; 0.30751926948714026 0.29824122847609724 … 0.27716038919705477 0.2931311915341791; 0.3343805320582483 0.32142600287692374 … 0.2931311915341791 0.31861604783277436;;; 0.3785174209748359 0.36364954268739424 … 0.3343805320582484 0.3664584407246045; 0.36364954268739424 0.35191706641470893 … 0.3214260028769237 0.35191706641470893; … ; 0.33438053205824836 0.32142600287692363 … 0.2931311915341792 0.31861604783277436; 0.36645844072460443 0.35191706641470893 … 0.3186160478327743 0.3510288634945273]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923474311 -0.49665655725940316 … -0.4771919009933798 -0.49665655725940316; -0.49665655725940316 -0.4848182087445084 … -0.47638044578786004 -0.4920413111974583; … ; -0.4771919009933798 -0.47638044578786004 … -0.41228807088992653 -0.45507008158229434; -0.49665655725940316 -0.4920413111974583 … -0.45507008158229434 -0.4848182087445084;;; -0.49665655725940316 -0.4848182087445084 … -0.47638044578786004 -0.49204131119745825; -0.4848182087445084 -0.45837440794254136 … -0.4706560157209865 -0.4861790252033624; … ; -0.47638044578786004 -0.4706560157209865 … -0.44639843646311583 -0.46889439641743297; -0.49204131119745825 -0.4861790252033624 … -0.46889439641743297 -0.4861790252033624;;; -0.4771919009933798 -0.45507008158229434 … -0.4605141234322264 -0.47638044578786004; -0.45507008158229434 -0.40906618245080184 … -0.4567199083334603 -0.46889439641743297; … ; -0.4605141234322264 -0.4567199083334603 … -0.44514495662221887 -0.4567199083334604; -0.47638044578786004 -0.46889439641743297 … -0.4567199083334603 -0.4706560157209865;;; … ;;; -0.44947595086129377 -0.45514997221670905 … -0.3712598626240089 -0.41774571521784964; -0.45514997221670905 -0.44880351100209787 … -0.41743801073914744 -0.4441260993211459; … ; -0.3712598626240089 -0.41743801073914744 … -0.25365698323135544 -0.2997980910332384; -0.41774571521784964 -0.4441260993211459 … -0.2997980910332383 -0.3610634326433731;;; -0.4771919009933798 -0.47638044578786004 … -0.41228807088992653 -0.45507008158229434; -0.47638044578786004 -0.4706560157209865 … -0.44639843646311583 -0.46889439641743297; … ; -0.41228807088992653 -0.44639843646311583 … -0.25365698323135555 -0.34106330228989185; -0.45507008158229434 -0.46889439641743297 … -0.3410633022898918 -0.40906618245080184;;; -0.49665655725940316 -0.49204131119745825 … -0.4550700815822944 -0.4848182087445084; -0.49204131119745825 -0.4861790252033624 … -0.46889439641743297 -0.4861790252033624; … ; -0.45507008158229434 -0.46889439641743297 … -0.3410633022898919 -0.40906618245080184; -0.4848182087445084 -0.4861790252033624 … -0.40906618245080184 -0.45837440794254136])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4129139212238381 -0.4868367442358191 … -0.7027113225794257 -0.4868367442358192; -0.48683674423581885 -0.7744303949975466 … -0.4136373284044504 -0.3823307497556803; … ; -0.7027113225794259 -0.41363732840445067 … -2.3967616825354714 -1.2958067581294714; -0.4868367442358188 -0.3823307497556802 … -1.2958067581294714 -0.7744303949975464;;; -0.48683674423581896 -0.7744303949975466 … -0.41363732840445044 -0.38233074975568054; -0.7744303949975464 -1.4814477483427588 … -0.32458456940048663 -0.44991939653292484; … ; -0.41363732840445055 -0.324584569400487 … -1.0113572985747479 -0.63732777915727; -0.38233074975568015 -0.44991939653292484 … -0.6373277791572698 -0.44991939653292473;;; -0.7027113225794257 -1.2958067581294719 … -0.29820348934522234 -0.4136373284044506; -1.2958067581294714 -2.919672393595769 … -0.35372958463236703 -0.6373277791572697; … ; -0.29820348934522234 -0.3537295846323677 … -0.490372608081025 -0.3537295846323677; -0.41363732840445044 -0.6373277791572697 … -0.35372958463236703 -0.32458456940048674;;; … ;;; -1.0166744212160894 -0.5332878142755061 … -3.636138257063853 -1.9987602620006575; -0.5332878142755059 -0.32174124744609783 … -1.4667339407125422 -0.9061938941119387; … ; -3.636138257063853 -1.4667339407125422 … -10.988177824353826 -8.087376168120514; -1.9987602620006573 -0.9061938941119387 … -8.087376168120514 -4.647878371074742;;; -0.7027113225794257 -0.4136373284044504 … -2.396761682535472 -1.2958067581294717; -0.4136373284044502 -0.32458456940048697 … -1.0113572985747479 -0.6373277791572697; … ; -2.396761682535472 -1.0113572985747483 … -11.002806190762932 -6.077304186319174; -1.2958067581294714 -0.6373277791572696 … -6.077304186319174 -2.919672393595769;;; -0.486836744235819 -0.3823307497556805 … -1.2958067581294714 -0.7744303949975466; -0.38233074975568027 -0.4499193965329249 … -0.6373277791572697 -0.44991939653292484; … ; -1.2958067581294714 -0.6373277791572699 … -6.077304186319173 -2.9196723935957687; -0.7744303949975464 -0.4499193965329247 … -2.9196723935957687 -1.4814477483427588]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.08058600164080973 - 0.13925800342122746im 0.03394001855968826 - 0.09079535962534473im … 0.04055932290822421 + 0.02743746964994593im 0.10549189029754173 - 0.027543520362056532im; -0.18669293997745334 - 0.03886279141454295im -0.17043176597248882 + 0.035315686415924696im … -0.01564493765430134 + 0.03255182639910529im -0.11418332593614643 + 0.025066452376456654im; … ; -0.01422385937509402 + 0.008478583249422654im 0.023289427665209642 - 0.02305830866226372im … -0.03368137258036936 + 0.017169407347798052im -0.06034627808947592 + 0.04847325937853193im; 0.10905896855590506 - 0.08788524351218299im 0.08244917536826603 - 0.07997787384832657im … -0.020678755524966338 + 0.029945282555336617im 0.007384894291553541 + 0.04220432288977913im;;; 0.08774726937394652 - 0.12341859425803885im 0.0044113328236302166 - 0.02076608893842528im … -0.009736363540749917 + 0.027732698783369824im 0.03733451372004805 - 0.024289378469722147im; -0.08468406066447914 - 0.043733120475591275im -0.08979661403265654 + 0.07035825609498292im … -0.028060027114723468 + 0.022187709964396785im -0.04824482196333855 - 0.018839134297263818im; … ; 0.012854381979584066 - 0.01315374506925713im 0.03140713076378579 - 0.025315598667374956im … -0.027787809535193046 + 0.01623069749560141im -0.026242205189759896 + 0.017729282032727306im; 0.08890755606620061 - 0.07346256956971155im 0.06223449852191544 - 0.050547304453179im … -0.023590445219221275 + 0.02525012921899035im 0.012848172879296758 + 0.0025693006174549084im;;; 0.04552313611953097 - 0.04221631126869111im -0.019412528711334538 + 0.019733606671945868im … 0.003448708828971298 + 0.004113309764667054im 0.03713791650695766 - 0.027343269547569455im; 0.008022172081498587 - 0.022700535830824008im -0.04996048748619258 + 0.06107813455532943im … 0.0019427411055653538 - 0.0031234910909411764im 0.020283548994667205 - 0.03148575735174744im; … ; 0.021207299829549088 - 0.01415180851733261im 0.022903987461718633 - 0.014169927235652552im … -0.013084071102482877 + 0.008629994986154146im -0.000444359151612745 + 0.0010204664354224158im; 0.05006320761638489 - 0.03376510976938723im 0.023828581023055656 - 0.012803581508184132im … -0.005245101528942703 + 0.008626192143330085im 0.02424697013350312 - 0.011854555759839883im;;; … ;;; 0.03161666228876926 - 0.004067537139112294im 0.023795196209878473 - 0.01034880117417768im … -0.03412744760036719 + 0.011242238900492871im 0.00909464034883008 + 0.0068632684106469345im; 0.03761555588456705 - 0.013209422063895616im 0.014383997758416638 - 0.009731432273563777im … 0.01887084327187178 - 0.006653659469988753im 0.04428635665999721 - 0.011581897541563005im; … ; -0.02726358387560772 + 0.020244038430123935im -0.012152255172551973 + 0.011648057634723818im … -0.01895798145980176 - 0.003533886383293823im -0.03473396228304637 + 0.013541351256086853im; -0.016332898153748096 + 0.020199634305066553im 0.0038968642811858718 + 0.0032826987155993403im … -0.07797839155214781 + 0.023241267088180882im -0.0567128797513201 + 0.03176223705892186im;;; 0.11349058914974842 - 0.039583244230211534im 0.04643487028236856 - 0.03390567160840489im … 0.03721421098172861 - 0.01019294347791802im 0.13527258645741752 - 0.017770840505080286im; 0.04688049674567738 - 0.02696584008819766im -0.005289791244984691 - 0.01299881234186231im … 0.07625915688506785 - 0.023156813011022737im 0.10502939491882637 - 0.028202693863855398im; … ; -0.04186600202503567 + 0.03867493870024448im -0.010291573457809098 + 0.011261930838739316im … -0.04850568374596353 + 0.005157956070473529im -0.06742404671123019 + 0.04392311092594542im; 0.011358407601723467 + 0.020925676625310606im 0.025574846571548383 - 0.01273593079361414im … -0.09957280269256641 + 0.031508729386371004im -0.04996048659883426 + 0.061078135125057983im;;; 0.18744524349590452 - 0.11955628259210498im 0.056461643851128424 - 0.07471952699216454im … 0.13495220955413947 - 0.024846397588509817im 0.23379904449804767 - 0.031395050020991896im; -0.07163172117576663 - 0.028510739832767903im -0.08666989906533396 - 0.0012860388574875265im … 0.08389479864659599 - 0.012578459523331876im 0.06846248368968375 - 0.014317879590804737im; … ; -0.03986100001462335 + 0.039274930122874564im 0.0033283723963769894 - 0.0031571389926362864im … -0.03756363576931243 + 0.009883019756407497im -0.0767721857977658 + 0.06734844195050142im; 0.07276614387245284 - 0.018118015114395345im 0.0604716261892208 - 0.05061559802162349im … -0.02195155375315302 + 0.016539027198673208im 0.009901361178918766 + 0.07422056846386918im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.85264668672985), converged = true, ρ = [0.09132316919815138 0.08747419136001859 … 0.07684754937450484 0.08747419136001859; 0.08747419136001859 0.08089966873989757 … 0.07642471018067896 0.08486944835992384; … ; 0.07684754937450484 0.07642471018067896 … 0.04778466667706507 0.06587895343533665; 0.08747419136001859 0.08486944835992384 … 0.06587895343533663 0.08089966873989755;;; 0.08747419136001859 0.08089966873989757 … 0.07642471018067896 0.08486944835992383; 0.08089966873989757 0.06744471471096897 … 0.0734866993547745 0.08163768630523749; … ; 0.07642471018067896 0.0734866993547745 … 0.06188804121208327 0.07259829029748169; 0.08486944835992383 0.08163768630523749 … 0.07259829029748169 0.08163768630523748;;; 0.07684754937450483 0.06587895343533665 … 0.06847203699434963 0.07642471018067896; 0.06587895343533665 0.04657864265414035 … 0.06665759372215749 0.07259829029748169; … ; 0.06847203699434963 0.06665759372215749 … 0.06132515315219374 0.0666575937221575; 0.07642471018067896 0.07259829029748169 … 0.06665759372215749 0.0734866993547745;;; … ;;; 0.06328495230818117 0.06591651446668319 … 0.03394064888234153 0.04987593486585517; 0.06591651446668319 0.06297790960305369 … 0.049756397895263024 0.060870204581425294; … ; 0.03394064888234152 0.049756397895263024 … 0.00969635320740673 0.016831338787718232; 0.04987593486585516 0.060870204581425294 … 0.01683133878771822 0.03098572188374284;;; 0.07684754937450483 0.07642471018067895 … 0.04778466667706506 0.06587895343533665; 0.07642471018067896 0.0734866993547745 … 0.06188804121208326 0.07259829029748169; … ; 0.04778466667706506 0.06188804121208326 … 0.009696353207406744 0.025710010672598413; 0.06587895343533663 0.07259829029748169 … 0.025710010672598396 0.04657864265414035;;; 0.08747419136001859 0.08486944835992383 … 0.06587895343533666 0.08089966873989757; 0.08486944835992383 0.08163768630523748 … 0.07259829029748169 0.08163768630523749; … ; 0.06587895343533665 0.07259829029748169 … 0.025710010672598416 0.04657864265414035; 0.08089966873989757 0.08163768630523749 … 0.04657864265414035 0.06744471471096897;;;;], ψ = Matrix{ComplexF64}[[-0.9402226409958945 - 0.17020003158986682im 5.503467369327719e-10 - 4.862857061471715e-10im -4.1392292371433825e-10 + 9.178307749241332e-10im 4.114777130137526e-10 + 3.166064424520165e-10im; -0.09475018471366103 - 0.01715177165753265im -0.32237327906521723 - 0.049157310181078856im 0.15984011273596643 + 0.17255411890797365im -0.1544269360265122 - 0.25826469379617045im; … ; -0.01160564365926464 - 0.0021008649891258503im 0.012596080115251474 - 0.005764129455756479im 0.019521747476197525 - 0.03562004874117342im 0.03646868956361162 + 0.018351024669230474im; 0.09475018331558836 + 0.017151772745640805im -0.19905486036114528 - 0.10558940258188704im 0.3509623501677881 - 0.17617409420668834im 0.20260958191983625 - 0.07860405720500427im], [-0.1162668862587791 - 0.9214322328714315im -0.06467220575822902 + 0.1862140577179045im 1.3987510329681319e-9 - 7.151069736366367e-10im -1.4738085751808683e-9 + 5.898599941822624e-10im; -0.007926138242244465 - 0.06281581114393686im 0.0028783785425946142 - 0.008287861710402338im -3.680560192557969e-10 - 1.0049037548268136e-9im -2.1840582146645526e-9 + 2.686831314727134e-9im; … ; -0.0009703025705081695 - 0.007689791155310165im -0.028299520242627232 + 0.08148428489462596im -0.0605831622836213 - 0.051903675764454565im -0.028158884257957314 + 0.04990550575650302im; 0.014137735830422042 + 0.11204364378556397im 0.029759114368903293 - 0.08568696640221046im -0.37940115610572733 - 0.32504600647737447im -0.17634460056510914 + 0.31253249411468803im], [0.08460447228740875 - 0.9299101228693352im -1.2204470767329667e-10 - 8.860133737798037e-10im 1.8915303490185664e-9 + 7.935780366175038e-10im 2.758538675262656e-10 - 1.887394684985111e-10im; 0.006229110094222875 - 0.0684658009942441im 0.0329094871660237 + 0.04677281916121827im -0.012818178708338093 + 0.03273984073439078im -0.003884144573678314 + 0.011621576399921727im; … ; 0.0012567462899817205 - 0.013813230930568125im -4.913161457537063e-10 - 6.621502009890312e-10im 0.034690188080561755 - 0.11380999945336327im 0.007894200495298497 + 0.059560720094122256im; -0.013881804400875056 + 0.1525785743178076im 0.16522396983150978 + 0.2348256377822899im 0.015611437749523855 - 0.2152553640795142im -0.013482770153443775 + 0.6191213783016196im], [0.35634995516850926 - 0.7263030961889827im 3.371132539786714e-10 + 1.5622281246407965e-11im -0.421292002741392 + 0.2603522785892227im -2.590610226338441e-10 - 5.474124209481346e-10im; 0.17067256540433692 - 0.3478603290487383im 0.6261170021987765 + 0.024255835858969343im 0.45830218204676787 - 0.2832240281938931im -1.138690197688419e-9 - 8.324776284984736e-11im; … ; 0.005018635678566095 - 0.010228850275187907im 0.0016424090489006438 + 6.362698801174217e-5im 0.017757610270428104 - 0.010973942866963496im -0.008215869056238112 + 0.004139377583600251im; -0.028710055000302805 + 0.05851607916438299im 0.012475764992141822 + 0.0004833118107722288im 0.10732967248732397 - 0.06632816573420461im -0.1595833949545799 + 0.08040243869041461im]], eigenvalues = Any[[-0.16677707594706542, 0.26427771785470466, 0.2642777178547051, 0.26427771785470533], [-0.11613218759323116, 0.07040532321687801, 0.22624813605246677, 0.22624813605246694], [-0.09588938141868894, 0.08764319970243742, 0.17312704144576174, 0.17312704144576183], [-0.04505146346544195, 0.022269526260130734, 0.09831189252612016, 0.18446409324047638]], occupation = [[2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0]], εF = nothing, optim_res =  * Status: success

 * Candidate solution
    Final objective value:     -7.852647e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 9.99e-16 ≤ 1.0e-12
    |x - x&#39;|/|x&#39;|          = 1.36e-15 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 0.00e+00 ≰ -1.0e+00
    |g(x)|                 = 7.25e-09 ≰ -1.0e+00

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    44
    f(x) calls:    59
    ∇f(x) calls:   46
)</code></pre><p>Start not too far from the solution to ensure convergence: We run first a very crude SCF to get close and then switch to Newton.</p><pre><code class="language-julia hljs">scfres_start = self_consistent_field(basis; tol=1e-1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3929893759302636 0.3796923087990368 … 0.345185822645026 0.3796923087990368; 0.37969230879903687 0.3671226817829779 … 0.3281679626761112 0.36487339151459713; … ; 0.345185822645026 0.32816796267611115 … 0.3066719218453906 0.33424212274578646; 0.37969230879903687 0.364873391514597 … 0.3342421227457865 0.3671226817829779;;; 0.3796923087990368 0.3671226817829778 … 0.3281679626761111 0.36487339151459697; 0.36712268178297786 0.3510635537546517 … 0.31207886734325385 0.35289196429382635; … ; 0.3281679626761111 0.31207886734325385 … 0.29779664713540516 0.32173909919668414; 0.3648733915145971 0.35289196429382624 … 0.3217390991966842 0.35289196429382624;;; 0.345185822645026 0.3342421227457864 … 0.28728480530207845 0.3281679626761111; 0.33424212274578646 0.31792264215922617 … 0.27858813971176505 0.32173909919668425; … ; 0.28728480530207845 0.278588139711765 … 0.25584633146644115 0.278588139711765; 0.32816796267611115 0.32173909919668414 … 0.27858813971176505 0.31207886734325385;;; … ;;; 0.30451805545882843 0.2831385943153532 … 0.2842365509925992 0.30006670527248425; 0.28313859431535326 0.2594326949836433 … 0.2714879525870656 0.2849181856398061; … ; 0.2842365509925992 0.27148795258706554 … 0.275819943206304 0.27985821816665113; 0.3000667052724843 0.284918185639806 … 0.2798582181666512 0.2918911854585153;;; 0.34518582264502595 0.3281679626761111 … 0.3066719218453905 0.3342421227457864; 0.32816796267611115 0.31207886734325385 … 0.2977966471354051 0.32173909919668425; … ; 0.3066719218453905 0.2977966471354051 … 0.275819943206304 0.29196644571043395; 0.33424212274578646 0.32173909919668414 … 0.29196644571043395 0.31792264215922617;;; 0.3796923087990368 0.36487339151459697 … 0.3342421227457864 0.36712268178297774; 0.364873391514597 0.35289196429382624 … 0.3217390991966842 0.35289196429382635; … ; 0.3342421227457864 0.3217390991966842 … 0.29196644571043395 0.3179226421592261; 0.36712268178297786 0.35289196429382624 … 0.31792264215922617 0.3510635537546517]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5045333916678539 -0.49777371643692536 … -0.47794434295140786 -0.49777371643692536; -0.49777371643692536 -0.48576260306915686 … -0.47720396502982004 -0.4931207061997502; … ; -0.47794434295140786 -0.47720396502982004 … -0.4122007829587142 -0.45555501093166145; -0.49777371643692536 -0.4931207061997502 … -0.45555501093166145 -0.4857626030691568;;; -0.49777371643692536 -0.48576260306915686 … -0.47720396502982004 -0.4931207061997502; -0.48576260306915686 -0.4591226515172808 … -0.4714879219018189 -0.48714167340233866; … ; -0.47720396502982004 -0.4714879219018188 … -0.4464294267849465 -0.46947014444720525; -0.4931207061997502 -0.48714167340233866 … -0.46947014444720525 -0.4871416734023386;;; -0.47794434295140786 -0.45555501093166145 … -0.4612419965619334 -0.47720396502982004; -0.4555550109316615 -0.4093181357907216 … -0.4573138845106966 -0.4694701444472053; … ; -0.4612419965619333 -0.4573138845106966 … -0.4453134837637775 -0.4573138845106966; -0.47720396502982004 -0.4694701444472053 … -0.4573138845106966 -0.4714879219018188;;; … ;;; -0.4495823319502023 -0.4554569135939184 … -0.37043605058923434 -0.41750055077713244; -0.4554569135939184 -0.4492985154810112 … -0.41669352449437225 -0.44403437592407174; … ; -0.3704360505892344 -0.41669352449437225 … -0.2528249170609107 -0.29898105535449593; -0.41750055077713244 -0.44403437592407174 … -0.29898105535449593 -0.3606066201593247;;; -0.47794434295140786 -0.47720396502982004 … -0.4122007829587142 -0.45555501093166145; -0.47720396502982004 -0.4714879219018189 … -0.4464294267849465 -0.46947014444720525; … ; -0.4122007829587142 -0.4464294267849465 … -0.25282491706091076 -0.34077340723011457; -0.4555550109316615 -0.46947014444720525 … -0.3407734072301145 -0.4093181357907216;;; -0.49777371643692536 -0.4931207061997502 … -0.45555501093166145 -0.4857626030691568; -0.4931207061997502 -0.48714167340233866 … -0.46947014444720525 -0.4871416734023386; … ; -0.45555501093166145 -0.46947014444720525 … -0.34077340723011457 -0.4093181357907216; -0.48576260306915686 -0.4871416734023386 … -0.4093181357907216 -0.4591226515172808])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41270538172515836 -0.4867790155891404 … -0.7029775422308073 -0.4867790155891405; -0.4867790155891401 -0.7747105482638217 … -0.41365016674850363 -0.38218629593076936; … ; -0.7029775422308076 -0.4136501667485039 … -2.397521742246009 -1.2964300967913003; -0.48677901558914 -0.38218629593076936 … -1.2964300967913005 -0.7747105482638215;;; -0.4867790155891403 -0.7747105482638218 … -0.41365016674850374 -0.3821862959307698; -0.7747105482638215 -1.4821613016573738 … -0.32453162174671535 -0.44990714685278366; … ; -0.41365016674850386 -0.3245316217467156 … -1.0118328702372708 -0.6375904308672817; -0.38218629593076925 -0.44990714685278377 … -0.6375904308672815 -0.4499071468527836;;; -0.7029775422308073 -1.296430096791301 … -0.2981817109767001 -0.41365016674850397; -1.2964300967913007 -2.920617752609237 … -0.3537943399627347 -0.6375904308672815; … ; -0.2981817109767001 -0.3537943399627353 … -0.4905966615241479 -0.3537943399627352; -0.4136501667485037 -0.6375904308672816 … -0.35379433996273446 -0.32453162174671524;;; … ;;; -1.017137496195283 -0.5334928303460535 … -3.636642226419138 -1.9994057628709219; -0.5334928303460533 -0.3217878731962801 … -1.4671345032307181 -0.9065981817589968; … ; -3.636642226419138 -1.4671345032307181 … -10.988686204174133 -8.087911788120216; -1.9994057628709219 -0.9065981817589968 … -8.087911788120216 -4.648613099467714;;; -0.7029775422308073 -0.41365016674850374 … -2.3975217422460093 -1.2964300967913007; -0.4136501667485036 -0.32453162174671557 … -1.011832870237271 -0.6375904308672815; … ; -2.3975217422460093 -1.0118328702372712 … -11.003314570583239 -6.078179037083142; -1.2964300967913003 -0.6375904308672814 … -6.078179037083142 -2.920617752609237;;; -0.48677901558914033 -0.3821862959307697 … -1.2964300967913007 -0.7747105482638218; -0.3821862959307694 -0.4499071468527838 … -0.6375904308672815 -0.4499071468527836; … ; -1.2964300967913007 -0.6375904308672816 … -6.0781790370831414 -2.9206177526092367; -0.7747105482638215 -0.44990714685278355 … -2.9206177526092367 -1.4821613016573738]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3929893759302636 0.3796923087990368 … 0.345185822645026 0.3796923087990368; 0.37969230879903687 0.3671226817829779 … 0.3281679626761112 0.36487339151459713; … ; 0.345185822645026 0.32816796267611115 … 0.3066719218453906 0.33424212274578646; 0.37969230879903687 0.364873391514597 … 0.3342421227457865 0.3671226817829779;;; 0.3796923087990368 0.3671226817829778 … 0.3281679626761111 0.36487339151459697; 0.36712268178297786 0.3510635537546517 … 0.31207886734325385 0.35289196429382635; … ; 0.3281679626761111 0.31207886734325385 … 0.29779664713540516 0.32173909919668414; 0.3648733915145971 0.35289196429382624 … 0.3217390991966842 0.35289196429382624;;; 0.345185822645026 0.3342421227457864 … 0.28728480530207845 0.3281679626761111; 0.33424212274578646 0.31792264215922617 … 0.27858813971176505 0.32173909919668425; … ; 0.28728480530207845 0.278588139711765 … 0.25584633146644115 0.278588139711765; 0.32816796267611115 0.32173909919668414 … 0.27858813971176505 0.31207886734325385;;; … ;;; 0.30451805545882843 0.2831385943153532 … 0.2842365509925992 0.30006670527248425; 0.28313859431535326 0.2594326949836433 … 0.2714879525870656 0.2849181856398061; … ; 0.2842365509925992 0.27148795258706554 … 0.275819943206304 0.27985821816665113; 0.3000667052724843 0.284918185639806 … 0.2798582181666512 0.2918911854585153;;; 0.34518582264502595 0.3281679626761111 … 0.3066719218453905 0.3342421227457864; 0.32816796267611115 0.31207886734325385 … 0.2977966471354051 0.32173909919668425; … ; 0.3066719218453905 0.2977966471354051 … 0.275819943206304 0.29196644571043395; 0.33424212274578646 0.32173909919668414 … 0.29196644571043395 0.31792264215922617;;; 0.3796923087990368 0.36487339151459697 … 0.3342421227457864 0.36712268178297774; 0.364873391514597 0.35289196429382624 … 0.3217390991966842 0.35289196429382635; … ; 0.3342421227457864 0.3217390991966842 … 0.29196644571043395 0.3179226421592261; 0.36712268178297786 0.35289196429382624 … 0.31792264215922617 0.3510635537546517]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5045333916678539 -0.49777371643692536 … -0.47794434295140786 -0.49777371643692536; -0.49777371643692536 -0.48576260306915686 … -0.47720396502982004 -0.4931207061997502; … ; -0.47794434295140786 -0.47720396502982004 … -0.4122007829587142 -0.45555501093166145; -0.49777371643692536 -0.4931207061997502 … -0.45555501093166145 -0.4857626030691568;;; -0.49777371643692536 -0.48576260306915686 … -0.47720396502982004 -0.4931207061997502; -0.48576260306915686 -0.4591226515172808 … -0.4714879219018189 -0.48714167340233866; … ; -0.47720396502982004 -0.4714879219018188 … -0.4464294267849465 -0.46947014444720525; -0.4931207061997502 -0.48714167340233866 … -0.46947014444720525 -0.4871416734023386;;; -0.47794434295140786 -0.45555501093166145 … -0.4612419965619334 -0.47720396502982004; -0.4555550109316615 -0.4093181357907216 … -0.4573138845106966 -0.4694701444472053; … ; -0.4612419965619333 -0.4573138845106966 … -0.4453134837637775 -0.4573138845106966; -0.47720396502982004 -0.4694701444472053 … -0.4573138845106966 -0.4714879219018188;;; … ;;; -0.4495823319502023 -0.4554569135939184 … -0.37043605058923434 -0.41750055077713244; -0.4554569135939184 -0.4492985154810112 … -0.41669352449437225 -0.44403437592407174; … ; -0.3704360505892344 -0.41669352449437225 … -0.2528249170609107 -0.29898105535449593; -0.41750055077713244 -0.44403437592407174 … -0.29898105535449593 -0.3606066201593247;;; -0.47794434295140786 -0.47720396502982004 … -0.4122007829587142 -0.45555501093166145; -0.47720396502982004 -0.4714879219018189 … -0.4464294267849465 -0.46947014444720525; … ; -0.4122007829587142 -0.4464294267849465 … -0.25282491706091076 -0.34077340723011457; -0.4555550109316615 -0.46947014444720525 … -0.3407734072301145 -0.4093181357907216;;; -0.49777371643692536 -0.4931207061997502 … -0.45555501093166145 -0.4857626030691568; -0.4931207061997502 -0.48714167340233866 … -0.46947014444720525 -0.4871416734023386; … ; -0.45555501093166145 -0.46947014444720525 … -0.34077340723011457 -0.4093181357907216; -0.48576260306915686 -0.4871416734023386 … -0.4093181357907216 -0.4591226515172808])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41270538172515836 -0.4867790155891404 … -0.7029775422308073 -0.4867790155891405; -0.4867790155891401 -0.7747105482638217 … -0.41365016674850363 -0.38218629593076936; … ; -0.7029775422308076 -0.4136501667485039 … -2.397521742246009 -1.2964300967913003; -0.48677901558914 -0.38218629593076936 … -1.2964300967913005 -0.7747105482638215;;; -0.4867790155891403 -0.7747105482638218 … -0.41365016674850374 -0.3821862959307698; -0.7747105482638215 -1.4821613016573738 … -0.32453162174671535 -0.44990714685278366; … ; -0.41365016674850386 -0.3245316217467156 … -1.0118328702372708 -0.6375904308672817; -0.38218629593076925 -0.44990714685278377 … -0.6375904308672815 -0.4499071468527836;;; -0.7029775422308073 -1.296430096791301 … -0.2981817109767001 -0.41365016674850397; -1.2964300967913007 -2.920617752609237 … -0.3537943399627347 -0.6375904308672815; … ; -0.2981817109767001 -0.3537943399627353 … -0.4905966615241479 -0.3537943399627352; -0.4136501667485037 -0.6375904308672816 … -0.35379433996273446 -0.32453162174671524;;; … ;;; -1.017137496195283 -0.5334928303460535 … -3.636642226419138 -1.9994057628709219; -0.5334928303460533 -0.3217878731962801 … -1.4671345032307181 -0.9065981817589968; … ; -3.636642226419138 -1.4671345032307181 … -10.988686204174133 -8.087911788120216; -1.9994057628709219 -0.9065981817589968 … -8.087911788120216 -4.648613099467714;;; -0.7029775422308073 -0.41365016674850374 … -2.3975217422460093 -1.2964300967913007; -0.4136501667485036 -0.32453162174671557 … -1.011832870237271 -0.6375904308672815; … ; -2.3975217422460093 -1.0118328702372712 … -11.003314570583239 -6.078179037083142; -1.2964300967913003 -0.6375904308672814 … -6.078179037083142 -2.920617752609237;;; -0.48677901558914033 -0.3821862959307697 … -1.2964300967913007 -0.7747105482638218; -0.3821862959307694 -0.4499071468527838 … -0.6375904308672815 -0.4499071468527836; … ; -1.2964300967913007 -0.6375904308672816 … -6.0781790370831414 -2.9206177526092367; -0.7747105482638215 -0.44990714685278355 … -2.9206177526092367 -1.4821613016573738]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3929893759302636 0.3796923087990368 … 0.345185822645026 0.3796923087990368; 0.37969230879903687 0.3671226817829779 … 0.3281679626761112 0.36487339151459713; … ; 0.345185822645026 0.32816796267611115 … 0.3066719218453906 0.33424212274578646; 0.37969230879903687 0.364873391514597 … 0.3342421227457865 0.3671226817829779;;; 0.3796923087990368 0.3671226817829778 … 0.3281679626761111 0.36487339151459697; 0.36712268178297786 0.3510635537546517 … 0.31207886734325385 0.35289196429382635; … ; 0.3281679626761111 0.31207886734325385 … 0.29779664713540516 0.32173909919668414; 0.3648733915145971 0.35289196429382624 … 0.3217390991966842 0.35289196429382624;;; 0.345185822645026 0.3342421227457864 … 0.28728480530207845 0.3281679626761111; 0.33424212274578646 0.31792264215922617 … 0.27858813971176505 0.32173909919668425; … ; 0.28728480530207845 0.278588139711765 … 0.25584633146644115 0.278588139711765; 0.32816796267611115 0.32173909919668414 … 0.27858813971176505 0.31207886734325385;;; … ;;; 0.30451805545882843 0.2831385943153532 … 0.2842365509925992 0.30006670527248425; 0.28313859431535326 0.2594326949836433 … 0.2714879525870656 0.2849181856398061; … ; 0.2842365509925992 0.27148795258706554 … 0.275819943206304 0.27985821816665113; 0.3000667052724843 0.284918185639806 … 0.2798582181666512 0.2918911854585153;;; 0.34518582264502595 0.3281679626761111 … 0.3066719218453905 0.3342421227457864; 0.32816796267611115 0.31207886734325385 … 0.2977966471354051 0.32173909919668425; … ; 0.3066719218453905 0.2977966471354051 … 0.275819943206304 0.29196644571043395; 0.33424212274578646 0.32173909919668414 … 0.29196644571043395 0.31792264215922617;;; 0.3796923087990368 0.36487339151459697 … 0.3342421227457864 0.36712268178297774; 0.364873391514597 0.35289196429382624 … 0.3217390991966842 0.35289196429382635; … ; 0.3342421227457864 0.3217390991966842 … 0.29196644571043395 0.3179226421592261; 0.36712268178297786 0.35289196429382624 … 0.31792264215922617 0.3510635537546517]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5045333916678539 -0.49777371643692536 … -0.47794434295140786 -0.49777371643692536; -0.49777371643692536 -0.48576260306915686 … -0.47720396502982004 -0.4931207061997502; … ; -0.47794434295140786 -0.47720396502982004 … -0.4122007829587142 -0.45555501093166145; -0.49777371643692536 -0.4931207061997502 … -0.45555501093166145 -0.4857626030691568;;; -0.49777371643692536 -0.48576260306915686 … -0.47720396502982004 -0.4931207061997502; -0.48576260306915686 -0.4591226515172808 … -0.4714879219018189 -0.48714167340233866; … ; -0.47720396502982004 -0.4714879219018188 … -0.4464294267849465 -0.46947014444720525; -0.4931207061997502 -0.48714167340233866 … -0.46947014444720525 -0.4871416734023386;;; -0.47794434295140786 -0.45555501093166145 … -0.4612419965619334 -0.47720396502982004; -0.4555550109316615 -0.4093181357907216 … -0.4573138845106966 -0.4694701444472053; … ; -0.4612419965619333 -0.4573138845106966 … -0.4453134837637775 -0.4573138845106966; -0.47720396502982004 -0.4694701444472053 … -0.4573138845106966 -0.4714879219018188;;; … ;;; -0.4495823319502023 -0.4554569135939184 … -0.37043605058923434 -0.41750055077713244; -0.4554569135939184 -0.4492985154810112 … -0.41669352449437225 -0.44403437592407174; … ; -0.3704360505892344 -0.41669352449437225 … -0.2528249170609107 -0.29898105535449593; -0.41750055077713244 -0.44403437592407174 … -0.29898105535449593 -0.3606066201593247;;; -0.47794434295140786 -0.47720396502982004 … -0.4122007829587142 -0.45555501093166145; -0.47720396502982004 -0.4714879219018189 … -0.4464294267849465 -0.46947014444720525; … ; -0.4122007829587142 -0.4464294267849465 … -0.25282491706091076 -0.34077340723011457; -0.4555550109316615 -0.46947014444720525 … -0.3407734072301145 -0.4093181357907216;;; -0.49777371643692536 -0.4931207061997502 … -0.45555501093166145 -0.4857626030691568; -0.4931207061997502 -0.48714167340233866 … -0.46947014444720525 -0.4871416734023386; … ; -0.45555501093166145 -0.46947014444720525 … -0.34077340723011457 -0.4093181357907216; -0.48576260306915686 -0.4871416734023386 … -0.4093181357907216 -0.4591226515172808])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41270538172515836 -0.4867790155891404 … -0.7029775422308073 -0.4867790155891405; -0.4867790155891401 -0.7747105482638217 … -0.41365016674850363 -0.38218629593076936; … ; -0.7029775422308076 -0.4136501667485039 … -2.397521742246009 -1.2964300967913003; -0.48677901558914 -0.38218629593076936 … -1.2964300967913005 -0.7747105482638215;;; -0.4867790155891403 -0.7747105482638218 … -0.41365016674850374 -0.3821862959307698; -0.7747105482638215 -1.4821613016573738 … -0.32453162174671535 -0.44990714685278366; … ; -0.41365016674850386 -0.3245316217467156 … -1.0118328702372708 -0.6375904308672817; -0.38218629593076925 -0.44990714685278377 … -0.6375904308672815 -0.4499071468527836;;; -0.7029775422308073 -1.296430096791301 … -0.2981817109767001 -0.41365016674850397; -1.2964300967913007 -2.920617752609237 … -0.3537943399627347 -0.6375904308672815; … ; -0.2981817109767001 -0.3537943399627353 … -0.4905966615241479 -0.3537943399627352; -0.4136501667485037 -0.6375904308672816 … -0.35379433996273446 -0.32453162174671524;;; … ;;; -1.017137496195283 -0.5334928303460535 … -3.636642226419138 -1.9994057628709219; -0.5334928303460533 -0.3217878731962801 … -1.4671345032307181 -0.9065981817589968; … ; -3.636642226419138 -1.4671345032307181 … -10.988686204174133 -8.087911788120216; -1.9994057628709219 -0.9065981817589968 … -8.087911788120216 -4.648613099467714;;; -0.7029775422308073 -0.41365016674850374 … -2.3975217422460093 -1.2964300967913007; -0.4136501667485036 -0.32453162174671557 … -1.011832870237271 -0.6375904308672815; … ; -2.3975217422460093 -1.0118328702372712 … -11.003314570583239 -6.078179037083142; -1.2964300967913003 -0.6375904308672814 … -6.078179037083142 -2.920617752609237;;; -0.48677901558914033 -0.3821862959307697 … -1.2964300967913007 -0.7747105482638218; -0.3821862959307694 -0.4499071468527838 … -0.6375904308672815 -0.4499071468527836; … ; -1.2964300967913007 -0.6375904308672816 … -6.0781790370831414 -2.9206177526092367; -0.7747105482638215 -0.44990714685278355 … -2.9206177526092367 -1.4821613016573738]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3929893759302636 0.3796923087990368 … 0.345185822645026 0.3796923087990368; 0.37969230879903687 0.3671226817829779 … 0.3281679626761112 0.36487339151459713; … ; 0.345185822645026 0.32816796267611115 … 0.3066719218453906 0.33424212274578646; 0.37969230879903687 0.364873391514597 … 0.3342421227457865 0.3671226817829779;;; 0.3796923087990368 0.3671226817829778 … 0.3281679626761111 0.36487339151459697; 0.36712268178297786 0.3510635537546517 … 0.31207886734325385 0.35289196429382635; … ; 0.3281679626761111 0.31207886734325385 … 0.29779664713540516 0.32173909919668414; 0.3648733915145971 0.35289196429382624 … 0.3217390991966842 0.35289196429382624;;; 0.345185822645026 0.3342421227457864 … 0.28728480530207845 0.3281679626761111; 0.33424212274578646 0.31792264215922617 … 0.27858813971176505 0.32173909919668425; … ; 0.28728480530207845 0.278588139711765 … 0.25584633146644115 0.278588139711765; 0.32816796267611115 0.32173909919668414 … 0.27858813971176505 0.31207886734325385;;; … ;;; 0.30451805545882843 0.2831385943153532 … 0.2842365509925992 0.30006670527248425; 0.28313859431535326 0.2594326949836433 … 0.2714879525870656 0.2849181856398061; … ; 0.2842365509925992 0.27148795258706554 … 0.275819943206304 0.27985821816665113; 0.3000667052724843 0.284918185639806 … 0.2798582181666512 0.2918911854585153;;; 0.34518582264502595 0.3281679626761111 … 0.3066719218453905 0.3342421227457864; 0.32816796267611115 0.31207886734325385 … 0.2977966471354051 0.32173909919668425; … ; 0.3066719218453905 0.2977966471354051 … 0.275819943206304 0.29196644571043395; 0.33424212274578646 0.32173909919668414 … 0.29196644571043395 0.31792264215922617;;; 0.3796923087990368 0.36487339151459697 … 0.3342421227457864 0.36712268178297774; 0.364873391514597 0.35289196429382624 … 0.3217390991966842 0.35289196429382635; … ; 0.3342421227457864 0.3217390991966842 … 0.29196644571043395 0.3179226421592261; 0.36712268178297786 0.35289196429382624 … 0.31792264215922617 0.3510635537546517]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5045333916678539 -0.49777371643692536 … -0.47794434295140786 -0.49777371643692536; -0.49777371643692536 -0.48576260306915686 … -0.47720396502982004 -0.4931207061997502; … ; -0.47794434295140786 -0.47720396502982004 … -0.4122007829587142 -0.45555501093166145; -0.49777371643692536 -0.4931207061997502 … -0.45555501093166145 -0.4857626030691568;;; -0.49777371643692536 -0.48576260306915686 … -0.47720396502982004 -0.4931207061997502; -0.48576260306915686 -0.4591226515172808 … -0.4714879219018189 -0.48714167340233866; … ; -0.47720396502982004 -0.4714879219018188 … -0.4464294267849465 -0.46947014444720525; -0.4931207061997502 -0.48714167340233866 … -0.46947014444720525 -0.4871416734023386;;; -0.47794434295140786 -0.45555501093166145 … -0.4612419965619334 -0.47720396502982004; -0.4555550109316615 -0.4093181357907216 … -0.4573138845106966 -0.4694701444472053; … ; -0.4612419965619333 -0.4573138845106966 … -0.4453134837637775 -0.4573138845106966; -0.47720396502982004 -0.4694701444472053 … -0.4573138845106966 -0.4714879219018188;;; … ;;; -0.4495823319502023 -0.4554569135939184 … -0.37043605058923434 -0.41750055077713244; -0.4554569135939184 -0.4492985154810112 … -0.41669352449437225 -0.44403437592407174; … ; -0.3704360505892344 -0.41669352449437225 … -0.2528249170609107 -0.29898105535449593; -0.41750055077713244 -0.44403437592407174 … -0.29898105535449593 -0.3606066201593247;;; -0.47794434295140786 -0.47720396502982004 … -0.4122007829587142 -0.45555501093166145; -0.47720396502982004 -0.4714879219018189 … -0.4464294267849465 -0.46947014444720525; … ; -0.4122007829587142 -0.4464294267849465 … -0.25282491706091076 -0.34077340723011457; -0.4555550109316615 -0.46947014444720525 … -0.3407734072301145 -0.4093181357907216;;; -0.49777371643692536 -0.4931207061997502 … -0.45555501093166145 -0.4857626030691568; -0.4931207061997502 -0.48714167340233866 … -0.46947014444720525 -0.4871416734023386; … ; -0.45555501093166145 -0.46947014444720525 … -0.34077340723011457 -0.4093181357907216; -0.48576260306915686 -0.4871416734023386 … -0.4093181357907216 -0.4591226515172808])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41270538172515836 -0.4867790155891404 … -0.7029775422308073 -0.4867790155891405; -0.4867790155891401 -0.7747105482638217 … -0.41365016674850363 -0.38218629593076936; … ; -0.7029775422308076 -0.4136501667485039 … -2.397521742246009 -1.2964300967913003; -0.48677901558914 -0.38218629593076936 … -1.2964300967913005 -0.7747105482638215;;; -0.4867790155891403 -0.7747105482638218 … -0.41365016674850374 -0.3821862959307698; -0.7747105482638215 -1.4821613016573738 … -0.32453162174671535 -0.44990714685278366; … ; -0.41365016674850386 -0.3245316217467156 … -1.0118328702372708 -0.6375904308672817; -0.38218629593076925 -0.44990714685278377 … -0.6375904308672815 -0.4499071468527836;;; -0.7029775422308073 -1.296430096791301 … -0.2981817109767001 -0.41365016674850397; -1.2964300967913007 -2.920617752609237 … -0.3537943399627347 -0.6375904308672815; … ; -0.2981817109767001 -0.3537943399627353 … -0.4905966615241479 -0.3537943399627352; -0.4136501667485037 -0.6375904308672816 … -0.35379433996273446 -0.32453162174671524;;; … ;;; -1.017137496195283 -0.5334928303460535 … -3.636642226419138 -1.9994057628709219; -0.5334928303460533 -0.3217878731962801 … -1.4671345032307181 -0.9065981817589968; … ; -3.636642226419138 -1.4671345032307181 … -10.988686204174133 -8.087911788120216; -1.9994057628709219 -0.9065981817589968 … -8.087911788120216 -4.648613099467714;;; -0.7029775422308073 -0.41365016674850374 … -2.3975217422460093 -1.2964300967913007; -0.4136501667485036 -0.32453162174671557 … -1.011832870237271 -0.6375904308672815; … ; -2.3975217422460093 -1.0118328702372712 … -11.003314570583239 -6.078179037083142; -1.2964300967913003 -0.6375904308672814 … -6.078179037083142 -2.920617752609237;;; -0.48677901558914033 -0.3821862959307697 … -1.2964300967913007 -0.7747105482638218; -0.3821862959307694 -0.4499071468527838 … -0.6375904308672815 -0.4499071468527836; … ; -1.2964300967913007 -0.6375904308672816 … -6.0781790370831414 -2.9206177526092367; -0.7747105482638215 -0.44990714685278355 … -2.9206177526092367 -1.4821613016573738]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852325327701582), converged = true, occupation_threshold = 1.0e-6, ρ = [0.092044476574717 0.08811276954754826 … 0.07724105863440131 0.08811276954754826; 0.08811276954754829 0.08141136161652543 … 0.07685384778465905 0.08547383811300563; … ; 0.07724105863440131 0.07685384778465905 … 0.047751715059501064 0.0661071703147329; 0.08811276954754828 0.08547383811300564 … 0.0661071703147329 0.08141136161652542;;; 0.08811276954754826 0.08141136161652543 … 0.07685384778465904 0.08547383811300563; 0.08141136161652544 0.06780275908714976 … 0.07390880371821017 0.0821625229290605; … ; 0.07685384778465905 0.07390880371821015 … 0.061902002181097746 0.072887838447686; 0.08547383811300564 0.0821625229290605 … 0.072887838447686 0.08216252292906048;;; 0.07724105863440128 0.0661071703147329 … 0.06882392025921164 0.07685384778465904; 0.06610717031473291 0.046672196657266275 … 0.06693945086371264 0.07288783844768601; … ; 0.06882392025921165 0.06693945086371264 … 0.06140062805024729 0.06693945086371264; 0.07685384778465905 0.07288783844768601 … 0.06693945086371264 0.07390880371821014;;; … ;;; 0.06333362027174708 0.0660609604540804 … 0.033695039037603666 0.04978067758434049; 0.0660609604540804 0.06320383466743616 … 0.04946798928353016 0.06082936076881811; … ; 0.03369503903760368 0.04946798928353016 … 0.009591536329962019 0.016680813761107516; 0.0497806775843405 0.06082936076881811 … 0.016680813761107513 0.030857621170622258;;; 0.0772410586344013 0.07685384778465904 … 0.04775171505950106 0.0661071703147329; 0.07685384778465905 0.07390880371821017 … 0.061902002181097746 0.072887838447686; … ; 0.04775171505950106 0.06190200218109773 … 0.009591536329962026 0.02563843781471134; 0.06610717031473291 0.072887838447686 … 0.025638437814711347 0.04667219665726626;;; 0.08811276954754826 0.08547383811300563 … 0.06610717031473289 0.08141136161652542; 0.08547383811300564 0.0821625229290605 … 0.072887838447686 0.08216252292906048; … ; 0.0661071703147329 0.072887838447686 … 0.02563843781471135 0.046672196657266275; 0.08141136161652544 0.08216252292906048 … 0.046672196657266275 0.06780275908714975;;;;], α = 0.8, eigenvalues = [[-0.16686009773709445, 0.2643377233308391, 0.2643433107611376, 0.2643799278809457, 0.35735117525717275, 0.35735591714703285, 0.3574557343992329], [-0.11619021140798996, 0.07031669875083649, 0.2262891807678131, 0.22628992722992192, 0.33638839587803987, 0.3933521219418186, 0.39336525615087303], [-0.09594709898657505, 0.08790686363664528, 0.17298555594425732, 0.17301010084654614, 0.29148327517941514, 0.3373879800232443, 0.5339916971309437], [-0.04493811600552205, 0.02237894241508199, 0.09784753366770636, 0.18447123062110324, 0.3247883286251453, 0.5030893232633893, 0.5071250961310155]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.29001813173374025, n_iter = 2, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.864313438847121 - 0.4099706075314652im 2.729097332969106e-5 - 0.00022222532153275847im … 0.00014716243717285027 + 0.000126544539985257im 0.0009375085419217641 - 0.00013806726951862862im; 0.08517133466058999 - 0.03994316376066668im -0.19995776608405777 + 0.23386420521045767im … 0.029332924098399125 + 0.28535595802790303im -0.33792636685798383 + 0.27000528540754715im; … ; 0.010441432510862087 - 0.0051497910539558675im 0.04485479063720939 + 0.000761670315052862im … 0.011594654275052017 + 0.010330400452568413im -0.05461416767882495 + 0.02247807308439482im; -0.08551947433277024 + 0.04003566587229672im 0.23338011413577076 + 0.24252426260093887im … 0.07027235745349837 - 0.20037899747609256im -0.11859452379660758 - 0.08364674844449653im], [0.9053030904463545 + 0.21035320183327302im -0.1888575795737872 - 0.05449091790913705im … -9.658960430047414e-5 + 7.82835368736411e-5im 8.66787820989494e-5 - 1.374969761363905e-5im; 0.060923664590676704 + 0.014124632639378194im 0.010968837568085107 + 0.003145732728469628im … -0.0009495041529543331 + 0.00025182472707067227im -4.340762239093103e-5 - 7.748260898539542e-6im; … ; 0.00784634339433738 + 0.0018312228818949498im -0.08219602629546001 - 0.023677387048755633im … 0.09351373737725341 + 0.0036621981801057434im -0.01899509863922802 - 0.04423092832497954im; -0.10938964010503108 - 0.02542082997918705im 0.08519495232814724 + 0.024555927044034462im … 0.41233574946314167 + 0.017075940813862715im -0.08237771019395004 - 0.1971077275256989im], [0.5748012941021639 - 0.7368005070523155im -3.6367514511341232e-6 + 0.00010116218690265982im … -0.0007120959540014306 + 0.0006533611195553976im -3.810113826205772e-5 + 8.435336728299672e-6im; 0.041411336287108705 - 0.05310908202950349im -0.006137253242139679 + 0.05926580002942226im … -0.004995714149529151 + 0.004055280003733454im -0.003368874951803495 - 0.004713717466418086im; … ; 0.008955998546426754 - 0.011466177650252221im 3.440162127974476e-5 - 1.1171520066896373e-5im … 0.004358299993432644 - 0.0053736787305097905im 0.04799298635437277 - 0.042859165991189364im; -0.09363190068612831 + 0.12001490370623578im -0.02960808332558589 + 0.28507739827596446im … 0.2596767795020726 - 0.2790205458528321im 0.1124765560345345 - 0.09728978577577067im], [-0.8018316323106865 - 0.11154836688171126im 0.00015032792764259112 - 4.278927763102079e-5im … 0.0063214147689167706 - 0.0019522619378930716im 0.2154444167199532 - 0.0592147175796362im; -0.3836159602829911 - 0.053358042111728794im 0.6110105279170456 - 0.142084489308704im … -0.006714203626379164 + 0.0017212675897203286im -0.20861042929766074 + 0.05734972827994078im; … ; -0.011195759944333434 - 0.0015781561048319609im 0.0013260022110115136 - 0.00027750057386371737im … 0.0071114414065001985 + 0.044935924837158456im 0.013484411879523768 - 0.005040214717366022im; 0.06338626208828016 + 0.008827700524312131im 0.013155533618999507 - 0.003067265188855311im … 0.08132031756095333 + 0.4822364763577306im 0.4339179066854619 - 0.13391437934963418im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16686009773709445, 0.2643377233308391, 0.2643433107611376, 0.2643799278809457, 0.35735117525717275, 0.35735591714703285, 0.3574557343992329], [-0.11619021140798996, 0.07031669875083649, 0.2262891807678131, 0.22628992722992192, 0.33638839587803987, 0.3933521219418186, 0.39336525615087303], [-0.09594709898657505, 0.08790686363664528, 0.17298555594425732, 0.17301010084654614, 0.29148327517941514, 0.3373879800232443, 0.5339916971309437], [-0.04493811600552205, 0.02237894241508199, 0.09784753366770636, 0.18447123062110324, 0.3247883286251453, 0.5030893232633893, 0.5071250961310155]], X = [[0.864313438847121 - 0.4099706075314652im 2.729097332969106e-5 - 0.00022222532153275847im … 0.00014716243717285027 + 0.000126544539985257im 0.0009375085419217641 - 0.00013806726951862862im; 0.08517133466058999 - 0.03994316376066668im -0.19995776608405777 + 0.23386420521045767im … 0.029332924098399125 + 0.28535595802790303im -0.33792636685798383 + 0.27000528540754715im; … ; 0.010441432510862087 - 0.0051497910539558675im 0.04485479063720939 + 0.000761670315052862im … 0.011594654275052017 + 0.010330400452568413im -0.05461416767882495 + 0.02247807308439482im; -0.08551947433277024 + 0.04003566587229672im 0.23338011413577076 + 0.24252426260093887im … 0.07027235745349837 - 0.20037899747609256im -0.11859452379660758 - 0.08364674844449653im], [0.9053030904463545 + 0.21035320183327302im -0.1888575795737872 - 0.05449091790913705im … -9.658960430047414e-5 + 7.82835368736411e-5im 8.66787820989494e-5 - 1.374969761363905e-5im; 0.060923664590676704 + 0.014124632639378194im 0.010968837568085107 + 0.003145732728469628im … -0.0009495041529543331 + 0.00025182472707067227im -4.340762239093103e-5 - 7.748260898539542e-6im; … ; 0.00784634339433738 + 0.0018312228818949498im -0.08219602629546001 - 0.023677387048755633im … 0.09351373737725341 + 0.0036621981801057434im -0.01899509863922802 - 0.04423092832497954im; -0.10938964010503108 - 0.02542082997918705im 0.08519495232814724 + 0.024555927044034462im … 0.41233574946314167 + 0.017075940813862715im -0.08237771019395004 - 0.1971077275256989im], [0.5748012941021639 - 0.7368005070523155im -3.6367514511341232e-6 + 0.00010116218690265982im … -0.0007120959540014306 + 0.0006533611195553976im -3.810113826205772e-5 + 8.435336728299672e-6im; 0.041411336287108705 - 0.05310908202950349im -0.006137253242139679 + 0.05926580002942226im … -0.004995714149529151 + 0.004055280003733454im -0.003368874951803495 - 0.004713717466418086im; … ; 0.008955998546426754 - 0.011466177650252221im 3.440162127974476e-5 - 1.1171520066896373e-5im … 0.004358299993432644 - 0.0053736787305097905im 0.04799298635437277 - 0.042859165991189364im; -0.09363190068612831 + 0.12001490370623578im -0.02960808332558589 + 0.28507739827596446im … 0.2596767795020726 - 0.2790205458528321im 0.1124765560345345 - 0.09728978577577067im], [-0.8018316323106865 - 0.11154836688171126im 0.00015032792764259112 - 4.278927763102079e-5im … 0.0063214147689167706 - 0.0019522619378930716im 0.2154444167199532 - 0.0592147175796362im; -0.3836159602829911 - 0.053358042111728794im 0.6110105279170456 - 0.142084489308704im … -0.006714203626379164 + 0.0017212675897203286im -0.20861042929766074 + 0.05734972827994078im; … ; -0.011195759944333434 - 0.0015781561048319609im 0.0013260022110115136 - 0.00027750057386371737im … 0.0071114414065001985 + 0.044935924837158456im 0.013484411879523768 - 0.005040214717366022im; 0.06338626208828016 + 0.008827700524312131im 0.013155533618999507 - 0.003067265188855311im … 0.08132031756095333 + 0.4822364763577306im 0.4339179066854619 - 0.13391437934963418im]], residual_norms = [[0.012661355189727032, 0.006981996341510382, 0.007112736613848661, 0.010478544640681138, 0.0039862041810853855, 0.004714228400511132, 0.010692062563779978], [0.004013640862491297, 0.006637667289973748, 0.006054886529897496, 0.006062999771279336, 0.0071267891390333115, 0.010612074820155356, 0.011026920641691062], [0.005873822569730732, 0.005748026429775526, 0.004534597028153702, 0.007276343980523986, 0.00809812187896239, 0.02007695337162346, 0.029886913633264935], [0.004946852223436323, 0.004918440707797501, 0.008127261457987851, 0.012499425747323928, 0.041380115298004796, 0.018563372779096136, 0.048491788224002304]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 0.002744619036767057)</code></pre><p>Remove the virtual orbitals (which Newton cannot treat yet)</p><pre><code class="language-julia hljs">ψ, _ = DFTK.select_occupied_orbitals(basis, scfres_start.ψ, scfres_start.occupation)
scfres_newton = newton(basis, ψ; tol)

# Comparison of results

println(&quot;|ρ_newton - ρ_scf|  = &quot;, norm(scfres_newton.ρ - scfres_scf.ρ))
println(&quot;|ρ_newton - ρ_scfv| = &quot;, norm(scfres_newton.ρ - scfres_scfv.ρ))
println(&quot;|ρ_newton - ρ_dm|   = &quot;, norm(scfres_newton.ρ - scfres_dm.ρ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)
---   ---------------   ---------   ---------
  1   -7.852646686709                   -2.54
  2   -7.852646686730      -10.68       -5.91
  3   -7.852646686730   +  -14.75      -12.60
|ρ_newton - ρ_scf|  = 2.646662485654541e-13
|ρ_newton - ρ_scfv| = 1.2073435908389371e-13
|ρ_newton - ρ_dm|   = 4.64696014930144e-10</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scf_callbacks/">« Monitoring self-consistent field calculations</a><a class="docs-footer-nextpage" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 17 September 2022 21:52">Saturday 17 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
