<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Eigenvalues of the dielectric matrix · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/dielectric/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li class="is-active"><a class="tocitem" href>Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../compare_solvers/">Comparison of DFT solvers</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Response and properties</a></li><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/dielectric.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Eigenvalues-of-the-dielectric-matrix"><a class="docs-heading-anchor" href="#Eigenvalues-of-the-dielectric-matrix">Eigenvalues of the dielectric matrix</a><a id="Eigenvalues-of-the-dielectric-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalues-of-the-dielectric-matrix" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/dielectric.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/dielectric.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compute a few eigenvalues of the dielectric matrix (q=0,ω=0) iteratively.</p><pre><code class="language-julia hljs">using DFTK
using Plots
using KrylovKit
using Printf

# Calculation parameters
kgrid = [1, 1, 1]
Ecut = 5

# Silicon lattice
a = 10.26
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

# Compute the dielectric operator without symmetries
model = model_LDA(lattice, atoms, positions, symmetries=false)
basis = PlaneWaveBasis(model; Ecut, kgrid)
scfres = self_consistent_field(basis, tol=1e-14)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.5274666757298031 0.5044274697070484 … 0.4441271625311382 0.5044274772057775; 0.5044274647224568 0.47725916318960065 … 0.42889200388269105 0.48607514113624456; … ; 0.44412717209439917 0.42889201714870634 … 0.36709511547556967 0.41730359358319236; 0.5044274820689005 0.48607515051845374 … 0.41730358855218574 0.4772591853665859;;; 0.5044274711174719 0.4772591694623766 … 0.42889200931004673 0.4860751472040874; 0.47725916444563937 0.4445296782053819 … 0.4098211877742627 0.4647445298598624; … ; 0.4288920183608014 0.409821200575257 … 0.3603062853911468 0.4089020051677461; 0.4860751519053559 0.46474453916214875 … 0.40890200041217284 0.4647445463238106;;; 0.4441271530976038 0.41730357344945135 … 0.3746744306638893 0.42889200374239667; 0.41730356870216845 0.3873367817350011 … 0.3577719505571192 0.4089019814304871; … ; 0.3746744388273104 0.35777196242655623 … 0.31349197200121137 0.3577719688585827; 0.4288920080937819 0.4089019902216796 … 0.3577719646415161 0.4098211973950517;;; … ;;; 0.37207165576267315 0.3538533896351781 … 0.3279354969137732 0.3563741637778219; 0.353853385892801 0.331782035044492 … 0.30993601664075615 0.3421493087153329; … ; 0.32793550525530835 0.3099360282194595 … 0.32417732782336434 0.3270201544481787; 0.35637416793968707 0.3421493163915724 … 0.32702015019267966 0.3434110452156051;;; 0.4441271596721665 0.42889200525085147 … 0.3670951047889209 0.4173035815572658; 0.4288920010142985 0.4098211838400419 … 0.3603062700345139 0.4089019882666747; … ; 0.36709511384701987 0.3603062825681417 … 0.324177333300761 0.3459587620364297; 0.4173035860943776 0.40890199671149186 … 0.3459587573894875 0.3873367964377891;;; 0.504427475702584 0.4860751443680565 … 0.4173035829795227 0.4772591791908862; 0.48607513967968996 0.46474452720838627 … 0.40890198975742803 0.46474453456292975; … ; 0.4173035925304352 0.40890200292634504 … 0.3459587625953413 0.38733680251849856; 0.47725918399335004 0.4647445436266763 … 0.3873367975519608 0.4445296988217865]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5575517639787542 -0.5479471285543338 … -0.5185332265608024 -0.547947131614925; -0.5479471272462567 -0.5318143632146057 … -0.5184377236247409 -0.541806586385681; … ; -0.5185332292609538 -0.5184377270347199 … -0.42962123239313377 -0.48956884722939326; -0.5479471328292046 -0.5418065887072796 … -0.4895688455346622 -0.5318143710137858;;; -0.5479471290137776 -0.5318143651384452 … -0.5184377250201254 -0.5418065879648134; -0.5318143637088728 -0.5005477154978628 … -0.512118330231226 -0.5325945651228884; … ; -0.5184377274439995 -0.5121183334969842 … -0.4661344096968525 -0.5043253450365925; -0.5418065891391065 -0.5325945675435221 … -0.5043253435678341 -0.5325945705124242;;; -0.5185332225258825 -0.48956883976617405 … -0.4981327764638328 -0.5184377225755796; -0.48956883828156283 -0.4364507909716754 … -0.4900722188063327 -0.5043253367429289; … ; -0.4981327785862059 -0.4900722219069986 … -0.46519528538764404 -0.4900722248591215; -0.5184377236906604 -0.5043253391928696 … -0.4900722236378883 -0.5121183327782791;;; … ;;; -0.4726017243427553 -0.48204415687412094 … -0.3634524748201787 -0.43056198033034987; -0.48204415602264566 -0.47922052892562994 … -0.4126646370006455 -0.46009328699160257; … ; -0.36345247852830276 -0.412664640931783 … -0.2285997331576359 -0.2848129686045723; -0.4305619816380962 -0.4600932890029161 … -0.2848129655799978 -0.3648044497542043;;; -0.5185332255030827 -0.5184377236222778 … -0.42962122802707114 -0.489568843145373; -0.5184377226374769 -0.5121183288588171 … -0.46613440460782013 -0.5043253400607052; … ; -0.42962123125689633 -0.4661344082859392 … -0.22859973880104406 -0.34831028834858513; -0.48956884440023607 -0.5043253421395401 … -0.3483102859521314 -0.4364507961868179;;; -0.5479471311137559 -0.5418065870435 … -0.4895688437721152 -0.5318143692599516; -0.5418065858958939 -0.5325945641824077 … -0.5043253406061096 -0.5325945674054161; … ; -0.48956884671100287 -0.5043253441450603 … -0.3483102890630294 -0.43645079883442156; -0.5318143704975081 -0.5325945696022121 … -0.43645079690538086 -0.5005477229731589])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.3310743091199901 -0.412807198931384 … -0.6446111588747088 -0.41280719449324604; -0.41280720260789816 -0.7100657350787221 … -0.3544615740369082 -0.30913306792129974; … ; -0.6446111520115996 -0.3544615641808721 … -2.3546475335187944 -1.2457143132794748; -0.4128071908444026 -0.3091330608606896 … -1.2457143166157505 -0.7100657207009169;;; -0.4128071979804044 -0.7100657307297855 … -0.35446157000493705 -0.3091330634325892; -0.7100657343169501 -1.4302028656769918 … -0.26727788414960607 -0.38354463079671763; … ; -0.35446156337805673 -0.26727787461437025 … -0.969057418049939 -0.5871334722124867; -0.309133059905614 -0.38354462391506533 … -0.587133475499302 -0.3835446197223054;;; -0.6446111642733234 -1.245714325949997 … -0.24780071108781992 -0.35446157312804133; -1.2457143292126682 -2.8821341204633377 … -0.3054389175948186 -0.5871334876560823; … ; -0.24780070504677215 -0.30543890882604774 … -0.453066685345465 -0.30543890534614393; -0.3544615698917371 -0.5871334813148308 … -0.3054389083419771 -0.26727787707587025;;; … ;;; -0.9709769939020115 -0.4899758221175932 … -3.5878603890987715 -1.9567619738475148; -0.4899758250084946 -0.2793181261144674 … -1.4218711409382545 -0.8653691198176943; … ; -3.5878603844653605 -1.4218711332906886 … -10.921547054264728 -8.025756889333483; -1.956761970993396 -0.8653691141527682 … -8.025756890564407 -4.601265256604818;;; -0.6446111606759608 -0.35446157266628475 … -2.354647539839381 -1.2457143212213817; -0.3544615759180367 -0.26727788671141806 … -0.9690574283175388 -0.587133484137671; … ; -2.354647534011107 -0.9690574194620302 … -10.930987244756164 -6.02781312728769; -1.2457143179391323 -0.5871334777716889 … -6.027813129538179 -2.8821341109756924;;; -0.4128071954952707 -0.3091330653473068 … -1.2457143204258672 -0.7100657251227824; -0.30913306888806713 -0.38354463250771315 … -0.5871334831923221 -0.383544628376178; … ; -1.2457143138138422 -0.5871334735623558 … -6.027813127443224 -2.8821341075425857; -0.710065721557875 -0.3835446215092278 … -2.8821341105800835 -1.430202852535883]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -7.2513387987045395), converged = true, occupation_threshold = 1.0e-6, ρ = [0.12710827558142124 0.12017965506006535 … 0.10056375873606824 0.12017965722601952; 0.12017965413435036 0.10912704728640372 … 0.10050389588168476 0.1158872115229908; … ; 0.10056376042891155 0.10050389801868437 … 0.05464060962697446 0.08349600893876886; 0.12017965808535476 0.1158872131258511 … 0.08349600800257846 0.1091270524554747;;; 0.12017965538520974 0.10912704856146882 … 0.10050389675615827 0.11588721261324325; 0.10912704761398963 0.08971211813258445 … 0.09659641856977062 0.10964497596060722; … ; 0.10050389827517585 0.09659642056192032 … 0.07122114744258698 0.09192172173271666; 0.11588721342398976 0.10964497757010623 … 0.09192172086649081 0.1096449795441533;;; 0.10056375620640015 0.08349600481599422 … 0.08831868325800234 0.10050389522418587; 0.08349600399587663 0.05751667546519568 … 0.08377439297488963 0.0919217168413847; … ; 0.08831868447610759 0.08377439469162154 … 0.07075664452933929 0.08377439632611032; 0.10050389592299583 0.09192171828627968 … 0.08377439564995559 0.09659642012350207;;; … ;;; 0.07447652234031019 0.07940929883590392 … 0.03166159793942285 0.05503081450798978; 0.07940929838133828 0.07791160733250428 … 0.047927000173424335 0.06826914806065812; … ; 0.03166159899623174 0.047927001660814574 … 0.006870415480240148 0.014215398002470946; 0.05503081505173607 0.0682691490293497 … 0.014215397504787893 0.03204851519600263;;; 0.10056375807293746 0.10050389588014119 … 0.054640607820406306 0.08349600668270556; 0.10050389526297629 0.0965964177325856 … 0.07122114491987346 0.09192171879810074; … ; 0.05464060915682768 0.07122114674317505 … 0.0068704160428192974 0.027544043869928567; 0.08349600737590743 0.09192172002412971 … 0.027544043249073488 0.05751667769994011;;; 0.12017965687134646 0.1158872119771572 … 0.08349600702892566 0.1091270512930841; 0.11588721118483572 0.10964497533527405 … 0.09192171911976245 0.10964497747827845; … ; 0.08349600865240363 0.09192172120691998 … 0.027544044055021377 0.057516678834466706; 0.10912705211330073 0.10964497893894594 … 0.05751667800785204 0.08971212246887425;;;;], α = 0.8, eigenvalues = [[-0.14431559203569977, 0.29698169229513405, 0.2969816926526804, 0.2969816931059026, 0.37573826715003844, 0.37573826732102944, 0.37573826756737866]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.344239382190884, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.9282082137088682 + 0.25840197867708464im 1.040250669095735e-10 - 2.7567437269020773e-11im … 1.69608655892943e-10 - 4.34239359800311e-11im -3.0346957193194134e-9 + 1.1111066533662583e-9im; -0.08307223441986385 + 0.023126308302272473im -0.3880850345118314 + 0.113128683946125im … 0.13501017592716189 + 0.3861073272417629im 0.14953257406377324 + 0.3930024677192948im; … ; -0.012345309244786027 + 0.0034367855845997496im 0.03683897877132202 - 0.010738741033286267im … 0.022527430695465405 + 0.06442482226709982im 0.015092704398312477 + 0.0396667614272687im; 0.08307223549068102 - 0.02312630610061157im 0.012716273429868283 - 0.003706869656223956im … 0.06611762103079898 + 0.18908577100924684im -0.014782951642409973 - 0.03885252646734329im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.14431559203569977, 0.29698169229513405, 0.2969816926526804, 0.2969816931059026, 0.37573826715003844, 0.37573826732102944, 0.37573826756737866]], X = [[-0.9282082137088682 + 0.25840197867708464im 1.040250669095735e-10 - 2.7567437269020773e-11im … 1.69608655892943e-10 - 4.34239359800311e-11im -3.0346957193194134e-9 + 1.1111066533662583e-9im; -0.08307223441986385 + 0.023126308302272473im -0.3880850345118314 + 0.113128683946125im … 0.13501017592716189 + 0.3861073272417629im 0.14953257406377324 + 0.3930024677192948im; … ; -0.012345309244786027 + 0.0034367855845997496im 0.03683897877132202 - 0.010738741033286267im … 0.022527430695465405 + 0.06442482226709982im 0.015092704398312477 + 0.0396667614272687im; 0.08307223549068102 - 0.02312630610061157im 0.012716273429868283 - 0.003706869656223956im … 0.06611762103079898 + 0.18908577100924684im -0.014782951642409973 - 0.03885252646734329im]], residual_norms = [[1.820270514739327e-9, 4.88103928169741e-9, 2.1468006618016247e-9, 4.617630658409806e-9, 2.8604187835418975e-9, 2.51329957617199e-9, 3.176822886665007e-9]], iterations = [1], converged = 1, n_matvec = 14)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 1.5745842943577164e-8)</code></pre><p>Apply ε† = 1 - χ0 (vc + fxc)</p><pre><code class="language-julia hljs">function eps_fun(δρ)
    δV = apply_kernel(basis, δρ; ρ=scfres.ρ)
    χ0δV = apply_χ0(scfres, δV)
    δρ - χ0δV
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">eps_fun (generic function with 1 method)</code></pre><p>eager diagonalizes the subspace matrix at each iteration</p><pre><code class="language-julia hljs">eigsolve(eps_fun, randn(size(scfres.ρ)), 5, :LM; eager=true, verbosity=3);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Arnoldi iteration step 1: normres = 0.042018432601692066
[ Info: Arnoldi iteration step 2: normres = 0.4273948551090769
[ Info: Arnoldi iteration step 3: normres = 0.5603675827698985
[ Info: Arnoldi iteration step 4: normres = 0.6890325830461529
[ Info: Arnoldi iteration step 5: normres = 0.4846712600454866
[ Info: Arnoldi schursolve in iter 1, krylovdim = 5: 0 values converged, normres = (1.69e-01, 7.30e-02, 3.65e-01, 2.61e-01, 6.99e-03)
[ Info: Arnoldi iteration step 6: normres = 0.298987227518103
[ Info: Arnoldi schursolve in iter 1, krylovdim = 6: 0 values converged, normres = (4.41e-02, 1.21e-01, 2.33e-01, 9.87e-02, 8.95e-02)
[ Info: Arnoldi iteration step 7: normres = 0.08025853634725781
[ Info: Arnoldi schursolve in iter 1, krylovdim = 7: 0 values converged, normres = (1.67e-03, 9.24e-03, 1.51e-02, 3.06e-02, 6.07e-02)
[ Info: Arnoldi iteration step 8: normres = 0.10893928562030304
[ Info: Arnoldi schursolve in iter 1, krylovdim = 8: 0 values converged, normres = (7.92e-05, 7.31e-04, 1.32e-03, 1.17e-02, 5.70e-02)
[ Info: Arnoldi iteration step 9: normres = 0.08270352265866816
[ Info: Arnoldi schursolve in iter 1, krylovdim = 9: 0 values converged, normres = (2.80e-06, 4.24e-05, 8.48e-05, 3.14e-03, 3.41e-02)
[ Info: Arnoldi iteration step 10: normres = 0.08668866081040337
[ Info: Arnoldi schursolve in iter 1, krylovdim = 10: 0 values converged, normres = (1.08e-07, 2.75e-06, 6.13e-06, 1.18e-03, 3.86e-02)
[ Info: Arnoldi iteration step 11: normres = 0.08456022697648663
[ Info: Arnoldi schursolve in iter 1, krylovdim = 11: 0 values converged, normres = (3.89e-09, 1.61e-07, 3.98e-07, 3.00e-04, 1.93e-02)
[ Info: Arnoldi iteration step 12: normres = 0.06861731367791359
[ Info: Arnoldi schursolve in iter 1, krylovdim = 12: 0 values converged, normres = (1.16e-10, 7.88e-09, 2.16e-08, 6.83e-05, 9.49e-03)
[ Info: Arnoldi iteration step 13: normres = 0.06892288494785576
[ Info: Arnoldi schursolve in iter 1, krylovdim = 13: 0 values converged, normres = (3.38e-12, 3.76e-10, 1.14e-09, 1.38e-05, 3.67e-03)
[ Info: Arnoldi iteration step 14: normres = 0.5509111194391103
[ Info: Arnoldi schursolve in iter 1, krylovdim = 14: 0 values converged, normres = (1.61e-12, 8.30e-10, 5.75e-09, 5.50e-01, 9.53e-03)
[ Info: Arnoldi iteration step 15: normres = 0.10587638934565845
[ Info: Arnoldi schursolve in iter 1, krylovdim = 15: 1 values converged, normres = (8.85e-14, 1.10e-09, 4.22e-02, 8.80e-05, 2.60e-06)
[ Info: Arnoldi iteration step 16: normres = 0.33537944789953356
[ Info: Arnoldi schursolve in iter 1, krylovdim = 16: 1 values converged, normres = (2.63e-14, 4.32e-09, 6.41e-02, 8.40e-04, 3.28e-01)
[ Info: Arnoldi iteration step 17: normres = 0.030934631197522783
[ Info: Arnoldi schursolve in iter 1, krylovdim = 17: 1 values converged, normres = (3.69e-16, 1.51e-03, 1.58e-03, 1.37e-03, 7.40e-03)
[ Info: Arnoldi iteration step 18: normres = 0.017982799835315342
[ Info: Arnoldi schursolve in iter 1, krylovdim = 18: 1 values converged, normres = (2.74e-18, 3.05e-08, 2.59e-05, 8.28e-05, 5.26e-05)
[ Info: Arnoldi iteration step 19: normres = 0.08737586499340433
[ Info: Arnoldi schursolve in iter 1, krylovdim = 19: 1 values converged, normres = (9.97e-20, 1.43e-06, 4.97e-07, 1.38e-08, 6.34e-06)
[ Info: Arnoldi iteration step 20: normres = 0.15394717140343456
[ Info: Arnoldi schursolve in iter 1, krylovdim = 20: 1 values converged, normres = (7.40e-21, 1.79e-07, 8.91e-08, 6.79e-07, 6.67e-07)
[ Info: Arnoldi iteration step 21: normres = 0.021780623000572395
[ Info: Arnoldi schursolve in iter 1, krylovdim = 21: 1 values converged, normres = (6.89e-23, 2.44e-09, 1.85e-09, 9.82e-09, 1.28e-08)
[ Info: Arnoldi iteration step 22: normres = 0.061170331014345665
[ Info: Arnoldi schursolve in iter 1, krylovdim = 22: 1 values converged, normres = (1.73e-24, 9.91e-11, 7.16e-11, 2.77e-10, 6.54e-10)
[ Info: Arnoldi iteration step 23: normres = 0.39826711193819897
[ Info: Arnoldi schursolve in iter 1, krylovdim = 23: 1 values converged, normres = (5.74e-25, 1.36e-10, 9.80e-11, 7.65e-10, 1.72e-09)
[ Info: Arnoldi iteration step 24: normres = 0.016283833855559395
[ Info: Arnoldi schursolve in iter 1, krylovdim = 24: 1 values converged, normres = (4.38e-27, 2.99e-12, 2.16e-12, 9.97e-04, 5.18e-04)
[ Info: Arnoldi iteration step 25: normres = 0.026846691466202655
[ Info: Arnoldi schursolve in iter 1, krylovdim = 25: 3 values converged, normres = (4.82e-29, 5.24e-14, 3.79e-14, 1.11e-08, 1.51e-08)
[ Info: Arnoldi iteration step 26: normres = 0.1023976043475765
[ Info: Arnoldi schursolve in iter 1, krylovdim = 26: 3 values converged, normres = (2.20e-30, 4.00e-15, 2.89e-15, 4.16e-06, 4.10e-06)
[ Info: Arnoldi iteration step 27: normres = 0.035632692361342456
[ Info: Arnoldi schursolve in iter 1, krylovdim = 27: 3 values converged, normres = (3.29e-32, 9.70e-17, 7.00e-17, 1.20e-07, 8.73e-09)
[ Info: Arnoldi iteration step 28: normres = 0.08071134016696892
[ Info: Arnoldi schursolve in iter 1, krylovdim = 28: 3 values converged, normres = (1.17e-33, 5.72e-18, 4.13e-18, 1.32e-08, 1.05e-09)
[ Info: Arnoldi iteration step 29: normres = 0.02137521531829154
[ Info: Arnoldi schursolve in iter 1, krylovdim = 29: 3 values converged, normres = (1.04e-35, 8.17e-20, 5.90e-20, 1.89e-10, 1.07e-10)
[ Info: Arnoldi iteration step 30: normres = 0.11367717999156506
[ Info: Arnoldi schursolve in iter 1, krylovdim = 30: 3 values converged, normres = (5.07e-37, 6.55e-21, 4.73e-21, 1.68e-11, 9.54e-12)
[ Info: Arnoldi schursolve in iter 2, krylovdim = 19: 3 values converged, normres = (5.07e-37, 6.55e-21, 4.73e-21, 1.68e-11, 9.54e-12)
[ Info: Arnoldi iteration step 20: normres = 0.19639101721713584
[ Info: Arnoldi schursolve in iter 2, krylovdim = 20: 3 values converged, normres = (4.55e-38, 1.01e-21, 7.27e-22, 2.90e-12, 1.65e-12)
[ Info: Arnoldi iteration step 21: normres = 0.03833239934369044
┌ Info: Arnoldi eigsolve finished after 2 iterations:
│ *  6 eigenvalues converged
│ *  norm of residuals = (7.939870442958478e-40, 3.0158169617408337e-23, 9.48961505763003e-24, 9.790336900036578e-14, 1.7110832504505312e-14, 1.9040945720664764e-14)
└ *  number of operations = 32</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../forwarddiff/">« Polarizability using automatic differentiation</a><a class="docs-footer-nextpage" href="../atomsbase/">AtomsBase integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Friday 29 July 2022 14:43">Friday 29 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
