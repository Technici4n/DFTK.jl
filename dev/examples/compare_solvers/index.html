<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison of DFT solvers · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/compare_solvers/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li class="is-active"><a class="tocitem" href>Comparison of DFT solvers</a><ul class="internal"><li><a class="tocitem" href="#Density-based-self-consistent-field"><span>Density-based self-consistent field</span></a></li><li><a class="tocitem" href="#Potential-based-SCF"><span>Potential-based SCF</span></a></li><li><a class="tocitem" href="#Direct-minimization"><span>Direct minimization</span></a></li></ul></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/compare_solvers.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-of-DFT-solvers"><a class="docs-heading-anchor" href="#Comparison-of-DFT-solvers">Comparison of DFT solvers</a><a id="Comparison-of-DFT-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-DFT-solvers" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/compare_solvers.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/compare_solvers.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compare four different approaches for solving the DFT minimisation problem, namely a density-based SCF, a potential-based SCF, direct minimisation and Newton.</p><p>First we setup our problem</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra

a = 10.26  # Silicon lattice constant in Bohr
lattice = a / 2 * [[0 1 1.];
                   [1 0 1.];
                   [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=[3, 3, 3])

# Convergence we desire
tol = 1e-12
is_converged = DFTK.ScfConvergenceDensity(tol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">#506 (generic function with 1 method)</code></pre><h2 id="Density-based-self-consistent-field"><a class="docs-heading-anchor" href="#Density-based-self-consistent-field">Density-based self-consistent field</a><a id="Density-based-self-consistent-field-1"></a><a class="docs-heading-anchor-permalink" href="#Density-based-self-consistent-field" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scf = self_consistent_field(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3915556370333874 0.37851742089968515 … 0.34469960027014557 0.37851742089968515; 0.3785174208996851 0.36645844064785743 … 0.32735728172219936 0.36364954262047927; … ; 0.34469960027014557 0.32735728172219936 … 0.30751926941848307 0.3343805319865147; 0.37851742089968515 0.36364954262047916 … 0.33438053198651463 0.3664584406478575;;; 0.37851742089968515 0.3664584406478575 … 0.32735728172219936 0.3636495426204792; 0.3664584406478575 0.3510288634176571 … 0.31119401346053144 0.3519170663491307; … ; 0.32735728172219936 0.31119401346053144 … 0.2982412284121874 0.3214260028150367; 0.3636495426204792 0.35191706634913067 … 0.3214260028150367 0.3519170663491306;;; 0.34469960027014557 0.33438053198651463 … 0.2865351537638882 0.3273572817221994; 0.33438053198651463 0.3186160477629119 … 0.27805891882343897 0.32142600281503675; … ; 0.2865351537638882 0.2780589188234389 … 0.2559018577230793 0.2780589188234391; 0.3273572817221994 0.32142600281503664 … 0.278058918823439 0.3111940134605315;;; … ;;; 0.30487474928899083 0.28303666896233254 … 0.2855643323174889 0.30095737051835714; 0.28303666896233254 0.25898431622269225 … 0.2726330012865248 0.28541419662657647; … ; 0.2855643323174889 0.2726330012865248 … 0.2771603891376443 0.2812108737837388; 0.30095737051835714 0.2854141966265764 … 0.28121087378373877 0.2930827262716384;;; 0.34469960027014557 0.3273572817221994 … 0.30751926941848295 0.33438053198651463; 0.3273572817221994 0.31119401346053144 … 0.2982412284121874 0.32142600281503675; … ; 0.30751926941848307 0.29824122841218736 … 0.2771603891376443 0.29313119147016947; 0.33438053198651463 0.32142600281503664 … 0.2931311914701694 0.31861604776291197;;; 0.37851742089968515 0.3636495426204792 … 0.3343805319865146 0.3664584406478575; 0.3636495426204792 0.3519170663491306 … 0.32142600281503664 0.3519170663491307; … ; 0.33438053198651463 0.3214260028150366 … 0.2931311914701694 0.318616047762912; 0.3664584406478575 0.35191706634913067 … 0.318616047762912 0.35102886341765716]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923121803 -0.49665655722567265 … -0.47719190096486735 -0.4966565572256726; -0.4966565572256727 -0.4848182087107125 … -0.4763804457667573 -0.49204131116939837; … ; -0.47719190096486735 -0.4763804457667573 … -0.4122880708739021 -0.45507008155610257; -0.4966565572256727 -0.49204131116939837 … -0.45507008155610257 -0.4848182087107126;;; -0.49665655722567265 -0.4848182087107126 … -0.4763804457667573 -0.4920413111693983; -0.4848182087107126 -0.4583744079148379 … -0.47065601570569676 -0.48617902517559647; … ; -0.4763804457667573 -0.47065601570569676 … -0.4463984364362021 -0.4688943963915041; -0.49204131116939837 -0.48617902517559647 … -0.4688943963915041 -0.48617902517559647;;; -0.47719190096486735 -0.45507008155610257 … -0.46051412342264886 -0.4763804457667572; -0.45507008155610257 -0.4090661824391121 … -0.45671990832112164 -0.4688943963915041; … ; -0.46051412342264886 -0.45671990832112164 … -0.44514495660347897 -0.4567199083211217; -0.4763804457667573 -0.4688943963915041 … -0.4567199083211217 -0.47065601570569676;;; … ;;; -0.4494759508408985 -0.4551499722014763 … -0.37125986261790106 -0.4177457152027522; -0.4551499722014763 -0.4488035109976989 … -0.4174380107134144 -0.4441260992987684; … ; -0.37125986261790106 -0.41743801071341435 … -0.25365698328407005 -0.2997980910595979; -0.4177457152027522 -0.44412609929876845 … -0.2997980910595979 -0.3610634326480172;;; -0.47719190096486735 -0.4763804457667573 … -0.4122880708739021 -0.45507008155610257; -0.4763804457667573 -0.47065601570569676 … -0.4463984364362021 -0.4688943963915041; … ; -0.4122880708739021 -0.4463984364362021 … -0.2536569832840701 -0.34106330230083176; -0.4550700815561026 -0.4688943963915041 … -0.34106330230083176 -0.4090661824391121;;; -0.49665655722567265 -0.49204131116939837 … -0.45507008155610257 -0.4848182087107125; -0.49204131116939837 -0.48617902517559647 … -0.4688943963915041 -0.48617902517559647; … ; -0.45507008155610257 -0.4688943963915041 … -0.3410633023008317 -0.4090661824391122; -0.4848182087107126 -0.48617902517559647 … -0.4090661824391121 -0.4583744079148379])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417761498319 -0.48742667641008613 … -0.7026973955397664 -0.48742667641008597; -0.48742667641008586 -0.7738703031165721 … -0.41393901833941626 -0.3817933912207824; … ; -0.7026973955397666 -0.4139390183394165 … -2.396890218056649 -1.2941386092028617; -0.4874266764100861 -0.38179339122078293 … -1.294138609202862 -0.773870303116572;;; -0.48742667641008613 -0.773870303116572 … -0.4139390183394163 -0.38179339122078226; -0.7738703031165717 -1.4815303728816918 … -0.32444274393780814 -0.4499565543601574; … ; -0.41393901833941654 -0.32444274393780836 … -1.011386501768248 -0.6391785259201077; -0.38179339122078254 -0.4499565543601578 … -0.6391785259201082 -0.4499565543601577;;; -0.7026973955397664 -1.2941386092028622 … -0.29832133494663704 -0.41393901833941615; -1.2941386092028617 -2.9234702459028634 … -0.35179963884328774 -0.6391785259201078; … ; -0.29832133494663726 -0.35179963884328813 … -0.49060647083943204 -0.35179963884328774; -0.4139390183394165 -0.6391785259201083 … -0.3517996388432876 -0.32444274393780803;;; … ;;; -1.015048126873837 -0.5338983581177941 … -3.638038941492778 -1.9993625019793817; -0.5338983581177937 -0.3216988270083361 … -1.4639475300052547 -0.9061370442136165; … ; -3.638038941492778 -1.4639475300052547 … -10.993621243076882 -8.086551292452949; -1.9993625019793817 -0.9061370442136166 … -8.086551292452949 -4.647852558442598;;; -0.7026973955397664 -0.4139390183394163 … -2.39689021805665 -1.2941386092028624; -0.41393901833941615 -0.32444274393780814 … -1.0113865017682473 -0.6391785259201078; … ; -2.396890218056649 -1.0113865017682473 … -11.003061433402307 -6.0733937118061965; -1.2941386092028622 -0.6391785259201082 … -6.073393711806198 -2.9234702459028634;;; -0.4874266764100862 -0.3817933912207824 … -1.2941386092028626 -0.7738703031165719; -0.3817933912207823 -0.4499565543601576 … -0.6391785259201079 -0.44995655436015736; … ; -1.2941386092028624 -0.6391785259201082 … -6.073393711806198 -2.9234702459028634; -0.7738703031165719 -0.4499565543601578 … -2.9234702459028634 -1.4815303728816915]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3915556370333874 0.37851742089968515 … 0.34469960027014557 0.37851742089968515; 0.3785174208996851 0.36645844064785743 … 0.32735728172219936 0.36364954262047927; … ; 0.34469960027014557 0.32735728172219936 … 0.30751926941848307 0.3343805319865147; 0.37851742089968515 0.36364954262047916 … 0.33438053198651463 0.3664584406478575;;; 0.37851742089968515 0.3664584406478575 … 0.32735728172219936 0.3636495426204792; 0.3664584406478575 0.3510288634176571 … 0.31119401346053144 0.3519170663491307; … ; 0.32735728172219936 0.31119401346053144 … 0.2982412284121874 0.3214260028150367; 0.3636495426204792 0.35191706634913067 … 0.3214260028150367 0.3519170663491306;;; 0.34469960027014557 0.33438053198651463 … 0.2865351537638882 0.3273572817221994; 0.33438053198651463 0.3186160477629119 … 0.27805891882343897 0.32142600281503675; … ; 0.2865351537638882 0.2780589188234389 … 0.2559018577230793 0.2780589188234391; 0.3273572817221994 0.32142600281503664 … 0.278058918823439 0.3111940134605315;;; … ;;; 0.30487474928899083 0.28303666896233254 … 0.2855643323174889 0.30095737051835714; 0.28303666896233254 0.25898431622269225 … 0.2726330012865248 0.28541419662657647; … ; 0.2855643323174889 0.2726330012865248 … 0.2771603891376443 0.2812108737837388; 0.30095737051835714 0.2854141966265764 … 0.28121087378373877 0.2930827262716384;;; 0.34469960027014557 0.3273572817221994 … 0.30751926941848295 0.33438053198651463; 0.3273572817221994 0.31119401346053144 … 0.2982412284121874 0.32142600281503675; … ; 0.30751926941848307 0.29824122841218736 … 0.2771603891376443 0.29313119147016947; 0.33438053198651463 0.32142600281503664 … 0.2931311914701694 0.31861604776291197;;; 0.37851742089968515 0.3636495426204792 … 0.3343805319865146 0.3664584406478575; 0.3636495426204792 0.3519170663491306 … 0.32142600281503664 0.3519170663491307; … ; 0.33438053198651463 0.3214260028150366 … 0.2931311914701694 0.318616047762912; 0.3664584406478575 0.35191706634913067 … 0.318616047762912 0.35102886341765716]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923121803 -0.49665655722567265 … -0.47719190096486735 -0.4966565572256726; -0.4966565572256727 -0.4848182087107125 … -0.4763804457667573 -0.49204131116939837; … ; -0.47719190096486735 -0.4763804457667573 … -0.4122880708739021 -0.45507008155610257; -0.4966565572256727 -0.49204131116939837 … -0.45507008155610257 -0.4848182087107126;;; -0.49665655722567265 -0.4848182087107126 … -0.4763804457667573 -0.4920413111693983; -0.4848182087107126 -0.4583744079148379 … -0.47065601570569676 -0.48617902517559647; … ; -0.4763804457667573 -0.47065601570569676 … -0.4463984364362021 -0.4688943963915041; -0.49204131116939837 -0.48617902517559647 … -0.4688943963915041 -0.48617902517559647;;; -0.47719190096486735 -0.45507008155610257 … -0.46051412342264886 -0.4763804457667572; -0.45507008155610257 -0.4090661824391121 … -0.45671990832112164 -0.4688943963915041; … ; -0.46051412342264886 -0.45671990832112164 … -0.44514495660347897 -0.4567199083211217; -0.4763804457667573 -0.4688943963915041 … -0.4567199083211217 -0.47065601570569676;;; … ;;; -0.4494759508408985 -0.4551499722014763 … -0.37125986261790106 -0.4177457152027522; -0.4551499722014763 -0.4488035109976989 … -0.4174380107134144 -0.4441260992987684; … ; -0.37125986261790106 -0.41743801071341435 … -0.25365698328407005 -0.2997980910595979; -0.4177457152027522 -0.44412609929876845 … -0.2997980910595979 -0.3610634326480172;;; -0.47719190096486735 -0.4763804457667573 … -0.4122880708739021 -0.45507008155610257; -0.4763804457667573 -0.47065601570569676 … -0.4463984364362021 -0.4688943963915041; … ; -0.4122880708739021 -0.4463984364362021 … -0.2536569832840701 -0.34106330230083176; -0.4550700815561026 -0.4688943963915041 … -0.34106330230083176 -0.4090661824391121;;; -0.49665655722567265 -0.49204131116939837 … -0.45507008155610257 -0.4848182087107125; -0.49204131116939837 -0.48617902517559647 … -0.4688943963915041 -0.48617902517559647; … ; -0.45507008155610257 -0.4688943963915041 … -0.3410633023008317 -0.4090661824391122; -0.4848182087107126 -0.48617902517559647 … -0.4090661824391121 -0.4583744079148379])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417761498319 -0.48742667641008613 … -0.7026973955397664 -0.48742667641008597; -0.48742667641008586 -0.7738703031165721 … -0.41393901833941626 -0.3817933912207824; … ; -0.7026973955397666 -0.4139390183394165 … -2.396890218056649 -1.2941386092028617; -0.4874266764100861 -0.38179339122078293 … -1.294138609202862 -0.773870303116572;;; -0.48742667641008613 -0.773870303116572 … -0.4139390183394163 -0.38179339122078226; -0.7738703031165717 -1.4815303728816918 … -0.32444274393780814 -0.4499565543601574; … ; -0.41393901833941654 -0.32444274393780836 … -1.011386501768248 -0.6391785259201077; -0.38179339122078254 -0.4499565543601578 … -0.6391785259201082 -0.4499565543601577;;; -0.7026973955397664 -1.2941386092028622 … -0.29832133494663704 -0.41393901833941615; -1.2941386092028617 -2.9234702459028634 … -0.35179963884328774 -0.6391785259201078; … ; -0.29832133494663726 -0.35179963884328813 … -0.49060647083943204 -0.35179963884328774; -0.4139390183394165 -0.6391785259201083 … -0.3517996388432876 -0.32444274393780803;;; … ;;; -1.015048126873837 -0.5338983581177941 … -3.638038941492778 -1.9993625019793817; -0.5338983581177937 -0.3216988270083361 … -1.4639475300052547 -0.9061370442136165; … ; -3.638038941492778 -1.4639475300052547 … -10.993621243076882 -8.086551292452949; -1.9993625019793817 -0.9061370442136166 … -8.086551292452949 -4.647852558442598;;; -0.7026973955397664 -0.4139390183394163 … -2.39689021805665 -1.2941386092028624; -0.41393901833941615 -0.32444274393780814 … -1.0113865017682473 -0.6391785259201078; … ; -2.396890218056649 -1.0113865017682473 … -11.003061433402307 -6.0733937118061965; -1.2941386092028622 -0.6391785259201082 … -6.073393711806198 -2.9234702459028634;;; -0.4874266764100862 -0.3817933912207824 … -1.2941386092028626 -0.7738703031165719; -0.3817933912207823 -0.4499565543601576 … -0.6391785259201079 -0.44995655436015736; … ; -1.2941386092028624 -0.6391785259201082 … -6.073393711806198 -2.9234702459028634; -0.7738703031165719 -0.4499565543601578 … -2.9234702459028634 -1.4815303728816915]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3915556370333874 0.37851742089968515 … 0.34469960027014557 0.37851742089968515; 0.3785174208996851 0.36645844064785743 … 0.32735728172219936 0.36364954262047927; … ; 0.34469960027014557 0.32735728172219936 … 0.30751926941848307 0.3343805319865147; 0.37851742089968515 0.36364954262047916 … 0.33438053198651463 0.3664584406478575;;; 0.37851742089968515 0.3664584406478575 … 0.32735728172219936 0.3636495426204792; 0.3664584406478575 0.3510288634176571 … 0.31119401346053144 0.3519170663491307; … ; 0.32735728172219936 0.31119401346053144 … 0.2982412284121874 0.3214260028150367; 0.3636495426204792 0.35191706634913067 … 0.3214260028150367 0.3519170663491306;;; 0.34469960027014557 0.33438053198651463 … 0.2865351537638882 0.3273572817221994; 0.33438053198651463 0.3186160477629119 … 0.27805891882343897 0.32142600281503675; … ; 0.2865351537638882 0.2780589188234389 … 0.2559018577230793 0.2780589188234391; 0.3273572817221994 0.32142600281503664 … 0.278058918823439 0.3111940134605315;;; … ;;; 0.30487474928899083 0.28303666896233254 … 0.2855643323174889 0.30095737051835714; 0.28303666896233254 0.25898431622269225 … 0.2726330012865248 0.28541419662657647; … ; 0.2855643323174889 0.2726330012865248 … 0.2771603891376443 0.2812108737837388; 0.30095737051835714 0.2854141966265764 … 0.28121087378373877 0.2930827262716384;;; 0.34469960027014557 0.3273572817221994 … 0.30751926941848295 0.33438053198651463; 0.3273572817221994 0.31119401346053144 … 0.2982412284121874 0.32142600281503675; … ; 0.30751926941848307 0.29824122841218736 … 0.2771603891376443 0.29313119147016947; 0.33438053198651463 0.32142600281503664 … 0.2931311914701694 0.31861604776291197;;; 0.37851742089968515 0.3636495426204792 … 0.3343805319865146 0.3664584406478575; 0.3636495426204792 0.3519170663491306 … 0.32142600281503664 0.3519170663491307; … ; 0.33438053198651463 0.3214260028150366 … 0.2931311914701694 0.318616047762912; 0.3664584406478575 0.35191706634913067 … 0.318616047762912 0.35102886341765716]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923121803 -0.49665655722567265 … -0.47719190096486735 -0.4966565572256726; -0.4966565572256727 -0.4848182087107125 … -0.4763804457667573 -0.49204131116939837; … ; -0.47719190096486735 -0.4763804457667573 … -0.4122880708739021 -0.45507008155610257; -0.4966565572256727 -0.49204131116939837 … -0.45507008155610257 -0.4848182087107126;;; -0.49665655722567265 -0.4848182087107126 … -0.4763804457667573 -0.4920413111693983; -0.4848182087107126 -0.4583744079148379 … -0.47065601570569676 -0.48617902517559647; … ; -0.4763804457667573 -0.47065601570569676 … -0.4463984364362021 -0.4688943963915041; -0.49204131116939837 -0.48617902517559647 … -0.4688943963915041 -0.48617902517559647;;; -0.47719190096486735 -0.45507008155610257 … -0.46051412342264886 -0.4763804457667572; -0.45507008155610257 -0.4090661824391121 … -0.45671990832112164 -0.4688943963915041; … ; -0.46051412342264886 -0.45671990832112164 … -0.44514495660347897 -0.4567199083211217; -0.4763804457667573 -0.4688943963915041 … -0.4567199083211217 -0.47065601570569676;;; … ;;; -0.4494759508408985 -0.4551499722014763 … -0.37125986261790106 -0.4177457152027522; -0.4551499722014763 -0.4488035109976989 … -0.4174380107134144 -0.4441260992987684; … ; -0.37125986261790106 -0.41743801071341435 … -0.25365698328407005 -0.2997980910595979; -0.4177457152027522 -0.44412609929876845 … -0.2997980910595979 -0.3610634326480172;;; -0.47719190096486735 -0.4763804457667573 … -0.4122880708739021 -0.45507008155610257; -0.4763804457667573 -0.47065601570569676 … -0.4463984364362021 -0.4688943963915041; … ; -0.4122880708739021 -0.4463984364362021 … -0.2536569832840701 -0.34106330230083176; -0.4550700815561026 -0.4688943963915041 … -0.34106330230083176 -0.4090661824391121;;; -0.49665655722567265 -0.49204131116939837 … -0.45507008155610257 -0.4848182087107125; -0.49204131116939837 -0.48617902517559647 … -0.4688943963915041 -0.48617902517559647; … ; -0.45507008155610257 -0.4688943963915041 … -0.3410633023008317 -0.4090661824391122; -0.4848182087107126 -0.48617902517559647 … -0.4090661824391121 -0.4583744079148379])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417761498319 -0.48742667641008613 … -0.7026973955397664 -0.48742667641008597; -0.48742667641008586 -0.7738703031165721 … -0.41393901833941626 -0.3817933912207824; … ; -0.7026973955397666 -0.4139390183394165 … -2.396890218056649 -1.2941386092028617; -0.4874266764100861 -0.38179339122078293 … -1.294138609202862 -0.773870303116572;;; -0.48742667641008613 -0.773870303116572 … -0.4139390183394163 -0.38179339122078226; -0.7738703031165717 -1.4815303728816918 … -0.32444274393780814 -0.4499565543601574; … ; -0.41393901833941654 -0.32444274393780836 … -1.011386501768248 -0.6391785259201077; -0.38179339122078254 -0.4499565543601578 … -0.6391785259201082 -0.4499565543601577;;; -0.7026973955397664 -1.2941386092028622 … -0.29832133494663704 -0.41393901833941615; -1.2941386092028617 -2.9234702459028634 … -0.35179963884328774 -0.6391785259201078; … ; -0.29832133494663726 -0.35179963884328813 … -0.49060647083943204 -0.35179963884328774; -0.4139390183394165 -0.6391785259201083 … -0.3517996388432876 -0.32444274393780803;;; … ;;; -1.015048126873837 -0.5338983581177941 … -3.638038941492778 -1.9993625019793817; -0.5338983581177937 -0.3216988270083361 … -1.4639475300052547 -0.9061370442136165; … ; -3.638038941492778 -1.4639475300052547 … -10.993621243076882 -8.086551292452949; -1.9993625019793817 -0.9061370442136166 … -8.086551292452949 -4.647852558442598;;; -0.7026973955397664 -0.4139390183394163 … -2.39689021805665 -1.2941386092028624; -0.41393901833941615 -0.32444274393780814 … -1.0113865017682473 -0.6391785259201078; … ; -2.396890218056649 -1.0113865017682473 … -11.003061433402307 -6.0733937118061965; -1.2941386092028622 -0.6391785259201082 … -6.073393711806198 -2.9234702459028634;;; -0.4874266764100862 -0.3817933912207824 … -1.2941386092028626 -0.7738703031165719; -0.3817933912207823 -0.4499565543601576 … -0.6391785259201079 -0.44995655436015736; … ; -1.2941386092028624 -0.6391785259201082 … -6.073393711806198 -2.9234702459028634; -0.7738703031165719 -0.4499565543601578 … -2.9234702459028634 -1.4815303728816915]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3915556370333874 0.37851742089968515 … 0.34469960027014557 0.37851742089968515; 0.3785174208996851 0.36645844064785743 … 0.32735728172219936 0.36364954262047927; … ; 0.34469960027014557 0.32735728172219936 … 0.30751926941848307 0.3343805319865147; 0.37851742089968515 0.36364954262047916 … 0.33438053198651463 0.3664584406478575;;; 0.37851742089968515 0.3664584406478575 … 0.32735728172219936 0.3636495426204792; 0.3664584406478575 0.3510288634176571 … 0.31119401346053144 0.3519170663491307; … ; 0.32735728172219936 0.31119401346053144 … 0.2982412284121874 0.3214260028150367; 0.3636495426204792 0.35191706634913067 … 0.3214260028150367 0.3519170663491306;;; 0.34469960027014557 0.33438053198651463 … 0.2865351537638882 0.3273572817221994; 0.33438053198651463 0.3186160477629119 … 0.27805891882343897 0.32142600281503675; … ; 0.2865351537638882 0.2780589188234389 … 0.2559018577230793 0.2780589188234391; 0.3273572817221994 0.32142600281503664 … 0.278058918823439 0.3111940134605315;;; … ;;; 0.30487474928899083 0.28303666896233254 … 0.2855643323174889 0.30095737051835714; 0.28303666896233254 0.25898431622269225 … 0.2726330012865248 0.28541419662657647; … ; 0.2855643323174889 0.2726330012865248 … 0.2771603891376443 0.2812108737837388; 0.30095737051835714 0.2854141966265764 … 0.28121087378373877 0.2930827262716384;;; 0.34469960027014557 0.3273572817221994 … 0.30751926941848295 0.33438053198651463; 0.3273572817221994 0.31119401346053144 … 0.2982412284121874 0.32142600281503675; … ; 0.30751926941848307 0.29824122841218736 … 0.2771603891376443 0.29313119147016947; 0.33438053198651463 0.32142600281503664 … 0.2931311914701694 0.31861604776291197;;; 0.37851742089968515 0.3636495426204792 … 0.3343805319865146 0.3664584406478575; 0.3636495426204792 0.3519170663491306 … 0.32142600281503664 0.3519170663491307; … ; 0.33438053198651463 0.3214260028150366 … 0.2931311914701694 0.318616047762912; 0.3664584406478575 0.35191706634913067 … 0.318616047762912 0.35102886341765716]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923121803 -0.49665655722567265 … -0.47719190096486735 -0.4966565572256726; -0.4966565572256727 -0.4848182087107125 … -0.4763804457667573 -0.49204131116939837; … ; -0.47719190096486735 -0.4763804457667573 … -0.4122880708739021 -0.45507008155610257; -0.4966565572256727 -0.49204131116939837 … -0.45507008155610257 -0.4848182087107126;;; -0.49665655722567265 -0.4848182087107126 … -0.4763804457667573 -0.4920413111693983; -0.4848182087107126 -0.4583744079148379 … -0.47065601570569676 -0.48617902517559647; … ; -0.4763804457667573 -0.47065601570569676 … -0.4463984364362021 -0.4688943963915041; -0.49204131116939837 -0.48617902517559647 … -0.4688943963915041 -0.48617902517559647;;; -0.47719190096486735 -0.45507008155610257 … -0.46051412342264886 -0.4763804457667572; -0.45507008155610257 -0.4090661824391121 … -0.45671990832112164 -0.4688943963915041; … ; -0.46051412342264886 -0.45671990832112164 … -0.44514495660347897 -0.4567199083211217; -0.4763804457667573 -0.4688943963915041 … -0.4567199083211217 -0.47065601570569676;;; … ;;; -0.4494759508408985 -0.4551499722014763 … -0.37125986261790106 -0.4177457152027522; -0.4551499722014763 -0.4488035109976989 … -0.4174380107134144 -0.4441260992987684; … ; -0.37125986261790106 -0.41743801071341435 … -0.25365698328407005 -0.2997980910595979; -0.4177457152027522 -0.44412609929876845 … -0.2997980910595979 -0.3610634326480172;;; -0.47719190096486735 -0.4763804457667573 … -0.4122880708739021 -0.45507008155610257; -0.4763804457667573 -0.47065601570569676 … -0.4463984364362021 -0.4688943963915041; … ; -0.4122880708739021 -0.4463984364362021 … -0.2536569832840701 -0.34106330230083176; -0.4550700815561026 -0.4688943963915041 … -0.34106330230083176 -0.4090661824391121;;; -0.49665655722567265 -0.49204131116939837 … -0.45507008155610257 -0.4848182087107125; -0.49204131116939837 -0.48617902517559647 … -0.4688943963915041 -0.48617902517559647; … ; -0.45507008155610257 -0.4688943963915041 … -0.3410633023008317 -0.4090661824391122; -0.4848182087107126 -0.48617902517559647 … -0.4090661824391121 -0.4583744079148379])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417761498319 -0.48742667641008613 … -0.7026973955397664 -0.48742667641008597; -0.48742667641008586 -0.7738703031165721 … -0.41393901833941626 -0.3817933912207824; … ; -0.7026973955397666 -0.4139390183394165 … -2.396890218056649 -1.2941386092028617; -0.4874266764100861 -0.38179339122078293 … -1.294138609202862 -0.773870303116572;;; -0.48742667641008613 -0.773870303116572 … -0.4139390183394163 -0.38179339122078226; -0.7738703031165717 -1.4815303728816918 … -0.32444274393780814 -0.4499565543601574; … ; -0.41393901833941654 -0.32444274393780836 … -1.011386501768248 -0.6391785259201077; -0.38179339122078254 -0.4499565543601578 … -0.6391785259201082 -0.4499565543601577;;; -0.7026973955397664 -1.2941386092028622 … -0.29832133494663704 -0.41393901833941615; -1.2941386092028617 -2.9234702459028634 … -0.35179963884328774 -0.6391785259201078; … ; -0.29832133494663726 -0.35179963884328813 … -0.49060647083943204 -0.35179963884328774; -0.4139390183394165 -0.6391785259201083 … -0.3517996388432876 -0.32444274393780803;;; … ;;; -1.015048126873837 -0.5338983581177941 … -3.638038941492778 -1.9993625019793817; -0.5338983581177937 -0.3216988270083361 … -1.4639475300052547 -0.9061370442136165; … ; -3.638038941492778 -1.4639475300052547 … -10.993621243076882 -8.086551292452949; -1.9993625019793817 -0.9061370442136166 … -8.086551292452949 -4.647852558442598;;; -0.7026973955397664 -0.4139390183394163 … -2.39689021805665 -1.2941386092028624; -0.41393901833941615 -0.32444274393780814 … -1.0113865017682473 -0.6391785259201078; … ; -2.396890218056649 -1.0113865017682473 … -11.003061433402307 -6.0733937118061965; -1.2941386092028622 -0.6391785259201082 … -6.073393711806198 -2.9234702459028634;;; -0.4874266764100862 -0.3817933912207824 … -1.2941386092028626 -0.7738703031165719; -0.3817933912207823 -0.4499565543601576 … -0.6391785259201079 -0.44995655436015736; … ; -1.2941386092028624 -0.6391785259201082 … -6.073393711806198 -2.9234702459028634; -0.7738703031165719 -0.4499565543601578 … -2.9234702459028634 -1.4815303728816915]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729845), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09132316917745381 0.08747419134078568 … 0.07684754935961943 0.08747419134078566; 0.0874741913407857 0.0808996687216255 … 0.07642471016970323 0.08486944834425009; … ; 0.07684754935961943 0.07642471016970323 … 0.04778466667101436 0.06587895342302483; 0.0874741913407857 0.08486944834425009 … 0.06587895342302483 0.08089966872162553;;; 0.08747419134078568 0.08089966872162552 … 0.07642471016970323 0.08486944834425006; 0.08089966872162552 0.06744471469773634 … 0.07348669934703168 0.08163768629013247; … ; 0.07642471016970323 0.07348669934703168 … 0.06188804119995973 0.07259829028445955; 0.08486944834425007 0.08163768629013247 … 0.07259829028445955 0.08163768629013249;;; 0.07684754935961943 0.06587895342302483 … 0.06847203698972759 0.07642471016970322; 0.06587895342302483 0.04657864264980273 … 0.06665759371631086 0.07259829028445954; … ; 0.06847203698972759 0.06665759371631086 … 0.06132515314380461 0.06665759371631087; 0.07642471016970323 0.07259829028445954 … 0.06665759371631087 0.07348669934703171;;; … ;;; 0.06328495229885303 0.06591651445952007 … 0.033940648880516025 0.04987593485998532; 0.06591651445952007 0.06297790960104842 … 0.04975639788527447 0.06087020457145849; … ; 0.033940648880516025 0.049756397885274466 … 0.009696353214072171 0.016831338792589527; 0.04987593485998534 0.0608702045714585 … 0.016831338792589527 0.030985721885047;;; 0.07684754935961943 0.07642471016970323 … 0.04778466667101435 0.06587895342302481; 0.07642471016970323 0.0734866993470317 … 0.06188804119995973 0.07259829028445954; … ; 0.04778466667101435 0.06188804119995973 … 0.009696353214072181 0.025710010675301962; 0.06587895342302484 0.07259829028445954 … 0.025710010675301966 0.04657864264980274;;; 0.08747419134078567 0.08486944834425007 … 0.0658789534230248 0.0808996687216255; 0.08486944834425007 0.08163768629013247 … 0.07259829028445954 0.08163768629013247; … ; 0.06587895342302481 0.07259829028445954 … 0.025710010675301955 0.046578642649802736; 0.08089966872162552 0.08163768629013247 … 0.04657864264980273 0.06744471469773637;;;;], α = 0.8, eigenvalues = [[-0.16677707596303976, 0.2642777178299749, 0.2642777178299747, 0.26427771782997495, 0.35732037190453847, 0.35732037190453836, 0.35732037190453825], [-0.11613218761079608, 0.07040532320007664, 0.226248136030276, 0.22624813603027605, 0.3361178489460549, 0.39343797761801946, 0.3934379776180189], [-0.09588938143636463, 0.08764319967963413, 0.1731270414274607, 0.1731270414274609, 0.29197248922131697, 0.33773212507290135, 0.5327646516180093], [-0.04505146348589943, 0.022269526239857017, 0.09831189251536276, 0.18446409322121218, 0.32292701516248257, 0.48024696717975424, 0.5024422335601102]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.28971208183819547, n_iter = 22, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.8917186871323927 - 0.343255660710051im -1.9917036717404008e-16 + 9.351961688823202e-17im … 1.8399188258187475e-12 - 1.2028297103353062e-12im -2.6422308066725715e-15 + 7.391162996616338e-15im; 0.08986223704980258 - 0.03459131449920287im 0.2011593252349994 - 0.19669341358181722im … 0.04277687637925193 + 0.008878162121527252im -0.16805508965318874 - 0.036762256576385786im; … ; 0.011006934302180691 - 0.0042369780523920115im -0.027703527142725 + 0.02124701515632739im … 0.026457633042318855 + 0.011107289454614302im -0.03870720482160485 + 0.0543559154638212im; -0.08986223704980194 + 0.03459131449920259im -0.07006434704225853 + 0.011319575014948883im … 0.17521571821724224 + 0.08263821973023275im -0.15086550298793888 + 0.48461740016426563im], [0.17032192673945426 + 0.9129872890560318im 0.1894414653646223 + 0.05449863022428482im … 5.019552591597171e-13 + 5.23984861620547e-13im -2.7967982009943377e-13 + 4.505177272776602e-14im; 0.011611174003598642 + 0.062240103075628266im -0.008431505597477587 - 0.002425580402402798im … 6.957111906361461e-11 + 1.8190389178824712e-11im -2.9124121709029106e-11 - 1.7240641669500025e-12im; … ; 0.0014214176511833754 + 0.007619314041435053im 0.08289654728985814 + 0.023847726625870858im … 0.0670681366288228 - 0.014231055210299411im -0.08586982543269912 + 0.0013886798071673218im; -0.020710681062042557 - 0.11101676055052688im -0.0871720676859401 - 0.025077710804012016im … 0.2846746625572503 - 0.06040455343734491im -0.36447953996518334 + 0.005894333370113371im], [-0.19400228751029516 - 0.91337498632415im 2.717848863035735e-16 + 7.380715705698114e-17im … 1.5964386724949453e-14 + 3.6297214138867354e-14im 4.375849995331889e-11 - 3.529844670895295e-11im; -0.014283662071695272 - 0.0672483805053102im -0.046788256547943836 - 0.032887537145285806im … -0.01098778723191849 + 0.022658185290943347im 0.0028614708035532566 + 0.0031646377254767313im; … ; -0.0028817820932860233 - 0.013567611566975162im -4.119555854198654e-16 + 9.615410532199837e-16im … 3.2757131480160612e-12 - 1.9625885084287866e-11im -0.038992621872820966 - 0.051536287267306066im; 0.03183167043769171 + 0.1498655089268399im -0.23490313514218172 - 0.1651137732524285im … 0.16661344941132064 - 0.34357767764555885im -0.09247119093003679 - 0.12201142732949867im], [-0.7493671853607523 + 0.3048775160095238im -6.638382054544467e-16 + 3.8729701561389387e-16im … 0.149004247687197 + 0.11376118280956422im -2.6939539870398533e-6 + 6.128107450118681e-6im; -0.35890679387580954 + 0.14602002053655672im -0.3064994918543439 + 0.5465060915389964im … -0.14168745962186272 - 0.10816103263096372im 3.1454239770838956e-7 - 4.472774579313034e-6im; … ; -0.010553672583474918 + 0.0042937261530589365im -0.0008039992595531743 + 0.0014335765788068451im … 0.012858887492512391 + 0.009809797381184614im 0.013052417028024252 - 0.042321918218939686im; 0.060374283268752264 - 0.024563073848731992im -0.006107190205339465 + 0.010889468785778933im … 0.10770717014531983 + 0.08218332934773338im 0.1386984852582319 - 0.4497341592781836im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596303976, 0.2642777178299749, 0.2642777178299747, 0.26427771782997495, 0.35732037190453847, 0.35732037190453836, 0.35732037190453825], [-0.11613218761079608, 0.07040532320007664, 0.226248136030276, 0.22624813603027605, 0.3361178489460549, 0.39343797761801946, 0.3934379776180189], [-0.09588938143636463, 0.08764319967963413, 0.1731270414274607, 0.1731270414274609, 0.29197248922131697, 0.33773212507290135, 0.5327646516180093], [-0.04505146348589943, 0.022269526239857017, 0.09831189251536276, 0.18446409322121218, 0.32292701516248257, 0.48024696717975424, 0.5024422335601102]], X = [[0.8917186871323927 - 0.343255660710051im -1.9917036717404008e-16 + 9.351961688823202e-17im … 1.8399188258187475e-12 - 1.2028297103353062e-12im -2.6422308066725715e-15 + 7.391162996616338e-15im; 0.08986223704980258 - 0.03459131449920287im 0.2011593252349994 - 0.19669341358181722im … 0.04277687637925193 + 0.008878162121527252im -0.16805508965318874 - 0.036762256576385786im; … ; 0.011006934302180691 - 0.0042369780523920115im -0.027703527142725 + 0.02124701515632739im … 0.026457633042318855 + 0.011107289454614302im -0.03870720482160485 + 0.0543559154638212im; -0.08986223704980194 + 0.03459131449920259im -0.07006434704225853 + 0.011319575014948883im … 0.17521571821724224 + 0.08263821973023275im -0.15086550298793888 + 0.48461740016426563im], [0.17032192673945426 + 0.9129872890560318im 0.1894414653646223 + 0.05449863022428482im … 5.019552591597171e-13 + 5.23984861620547e-13im -2.7967982009943377e-13 + 4.505177272776602e-14im; 0.011611174003598642 + 0.062240103075628266im -0.008431505597477587 - 0.002425580402402798im … 6.957111906361461e-11 + 1.8190389178824712e-11im -2.9124121709029106e-11 - 1.7240641669500025e-12im; … ; 0.0014214176511833754 + 0.007619314041435053im 0.08289654728985814 + 0.023847726625870858im … 0.0670681366288228 - 0.014231055210299411im -0.08586982543269912 + 0.0013886798071673218im; -0.020710681062042557 - 0.11101676055052688im -0.0871720676859401 - 0.025077710804012016im … 0.2846746625572503 - 0.06040455343734491im -0.36447953996518334 + 0.005894333370113371im], [-0.19400228751029516 - 0.91337498632415im 2.717848863035735e-16 + 7.380715705698114e-17im … 1.5964386724949453e-14 + 3.6297214138867354e-14im 4.375849995331889e-11 - 3.529844670895295e-11im; -0.014283662071695272 - 0.0672483805053102im -0.046788256547943836 - 0.032887537145285806im … -0.01098778723191849 + 0.022658185290943347im 0.0028614708035532566 + 0.0031646377254767313im; … ; -0.0028817820932860233 - 0.013567611566975162im -4.119555854198654e-16 + 9.615410532199837e-16im … 3.2757131480160612e-12 - 1.9625885084287866e-11im -0.038992621872820966 - 0.051536287267306066im; 0.03183167043769171 + 0.1498655089268399im -0.23490313514218172 - 0.1651137732524285im … 0.16661344941132064 - 0.34357767764555885im -0.09247119093003679 - 0.12201142732949867im], [-0.7493671853607523 + 0.3048775160095238im -6.638382054544467e-16 + 3.8729701561389387e-16im … 0.149004247687197 + 0.11376118280956422im -2.6939539870398533e-6 + 6.128107450118681e-6im; -0.35890679387580954 + 0.14602002053655672im -0.3064994918543439 + 0.5465060915389964im … -0.14168745962186272 - 0.10816103263096372im 3.1454239770838956e-7 - 4.472774579313034e-6im; … ; -0.010553672583474918 + 0.0042937261530589365im -0.0008039992595531743 + 0.0014335765788068451im … 0.012858887492512391 + 0.009809797381184614im 0.013052417028024252 - 0.042321918218939686im; 0.060374283268752264 - 0.024563073848731992im -0.006107190205339465 + 0.010889468785778933im … 0.10770717014531983 + 0.08218332934773338im 0.1386984852582319 - 0.4497341592781836im]], residual_norms = [[4.368009440088272e-14, 4.534098253792878e-14, 4.2860151017387855e-14, 4.465562845592369e-14, 6.628138588180124e-11, 1.676275299279506e-10, 6.436733686586667e-13], [2.8975920083771685e-14, 2.407391773051084e-14, 5.4292167192027497e-14, 4.256408399977866e-14, 7.57999131116179e-13, 8.251102058520678e-11, 4.4868265268998084e-11], [2.7924138386430553e-14, 1.749413667471497e-14, 4.5090626600378686e-14, 3.3309303714025626e-14, 6.920968357874879e-13, 8.377313745893006e-11, 6.522798755738096e-8], [1.6117873039461387e-14, 1.7857862215814215e-14, 3.8463043522244785e-14, 4.636288209980964e-14, 7.159178170177186e-11, 4.3745595459880455e-5, 3.541428040713209e-6]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 3.292538210135035e-14)</code></pre><h2 id="Potential-based-SCF"><a class="docs-heading-anchor" href="#Potential-based-SCF">Potential-based SCF</a><a id="Potential-based-SCF-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-based-SCF" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scfv = DFTK.scf_potential_mixing(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41274177614980234 -0.4874266764100577 … -0.7026973955397406 -0.4874266764100576; -0.4874266764100573 -0.773870303116544 … -0.41393901833939245 -0.38179339122075545; … ; -0.7026973955397408 -0.4139390183393928 … -2.396890218056624 -1.2941386092028355; -0.48742667641005755 -0.38179339122075595 … -1.2941386092028355 -0.7738703031165439;;; -0.4874266764100577 -0.7738703031165439 … -0.4139390183393926 -0.38179339122075545; -0.7738703031165437 -1.4815303728816636 … -0.32444274393778594 -0.4499565543601314; … ; -0.41393901833939284 -0.32444274393778627 … -1.011386501768225 -0.6391785259200837; -0.3817933912207557 -0.44995655436013177 … -0.6391785259200842 -0.4499565543601316;;; -0.7026973955397406 -1.294138609202836 … -0.2983213349466172 -0.4139390183393926; -1.2941386092028353 -2.9234702459028368 … -0.3517996388432682 -0.639178525920084; … ; -0.2983213349466174 -0.3517996388432685 … -0.4906064708394138 -0.35179963884326815; -0.4139390183393928 -0.6391785259200844 … -0.3517996388432679 -0.32444274393778605;;; … ;;; -1.0150481268738136 -0.5338983581177739 … -3.638038941492753 -1.999362501979357; -0.5338983581177733 -0.3216988270083183 … -1.4639475300052327 -0.9061370442135949; … ; -3.638038941492753 -1.4639475300052327 … -10.993621243076856 -8.086551292452922; -1.999362501979357 -0.9061370442135949 … -8.086551292452922 -4.647852558442572;;; -0.7026973955397406 -0.4139390183393927 … -2.3968902180566243 -1.294138609202836; -0.4139390183393925 -0.32444274393778605 … -1.0113865017682244 -0.639178525920084; … ; -2.396890218056624 -1.0113865017682244 … -11.003061433402282 -6.073393711806169; -1.2941386092028357 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363;;; -0.4874266764100578 -0.38179339122075556 … -1.2941386092028362 -0.7738703031165439; -0.38179339122075545 -0.44995655436013154 … -0.639178525920084 -0.4499565543601313; … ; -1.2941386092028362 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363; -0.7738703031165437 -0.4499565543601317 … -2.9234702459028363 -1.4815303728816633])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41274177614980234 -0.4874266764100577 … -0.7026973955397406 -0.4874266764100576; -0.4874266764100573 -0.773870303116544 … -0.41393901833939245 -0.38179339122075545; … ; -0.7026973955397408 -0.4139390183393928 … -2.396890218056624 -1.2941386092028355; -0.48742667641005755 -0.38179339122075595 … -1.2941386092028355 -0.7738703031165439;;; -0.4874266764100577 -0.7738703031165439 … -0.4139390183393926 -0.38179339122075545; -0.7738703031165437 -1.4815303728816636 … -0.32444274393778594 -0.4499565543601314; … ; -0.41393901833939284 -0.32444274393778627 … -1.011386501768225 -0.6391785259200837; -0.3817933912207557 -0.44995655436013177 … -0.6391785259200842 -0.4499565543601316;;; -0.7026973955397406 -1.294138609202836 … -0.2983213349466172 -0.4139390183393926; -1.2941386092028353 -2.9234702459028368 … -0.3517996388432682 -0.639178525920084; … ; -0.2983213349466174 -0.3517996388432685 … -0.4906064708394138 -0.35179963884326815; -0.4139390183393928 -0.6391785259200844 … -0.3517996388432679 -0.32444274393778605;;; … ;;; -1.0150481268738136 -0.5338983581177739 … -3.638038941492753 -1.999362501979357; -0.5338983581177733 -0.3216988270083183 … -1.4639475300052327 -0.9061370442135949; … ; -3.638038941492753 -1.4639475300052327 … -10.993621243076856 -8.086551292452922; -1.999362501979357 -0.9061370442135949 … -8.086551292452922 -4.647852558442572;;; -0.7026973955397406 -0.4139390183393927 … -2.3968902180566243 -1.294138609202836; -0.4139390183393925 -0.32444274393778605 … -1.0113865017682244 -0.639178525920084; … ; -2.396890218056624 -1.0113865017682244 … -11.003061433402282 -6.073393711806169; -1.2941386092028357 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363;;; -0.4874266764100578 -0.38179339122075556 … -1.2941386092028362 -0.7738703031165439; -0.38179339122075545 -0.44995655436013154 … -0.639178525920084 -0.4499565543601313; … ; -1.2941386092028362 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363; -0.7738703031165437 -0.4499565543601317 … -2.9234702459028363 -1.4815303728816633]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.022768325511607367 - 0.030314575933925714im 0.011643157523780756 - 0.03878964327165989im … -0.030796759089502065 + 0.08722971193731649im -0.07261416019308413 + 0.034017834693126206im; 0.0058791133328321525 - 0.07999144095324846im 0.05239799015811465 - 0.09479027462734374im … -0.08183472559221482 + 0.032024309782771265im -0.0888064577646781 - 0.043290433471180736im; … ; 0.03282303480146556 - 0.02709266705081595im 0.03924812766401406 - 0.04570776424298999im … 0.05397593735279995 + 0.034857732671389294im 0.0037036636453203903 + 0.0340101361321004im; -0.001992587894047865 - 0.04146750929484839im -0.0026983100210982887 - 0.01517261751380619im … 0.004878699017465803 + 0.016786823809489607im -0.044654770948298256 + 0.018440701728676876im;;; 0.011115941450949096 - 0.07790218719245096im 0.037213550718556074 - 0.07572725010325394im … -0.1165429559019157 + 0.0041325928875065795im -0.10393615333057972 - 0.05064252787660768im; 0.05381379064141943 - 0.08665125905102367im 0.04865650963267808 - 0.03652439710826947im … -0.08770930157038712 - 0.04877697981131769im -0.04425911162248067 - 0.11714473099562933im; … ; 0.04037746526856471 - 0.06897564502968721im 0.04218222121058425 - 0.05389273651217011im … -0.009517284771907768 + 0.026729622555613338im -0.025707012515717467 - 0.016589103336377295im; 0.006145662808949435 - 0.057267296271357696im 0.019077632126237205 - 0.05029159162430004im … -0.0694133871154348 + 0.0037051088042567883im -0.08034034901353981 - 0.05176693711304753im;;; 0.07255400646487761 - 0.03338271138248233im 0.02569745539275003 - 0.019621033971473037im … -0.06190602972257518 - 0.022634833814251607im -0.009292825378395984 - 0.039499813875709014im; 0.09412026775975052 + 0.004599839468774021im 0.047633451109725986 + 0.03961555607524163im … -0.025539869197098948 - 0.044945854297405136im 0.04796847069684614 - 0.042536133097722im; … ; 0.020772976376102297 - 0.05137143850640766im 0.010932732986569101 - 0.018056850593449414im … -0.025852973882292025 - 0.0028704097143115413im -0.019360606204527352 - 0.03755041998416215im; 0.033817741831602334 - 0.048690869902984046im 0.021027663495992634 - 0.003727589902754811im … -0.05818701100181653 - 0.02324939033745395im -0.032093353054156906 - 0.049268725433848595im;;; … ;;; -0.06916923181854656 - 0.00810580784285029im -0.021866362741077026 + 0.034138844472081126im … -0.024030668745213903 - 0.07543422704764874im -0.043522270990157416 - 0.0580271423193296im; -0.02042301448644061 + 0.04794055830480062im 0.013894668138834665 + 0.04834227878839277im … -0.00626589978961231 - 0.01451550400324379im -0.030358255026131042 + 0.008495043234156802im; … ; -0.0185968949536734 - 0.01970155747231945im -0.022383230755012567 - 0.019496743470969698im … 0.044828632587483506 + 0.007875252207066457im 0.030222472761564603 + 0.01921143303087742im; -0.04901421749805724 - 0.06353533268947228im -0.036224360183777476 - 0.01593387870921397im … -0.0014729538057068022 - 0.07477231627957276im -0.030718339818477842 - 0.07257673233611053im;;; -0.04681493345614823 + 0.07613715945616906im 0.0009607735820941392 + 0.08642193862741704im … 0.01059556648592658 - 0.03493139541475009im -0.03975505155619147 + 0.029519538189102277im; 0.013516631224523323 + 0.1060961848671492im 0.05273254605435253 + 0.043082425561619286im … 0.0017954774518430248 + 0.04507304694135873im -0.018874215251459985 + 0.09071621891764783im; … ; -0.048385449413244616 - 0.012549906329906498im -0.025957101112047076 - 0.013906584318629801im … 0.023470940116047397 - 0.008214907062573197im -0.013921374878381135 + 0.05306753789022073im; -0.06550820144084968 - 0.030912690183526593im -0.021700400529452296 + 0.006348321486709725im … -0.014360971111160165 - 0.07788176902531457im -0.04884264414234877 - 0.037217464891844645im;;; -0.0013344763552955363 + 0.06471185515752731im 0.01690056420321382 + 0.05693046219165829im … 0.022179405035229333 + 0.06932095313018521im -0.011768871490883865 + 0.11317749018580867im; 0.008592208214682116 + 0.027178601130184145im 0.07351848632580577 - 0.034698758353702557im … -0.017897163496634637 + 0.09670502176614687im -0.035988745698274434 + 0.07483457146915351im; … ; -0.004395502833437051 + 0.007424514575696985im 0.023221306724567715 - 0.01384783747343122im … 0.048195854017574466 + 0.033705622308988395im -0.007945411404275285 + 0.07104192606565972im; -0.014461357394172699 + 0.014585596634220387im -0.006561843337285117 + 0.01501919009206777im … 0.024858006362746148 - 0.018692810964599547im -0.017715615118264333 + 0.020799693943922205im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41274177614980234 -0.4874266764100577 … -0.7026973955397406 -0.4874266764100576; -0.4874266764100573 -0.773870303116544 … -0.41393901833939245 -0.38179339122075545; … ; -0.7026973955397408 -0.4139390183393928 … -2.396890218056624 -1.2941386092028355; -0.48742667641005755 -0.38179339122075595 … -1.2941386092028355 -0.7738703031165439;;; -0.4874266764100577 -0.7738703031165439 … -0.4139390183393926 -0.38179339122075545; -0.7738703031165437 -1.4815303728816636 … -0.32444274393778594 -0.4499565543601314; … ; -0.41393901833939284 -0.32444274393778627 … -1.011386501768225 -0.6391785259200837; -0.3817933912207557 -0.44995655436013177 … -0.6391785259200842 -0.4499565543601316;;; -0.7026973955397406 -1.294138609202836 … -0.2983213349466172 -0.4139390183393926; -1.2941386092028353 -2.9234702459028368 … -0.3517996388432682 -0.639178525920084; … ; -0.2983213349466174 -0.3517996388432685 … -0.4906064708394138 -0.35179963884326815; -0.4139390183393928 -0.6391785259200844 … -0.3517996388432679 -0.32444274393778605;;; … ;;; -1.0150481268738136 -0.5338983581177739 … -3.638038941492753 -1.999362501979357; -0.5338983581177733 -0.3216988270083183 … -1.4639475300052327 -0.9061370442135949; … ; -3.638038941492753 -1.4639475300052327 … -10.993621243076856 -8.086551292452922; -1.999362501979357 -0.9061370442135949 … -8.086551292452922 -4.647852558442572;;; -0.7026973955397406 -0.4139390183393927 … -2.3968902180566243 -1.294138609202836; -0.4139390183393925 -0.32444274393778605 … -1.0113865017682244 -0.639178525920084; … ; -2.396890218056624 -1.0113865017682244 … -11.003061433402282 -6.073393711806169; -1.2941386092028357 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363;;; -0.4874266764100578 -0.38179339122075556 … -1.2941386092028362 -0.7738703031165439; -0.38179339122075545 -0.44995655436013154 … -0.639178525920084 -0.4499565543601313; … ; -1.2941386092028362 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363; -0.7738703031165437 -0.4499565543601317 … -2.9234702459028363 -1.4815303728816633])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41274177614980234 -0.4874266764100577 … -0.7026973955397406 -0.4874266764100576; -0.4874266764100573 -0.773870303116544 … -0.41393901833939245 -0.38179339122075545; … ; -0.7026973955397408 -0.4139390183393928 … -2.396890218056624 -1.2941386092028355; -0.48742667641005755 -0.38179339122075595 … -1.2941386092028355 -0.7738703031165439;;; -0.4874266764100577 -0.7738703031165439 … -0.4139390183393926 -0.38179339122075545; -0.7738703031165437 -1.4815303728816636 … -0.32444274393778594 -0.4499565543601314; … ; -0.41393901833939284 -0.32444274393778627 … -1.011386501768225 -0.6391785259200837; -0.3817933912207557 -0.44995655436013177 … -0.6391785259200842 -0.4499565543601316;;; -0.7026973955397406 -1.294138609202836 … -0.2983213349466172 -0.4139390183393926; -1.2941386092028353 -2.9234702459028368 … -0.3517996388432682 -0.639178525920084; … ; -0.2983213349466174 -0.3517996388432685 … -0.4906064708394138 -0.35179963884326815; -0.4139390183393928 -0.6391785259200844 … -0.3517996388432679 -0.32444274393778605;;; … ;;; -1.0150481268738136 -0.5338983581177739 … -3.638038941492753 -1.999362501979357; -0.5338983581177733 -0.3216988270083183 … -1.4639475300052327 -0.9061370442135949; … ; -3.638038941492753 -1.4639475300052327 … -10.993621243076856 -8.086551292452922; -1.999362501979357 -0.9061370442135949 … -8.086551292452922 -4.647852558442572;;; -0.7026973955397406 -0.4139390183393927 … -2.3968902180566243 -1.294138609202836; -0.4139390183393925 -0.32444274393778605 … -1.0113865017682244 -0.639178525920084; … ; -2.396890218056624 -1.0113865017682244 … -11.003061433402282 -6.073393711806169; -1.2941386092028357 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363;;; -0.4874266764100578 -0.38179339122075556 … -1.2941386092028362 -0.7738703031165439; -0.38179339122075545 -0.44995655436013154 … -0.639178525920084 -0.4499565543601313; … ; -1.2941386092028362 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363; -0.7738703031165437 -0.4499565543601317 … -2.9234702459028363 -1.4815303728816633]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.046411818572527574 - 0.05349466694827856im -0.042930376640001336 + 0.0349799181767803im … 0.03151018035159442 - 0.10323483077609083im 0.08528097154966507 - 0.12531094742547808im; 0.0065666680907182145 - 0.006297950430220651im -0.01837033696720157 + 0.03306812745228959im … 0.044587270424884105 - 0.08524605992165701im 0.06347030409652284 - 0.0827837065704116im; … ; 0.03225164534420416 - 0.037724988663044134im -0.007540915824922173 - 0.023780754980937492im … -0.034715964916341616 + 0.026804766835485425im 0.017837077968866407 - 0.061528947192533046im; 0.028173251239464916 - 0.035155763167134035im -0.039390279105796636 - 0.007547155098475045im … -0.030951270375845677 - 0.0012300193925468645im 0.04359338211602577 - 0.09832099211910261im;;; 0.029921179101159344 - 0.009966845998944828im -0.0786219819240562 + 0.0267684499976548im … 0.052792028453863674 - 0.09853299388282052im 0.10978521563241309 - 0.10643257003742475im; -0.025733323948049155 + 0.032238379245446355im -0.0935168141193701 + 0.05295466572466012im … 0.06262905485581634 - 0.06531379418366746im 0.09013323856928811 - 0.05732071503567117im; … ; -0.00818431934543459 + 0.017940919962230704im -0.02299886871097779 + 0.01495147149377185im … -0.020987553969506932 - 0.00904382591946295im 0.002780663498090908 - 0.04159402931710505im; 0.015671874352880342 + 0.009385518665015077im -0.04869783349658854 + 0.02300213295723066im … 0.006134546715222162 - 0.06572350206269678im 0.04866388737253392 - 0.06890642470389216im;;; -0.025624028807336975 + 0.0077864214446668415im -0.07089948192766753 + 0.0007448430374000249im … 0.05164589399622209 - 0.04894126926945047im 0.06524650177059763 - 0.040927698499338985im; -0.10400914849764441 + 0.0732566404171227im -0.10515927033679354 + 0.05226109281008907im … 0.042189807780862745 - 0.02268153080617347im 0.013500436331116653 + 0.016516069295497815im; … ; 0.004705469700223995 + 0.008262709111733987im -0.011042062284110423 + 0.004983767832007482im … -0.004640950529022454 - 0.013700059723321589im 0.0062678891555031915 - 0.009264710547371473im; 0.00014131284829383382 + 0.008644735683215981im -0.03732821175015784 - 0.014400143466927735im … 0.018631599612320405 - 0.03263399295123992im 0.04718401887897596 - 0.039439438135997325im;;; … ;;; -0.00027729325999720775 + 0.008095665158613038im -0.0251386462547166 + 0.01620971920381712im … 0.018614406520207974 - 0.014404436324738285im 0.03907959387790007 - 0.020343353354053576im; -0.019256143678192714 + 0.022366601086831653im -0.027265353737915575 + 0.021741387444005864im … 0.014944176858693278 - 0.0008386056856889831im 0.008810563173057324 + 0.004762803972992481im; … ; 0.049676190051968744 - 0.039832677089019095im 0.022977561170226306 - 0.014858244828460699im … -0.029085484984036715 + 0.003253198027692355im 0.038290292507903084 - 0.05344172136376109im; 0.036950188292259274 - 0.024750212003449318im 0.007080800402726935 - 0.006184040695364186im … 0.0005881692786951623 - 0.034421591324089174im 0.05872989276162527 - 0.06169248238004449im;;; -0.05683131163008026 + 0.05452951930215787im -0.07837858964100797 + 0.047011350543622474im … 0.02579066673428794 + 0.01668022665927313im 0.03828133779366372 + 0.00885552355860518im; -0.05803192711296731 + 0.050721636339852064im -0.042472694456269194 + 0.039373265493375005im … 0.01732356778644786 + 0.008392530669082939im -0.015070603927626963 + 0.02945339641098091im; … ; 0.07192782891515014 - 0.05106454489130896im 0.02069834137549336 - 0.017300117809948112im … -0.005417721011564891 + 0.002952105173764831im 0.04122587616021291 - 0.05642927680030123im; 0.036201016338774164 - 0.023017868561463165im -0.05578403502876336 + 0.02338633223976616im … 0.004138248377752949 + 0.012623915624370647im 0.04724395551638923 - 0.028519979018566795im;;; -0.04661878453951739 + 0.023568369409669755im -0.06763866530558114 + 0.03354165653498192im … 0.007291626111795133 + 0.01898455129972393im 0.024390440594342602 - 0.018690785268993745im; -0.039172912692102005 + 0.02428938953557943im -0.03703741159905076 + 0.05081746075644601im … 0.01765240710614195 - 0.032670249552340186im -0.0010677537973681475 - 0.015625436234770237im; … ; 0.05123209139232545 - 0.04987483308068684im -0.020155267653121187 - 0.009692180936734934im … -0.04263696564504582 + 0.05935275527265019im 0.01413105104658022 - 0.037211794760753605im; -0.029840666299250706 + 0.01322406875843642im -0.06814226669289529 + 0.002760500929252889im … -0.047303136887795805 + 0.07664859337525762im 0.02424345013351266 - 0.02291731908997846im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41274177614980234 -0.4874266764100577 … -0.7026973955397406 -0.4874266764100576; -0.4874266764100573 -0.773870303116544 … -0.41393901833939245 -0.38179339122075545; … ; -0.7026973955397408 -0.4139390183393928 … -2.396890218056624 -1.2941386092028355; -0.48742667641005755 -0.38179339122075595 … -1.2941386092028355 -0.7738703031165439;;; -0.4874266764100577 -0.7738703031165439 … -0.4139390183393926 -0.38179339122075545; -0.7738703031165437 -1.4815303728816636 … -0.32444274393778594 -0.4499565543601314; … ; -0.41393901833939284 -0.32444274393778627 … -1.011386501768225 -0.6391785259200837; -0.3817933912207557 -0.44995655436013177 … -0.6391785259200842 -0.4499565543601316;;; -0.7026973955397406 -1.294138609202836 … -0.2983213349466172 -0.4139390183393926; -1.2941386092028353 -2.9234702459028368 … -0.3517996388432682 -0.639178525920084; … ; -0.2983213349466174 -0.3517996388432685 … -0.4906064708394138 -0.35179963884326815; -0.4139390183393928 -0.6391785259200844 … -0.3517996388432679 -0.32444274393778605;;; … ;;; -1.0150481268738136 -0.5338983581177739 … -3.638038941492753 -1.999362501979357; -0.5338983581177733 -0.3216988270083183 … -1.4639475300052327 -0.9061370442135949; … ; -3.638038941492753 -1.4639475300052327 … -10.993621243076856 -8.086551292452922; -1.999362501979357 -0.9061370442135949 … -8.086551292452922 -4.647852558442572;;; -0.7026973955397406 -0.4139390183393927 … -2.3968902180566243 -1.294138609202836; -0.4139390183393925 -0.32444274393778605 … -1.0113865017682244 -0.639178525920084; … ; -2.396890218056624 -1.0113865017682244 … -11.003061433402282 -6.073393711806169; -1.2941386092028357 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363;;; -0.4874266764100578 -0.38179339122075556 … -1.2941386092028362 -0.7738703031165439; -0.38179339122075545 -0.44995655436013154 … -0.639178525920084 -0.4499565543601313; … ; -1.2941386092028362 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363; -0.7738703031165437 -0.4499565543601317 … -2.9234702459028363 -1.4815303728816633])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41274177614980234 -0.4874266764100577 … -0.7026973955397406 -0.4874266764100576; -0.4874266764100573 -0.773870303116544 … -0.41393901833939245 -0.38179339122075545; … ; -0.7026973955397408 -0.4139390183393928 … -2.396890218056624 -1.2941386092028355; -0.48742667641005755 -0.38179339122075595 … -1.2941386092028355 -0.7738703031165439;;; -0.4874266764100577 -0.7738703031165439 … -0.4139390183393926 -0.38179339122075545; -0.7738703031165437 -1.4815303728816636 … -0.32444274393778594 -0.4499565543601314; … ; -0.41393901833939284 -0.32444274393778627 … -1.011386501768225 -0.6391785259200837; -0.3817933912207557 -0.44995655436013177 … -0.6391785259200842 -0.4499565543601316;;; -0.7026973955397406 -1.294138609202836 … -0.2983213349466172 -0.4139390183393926; -1.2941386092028353 -2.9234702459028368 … -0.3517996388432682 -0.639178525920084; … ; -0.2983213349466174 -0.3517996388432685 … -0.4906064708394138 -0.35179963884326815; -0.4139390183393928 -0.6391785259200844 … -0.3517996388432679 -0.32444274393778605;;; … ;;; -1.0150481268738136 -0.5338983581177739 … -3.638038941492753 -1.999362501979357; -0.5338983581177733 -0.3216988270083183 … -1.4639475300052327 -0.9061370442135949; … ; -3.638038941492753 -1.4639475300052327 … -10.993621243076856 -8.086551292452922; -1.999362501979357 -0.9061370442135949 … -8.086551292452922 -4.647852558442572;;; -0.7026973955397406 -0.4139390183393927 … -2.3968902180566243 -1.294138609202836; -0.4139390183393925 -0.32444274393778605 … -1.0113865017682244 -0.639178525920084; … ; -2.396890218056624 -1.0113865017682244 … -11.003061433402282 -6.073393711806169; -1.2941386092028357 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363;;; -0.4874266764100578 -0.38179339122075556 … -1.2941386092028362 -0.7738703031165439; -0.38179339122075545 -0.44995655436013154 … -0.639178525920084 -0.4499565543601313; … ; -1.2941386092028362 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363; -0.7738703031165437 -0.4499565543601317 … -2.9234702459028363 -1.4815303728816633]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.03783431036156435 - 0.003619172698767297im -0.04960619715020877 - 0.005336412577682727im … 2.9949421640221036e-5 + 0.0019841989576483104im -0.012558959996117783 - 0.001099112508266744im; -0.052796815375538875 - 0.007805028843737074im -0.04111417824369398 - 0.004564398032810393im … -0.016898043366071175 - 0.0031795916053351672im -0.03767125757217949 - 0.006209503324802136im; … ; -0.000592943300397014 - 0.0006619989979624714im -0.004697153221738593 + 0.00014906875123557898im … 0.02249461180489129 + 0.0044591375920639675im 0.01269888942140382 + 0.002919825227411222im; -0.007880171988605413 - 0.0017627247456184752im -0.026552129503553297 - 0.002266786656491512im … 0.02398392812835435 + 0.0061279780016018056im 0.002261839474661906 + 0.0018479577787146946im;;; 0.00011142550468717515 + 0.05648535925691188im -0.029999943352271463 - 0.014888926366703768im … -0.039839485902521884 - 0.026351319407253663im -0.0232887392557089 + 0.015803378334465698im; 0.0177306299816824 + 0.06800200887424429im -0.023415170053039027 - 0.026475086525778874im … -0.02861902194132277 - 0.012310571057053452im -0.007009927868988639 + 0.038101732311170866im; … ; 0.0066572976832889215 + 0.035695126739100726im -0.022607798952686057 - 0.023767925291798223im … 0.01601602496296406 + 0.02648086142038662im 0.015572746303203239 + 0.050589908375774484im; -0.011163466617511487 + 0.02339198026641634im -0.04075337228501975 - 0.02759253092423266im … -0.011902436928331515 + 0.003316004074070832im -0.011939226509288067 + 0.025575807261405285im;;; 0.011297708313735496 - 0.002417953375359277im -0.022950877065775935 - 0.06602737850666492im … -0.01947927541671893 - 0.009430432565369148im 0.0046549029154768695 + 0.01805745244859123im; 0.024114263382008703 + 0.00898791752313204im -0.0510388186992757 - 0.11568981124819933im … -0.0030151429971932817 + 0.004742353894562462im 0.03228204800218015 + 0.040980380437512814im; … ; -0.023480551735730035 - 0.023301335630749705im -0.022852135668488274 - 0.034071630414915365im … -0.0026582543949489404 + 0.01061989201627653im -0.009122598103465654 + 0.009198655581679444im; -0.02230481640591971 - 0.028442395650626874im -0.01871741091582017 - 0.03966937774000425im … -0.02605101625956996 - 0.01716714617818749im -0.027522032196742652 - 0.019622680173324438im;;; … ;;; 0.03949850105584111 + 0.058808048115261094im 0.019776293039878733 + 0.026960640413716524im … 0.004819445566329655 - 0.004220302819442421im 0.054076007458437395 + 0.08107685658142455im; 0.02342161728487822 + 0.03159815082825678im 0.005886008844387244 + 0.005756228175045073im … 0.020490181511017 + 0.02600274660403598im 0.03594394231519 + 0.05269074929652283im; … ; 0.008619715038808328 + 0.002886636045782897im 0.0027085446369930575 - 0.00048678414951319813im … -0.05421401353852302 - 0.08813999894462979im -0.004130781239718751 - 0.021371898392575996im; 0.032471940399401045 + 0.04522620299515183im 0.011498265692541438 + 0.015689380423635275im … -0.0387023070955172 - 0.07690438168079175im 0.030229918739219465 + 0.03418715943704843im;;; 0.05519878225844776 + 0.07252448995440391im 0.005091747325699206 + 0.006680193327851856im … 0.05587398349365162 + 0.06066993477982385im 0.11482191553969036 + 0.15423672062546706im; 0.005874644186102526 + 0.00281423668581552im -0.013238607303312451 - 0.02160726766679159im … 0.04650304185338927 + 0.05533344705183105im 0.05935946976721599 + 0.08405230970188904im; … ; 0.022604726275956194 + 0.015515739133818773im 0.0027598523055913813 - 0.007014200166925669im … 0.013945184257657794 + 0.0004747600989507im 0.05847999451803321 + 0.06782092425368554im; 0.05198263161289962 + 0.05770507370285592im 0.018980028363871772 + 0.020917042945342267im … 0.015835589234652184 - 0.007115893806552928im 0.09337485268643 + 0.12085890688132854im;;; -0.009288921418590109 - 0.024026483367495587im -0.026237820130904116 - 0.017962132603385292im … 0.06271210273038652 + 0.05220439574743634im 0.06938466581295957 + 0.0770364753034817im; -0.04878258793975768 - 0.05701667648184752im -0.05403443644791595 - 0.05323032060544809im … 0.03215269394281135 + 0.039712095851915555im 0.017259061523682367 + 0.03050899503525474im; … ; 0.010900430053705834 - 0.02086161250628884im 0.008758174259389571 - 0.0023819108967448447im … 0.04370621520200629 + 0.02975014085814955im 0.04266645836429594 + 0.03079589372435284im; 0.01528477994147631 - 0.00804960090316921im -0.008015822181613029 - 0.010365620859983386im … 0.049415088340424615 + 0.02725155056991424im 0.07568378826629335 + 0.06857378206991012im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41274177614980234 -0.4874266764100577 … -0.7026973955397406 -0.4874266764100576; -0.4874266764100573 -0.773870303116544 … -0.41393901833939245 -0.38179339122075545; … ; -0.7026973955397408 -0.4139390183393928 … -2.396890218056624 -1.2941386092028355; -0.48742667641005755 -0.38179339122075595 … -1.2941386092028355 -0.7738703031165439;;; -0.4874266764100577 -0.7738703031165439 … -0.4139390183393926 -0.38179339122075545; -0.7738703031165437 -1.4815303728816636 … -0.32444274393778594 -0.4499565543601314; … ; -0.41393901833939284 -0.32444274393778627 … -1.011386501768225 -0.6391785259200837; -0.3817933912207557 -0.44995655436013177 … -0.6391785259200842 -0.4499565543601316;;; -0.7026973955397406 -1.294138609202836 … -0.2983213349466172 -0.4139390183393926; -1.2941386092028353 -2.9234702459028368 … -0.3517996388432682 -0.639178525920084; … ; -0.2983213349466174 -0.3517996388432685 … -0.4906064708394138 -0.35179963884326815; -0.4139390183393928 -0.6391785259200844 … -0.3517996388432679 -0.32444274393778605;;; … ;;; -1.0150481268738136 -0.5338983581177739 … -3.638038941492753 -1.999362501979357; -0.5338983581177733 -0.3216988270083183 … -1.4639475300052327 -0.9061370442135949; … ; -3.638038941492753 -1.4639475300052327 … -10.993621243076856 -8.086551292452922; -1.999362501979357 -0.9061370442135949 … -8.086551292452922 -4.647852558442572;;; -0.7026973955397406 -0.4139390183393927 … -2.3968902180566243 -1.294138609202836; -0.4139390183393925 -0.32444274393778605 … -1.0113865017682244 -0.639178525920084; … ; -2.396890218056624 -1.0113865017682244 … -11.003061433402282 -6.073393711806169; -1.2941386092028357 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363;;; -0.4874266764100578 -0.38179339122075556 … -1.2941386092028362 -0.7738703031165439; -0.38179339122075545 -0.44995655436013154 … -0.639178525920084 -0.4499565543601313; … ; -1.2941386092028362 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363; -0.7738703031165437 -0.4499565543601317 … -2.9234702459028363 -1.4815303728816633])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41274177614980234 -0.4874266764100577 … -0.7026973955397406 -0.4874266764100576; -0.4874266764100573 -0.773870303116544 … -0.41393901833939245 -0.38179339122075545; … ; -0.7026973955397408 -0.4139390183393928 … -2.396890218056624 -1.2941386092028355; -0.48742667641005755 -0.38179339122075595 … -1.2941386092028355 -0.7738703031165439;;; -0.4874266764100577 -0.7738703031165439 … -0.4139390183393926 -0.38179339122075545; -0.7738703031165437 -1.4815303728816636 … -0.32444274393778594 -0.4499565543601314; … ; -0.41393901833939284 -0.32444274393778627 … -1.011386501768225 -0.6391785259200837; -0.3817933912207557 -0.44995655436013177 … -0.6391785259200842 -0.4499565543601316;;; -0.7026973955397406 -1.294138609202836 … -0.2983213349466172 -0.4139390183393926; -1.2941386092028353 -2.9234702459028368 … -0.3517996388432682 -0.639178525920084; … ; -0.2983213349466174 -0.3517996388432685 … -0.4906064708394138 -0.35179963884326815; -0.4139390183393928 -0.6391785259200844 … -0.3517996388432679 -0.32444274393778605;;; … ;;; -1.0150481268738136 -0.5338983581177739 … -3.638038941492753 -1.999362501979357; -0.5338983581177733 -0.3216988270083183 … -1.4639475300052327 -0.9061370442135949; … ; -3.638038941492753 -1.4639475300052327 … -10.993621243076856 -8.086551292452922; -1.999362501979357 -0.9061370442135949 … -8.086551292452922 -4.647852558442572;;; -0.7026973955397406 -0.4139390183393927 … -2.3968902180566243 -1.294138609202836; -0.4139390183393925 -0.32444274393778605 … -1.0113865017682244 -0.639178525920084; … ; -2.396890218056624 -1.0113865017682244 … -11.003061433402282 -6.073393711806169; -1.2941386092028357 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363;;; -0.4874266764100578 -0.38179339122075556 … -1.2941386092028362 -0.7738703031165439; -0.38179339122075545 -0.44995655436013154 … -0.639178525920084 -0.4499565543601313; … ; -1.2941386092028362 -0.6391785259200842 … -6.073393711806171 -2.9234702459028363; -0.7738703031165437 -0.4499565543601317 … -2.9234702459028363 -1.4815303728816633]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.043498675572232345 - 0.06375585930281527im 0.0409119443542029 - 0.04888592288991295im … -0.005336104091502784 + 0.0035113604382364266im 0.033284070290122106 - 0.05178021695729121im; 0.01623128272556304 - 0.02404407228270039im 0.01606939744558726 - 0.02704835325956378im … 0.01599376216715359 - 0.03311180017026151im 0.015969240892078504 - 0.02221436240116441im; … ; -0.024843125226238463 + 0.0033391313442779503im -0.002153109684620677 - 0.006629855249867936im … -0.034056445466594136 + 0.07502770531796765im -0.026609420648286985 + 0.03294574657958822im; 0.004667434121288713 - 0.02871858393134142im 0.02676628261839963 - 0.029406613004930613im … -0.034421367218684065 + 0.0552409137809803im -0.014410883882137304 + 0.001752870695243974im;;; 0.10835009971231774 - 0.06124522357047429im 0.07830351020607777 - 0.04799697614580417im … -0.04397213055515759 - 0.03811853628599398im 0.04819245621914022 - 0.07310326290575493im; 0.06625857602429439 - 0.033332291716083665im -0.027892520205919355 - 0.007042978360486254im … -0.022062596252801776 - 0.027355536812223302im 0.05000900942930607 - 0.034956354168766926im; … ; 0.006327357772190834 - 0.031933537575198026im 0.019938037003193642 - 0.025019401428365215im … -0.03142235050061257 + 0.018286580855412304im -0.03180118914750973 - 0.01765970823452396im; 0.07064654511877766 - 0.05863921003808607im 0.07646243934834242 - 0.04638876270052176im … -0.04728833503578342 - 0.013354340810966689im 0.0060944141626668395 - 0.05873902116982532im;;; 0.07751154907628144 - 0.026387263368662296im -0.021819864958024647 - 0.006381724229197514im … -0.01281454961743915 - 0.02850813343986466im 0.07516119385909131 - 0.03665328722512022im; 0.007844106342996256 + 0.0004238502814906649im -0.11667200784650147 + 0.041837275202126045im … 0.030012894882699995 - 0.01388017429924033im 0.0857143468634595 - 0.013965664860987544im; … ; 0.023811377013346874 - 0.022838356058981296im 0.028372846332884213 - 0.013560560703972886im … -0.017855149907473073 - 0.006361944495647347im -0.0037295192450834506 - 0.019192869584315736im; 0.08310109162306326 - 0.02759207080055617im 0.031111001160725005 - 0.018191352806608406im … -0.015948863365453092 - 0.02004861466425053im 0.029247130793397944 - 0.036237865184614096im;;; … ;;; 0.0514040948635094 + 0.013802250188512135im -0.0018034853006860213 + 0.017847847814038552im … -0.009160283140619504 - 0.027260440432875014im 0.01716289788945349 - 0.007638578537361915im; 0.0068418040194206725 + 0.01443151890758567im -0.03602192584865965 + 0.015614209988641993im … 0.0016992477165462833 - 0.01112490331876968im 0.021030853919032387 + 0.001046300837456208im; … ; 0.03717800479244367 - 0.02071008658086694im 0.031350413189783474 + 0.0009126918062463735im … -0.055763393050980256 - 0.04320110215443941im -0.011248009012776098 - 0.04368368320513964im; 0.07293869780025733 + 0.001340002265742393im 0.03838900611534288 + 0.013563629256630252im … -0.028843092001916086 - 0.044610032752589984im 0.022221491591766975 - 0.02895223844058594im;;; 0.02437755043141803 + 0.035256750116571145im -0.08456553595266152 + 0.02975009770384015im … -0.015901678583089645 + 0.010528080642106391im 0.03148258488989826 + 0.027360011719071264im; -0.021909570950952445 + 0.029891983758471553im -0.0827348916649068 + 0.014888691923486127im … 0.03610992087022752 - 0.009303754768871946im 0.007687871325976833 + 0.02732446543700339im; … ; 0.05099685358498587 + 0.015056298787378634im 0.014216652166124857 + 0.02171536109492498im … -0.04106241202879184 - 0.027109898949403317im 0.031424027273520734 - 0.004975926489247391im; 0.07963414098483734 + 0.04258303011318108im -0.00533001565275828 + 0.03964095822180752im … -0.024384900392871126 + 0.001107780431529633im 0.05290744218392042 + 0.037118576316912975im;;; -0.02776988613191065 + 0.009352102876099666im -0.07405226226561655 - 0.008440866885698424im … -0.0076055203803183065 + 0.03896875276986528im 0.019665418681683654 + 0.02768263823847706im; -0.013371305022363177 + 0.004005715687065056im -0.07223661152214042 - 0.0022438993835281864im … 0.028748168678431572 - 0.005918649799478388im -0.008124208793669128 + 0.00823172321313461im; … ; -0.00376848805561254 + 0.04657601637277391im -0.026520214230032195 + 0.029503142237699554im … -0.05054675497172789 + 0.05918822885740134im 0.00378701152649329 + 0.06214449826233829im; -0.00039614072870262484 + 0.041612217149060306im -0.05746779158144072 + 0.026818370401512998im … -0.04217652430293077 + 0.07764793241480498im 0.016496231474308377 + 0.06086992466022419im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729845), converged = true, ρ = [0.09132316917746439 0.08747419134079504 … 0.07684754935962598 0.08747419134079504; 0.08747419134079504 0.08089966872163298 … 0.07642471016971027 0.08486944834425923; … ; 0.07684754935962597 0.07642471016971025 … 0.047784666671017044 0.0658789534230295; 0.08747419134079504 0.08486944834425923 … 0.06587895342302949 0.08089966872163297;;; 0.08747419134079505 0.080899668721633 … 0.07642471016971028 0.08486944834425925; 0.080899668721633 0.06744471469774171 … 0.07348669934703853 0.08163768629014057; … ; 0.07642471016971025 0.07348669934703851 … 0.061888041199963106 0.07259829028446509; 0.08486944834425923 0.08163768629014057 … 0.07259829028446509 0.08163768629014057;;; 0.07684754935962597 0.06587895342302949 … 0.06847203698973345 0.07642471016971025; 0.06587895342302949 0.04657864264980578 … 0.06665759371631592 0.0725982902844651; … ; 0.06847203698973343 0.06665759371631591 … 0.06132515314380778 0.06665759371631591; 0.07642471016971025 0.07259829028446509 … 0.0666575937163159 0.07348669934703851;;; … ;;; 0.0632849522988567 0.06591651445952432 … 0.033940648880517565 0.04987593485998784; 0.0659165144595243 0.06297790960105293 … 0.049756397885276214 0.06087020457146152; … ; 0.03394064888051755 0.0497563978852762 … 0.00969635321407302 0.016831338792590602; 0.04987593485998784 0.06087020457146151 … 0.016831338792590588 0.03098572188504864;;; 0.07684754935962597 0.07642471016971025 … 0.04778466667101705 0.06587895342302949; 0.07642471016971025 0.07348669934703853 … 0.061888041199963106 0.0725982902844651; … ; 0.04778466667101704 0.061888041199963106 … 0.009696353214073025 0.02571001067530356; 0.06587895342302949 0.07259829028446509 … 0.025710010675303555 0.04657864264980577;;; 0.08747419134079505 0.08486944834425925 … 0.0658789534230295 0.080899668721633; 0.08486944834425925 0.08163768629014058 … 0.0725982902844651 0.08163768629014057; … ; 0.0658789534230295 0.07259829028446509 … 0.02571001067530357 0.04657864264980576; 0.08089966872163298 0.08163768629014057 … 0.046578642649805754 0.0674447146977417;;;;], eigenvalues = [[-0.16677707596306923, 0.2642777178299202, 0.2642777178299312, 0.26427771782994236, 0.3573203719045092, 0.3573203719045137, 0.3573203719045226], [-0.11613218761082762, 0.07040532320004583, 0.22624813603023616, 0.22624813603023686, 0.336117848946029, 0.3934379776179981, 0.3934379776180015], [-0.09588938143639619, 0.08764319967959486, 0.17312704142741842, 0.17312704142743732, 0.291972489221304, 0.3377321250728923, 0.5327646516179941], [-0.04505146348593537, 0.022269526239821383, 0.09831189251534109, 0.18446409322117813, 0.3229270151624698, 0.48024696047904814, 0.5024422335248755]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.28971208183819164, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.28906853835723245 + 0.9107283051067299im 8.520535969355407e-16 - 5.652733277418336e-15im … -7.694725919712094e-12 + 6.883719162867255e-11im 7.990598528243005e-12 - 7.147397128806274e-11im; -0.02913065061027321 + 0.0917779160877252im 0.13067442861035147 + 0.23730118528573205im … 0.4043417878293317 - 0.27514558909744546im -0.26967650030949164 - 0.06822980159449683im; … ; -0.0035681190227778137 + 0.011241579621581791im 0.019111470829235526 - 0.006572949603878115im … 0.07132016456115305 - 0.07131086180199847im -0.023816669151317537 - 0.003647479665234538im; 0.029130650610273864 - 0.09177791608772089im 0.31777996481927484 + 0.17295055151721322im … 0.18328703450380707 - 0.31240658401257826im 0.07344362033569454 + 0.03817709224691927im], [-0.7973629959749419 + 0.47620121939781274im -0.07546595483875525 - 0.18210727375944202im … -1.1977128517154237e-11 + 8.458442198796486e-12im -3.583653280123426e-12 - 9.074302265992115e-12im; -0.05435777217610197 + 0.03246355489867971im 0.0033587769151892832 + 0.008105081403901652im … -8.116781047057718e-12 + 2.271037215400469e-12im -1.1119973932945685e-11 - 3.3797040019332157e-12im; … ; -0.006654374211086928 + 0.0039741261252968585im -0.03302269163736519 - 0.07968722265726874im … 0.061657075377822786 - 0.0753983108470078im 0.00015873519698677988 + 0.05088897530464021im; 0.09695716233632369 - 0.057904767548756654im 0.034725889131649215 + 0.0837972170649548im … 0.26170709392432057 - 0.32003257860831824im 0.0006737608611531405 + 0.2160012579507204im], [-0.8875014257765858 - 0.29022744950531865im 5.07538977598739e-15 - 7.180190421076198e-17im … 6.493463393837768e-11 - 9.987084209491986e-11im 2.18203532695339e-10 - 1.2273152464301023e-9im; -0.06534340711456872 - 0.021368360475877073im -0.05712081344726411 - 0.0028184608211383896im … -0.01372930311413431 + 0.0211099747452721im -0.0011945330474725576 + 0.0015620009025477258im; … ; -0.013183276080871189 - 0.004311146418415927im -1.108386463843418e-14 - 2.6664495603513285e-16im … 1.6885876834962622e-10 - 2.783251011050194e-10im -0.065366886516428 - 0.0020303048276096958im; 0.1456202051061204 + 0.047620183468899215im -0.2867783317997419 - 0.014150244783808752im … 0.2081844654849446 - 0.3201013753274095im -0.1530077102511426 - 0.005288975014389724im], [0.4899670942411302 - 0.6437652715272164im -3.333171828982337e-16 - 5.234253931406248e-17im … -0.09037453959339277 + 0.1642065817261001im -1.251278172069344e-6 + 2.231870515354873e-6im; 0.23466802701546505 - 0.30832912639643456im 0.2845704324885595 - 0.5582387621344989im … 0.0859329886279488 - 0.15613576616511407im 6.489032704420343e-7 - 1.3584414676212431e-6im; … ; 0.006900425305938648 - 0.009066433691045024im 0.0007464756813358697 - 0.0014643533295731416im … -0.007799370132072645 + 0.014171248566141069im 0.04419250213750888 - 0.00291862070184524im; -0.03947519015774051 + 0.05186625144663414im 0.005670240258828927 - 0.01112324943745454im … -0.0652625620790776 + 0.11858441339065526im 0.46963090498082194 - 0.031010351789684455im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596306923, 0.2642777178299202, 0.2642777178299312, 0.26427771782994236, 0.3573203719045092, 0.3573203719045137, 0.3573203719045226], [-0.11613218761082762, 0.07040532320004583, 0.22624813603023616, 0.22624813603023686, 0.336117848946029, 0.3934379776179981, 0.3934379776180015], [-0.09588938143639619, 0.08764319967959486, 0.17312704142741842, 0.17312704142743732, 0.291972489221304, 0.3377321250728923, 0.5327646516179941], [-0.04505146348593537, 0.022269526239821383, 0.09831189251534109, 0.18446409322117813, 0.3229270151624698, 0.48024696047904814, 0.5024422335248755]], X = [[-0.28906853835723245 + 0.9107283051067299im 8.520535969355407e-16 - 5.652733277418336e-15im … -7.694725919712094e-12 + 6.883719162867255e-11im 7.990598528243005e-12 - 7.147397128806274e-11im; -0.02913065061027321 + 0.0917779160877252im 0.13067442861035147 + 0.23730118528573205im … 0.4043417878293317 - 0.27514558909744546im -0.26967650030949164 - 0.06822980159449683im; … ; -0.0035681190227778137 + 0.011241579621581791im 0.019111470829235526 - 0.006572949603878115im … 0.07132016456115305 - 0.07131086180199847im -0.023816669151317537 - 0.003647479665234538im; 0.029130650610273864 - 0.09177791608772089im 0.31777996481927484 + 0.17295055151721322im … 0.18328703450380707 - 0.31240658401257826im 0.07344362033569454 + 0.03817709224691927im], [-0.7973629959749419 + 0.47620121939781274im -0.07546595483875525 - 0.18210727375944202im … -1.1977128517154237e-11 + 8.458442198796486e-12im -3.583653280123426e-12 - 9.074302265992115e-12im; -0.05435777217610197 + 0.03246355489867971im 0.0033587769151892832 + 0.008105081403901652im … -8.116781047057718e-12 + 2.271037215400469e-12im -1.1119973932945685e-11 - 3.3797040019332157e-12im; … ; -0.006654374211086928 + 0.0039741261252968585im -0.03302269163736519 - 0.07968722265726874im … 0.061657075377822786 - 0.0753983108470078im 0.00015873519698677988 + 0.05088897530464021im; 0.09695716233632369 - 0.057904767548756654im 0.034725889131649215 + 0.0837972170649548im … 0.26170709392432057 - 0.32003257860831824im 0.0006737608611531405 + 0.2160012579507204im], [-0.8875014257765858 - 0.29022744950531865im 5.07538977598739e-15 - 7.180190421076198e-17im … 6.493463393837768e-11 - 9.987084209491986e-11im 2.18203532695339e-10 - 1.2273152464301023e-9im; -0.06534340711456872 - 0.021368360475877073im -0.05712081344726411 - 0.0028184608211383896im … -0.01372930311413431 + 0.0211099747452721im -0.0011945330474725576 + 0.0015620009025477258im; … ; -0.013183276080871189 - 0.004311146418415927im -1.108386463843418e-14 - 2.6664495603513285e-16im … 1.6885876834962622e-10 - 2.783251011050194e-10im -0.065366886516428 - 0.0020303048276096958im; 0.1456202051061204 + 0.047620183468899215im -0.2867783317997419 - 0.014150244783808752im … 0.2081844654849446 - 0.3201013753274095im -0.1530077102511426 - 0.005288975014389724im], [0.4899670942411302 - 0.6437652715272164im -3.333171828982337e-16 - 5.234253931406248e-17im … -0.09037453959339277 + 0.1642065817261001im -1.251278172069344e-6 + 2.231870515354873e-6im; 0.23466802701546505 - 0.30832912639643456im 0.2845704324885595 - 0.5582387621344989im … 0.0859329886279488 - 0.15613576616511407im 6.489032704420343e-7 - 1.3584414676212431e-6im; … ; 0.006900425305938648 - 0.009066433691045024im 0.0007464756813358697 - 0.0014643533295731416im … -0.007799370132072645 + 0.014171248566141069im 0.04419250213750888 - 0.00291862070184524im; -0.03947519015774051 + 0.05186625144663414im 0.005670240258828927 - 0.01112324943745454im … -0.0652625620790776 + 0.11858441339065526im 0.46963090498082194 - 0.031010351789684455im]], residual_norms = [[1.252441878902369e-13, 1.2117789592055448e-13, 5.2727267812191826e-14, 8.232972085393138e-14, 2.429493818280499e-10, 6.511591534373653e-10, 6.76095680035401e-10], [1.1790103356812823e-13, 1.2805108325798716e-13, 1.1996645762324378e-13, 5.4084776542951195e-14, 1.363699138953597e-10, 1.5891325182407744e-10, 2.4231926975359117e-10], [6.178592390044066e-14, 1.1309221760468186e-13, 2.355961498025624e-13, 2.325786059535759e-13, 4.185356459183868e-11, 1.1178436763168414e-9, 1.2928496136582646e-7], [1.4317595891183072e-13, 7.635507090489907e-14, 1.3110112488778186e-13, 1.0636008607252176e-13, 1.3194159534753312e-9, 1.266679482675792e-5, 4.4123290311681835e-6]], iterations = [34, 22, 21, 20], converged = 1, n_matvec = 668)], stage = :finalize, algorithm = &quot;SCF&quot;, occupation_threshold = 1.0e-6)</code></pre><h2 id="Direct-minimization"><a class="docs-heading-anchor" href="#Direct-minimization">Direct minimization</a><a id="Direct-minimization-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-minimization" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_dm = direct_minimization(basis; tol)

# Newton algorithm</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3915556370886795 0.3785174209521314 … 0.3446996003131316 0.3785174209521314; 0.3785174209521313 0.36645844069702604 … 0.32735728176314177 0.3636495426697784; … ; 0.34469960031313157 0.3273572817631419 … 0.30751926944479485 0.33438053202447515; 0.37851742095213137 0.3636495426697785 … 0.3343805320244751 0.3664584406970261;;; 0.37851742095213137 0.36645844069702616 … 0.3273572817631419 0.3636495426697785; 0.36645844069702604 0.35102886346229695 … 0.3111940134992437 0.35191706639545645; … ; 0.3273572817631418 0.3111940134992438 … 0.2982412284373232 0.32142600285172457; 0.3636495426697785 0.35191706639545656 … 0.3214260028517245 0.35191706639545656;;; 0.3446996003131316 0.3343805320244752 … 0.2865351537979721 0.32735728176314194; 0.3343805320244751 0.31861604779581565 … 0.2780589188544362 0.3214260028517245; … ; 0.28653515379797206 0.2780589188544363 … 0.25590185774453056 0.27805891885443623; 0.32735728176314194 0.3214260028517246 … 0.27805891885443623 0.31119401349924386;;; … ;;; 0.30487474931719366 0.2830366689900202 … 0.28556433233327255 0.3009573705418232; 0.28303666899002006 0.2589843162499771 … 0.27263300129757445 0.28541419664853873; … ; 0.28556433233327255 0.2726330012975745 … 0.2771603891585041 0.2812108738032786; 0.3009573705418232 0.28541419664853873 … 0.2812108738032786 0.29308272629366583;;; 0.3446996003131316 0.32735728176314194 … 0.30751926944479485 0.33438053202447526; 0.3273572817631418 0.3111940134992438 … 0.2982412284373232 0.3214260028517245; … ; 0.30751926944479485 0.29824122843732326 … 0.27716038915850416 0.2931311914942539; 0.3343805320244752 0.3214260028517246 … 0.2931311914942538 0.3186160477958157;;; 0.37851742095213137 0.36364954266977856 … 0.33438053202447515 0.36645844069702616; 0.36364954266977834 0.3519170663954565 … 0.3214260028517245 0.35191706639545645; … ; 0.33438053202447515 0.3214260028517246 … 0.2931311914942538 0.3186160477958157; 0.3664584406970261 0.35191706639545656 … 0.3186160477958157 0.35102886346229706]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923345847 -0.49665655724981006 … -0.47719190098965886 -0.49665655724981006; -0.49665655724981006 -0.48481820873962334 … -0.47638044578632943 -0.4920413111901851; … ; -0.47719190098965875 -0.4763804457863295 … -0.4122880708908734 -0.4550700815830374; -0.49665655724981006 -0.4920413111901851 … -0.4550700815830374 -0.48481820873962334;;; -0.49665655724981006 -0.48481820873962334 … -0.4763804457863295 -0.49204131119018524; -0.48481820873962334 -0.4583744079489188 … -0.47065601572326404 -0.48617902519746165; … ; -0.47638044578632943 -0.47065601572326404 … -0.44639843644982025 -0.4688943964122394; -0.49204131119018524 -0.48617902519746165 … -0.4688943964122394 -0.48617902519746165;;; -0.47719190098965875 -0.45507008158303747 … -0.46051412343868925 -0.4763804457863294; -0.4550700815830374 -0.4090661824669094 … -0.45671990833675147 -0.4688943964122394; … ; -0.46051412343868925 -0.45671990833675147 … -0.44514495661414805 -0.45671990833675136; -0.4763804457863294 -0.4688943964122394 … -0.45671990833675147 -0.47065601572326404;;; … ;;; -0.44947595085770803 -0.455149972215812 … -0.3712598626145754 -0.41774571521568266; -0.455149972215812 -0.4488035110107907 … -0.41743801070872566 -0.44412609930932506; … ; -0.37125986261457533 -0.41743801070872566 … -0.25365698327802366 -0.29979809105618094; -0.41774571521568266 -0.44412609930932506 … -0.2997980910561811 -0.3610634326576835;;; -0.47719190098965875 -0.4763804457863294 … -0.4122880708908735 -0.45507008158303747; -0.4763804457863294 -0.47065601572326404 … -0.44639843644982025 -0.4688943964122394; … ; -0.4122880708908734 -0.44639843644982025 … -0.25365698327802366 -0.34106330231461107; -0.4550700815830374 -0.4688943964122394 … -0.3410633023146111 -0.4090661824669095;;; -0.49665655724981006 -0.49204131119018524 … -0.45507008158303747 -0.48481820873962334; -0.4920413111901851 -0.48617902519746165 … -0.4688943964122394 -0.48617902519746165; … ; -0.4550700815830374 -0.4688943964122394 … -0.34106330231461107 -0.4090661824669095; -0.48481820873962334 -0.4861790251974617 … -0.4090661824669095 -0.4583744079489189])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417761169442 -0.4874266763817773 … -0.7026973955215718 -0.48742667638177717; -0.487426676381777 -0.7738703030963143 … -0.41393901831804597 -0.38179339119227; … ; -0.7026973955215721 -0.41393901831804614 … -2.396890218047309 -1.294138609191836; -0.4874266763817772 -0.38179339119227035 … -1.2941386091918363 -0.7738703030963141;;; -0.48742667638177734 -0.7738703030963141 … -0.41393901831804597 -0.3817933911922699; -0.7738703030963139 -1.4815303728711329 … -0.32444274391666317 -0.44995655433569687; … ; -0.4139390183180462 -0.3244427439166633 … -1.0113865017567303 -0.6391785259041551; -0.3817933911922701 -0.4499565543356971 … -0.6391785259041556 -0.4499565543356969;;; -0.7026973955215718 -1.2941386091918365 … -0.29832133492859353 -0.4139390183180458; -1.2941386091918363 -2.923470245897757 … -0.35179963882792037 -0.6391785259041554; … ; -0.2983213349285938 -0.35179963882792054 … -0.49060647082864983 -0.35179963882792026; -0.413939018318046 -0.6391785259041556 … -0.35179963882792015 -0.32444274391666295;;; … ;;; -1.0150481268624436 -0.5338983581044421 … -3.638038941473669 -1.9993625019688464; -0.5338983581044419 -0.3216988269941431 … -1.4639475299895164 -0.906137044202211; … ; -3.6380389414736687 -1.4639475299895164 … -10.993621243049976 -8.086551292429991; -1.9993625019688464 -0.906137044202211 … -8.086551292429991 -4.647852558430237;;; -0.7026973955215718 -0.41393901831804586 … -2.3968902180473095 -1.2941386091918368; -0.4139390183180458 -0.32444274391666306 … -1.0113865017567294 -0.6391785259041554; … ; -2.396890218047309 -1.0113865017567296 … -11.0030614333754 -6.073393711795891; -1.2941386091918363 -0.6391785259041555 … -6.073393711795893 -2.9234702458977573;;; -0.4874266763817774 -0.3817933911922699 … -1.2941386091918368 -0.7738703030963141; -0.38179339119226996 -0.44995655433569687 … -0.6391785259041554 -0.4499565543356968; … ; -1.2941386091918368 -0.6391785259041554 … -6.073393711795893 -2.9234702458977564; -0.7738703030963141 -0.44995655433569715 … -2.9234702458977573 -1.4815303728711324]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.1272356904110512 + 0.16981472018799082im 0.11827563956006543 + 0.02687918934515902im … 0.05124560576399175 - 0.06316013675146696im 0.11827564018130628 + 0.02687918990443911im; 0.14803682670018917 + 0.00011377906886926841im 0.14902554252127298 - 0.18406919769608604im … 0.026668490474957205 - 0.010270835251391313im 0.0832448130691052 + 0.015348165738685136im; … ; 0.08113810361636245 - 0.09004364246785387im 0.045093968776867485 - 0.026841597449861004im … -0.0176862118055139 - 0.023604848534119035im 0.0546416160171722 - 0.1212576961752518im; 0.14803682453403244 + 0.00011377879506138363im 0.08324481074922564 + 0.015348165060556604im … 0.04936319999009901 - 0.11651060831913954im 0.14902554284649416 - 0.184069196813453im;;; 0.00905700081189044 + 0.21447979782921528im -0.013026823122151282 + 0.06588450334885187im … 0.04157418936388596 - 0.03326176637802541im 0.042726282508503216 + 0.07784497353817449im; 0.02167512491662959 + 0.03467566979711266im -0.0016400200851588377 - 0.12823708963150487im … 0.01779917831536272 + 0.0026550058426182644im 0.021581135505618788 + 0.0544216619121689im; … ; 0.05680775631945511 - 0.046961916319631335im 0.021334767510723142 - 0.0005246902765802266im … 0.029056732384839884 - 0.05617360041329843im 0.06558572440760632 - 0.09066679306368466im; 0.051402932306769615 + 0.07004171805997901im 0.001880357891223033 + 0.07213934896224178im … 0.058854702352648246 - 0.08461331860988676im 0.0938797316600809 - 0.06976282967211775im;;; -0.058454928092724415 + 0.12526820687682555im -0.037357756161909866 + 0.0206444835124294im … 0.004316364147158376 + 0.01174919510579022im -0.026044278017847627 + 0.08288384610032536im; -0.022935395760879038 + 0.007673883967384136im -0.00872203920067571 - 0.10739511034203587im … -0.004359225175778457 + 0.021899663233208203im -0.019734338826677796 + 0.050376023732074865im; … ; 0.006811937394426147 + 0.00950482702173735im -0.00865175961306391 + 0.02576010892067834im … 0.022375744783392458 - 0.03330543924936721im 0.024065936111836828 - 0.02470449881306179im; -0.029236189682292815 + 0.08575445825690067im -0.034418187555638025 + 0.06358178962859377im … 0.021352292188936646 - 0.02226401138361593im 0.004824145505632181 + 0.024941713466368788im;;; … ;;; -0.017501906396216148 + 0.019721711670782315im -0.02004491975318981 + 0.03777982140405532im … 0.006139730655776896 - 0.03625842451129101im 0.00030281204568853755 - 0.029397112637121654im; -0.022592839953718934 + 0.04007126669109333im -0.013404262499668721 + 0.03022090630001198im … -0.004093826960899239 - 0.0056336089932638965im -0.01515718715080151 + 0.016962676204788106im; … ; 0.0002921424618932035 - 0.03099945707449539im -0.003068557282791679 - 0.006555674194187914im … -0.018126945248333835 + 0.0186193151165795im -0.00664488469509629 - 0.02745212953297059im; 0.001611027035569907 - 0.030573641814129623im -0.010170352425707567 + 0.012477818898484167im … 0.0013079420460555828 - 0.034604420923348936im 0.013535008621674357 - 0.07201313110591906im;;; -0.0584549249758476 + 0.12526820901687089im -0.026044274300683082 + 0.0828838485684188im … -0.01768621463371488 - 0.023604850093545647im -0.03735775982280292 + 0.02064448143363351im; -0.02923618565496404 + 0.08575446079140203im 0.00482414851332371 + 0.02494171528890106im … -0.01914019450909456 + 0.018166565595442864im -0.03441818692180458 + 0.06358179015570581im; … ; -0.01768621372939174 - 0.02360484983796749im -0.008819288195674088 + 0.008884567190804582im … -0.06590463354977626 + 0.03864497750199458im -0.04226752045269831 - 0.03644492261795454im; -0.022935398170259934 + 0.007673882274249999im -0.019734337727313225 + 0.05037602442616085im … -0.02784515997481531 - 0.04941552209759904im -0.008722047122655587 - 0.10739511564667256im;;; 0.009057007266369394 + 0.21447980227093888im 0.04272628731635854 + 0.07784497676017942im … -0.01798684536813594 - 0.012628184387941312im -0.01302682243082786 + 0.06588450431106015im; 0.05140293944337914 + 0.07004172195966778im 0.09387973404463086 - 0.06976282859095648im … -0.009716447341307369 + 0.0211525702526797im 0.0018803613505704014 + 0.07213935096942939im; … ; 0.0017139322864528188 - 0.030345871366585564im 0.01169842389776846 + 0.0018933300650876323im … -0.09519520167035052 + 0.05446690385405599im -0.04924057055452909 - 0.04489830394244902im; 0.02167512566196146 + 0.03467567079598197im 0.02158113724506689 + 0.05442166345321588im … -0.0405639207431905 - 0.052701559420631865im -0.0016400232299997645 - 0.1282370916146283im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3915556370886795 0.3785174209521314 … 0.3446996003131316 0.3785174209521314; 0.3785174209521313 0.36645844069702604 … 0.32735728176314177 0.3636495426697784; … ; 0.34469960031313157 0.3273572817631419 … 0.30751926944479485 0.33438053202447515; 0.37851742095213137 0.3636495426697785 … 0.3343805320244751 0.3664584406970261;;; 0.37851742095213137 0.36645844069702616 … 0.3273572817631419 0.3636495426697785; 0.36645844069702604 0.35102886346229695 … 0.3111940134992437 0.35191706639545645; … ; 0.3273572817631418 0.3111940134992438 … 0.2982412284373232 0.32142600285172457; 0.3636495426697785 0.35191706639545656 … 0.3214260028517245 0.35191706639545656;;; 0.3446996003131316 0.3343805320244752 … 0.2865351537979721 0.32735728176314194; 0.3343805320244751 0.31861604779581565 … 0.2780589188544362 0.3214260028517245; … ; 0.28653515379797206 0.2780589188544363 … 0.25590185774453056 0.27805891885443623; 0.32735728176314194 0.3214260028517246 … 0.27805891885443623 0.31119401349924386;;; … ;;; 0.30487474931719366 0.2830366689900202 … 0.28556433233327255 0.3009573705418232; 0.28303666899002006 0.2589843162499771 … 0.27263300129757445 0.28541419664853873; … ; 0.28556433233327255 0.2726330012975745 … 0.2771603891585041 0.2812108738032786; 0.3009573705418232 0.28541419664853873 … 0.2812108738032786 0.29308272629366583;;; 0.3446996003131316 0.32735728176314194 … 0.30751926944479485 0.33438053202447526; 0.3273572817631418 0.3111940134992438 … 0.2982412284373232 0.3214260028517245; … ; 0.30751926944479485 0.29824122843732326 … 0.27716038915850416 0.2931311914942539; 0.3343805320244752 0.3214260028517246 … 0.2931311914942538 0.3186160477958157;;; 0.37851742095213137 0.36364954266977856 … 0.33438053202447515 0.36645844069702616; 0.36364954266977834 0.3519170663954565 … 0.3214260028517245 0.35191706639545645; … ; 0.33438053202447515 0.3214260028517246 … 0.2931311914942538 0.3186160477958157; 0.3664584406970261 0.35191706639545656 … 0.3186160477958157 0.35102886346229706]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923345847 -0.49665655724981006 … -0.47719190098965886 -0.49665655724981006; -0.49665655724981006 -0.48481820873962334 … -0.47638044578632943 -0.4920413111901851; … ; -0.47719190098965875 -0.4763804457863295 … -0.4122880708908734 -0.4550700815830374; -0.49665655724981006 -0.4920413111901851 … -0.4550700815830374 -0.48481820873962334;;; -0.49665655724981006 -0.48481820873962334 … -0.4763804457863295 -0.49204131119018524; -0.48481820873962334 -0.4583744079489188 … -0.47065601572326404 -0.48617902519746165; … ; -0.47638044578632943 -0.47065601572326404 … -0.44639843644982025 -0.4688943964122394; -0.49204131119018524 -0.48617902519746165 … -0.4688943964122394 -0.48617902519746165;;; -0.47719190098965875 -0.45507008158303747 … -0.46051412343868925 -0.4763804457863294; -0.4550700815830374 -0.4090661824669094 … -0.45671990833675147 -0.4688943964122394; … ; -0.46051412343868925 -0.45671990833675147 … -0.44514495661414805 -0.45671990833675136; -0.4763804457863294 -0.4688943964122394 … -0.45671990833675147 -0.47065601572326404;;; … ;;; -0.44947595085770803 -0.455149972215812 … -0.3712598626145754 -0.41774571521568266; -0.455149972215812 -0.4488035110107907 … -0.41743801070872566 -0.44412609930932506; … ; -0.37125986261457533 -0.41743801070872566 … -0.25365698327802366 -0.29979809105618094; -0.41774571521568266 -0.44412609930932506 … -0.2997980910561811 -0.3610634326576835;;; -0.47719190098965875 -0.4763804457863294 … -0.4122880708908735 -0.45507008158303747; -0.4763804457863294 -0.47065601572326404 … -0.44639843644982025 -0.4688943964122394; … ; -0.4122880708908734 -0.44639843644982025 … -0.25365698327802366 -0.34106330231461107; -0.4550700815830374 -0.4688943964122394 … -0.3410633023146111 -0.4090661824669095;;; -0.49665655724981006 -0.49204131119018524 … -0.45507008158303747 -0.48481820873962334; -0.4920413111901851 -0.48617902519746165 … -0.4688943964122394 -0.48617902519746165; … ; -0.4550700815830374 -0.4688943964122394 … -0.34106330231461107 -0.4090661824669095; -0.48481820873962334 -0.4861790251974617 … -0.4090661824669095 -0.4583744079489189])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417761169442 -0.4874266763817773 … -0.7026973955215718 -0.48742667638177717; -0.487426676381777 -0.7738703030963143 … -0.41393901831804597 -0.38179339119227; … ; -0.7026973955215721 -0.41393901831804614 … -2.396890218047309 -1.294138609191836; -0.4874266763817772 -0.38179339119227035 … -1.2941386091918363 -0.7738703030963141;;; -0.48742667638177734 -0.7738703030963141 … -0.41393901831804597 -0.3817933911922699; -0.7738703030963139 -1.4815303728711329 … -0.32444274391666317 -0.44995655433569687; … ; -0.4139390183180462 -0.3244427439166633 … -1.0113865017567303 -0.6391785259041551; -0.3817933911922701 -0.4499565543356971 … -0.6391785259041556 -0.4499565543356969;;; -0.7026973955215718 -1.2941386091918365 … -0.29832133492859353 -0.4139390183180458; -1.2941386091918363 -2.923470245897757 … -0.35179963882792037 -0.6391785259041554; … ; -0.2983213349285938 -0.35179963882792054 … -0.49060647082864983 -0.35179963882792026; -0.413939018318046 -0.6391785259041556 … -0.35179963882792015 -0.32444274391666295;;; … ;;; -1.0150481268624436 -0.5338983581044421 … -3.638038941473669 -1.9993625019688464; -0.5338983581044419 -0.3216988269941431 … -1.4639475299895164 -0.906137044202211; … ; -3.6380389414736687 -1.4639475299895164 … -10.993621243049976 -8.086551292429991; -1.9993625019688464 -0.906137044202211 … -8.086551292429991 -4.647852558430237;;; -0.7026973955215718 -0.41393901831804586 … -2.3968902180473095 -1.2941386091918368; -0.4139390183180458 -0.32444274391666306 … -1.0113865017567294 -0.6391785259041554; … ; -2.396890218047309 -1.0113865017567296 … -11.0030614333754 -6.073393711795891; -1.2941386091918363 -0.6391785259041555 … -6.073393711795893 -2.9234702458977573;;; -0.4874266763817774 -0.3817933911922699 … -1.2941386091918368 -0.7738703030963141; -0.38179339119226996 -0.44995655433569687 … -0.6391785259041554 -0.4499565543356968; … ; -1.2941386091918368 -0.6391785259041554 … -6.073393711795893 -2.9234702458977564; -0.7738703030963141 -0.44995655433569715 … -2.9234702458977573 -1.4815303728711324]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0013827838613764947 - 0.09401000469960591im 0.17639010505561062 + 0.11994315443357145im … 0.09677619293676365 + 0.04180728633517653im 0.07218309995836304 - 0.027785497150685273im; 0.005325854507841541 - 0.0034611876505309877im 0.12209792010119445 + 0.09042475290222954im … 0.027931505249075013 + 0.02228712008490702im -0.004167444898970599 - 0.003992993686206449im; … ; -0.013973546026548272 - 0.15166372383880466im -0.0191501788114052 - 0.10842745377022431im … 0.033542302964987135 + 0.052982172660089304im 0.0963897279489703 + 0.03208636332096268im; -0.018012417686687522 - 0.24785736250566934im 0.06757239292350804 - 0.07852328643711008im … 0.12485139378382545 + 0.04631421322098757im 0.1451557104121021 - 0.06801282981213495im;;; -0.13320929176350815 - 0.023531449493960147im 0.03926899307539508 + 0.1849841688512411im … 0.04003180879484454 + 0.014440440188608706im -0.06447850526050403 - 0.04560512537217716im; -0.09820798938239092 - 0.011669448030440082im 0.01211121516546462 + 0.08124915318158116im … -0.012143436674179164 - 0.0016385085157163445im -0.0833191405005387 - 0.035794086886836426im; … ; -0.0006033272047370293 - 0.09983246861491532im -0.001843108584200167 - 0.046409470244632746im … 0.06277433144877037 + 0.023357294138693085im 0.07146815753003635 - 0.021591658417620205im; -0.07117839594375855 - 0.1428232000262727im 0.018891859673840206 + 0.041030965484565925im … 0.09200862684671592 + 0.020704845542647298im 0.05842946993203871 - 0.059399094672058034im;;; -0.11391082718979544 + 0.006427432285196547im 0.007621530010398742 + 0.1012919309062449im … -0.018710337917679513 - 0.007805263907058977im -0.09231492078106676 - 0.03089891345751804im; -0.03028138617241255 + 0.004501990706366328im 0.056456113077936375 + 0.04051692439522317im … -0.034040353871357246 - 0.014400512533851648im -0.06725012715404735 - 0.02676621683557924im; … ; -0.021661589381345082 - 0.03374652215322546im -0.011997831983166209 + 0.0010588698067164567im … 0.031591555514241663 + 0.003638412644119866im 0.011066724387521019 - 0.020914003173896217im; -0.07964853748714358 - 0.022918140098490067im -0.017676277713857498 + 0.05570914969387416im … 0.018404137889876784 - 0.0012114409677040478im -0.036833292011680785 - 0.03127160973148739im;;; … ;;; -0.03309658640259989 - 0.014295442305801794im -0.03413543755364787 - 0.015112525189957825im … 0.004713789330819236 - 0.005522029894369008im -0.002179716365716432 - 0.002615052772798246im; -0.02013741697025511 - 0.0033286691828186736im -0.010045029543544984 - 0.00048352838237402545im … -0.00022521087046549905 - 0.002166475899080353im -0.009566108391507316 - 0.0006068673912236842im; … ; 0.030355009870256317 + 0.03015670811683327im -0.01263066333141635 - 0.001300766557224287im … 0.009887829115102501 + 0.00028668420132394763im 0.05629860761713954 + 0.04209206050192682im; -0.013073920246104768 - 0.004200499805921219im -0.03960976959156147 - 0.020940740569713213im … 0.012590651499044463 + 4.776908791326431e-5im 0.03031861271401 + 0.017450606573499745im;;; -0.08348351531698106 - 0.04172869755062235im -0.0344792318607048 - 0.02008947859285098im … 0.0024772754499276894 + 0.001567882887468986im -0.021708433837820073 - 0.0009332302721548333im; -0.02028062643898116 - 5.535385584639178e-5im 0.01613558621209699 + 0.011466561019884542im … 0.0035887119820369445 + 0.007884487266527067im -0.011568610230143418 + 0.007906802673063328im; … ; -0.024106028329900206 + 0.02626677336914555im -0.06233404848708214 - 0.03462045221499925im … -0.016497735136049595 + 0.023759503150196683im 0.054091834445922075 + 0.1095600870928949im; -0.11265368682059734 - 0.06375043094693758im -0.09102124789645225 - 0.06411488959346524im … -0.005660300707040508 + 0.008882658511103968im 0.0030607079474420096 + 0.031016631291013688im;;; -0.062549516264706 - 0.09022330845347985im 0.07815323625342384 + 0.020493300068147886im … 0.04148125994024898 + 0.02835014815307634im 0.015734598361045612 - 0.0030044998229069196im; 0.010763394926913309 + 0.00292625869890194im 0.09162941561274382 + 0.045280601935862676im … 0.022967118337813716 + 0.023911355689552986im 0.006396916634712118 + 0.015218013688782443im; … ; -0.08787168772530535 - 0.05330409275742301im -0.08075180026643541 - 0.09213345678758011im … -0.05148140625187678 + 0.06063531817369213im 0.01923585835500075 + 0.1335814062613229im; -0.1496212587168856 - 0.20461842201858754im -0.06570368967373608 - 0.11692490432957184im … 0.015883374128739032 + 0.03695891349934599im 0.017308124561635954 + 0.0029099171657245896im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3915556370886795 0.3785174209521314 … 0.3446996003131316 0.3785174209521314; 0.3785174209521313 0.36645844069702604 … 0.32735728176314177 0.3636495426697784; … ; 0.34469960031313157 0.3273572817631419 … 0.30751926944479485 0.33438053202447515; 0.37851742095213137 0.3636495426697785 … 0.3343805320244751 0.3664584406970261;;; 0.37851742095213137 0.36645844069702616 … 0.3273572817631419 0.3636495426697785; 0.36645844069702604 0.35102886346229695 … 0.3111940134992437 0.35191706639545645; … ; 0.3273572817631418 0.3111940134992438 … 0.2982412284373232 0.32142600285172457; 0.3636495426697785 0.35191706639545656 … 0.3214260028517245 0.35191706639545656;;; 0.3446996003131316 0.3343805320244752 … 0.2865351537979721 0.32735728176314194; 0.3343805320244751 0.31861604779581565 … 0.2780589188544362 0.3214260028517245; … ; 0.28653515379797206 0.2780589188544363 … 0.25590185774453056 0.27805891885443623; 0.32735728176314194 0.3214260028517246 … 0.27805891885443623 0.31119401349924386;;; … ;;; 0.30487474931719366 0.2830366689900202 … 0.28556433233327255 0.3009573705418232; 0.28303666899002006 0.2589843162499771 … 0.27263300129757445 0.28541419664853873; … ; 0.28556433233327255 0.2726330012975745 … 0.2771603891585041 0.2812108738032786; 0.3009573705418232 0.28541419664853873 … 0.2812108738032786 0.29308272629366583;;; 0.3446996003131316 0.32735728176314194 … 0.30751926944479485 0.33438053202447526; 0.3273572817631418 0.3111940134992438 … 0.2982412284373232 0.3214260028517245; … ; 0.30751926944479485 0.29824122843732326 … 0.27716038915850416 0.2931311914942539; 0.3343805320244752 0.3214260028517246 … 0.2931311914942538 0.3186160477958157;;; 0.37851742095213137 0.36364954266977856 … 0.33438053202447515 0.36645844069702616; 0.36364954266977834 0.3519170663954565 … 0.3214260028517245 0.35191706639545645; … ; 0.33438053202447515 0.3214260028517246 … 0.2931311914942538 0.3186160477958157; 0.3664584406970261 0.35191706639545656 … 0.3186160477958157 0.35102886346229706]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923345847 -0.49665655724981006 … -0.47719190098965886 -0.49665655724981006; -0.49665655724981006 -0.48481820873962334 … -0.47638044578632943 -0.4920413111901851; … ; -0.47719190098965875 -0.4763804457863295 … -0.4122880708908734 -0.4550700815830374; -0.49665655724981006 -0.4920413111901851 … -0.4550700815830374 -0.48481820873962334;;; -0.49665655724981006 -0.48481820873962334 … -0.4763804457863295 -0.49204131119018524; -0.48481820873962334 -0.4583744079489188 … -0.47065601572326404 -0.48617902519746165; … ; -0.47638044578632943 -0.47065601572326404 … -0.44639843644982025 -0.4688943964122394; -0.49204131119018524 -0.48617902519746165 … -0.4688943964122394 -0.48617902519746165;;; -0.47719190098965875 -0.45507008158303747 … -0.46051412343868925 -0.4763804457863294; -0.4550700815830374 -0.4090661824669094 … -0.45671990833675147 -0.4688943964122394; … ; -0.46051412343868925 -0.45671990833675147 … -0.44514495661414805 -0.45671990833675136; -0.4763804457863294 -0.4688943964122394 … -0.45671990833675147 -0.47065601572326404;;; … ;;; -0.44947595085770803 -0.455149972215812 … -0.3712598626145754 -0.41774571521568266; -0.455149972215812 -0.4488035110107907 … -0.41743801070872566 -0.44412609930932506; … ; -0.37125986261457533 -0.41743801070872566 … -0.25365698327802366 -0.29979809105618094; -0.41774571521568266 -0.44412609930932506 … -0.2997980910561811 -0.3610634326576835;;; -0.47719190098965875 -0.4763804457863294 … -0.4122880708908735 -0.45507008158303747; -0.4763804457863294 -0.47065601572326404 … -0.44639843644982025 -0.4688943964122394; … ; -0.4122880708908734 -0.44639843644982025 … -0.25365698327802366 -0.34106330231461107; -0.4550700815830374 -0.4688943964122394 … -0.3410633023146111 -0.4090661824669095;;; -0.49665655724981006 -0.49204131119018524 … -0.45507008158303747 -0.48481820873962334; -0.4920413111901851 -0.48617902519746165 … -0.4688943964122394 -0.48617902519746165; … ; -0.4550700815830374 -0.4688943964122394 … -0.34106330231461107 -0.4090661824669095; -0.48481820873962334 -0.4861790251974617 … -0.4090661824669095 -0.4583744079489189])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417761169442 -0.4874266763817773 … -0.7026973955215718 -0.48742667638177717; -0.487426676381777 -0.7738703030963143 … -0.41393901831804597 -0.38179339119227; … ; -0.7026973955215721 -0.41393901831804614 … -2.396890218047309 -1.294138609191836; -0.4874266763817772 -0.38179339119227035 … -1.2941386091918363 -0.7738703030963141;;; -0.48742667638177734 -0.7738703030963141 … -0.41393901831804597 -0.3817933911922699; -0.7738703030963139 -1.4815303728711329 … -0.32444274391666317 -0.44995655433569687; … ; -0.4139390183180462 -0.3244427439166633 … -1.0113865017567303 -0.6391785259041551; -0.3817933911922701 -0.4499565543356971 … -0.6391785259041556 -0.4499565543356969;;; -0.7026973955215718 -1.2941386091918365 … -0.29832133492859353 -0.4139390183180458; -1.2941386091918363 -2.923470245897757 … -0.35179963882792037 -0.6391785259041554; … ; -0.2983213349285938 -0.35179963882792054 … -0.49060647082864983 -0.35179963882792026; -0.413939018318046 -0.6391785259041556 … -0.35179963882792015 -0.32444274391666295;;; … ;;; -1.0150481268624436 -0.5338983581044421 … -3.638038941473669 -1.9993625019688464; -0.5338983581044419 -0.3216988269941431 … -1.4639475299895164 -0.906137044202211; … ; -3.6380389414736687 -1.4639475299895164 … -10.993621243049976 -8.086551292429991; -1.9993625019688464 -0.906137044202211 … -8.086551292429991 -4.647852558430237;;; -0.7026973955215718 -0.41393901831804586 … -2.3968902180473095 -1.2941386091918368; -0.4139390183180458 -0.32444274391666306 … -1.0113865017567294 -0.6391785259041554; … ; -2.396890218047309 -1.0113865017567296 … -11.0030614333754 -6.073393711795891; -1.2941386091918363 -0.6391785259041555 … -6.073393711795893 -2.9234702458977573;;; -0.4874266763817774 -0.3817933911922699 … -1.2941386091918368 -0.7738703030963141; -0.38179339119226996 -0.44995655433569687 … -0.6391785259041554 -0.4499565543356968; … ; -1.2941386091918368 -0.6391785259041554 … -6.073393711795893 -2.9234702458977564; -0.7738703030963141 -0.44995655433569715 … -2.9234702458977573 -1.4815303728711324]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.09657974326047747 - 0.07187348002629357im 0.027831475000925955 - 0.057185331529891414im … 0.08926935924822232 - 0.07748066185656857im 0.17132497833354574 - 0.13478361597899782im; 0.025231104260003048 - 0.02500309385435644im -0.005985702330177273 - 0.0006861666158665403im … 0.03806137520873479 - 0.07435548796252481im 0.05856939637293855 - 0.09962809206897538im; … ; 0.07573340984865018 + 0.09004051580740323im 0.026638053223945315 + 0.06701977223346885im … -0.009534872131276536 + 0.0070957366052176495im 0.0841286785276506 + 0.018034855991978634im; 0.15384174277005874 + 0.08158925503957715im 0.04645687219689908 + 0.050276750062637154im … 0.083500231884077 + 0.025812525447295023im 0.2017679722544134 + 0.023129513034944354im;;; -0.18973312770089618 + 0.026496266805751987im -0.15978718297659095 - 0.028768018536685435im … 0.050032268525979834 - 0.061091012953396875im -0.03603159438988752 - 0.04324350179442432im; -0.1714195645650956 + 0.11519456761243468im -0.0959565196458772 + 0.047039605951847904im … -0.0005581650248421594 - 0.03145291808226119im -0.0762833573451957 + 0.027278879215903242im; … ; 0.0399933490581798 + 0.06315085466832199im -0.006427423842956816 + 0.04118514643453486im … 0.059330180777861515 - 0.008076220358779938im 0.09501882920299645 + 0.013756455956330514im; -0.04607235251117675 + 0.0810211212131933im -0.07509165314195505 + 0.012530324736300471im … 0.09820664690186562 - 0.025696039274312635im 0.10773238029519394 + 0.003394366700862411im;;; -0.17767955452107898 + 0.048829547679521884im -0.05234230548562881 - 0.035231275999533025im … -0.018583904986152415 - 0.006855160298485532im -0.10965808961338364 + 0.03306408587927778im; -0.06015810695559395 + 0.06149723958845884im 0.0728213959228859 - 0.02572106218471559im … -0.031528213867319764 + 0.011569115068108511im -0.07744567000188907 + 0.05607728425870809im; … ; -0.02154851318016071 + 0.029834889823814617im -0.03146258473090687 + 0.010756887473702627im … 0.034336796493399595 - 0.004444886490470944im 0.018819569003390546 + 0.013732327564766996im; -0.10999558118734357 + 0.0372408880820938im -0.07184232460719907 - 0.013269830774383751im … 0.020602417387441462 - 0.00833223963652551im -0.038474114962980296 + 0.02060111378103056im;;; … ;;; -0.03466401914933776 + 0.02059444421391541im -0.01884873352819783 + 0.011522152063067725im … -0.0012682749389253973 + 0.019137555172340406im -0.02790884990595536 + 0.025038317477487096im; -0.018240991261435715 + 0.0040007220740677606im -0.0038082525468580977 - 0.0008742104039026633im … -0.013559466415661248 + 0.015840237033277763im -0.023503608503095928 + 0.011096908751910071im; … ; 0.0018300272802647432 - 0.01920709387360164im -0.012324219889661859 + 0.0005528010208115588im … 0.0713959428876376 - 0.060271092693906125im 0.04182214532538292 - 0.047791350732380077im; -0.027072777173416076 + 0.014691064275969747im -0.023885538694345176 + 0.015823683371758386im … 0.039425778909055215 - 0.01813387389306794im 0.0007632645751215999 + 0.0012912090579300936im;;; -0.0496896807012272 + 0.02994478714014874im -0.004475927722729543 + 0.008507104623011148im … -0.05241424033738554 + 0.061202334715863574im -0.08294856087855415 + 0.05352445872049501im; -0.002610497294745136 - 0.014579499035359135im 0.01773871534958768 - 0.012863709200424393im … -0.02682070981731087 + 0.012764039755083003im -0.026622962011040682 - 0.00639043575600432im; … ; -0.047645452012981884 + 0.0021837141813511075im -0.02755610971749281 + 0.021865361364104753im … 0.027476377868157376 - 0.07240307996120895im -0.034280389425112634 - 0.045904589312257604im; -0.08440005834905476 + 0.07148821749601508im -0.030338905190253104 + 0.03959814859509052im … -0.04209619106742282 + 0.05082392593529389im -0.11076057295899777 + 0.08276288046897076im;;; 0.05654432652765793 - 0.023749790691146487im 0.054119413085108994 - 0.022208536582630133im … -0.0421758668383521 + 0.042722133534672635im -0.004885180617614216 - 0.01101094823693064im; 0.05670872051171383 - 0.05425385790142949im 0.047947768855972614 - 0.02705014462226888im … -0.0013318722097854865 - 0.03115373091085062im 0.026763683097738585 - 0.07081393214072604im; … ; -0.04336757133352874 + 0.05747068775942376im -0.00822681284647953 + 0.05417818891104149im … -0.11725735527562126 + 0.0022342188242133964im -0.10610915042350308 + 0.008907369828271722im; -0.01651756246853974 + 0.13295163757614936im 0.0161400012991093 + 0.060664963422894284im … -0.11614990846943318 + 0.13317199279105574im -0.07524935814398323 + 0.1300896170058772im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3915556370886795 0.3785174209521314 … 0.3446996003131316 0.3785174209521314; 0.3785174209521313 0.36645844069702604 … 0.32735728176314177 0.3636495426697784; … ; 0.34469960031313157 0.3273572817631419 … 0.30751926944479485 0.33438053202447515; 0.37851742095213137 0.3636495426697785 … 0.3343805320244751 0.3664584406970261;;; 0.37851742095213137 0.36645844069702616 … 0.3273572817631419 0.3636495426697785; 0.36645844069702604 0.35102886346229695 … 0.3111940134992437 0.35191706639545645; … ; 0.3273572817631418 0.3111940134992438 … 0.2982412284373232 0.32142600285172457; 0.3636495426697785 0.35191706639545656 … 0.3214260028517245 0.35191706639545656;;; 0.3446996003131316 0.3343805320244752 … 0.2865351537979721 0.32735728176314194; 0.3343805320244751 0.31861604779581565 … 0.2780589188544362 0.3214260028517245; … ; 0.28653515379797206 0.2780589188544363 … 0.25590185774453056 0.27805891885443623; 0.32735728176314194 0.3214260028517246 … 0.27805891885443623 0.31119401349924386;;; … ;;; 0.30487474931719366 0.2830366689900202 … 0.28556433233327255 0.3009573705418232; 0.28303666899002006 0.2589843162499771 … 0.27263300129757445 0.28541419664853873; … ; 0.28556433233327255 0.2726330012975745 … 0.2771603891585041 0.2812108738032786; 0.3009573705418232 0.28541419664853873 … 0.2812108738032786 0.29308272629366583;;; 0.3446996003131316 0.32735728176314194 … 0.30751926944479485 0.33438053202447526; 0.3273572817631418 0.3111940134992438 … 0.2982412284373232 0.3214260028517245; … ; 0.30751926944479485 0.29824122843732326 … 0.27716038915850416 0.2931311914942539; 0.3343805320244752 0.3214260028517246 … 0.2931311914942538 0.3186160477958157;;; 0.37851742095213137 0.36364954266977856 … 0.33438053202447515 0.36645844069702616; 0.36364954266977834 0.3519170663954565 … 0.3214260028517245 0.35191706639545645; … ; 0.33438053202447515 0.3214260028517246 … 0.2931311914942538 0.3186160477958157; 0.3664584406970261 0.35191706639545656 … 0.3186160477958157 0.35102886346229706]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923345847 -0.49665655724981006 … -0.47719190098965886 -0.49665655724981006; -0.49665655724981006 -0.48481820873962334 … -0.47638044578632943 -0.4920413111901851; … ; -0.47719190098965875 -0.4763804457863295 … -0.4122880708908734 -0.4550700815830374; -0.49665655724981006 -0.4920413111901851 … -0.4550700815830374 -0.48481820873962334;;; -0.49665655724981006 -0.48481820873962334 … -0.4763804457863295 -0.49204131119018524; -0.48481820873962334 -0.4583744079489188 … -0.47065601572326404 -0.48617902519746165; … ; -0.47638044578632943 -0.47065601572326404 … -0.44639843644982025 -0.4688943964122394; -0.49204131119018524 -0.48617902519746165 … -0.4688943964122394 -0.48617902519746165;;; -0.47719190098965875 -0.45507008158303747 … -0.46051412343868925 -0.4763804457863294; -0.4550700815830374 -0.4090661824669094 … -0.45671990833675147 -0.4688943964122394; … ; -0.46051412343868925 -0.45671990833675147 … -0.44514495661414805 -0.45671990833675136; -0.4763804457863294 -0.4688943964122394 … -0.45671990833675147 -0.47065601572326404;;; … ;;; -0.44947595085770803 -0.455149972215812 … -0.3712598626145754 -0.41774571521568266; -0.455149972215812 -0.4488035110107907 … -0.41743801070872566 -0.44412609930932506; … ; -0.37125986261457533 -0.41743801070872566 … -0.25365698327802366 -0.29979809105618094; -0.41774571521568266 -0.44412609930932506 … -0.2997980910561811 -0.3610634326576835;;; -0.47719190098965875 -0.4763804457863294 … -0.4122880708908735 -0.45507008158303747; -0.4763804457863294 -0.47065601572326404 … -0.44639843644982025 -0.4688943964122394; … ; -0.4122880708908734 -0.44639843644982025 … -0.25365698327802366 -0.34106330231461107; -0.4550700815830374 -0.4688943964122394 … -0.3410633023146111 -0.4090661824669095;;; -0.49665655724981006 -0.49204131119018524 … -0.45507008158303747 -0.48481820873962334; -0.4920413111901851 -0.48617902519746165 … -0.4688943964122394 -0.48617902519746165; … ; -0.4550700815830374 -0.4688943964122394 … -0.34106330231461107 -0.4090661824669095; -0.48481820873962334 -0.4861790251974617 … -0.4090661824669095 -0.4583744079489189])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417761169442 -0.4874266763817773 … -0.7026973955215718 -0.48742667638177717; -0.487426676381777 -0.7738703030963143 … -0.41393901831804597 -0.38179339119227; … ; -0.7026973955215721 -0.41393901831804614 … -2.396890218047309 -1.294138609191836; -0.4874266763817772 -0.38179339119227035 … -1.2941386091918363 -0.7738703030963141;;; -0.48742667638177734 -0.7738703030963141 … -0.41393901831804597 -0.3817933911922699; -0.7738703030963139 -1.4815303728711329 … -0.32444274391666317 -0.44995655433569687; … ; -0.4139390183180462 -0.3244427439166633 … -1.0113865017567303 -0.6391785259041551; -0.3817933911922701 -0.4499565543356971 … -0.6391785259041556 -0.4499565543356969;;; -0.7026973955215718 -1.2941386091918365 … -0.29832133492859353 -0.4139390183180458; -1.2941386091918363 -2.923470245897757 … -0.35179963882792037 -0.6391785259041554; … ; -0.2983213349285938 -0.35179963882792054 … -0.49060647082864983 -0.35179963882792026; -0.413939018318046 -0.6391785259041556 … -0.35179963882792015 -0.32444274391666295;;; … ;;; -1.0150481268624436 -0.5338983581044421 … -3.638038941473669 -1.9993625019688464; -0.5338983581044419 -0.3216988269941431 … -1.4639475299895164 -0.906137044202211; … ; -3.6380389414736687 -1.4639475299895164 … -10.993621243049976 -8.086551292429991; -1.9993625019688464 -0.906137044202211 … -8.086551292429991 -4.647852558430237;;; -0.7026973955215718 -0.41393901831804586 … -2.3968902180473095 -1.2941386091918368; -0.4139390183180458 -0.32444274391666306 … -1.0113865017567294 -0.6391785259041554; … ; -2.396890218047309 -1.0113865017567296 … -11.0030614333754 -6.073393711795891; -1.2941386091918363 -0.6391785259041555 … -6.073393711795893 -2.9234702458977573;;; -0.4874266763817774 -0.3817933911922699 … -1.2941386091918368 -0.7738703030963141; -0.38179339119226996 -0.44995655433569687 … -0.6391785259041554 -0.4499565543356968; … ; -1.2941386091918368 -0.6391785259041554 … -6.073393711795893 -2.9234702458977564; -0.7738703030963141 -0.44995655433569715 … -2.9234702458977573 -1.4815303728711324]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.2683631488120103 + 0.037075581786976224im -0.17970753685847718 + 0.06914461877174966im … 0.07036543605036794 - 0.12650380245568582im -0.022116319039551184 - 0.16408032422551658im; -0.19307166719475466 + 0.1573521236452794im -0.02040840919533201 + 0.0754317689687842im … 0.05254049530157122 - 0.07718330847738192im -0.024365748633966178 - 0.027010927950982005im; … ; 0.00887923311611243 - 0.007842969611419962im -0.037029897542636456 + 0.009021272340361255im … 0.02196616461876765 + 0.02479562418919174im 0.07009822373854474 - 0.018216812946032036im; -0.13575595274316482 - 0.013493716434734335im -0.1277565508643182 + 0.028672307945184054im … 0.052635946947013526 - 0.023183826241046538im 0.08363090391464367 - 0.12018428770447964im;;; -0.16665807938192403 + 0.12036954873330788im 6.0572732970398625e-5 + 0.06372999278310731im … 0.03322307105053118 - 0.08391142853339605im -0.03514501097102697 - 0.056459029795718214im; -0.05441787395207474 + 0.22567026850503674im 0.15908098860712147 + 0.05543365383532256im … 0.030025103880279805 - 0.03099942837119227im -0.023479900581003764 + 0.08599003667166022im; … ; -0.02686551675836813 - 0.00490247124126484im -0.03659799206455582 + 0.006636562196183073im … 0.013012142973120575 - 0.006085395692858517im 0.012349507596142765 - 0.021863216604907573im; -0.10564435997984607 + 0.010378878383219112im -0.06267122870310499 + 0.02350065884122317im … 0.022546472980975563 - 0.04981613152761662im -0.008328286807532963 - 0.06729042196688936im;;; -0.012189955778373368 + 0.07840241906757096im 0.05920256585108891 + 0.02265790958551326im … 0.010994146780296237 - 0.01851159881369754im -0.010514259110335855 + 0.028381958118411533im; 0.019884726371012268 + 0.10904870363426741im 0.10704752332647433 - 0.019243288034007083im … 0.007838427158314355 + 0.01258314473862734im -0.008877945832358378 + 0.08032028143645824im; … ; -0.017533848776706946 + 0.00023412435407422529im -0.01305317630235086 + 0.004355561868988088im … 0.004314895347011996 - 0.011468371606716534im -0.003587431178578763 - 0.011499333969170928im; -0.02728296681700567 + 0.019389450204417194im 0.0015930187775172596 + 0.013656358314423226im … 0.007015109094026473 - 0.025013319044219964im -0.010239649423597126 - 0.011081121264937535im;;; … ;;; 0.02328107774864755 - 0.005464977495130106im 0.0029227924216871865 + 0.0068646896819481405im … -0.0206205021864449 - 0.0014813550960277723im 0.017911811021539874 - 0.013807042171450732im; 0.009198525003083567 + 0.003365132472882992im -0.004612583270918338 + 0.009601257377909182im … -0.004297465788205106 - 0.002816912142618265im 0.013727601772716735 - 0.005862212332702208im; … ; 0.017004969035426823 - 0.013978691247264662im 0.017579300725471418 - 0.0063454448239074505im … -0.047953951407627635 - 0.002945675967350728im -0.018530460984177342 - 0.010554087160114984im; 0.03211767043998165 - 0.014140755985404992im 0.015665951114008394 - 0.0007978985938329557im … -0.0424630936668712 - 0.00024247056337538676im 0.0074305790278953515 - 0.01587858293523018im;;; 0.027577337129339907 + 0.003631443127222704im -0.0294058817470926 + 0.023380982780520705im … 0.0031883093617987935 + 0.009103102322342273im 0.09433807481018776 - 0.030939440718804122im; -0.0048139412625555055 + 0.017664147877966253im -0.02752140604151298 + 0.021412261113013347im … 0.014729789650002354 - 0.007413431361716186im 0.040706270146771764 - 0.012908599662233164im; … ; 0.06032408103939104 - 0.014272329690384182im 0.024336736216159015 - 0.0007858542357324135im … -0.06106397567102748 + 0.014728185431140758im 0.03424728202001076 - 0.009854427279602736im; 0.07720643048163905 - 0.011193188468726242im 0.0026147469160121197 + 0.011735291982993406im … -0.03604066941156913 + 0.03618776962528806im 0.10704752365651028 - 0.019243288345897332im;;; -0.10832547475350969 + 0.01069183551658012im -0.12462824066055136 + 0.04607261678357566im … 0.06854840834691993 - 0.0272737147433457im 0.13192441627497942 - 0.12469290457662235im; -0.0989004093810398 + 0.06341469336550395im -0.06655562979720034 + 0.042189379993819956im … 0.04718077710682058 - 0.040443340719710535im 0.04480474768183197 - 0.04239963729822245im; … ; 0.07430045899549233 - 0.008349821570045508im 0.0015518179933397113 + 0.007102613342335193im … -0.00451824297528671 + 0.05055365774888321im 0.11195204645464421 - 0.002161075039347775im; 0.04005450612431114 - 0.011467115229990194im -0.06370267297611688 + 0.02543999405584705im … 0.0431407199054462 + 0.06687602890234198im 0.21741359364519564 - 0.054244059772964565im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729848), converged = true, ρ = [0.09132316919060861 0.0874741913545487 … 0.07684754937256223 0.0874741913545487; 0.0874741913545487 0.08089966873725639 … 0.07642471017988288 0.08486944835586122; … ; 0.07684754937256222 0.0764247101798829 … 0.04778466667742261 0.06587895343568595; 0.08747419135454869 0.08486944835586122 … 0.06587895343568595 0.08089966873725639;;; 0.08747419135454869 0.08089966873725637 … 0.0764247101798829 0.08486944835586123; 0.08089966873725637 0.06744471471401513 … 0.07348669935592785 0.08163768630202742; … ; 0.07642471017988288 0.07348669935592785 … 0.06188804120609413 0.07259829029487336; 0.08486944835586123 0.08163768630202742 … 0.07259829029487336 0.08163768630202743;;; 0.07684754937256222 0.06587895343568596 … 0.06847203699746857 0.07642471017988287; 0.06587895343568595 0.04657864266011722 … 0.06665759372371693 0.07259829029487334; … ; 0.06847203699746857 0.06665759372371693 … 0.06132515314858073 0.06665759372371692; 0.07642471017988287 0.07259829029487336 … 0.06665759372371693 0.07348669935592786;;; … ;;; 0.06328495230654119 0.06591651446626136 … 0.03394064887952205 0.049875934865012655; 0.06591651446626136 0.06297790960701634 … 0.04975639788345451 0.06087020457616038; … ; 0.033940648879522035 0.04975639788345451 … 0.009696353213307644 0.016831338791958073; 0.04987593486501265 0.06087020457616038 … 0.01683133879195809 0.030985721887761494;;; 0.07684754937256222 0.07642471017988287 … 0.04778466667742263 0.06587895343568596; 0.07642471017988287 0.07348669935592785 … 0.06188804120609413 0.07259829029487336; … ; 0.04778466667742261 0.06188804120609413 … 0.009696353213307647 0.025710010678707217; 0.06587895343568595 0.07259829029487334 … 0.02571001067870723 0.04657864266011724;;; 0.08747419135454869 0.08486944835586123 … 0.06587895343568596 0.08089966873725637; 0.08486944835586122 0.08163768630202742 … 0.07259829029487336 0.08163768630202742; … ; 0.06587895343568595 0.07259829029487336 … 0.02571001067870722 0.046578642660117235; 0.08089966873725637 0.0816376863020274 … 0.04657864266011725 0.06744471471401514;;;;], ψ = Matrix{ComplexF64}[[-0.5729407045370597 - 0.7646735344882762im -6.498823423850553e-10 - 1.0112671811057794e-10im 3.5592920494612046e-10 - 9.42478456389395e-10im -7.858627637524762e-11 - 3.6491126786941663e-10im; -0.05773764086854538 - 0.07705936344727654im -0.28311569351336774 + 0.27535889391223123im 0.304724993185851 - 0.021847472293143377im 0.023904504197126197 + 0.04827016434614474im; … ; -0.00707209649988458 - 0.009438751727889046im 0.017639005316916548 - 0.03865493546036052im -0.009437439139050941 - 0.024293486296907762im -0.018664585521981567 + 0.02599142952357511im; 0.05773764141057022 + 0.07705936355066527im -0.11042590673403017 - 0.10308149617812139im 0.2123303693442832 - 0.2596860909412666im -0.15882593127774347 + 0.3027320265015951im], [-0.03363476646354524 + 0.9281293291028732im 0.019497163026949746 + 0.19615817626084162im 5.675898917534283e-10 + 5.577852069116318e-11im -1.3400270754138077e-9 - 3.917382807028247e-10im; -0.0022929471201598474 + 0.06327236558922504im -0.0008677641845634453 - 0.008730447687717283im 6.777654670137023e-10 + 6.832245186272345e-11im -1.304088425788108e-9 - 7.543213566794937e-10im; … ; -0.0002806985345173568 + 0.007745682148632332im 0.008531646121519205 + 0.08583567258175655im 0.012486823841873773 - 0.09465114687153384im -0.017636941699454813 + 0.01489870147617977im; 0.004089895711219746 - 0.11285799080513997im -0.008971678744349038 - 0.09026278290222889im 0.07819855171422446 - 0.5927514131413398im -0.1104510878364661 + 0.09330289972763856im], [-0.7490853175492116 + 0.557460258620488im 1.0985170550981138e-9 + 5.196753201375248e-10im -2.1940055328073527e-10 + 1.6142640002492215e-10im -3.7086731602409273e-10 + 1.0201265804310466e-9im; -0.05515234711303321 + 0.04104371133028373im 0.05681820070590564 + 0.0065133098253892935im 0.0022871241125803684 - 0.03508328135639266im 0.0011430143657333173 - 0.012205585537297274im; … ; -0.011127191539747998 + 0.008280721858526017im 4.912230032461107e-10 + 3.999243839737654e-10im -0.03199567013763322 + 0.10542409036651146im 0.0735814927152534 - 0.014619341142775103im; 0.12290905103105844 - 0.0914674330619378im 0.28525904522806167 + 0.03270044676686948im -0.18234634615526155 + 0.11563015788143896im 0.5321203202256405 - 0.31670031506682067im], [0.8027969743961748 - 0.10009243744446061im -1.123404563818653e-10 - 8.247626193114144e-11im 0.45837596138455866 - 0.1875146354170829im -1.1361865615011624e-10 + 3.198822179362182e-10im; 0.38449680463853486 - 0.047938923552290014im -0.2942272557162521 + 0.5532098775287968im -0.4986439379192284 + 0.2039876525222259im -1.6546039538489765e-10 - 7.320112571651549e-11im; … ; 0.011306148040686862 - 0.0014096464993790098im -0.0007718070039876772 + 0.0014511616446324276im -0.01932071261649422 + 0.007903809699675739im -0.005601524605631789 - 0.00729779894862942im; -0.06467896278320463 + 0.008064149428694899im -0.005862658286239829 + 0.011023045662090161im -0.1167772994795307 + 0.047771817533027214im -0.10880289070952641 - 0.14175098844966688im]], eigenvalues = Any[[-0.16677707595604097, 0.26427771784054577, 0.2642777178405461, 0.2642777178405461], [-0.1161321876031016, 0.07040532320728232, 0.2262481360398139, 0.2262481360398141], [-0.09588938142865197, 0.08764319968950324, 0.1731270414352994, 0.17312704143529958], [-0.04505146347693806, 0.022269526248658966, 0.09831189251986895, 0.18446409322947568]], occupation = [[2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0]], εF = nothing, optim_res =  * Status: success

 * Candidate solution
    Final objective value:     -7.852647e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 7.71e-09 ≰ 1.0e-12
    |x - x&#39;|/|x&#39;|          = 1.11e-08 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 0.00e+00 ≰ -1.0e+00
    |g(x)|                 = 4.50e-09 ≰ -1.0e+00

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    44
    f(x) calls:    51
    ∇f(x) calls:   46
)</code></pre><p>Start not too far from the solution to ensure convergence: We run first a very crude SCF to get close and then switch to Newton.</p><pre><code class="language-julia hljs">scfres_start = self_consistent_field(basis; tol=1e-1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39294758274386404 0.37965251754343554 … 0.34515127203704427 0.37965251754343554; 0.37965251754343554 0.36708498216240953 … 0.3281349928932497 0.3648352780451142; … ; 0.3451512720370442 0.32813499289324977 … 0.30664090780433995 0.3342088533615312; 0.3796525175434355 0.36483527804511423 … 0.3342088533615312 0.3670849821624096;;; 0.37965251754343554 0.36708498216240953 … 0.32813499289324977 0.3648352780451142; 0.36708498216240953 0.3510283521250433 … 0.312047585925308 0.35285535399830553; … ; 0.3281349928932497 0.31204758592530807 … 0.2977659148199179 0.3217064897305462; 0.3648352780451142 0.3528553539983056 … 0.3217064897305462 0.35285535399830564;;; 0.3451512720370442 0.3342088533615312 … 0.28725666185842375 0.3281349928932497; 0.3342088533615312 0.3178909610702747 … 0.278560325760289 0.3217064897305462; … ; 0.2872566618584237 0.27856032576028905 … 0.25581958535872573 0.278560325760289; 0.3281349928932497 0.3217064897305462 … 0.278560325760289 0.31204758592530807;;; … ;;; 0.3044896754824695 0.28311254475075753 … 0.2842069767740178 0.3000375484866681; 0.28311254475075753 0.25940947946295373 … 0.27145922828968166 0.28489038845306036; … ; 0.28420697677401774 0.27145922828968166 … 0.27578986744371026 0.27982834249328087; 0.3000375484866681 0.28489038845306036 … 0.27982834249328087 0.2918616839169406;;; 0.34515127203704427 0.32813499289324977 … 0.30664090780433995 0.3342088533615312; 0.3281349928932497 0.312047585925308 … 0.29776591481991777 0.3217064897305463; … ; 0.3066409078043399 0.2977659148199178 … 0.2757898674437103 0.2919361566498494; 0.3342088533615312 0.3217064897305463 … 0.2919361566498495 0.3178909610702748;;; 0.37965251754343554 0.3648352780451142 … 0.3342088533615313 0.36708498216240953; 0.3648352780451142 0.3528553539983056 … 0.3217064897305462 0.3528553539983056; … ; 0.3342088533615312 0.3217064897305462 … 0.2919361566498495 0.3178909610702747; 0.3670849821624095 0.3528553539983056 … 0.3178909610702747 0.35102835212504335]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5045188622000666 -0.49776016330507167 … -0.4779341345698165 -0.49776016330507167; -0.49776016330507167 -0.48575109270988753 … -0.4771927853528062 -0.4931073223734762; … ; -0.4779341345698165 -0.47719278535280624 … -0.41219690200391246 -0.45554774634508605; -0.49776016330507167 -0.4931073223734762 … -0.45554774634508605 -0.48575109270988753;;; -0.49776016330507167 -0.48575109270988753 … -0.4771927853528062 -0.4931073223734762; -0.48575109270988753 -0.45911510923853605 … -0.47147687025966023 -0.4871288552966166; … ; -0.47719278535280624 -0.47147687025966023 … -0.44642055977850614 -0.469459547220373; -0.4931073223734762 -0.4871288552966166 … -0.469459547220373 -0.48712885529661665;;; -0.4779341345698165 -0.455547746345086 … -0.46123206346538 -0.4771927853528062; -0.455547746345086 -0.40931538715931787 … -0.45730346571000213 -0.4694595472203729; … ; -0.46123206346538 -0.4573034657100022 … -0.44530249343287204 -0.4573034657100022; -0.4771927853528062 -0.4694595472203729 … -0.45730346571000213 -0.47147687025966023;;; … ;;; -0.44957757692801376 -0.4554502259668284 … -0.37043410142174404 -0.4174981055427963; -0.4554502259668284 -0.44929205583854104 … -0.41668671688049436 -0.44402771547231595; … ; -0.37043410142174416 -0.41668671688049447 … -0.25282288628740923 -0.29898071768232404; -0.4174981055427963 -0.44402771547231595 … -0.298980717682324 -0.3606071118484118;;; -0.4779341345698165 -0.4771927853528062 … -0.41219690200391246 -0.455547746345086; -0.4771927853528062 -0.4714768702596602 … -0.44642055977850614 -0.4694595472203729; … ; -0.41219690200391246 -0.44642055977850614 … -0.25282288628740923 -0.34077314533787617; -0.455547746345086 -0.4694595472203729 … -0.34077314533787617 -0.40931538715931787;;; -0.49776016330507167 -0.4931073223734762 … -0.455547746345086 -0.48575109270988753; -0.4931073223734762 -0.48712885529661665 … -0.4694595472203729 -0.4871288552966166; … ; -0.45554774634508605 -0.469459547220373 … -0.34077314533787617 -0.40931538715931787; -0.48575109270988753 -0.4871288552966166 … -0.40931538715931787 -0.45911510923853616])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41256050032724156 -0.48739518584573477 … -0.7029879573778168 -0.48739518584573466; -0.4873951858457344 -0.774176645601195 … -0.4139736467544148 -0.3816736670002253; … ; -0.7029879573778172 -0.413973646754415 … -2.397677410800803 -1.2947879526168287; -0.4873951858457347 -0.3816736670002257 … -1.2947879526168289 -0.7741766456011949;;; -0.48739518584573477 -0.7741766456011949 … -0.4139736467544148 -0.3816736670002252; -0.7741766456011946 -1.4822715854980038 … -0.324410026026995 -0.44996809683200273; … ; -0.4139736467544151 -0.3244100260269952 … -1.0118839387028216 -0.6394631898334671; -0.3816736670002254 -0.449968096832003 … -0.6394631898334675 -0.44996809683200284;;; -0.7029879573778169 -1.2947879526168289 … -0.29831776689483264 -0.41397364675441484; -1.2947879526168284 -2.9244445373157064 … -0.3518817892953182 -0.6394631898334672; … ; -0.2983177668948329 -0.35188178929531855 … -0.49084628003317865 -0.3518817892953183; -0.41397364675441506 -0.6394631898334675 … -0.35188178929531805 -0.324410026026995;;; … ;;; -1.0155348267674735 -0.5341227360947212 … -3.638570535840092 -2.000034714351115; -0.5341227360947208 -0.3217622086089168 … -1.4643700091691778 -0.9065624685606801; … ; -3.6385705358400924 -1.4643700091691778 … -10.994157667774155 -8.087116450366132; -2.000034714351115 -0.9065624685606801 … -8.087116450366132 -4.648617279997691;;; -0.7029879573778168 -0.41397364675441484 … -2.397677410800803 -1.2947879526168293; -0.4139736467544147 -0.324410026026995 … -1.011883938702821 -0.6394631898334671; … ; -2.397677410800803 -1.011883938702821 … -11.00359785809958 -6.074298589663561; -1.2947879526168289 -0.6394631898334673 … -6.074298589663563 -2.9244445373157064;;; -0.4873951858457348 -0.38167366700022526 … -1.2947879526168293 -0.7741766456011949; -0.3816736670002252 -0.4499680968320028 … -0.6394631898334672 -0.4499680968320026; … ; -1.2947879526168293 -0.6394631898334673 … -6.074298589663563 -2.924444537315706; -0.7741766456011949 -0.449968096832003 … -2.9244445373157064 -1.4822715854980033]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39294758274386404 0.37965251754343554 … 0.34515127203704427 0.37965251754343554; 0.37965251754343554 0.36708498216240953 … 0.3281349928932497 0.3648352780451142; … ; 0.3451512720370442 0.32813499289324977 … 0.30664090780433995 0.3342088533615312; 0.3796525175434355 0.36483527804511423 … 0.3342088533615312 0.3670849821624096;;; 0.37965251754343554 0.36708498216240953 … 0.32813499289324977 0.3648352780451142; 0.36708498216240953 0.3510283521250433 … 0.312047585925308 0.35285535399830553; … ; 0.3281349928932497 0.31204758592530807 … 0.2977659148199179 0.3217064897305462; 0.3648352780451142 0.3528553539983056 … 0.3217064897305462 0.35285535399830564;;; 0.3451512720370442 0.3342088533615312 … 0.28725666185842375 0.3281349928932497; 0.3342088533615312 0.3178909610702747 … 0.278560325760289 0.3217064897305462; … ; 0.2872566618584237 0.27856032576028905 … 0.25581958535872573 0.278560325760289; 0.3281349928932497 0.3217064897305462 … 0.278560325760289 0.31204758592530807;;; … ;;; 0.3044896754824695 0.28311254475075753 … 0.2842069767740178 0.3000375484866681; 0.28311254475075753 0.25940947946295373 … 0.27145922828968166 0.28489038845306036; … ; 0.28420697677401774 0.27145922828968166 … 0.27578986744371026 0.27982834249328087; 0.3000375484866681 0.28489038845306036 … 0.27982834249328087 0.2918616839169406;;; 0.34515127203704427 0.32813499289324977 … 0.30664090780433995 0.3342088533615312; 0.3281349928932497 0.312047585925308 … 0.29776591481991777 0.3217064897305463; … ; 0.3066409078043399 0.2977659148199178 … 0.2757898674437103 0.2919361566498494; 0.3342088533615312 0.3217064897305463 … 0.2919361566498495 0.3178909610702748;;; 0.37965251754343554 0.3648352780451142 … 0.3342088533615313 0.36708498216240953; 0.3648352780451142 0.3528553539983056 … 0.3217064897305462 0.3528553539983056; … ; 0.3342088533615312 0.3217064897305462 … 0.2919361566498495 0.3178909610702747; 0.3670849821624095 0.3528553539983056 … 0.3178909610702747 0.35102835212504335]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5045188622000666 -0.49776016330507167 … -0.4779341345698165 -0.49776016330507167; -0.49776016330507167 -0.48575109270988753 … -0.4771927853528062 -0.4931073223734762; … ; -0.4779341345698165 -0.47719278535280624 … -0.41219690200391246 -0.45554774634508605; -0.49776016330507167 -0.4931073223734762 … -0.45554774634508605 -0.48575109270988753;;; -0.49776016330507167 -0.48575109270988753 … -0.4771927853528062 -0.4931073223734762; -0.48575109270988753 -0.45911510923853605 … -0.47147687025966023 -0.4871288552966166; … ; -0.47719278535280624 -0.47147687025966023 … -0.44642055977850614 -0.469459547220373; -0.4931073223734762 -0.4871288552966166 … -0.469459547220373 -0.48712885529661665;;; -0.4779341345698165 -0.455547746345086 … -0.46123206346538 -0.4771927853528062; -0.455547746345086 -0.40931538715931787 … -0.45730346571000213 -0.4694595472203729; … ; -0.46123206346538 -0.4573034657100022 … -0.44530249343287204 -0.4573034657100022; -0.4771927853528062 -0.4694595472203729 … -0.45730346571000213 -0.47147687025966023;;; … ;;; -0.44957757692801376 -0.4554502259668284 … -0.37043410142174404 -0.4174981055427963; -0.4554502259668284 -0.44929205583854104 … -0.41668671688049436 -0.44402771547231595; … ; -0.37043410142174416 -0.41668671688049447 … -0.25282288628740923 -0.29898071768232404; -0.4174981055427963 -0.44402771547231595 … -0.298980717682324 -0.3606071118484118;;; -0.4779341345698165 -0.4771927853528062 … -0.41219690200391246 -0.455547746345086; -0.4771927853528062 -0.4714768702596602 … -0.44642055977850614 -0.4694595472203729; … ; -0.41219690200391246 -0.44642055977850614 … -0.25282288628740923 -0.34077314533787617; -0.455547746345086 -0.4694595472203729 … -0.34077314533787617 -0.40931538715931787;;; -0.49776016330507167 -0.4931073223734762 … -0.455547746345086 -0.48575109270988753; -0.4931073223734762 -0.48712885529661665 … -0.4694595472203729 -0.4871288552966166; … ; -0.45554774634508605 -0.469459547220373 … -0.34077314533787617 -0.40931538715931787; -0.48575109270988753 -0.4871288552966166 … -0.40931538715931787 -0.45911510923853616])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41256050032724156 -0.48739518584573477 … -0.7029879573778168 -0.48739518584573466; -0.4873951858457344 -0.774176645601195 … -0.4139736467544148 -0.3816736670002253; … ; -0.7029879573778172 -0.413973646754415 … -2.397677410800803 -1.2947879526168287; -0.4873951858457347 -0.3816736670002257 … -1.2947879526168289 -0.7741766456011949;;; -0.48739518584573477 -0.7741766456011949 … -0.4139736467544148 -0.3816736670002252; -0.7741766456011946 -1.4822715854980038 … -0.324410026026995 -0.44996809683200273; … ; -0.4139736467544151 -0.3244100260269952 … -1.0118839387028216 -0.6394631898334671; -0.3816736670002254 -0.449968096832003 … -0.6394631898334675 -0.44996809683200284;;; -0.7029879573778169 -1.2947879526168289 … -0.29831776689483264 -0.41397364675441484; -1.2947879526168284 -2.9244445373157064 … -0.3518817892953182 -0.6394631898334672; … ; -0.2983177668948329 -0.35188178929531855 … -0.49084628003317865 -0.3518817892953183; -0.41397364675441506 -0.6394631898334675 … -0.35188178929531805 -0.324410026026995;;; … ;;; -1.0155348267674735 -0.5341227360947212 … -3.638570535840092 -2.000034714351115; -0.5341227360947208 -0.3217622086089168 … -1.4643700091691778 -0.9065624685606801; … ; -3.6385705358400924 -1.4643700091691778 … -10.994157667774155 -8.087116450366132; -2.000034714351115 -0.9065624685606801 … -8.087116450366132 -4.648617279997691;;; -0.7029879573778168 -0.41397364675441484 … -2.397677410800803 -1.2947879526168293; -0.4139736467544147 -0.324410026026995 … -1.011883938702821 -0.6394631898334671; … ; -2.397677410800803 -1.011883938702821 … -11.00359785809958 -6.074298589663561; -1.2947879526168289 -0.6394631898334673 … -6.074298589663563 -2.9244445373157064;;; -0.4873951858457348 -0.38167366700022526 … -1.2947879526168293 -0.7741766456011949; -0.3816736670002252 -0.4499680968320028 … -0.6394631898334672 -0.4499680968320026; … ; -1.2947879526168293 -0.6394631898334673 … -6.074298589663563 -2.924444537315706; -0.7741766456011949 -0.449968096832003 … -2.9244445373157064 -1.4822715854980033]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39294758274386404 0.37965251754343554 … 0.34515127203704427 0.37965251754343554; 0.37965251754343554 0.36708498216240953 … 0.3281349928932497 0.3648352780451142; … ; 0.3451512720370442 0.32813499289324977 … 0.30664090780433995 0.3342088533615312; 0.3796525175434355 0.36483527804511423 … 0.3342088533615312 0.3670849821624096;;; 0.37965251754343554 0.36708498216240953 … 0.32813499289324977 0.3648352780451142; 0.36708498216240953 0.3510283521250433 … 0.312047585925308 0.35285535399830553; … ; 0.3281349928932497 0.31204758592530807 … 0.2977659148199179 0.3217064897305462; 0.3648352780451142 0.3528553539983056 … 0.3217064897305462 0.35285535399830564;;; 0.3451512720370442 0.3342088533615312 … 0.28725666185842375 0.3281349928932497; 0.3342088533615312 0.3178909610702747 … 0.278560325760289 0.3217064897305462; … ; 0.2872566618584237 0.27856032576028905 … 0.25581958535872573 0.278560325760289; 0.3281349928932497 0.3217064897305462 … 0.278560325760289 0.31204758592530807;;; … ;;; 0.3044896754824695 0.28311254475075753 … 0.2842069767740178 0.3000375484866681; 0.28311254475075753 0.25940947946295373 … 0.27145922828968166 0.28489038845306036; … ; 0.28420697677401774 0.27145922828968166 … 0.27578986744371026 0.27982834249328087; 0.3000375484866681 0.28489038845306036 … 0.27982834249328087 0.2918616839169406;;; 0.34515127203704427 0.32813499289324977 … 0.30664090780433995 0.3342088533615312; 0.3281349928932497 0.312047585925308 … 0.29776591481991777 0.3217064897305463; … ; 0.3066409078043399 0.2977659148199178 … 0.2757898674437103 0.2919361566498494; 0.3342088533615312 0.3217064897305463 … 0.2919361566498495 0.3178909610702748;;; 0.37965251754343554 0.3648352780451142 … 0.3342088533615313 0.36708498216240953; 0.3648352780451142 0.3528553539983056 … 0.3217064897305462 0.3528553539983056; … ; 0.3342088533615312 0.3217064897305462 … 0.2919361566498495 0.3178909610702747; 0.3670849821624095 0.3528553539983056 … 0.3178909610702747 0.35102835212504335]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5045188622000666 -0.49776016330507167 … -0.4779341345698165 -0.49776016330507167; -0.49776016330507167 -0.48575109270988753 … -0.4771927853528062 -0.4931073223734762; … ; -0.4779341345698165 -0.47719278535280624 … -0.41219690200391246 -0.45554774634508605; -0.49776016330507167 -0.4931073223734762 … -0.45554774634508605 -0.48575109270988753;;; -0.49776016330507167 -0.48575109270988753 … -0.4771927853528062 -0.4931073223734762; -0.48575109270988753 -0.45911510923853605 … -0.47147687025966023 -0.4871288552966166; … ; -0.47719278535280624 -0.47147687025966023 … -0.44642055977850614 -0.469459547220373; -0.4931073223734762 -0.4871288552966166 … -0.469459547220373 -0.48712885529661665;;; -0.4779341345698165 -0.455547746345086 … -0.46123206346538 -0.4771927853528062; -0.455547746345086 -0.40931538715931787 … -0.45730346571000213 -0.4694595472203729; … ; -0.46123206346538 -0.4573034657100022 … -0.44530249343287204 -0.4573034657100022; -0.4771927853528062 -0.4694595472203729 … -0.45730346571000213 -0.47147687025966023;;; … ;;; -0.44957757692801376 -0.4554502259668284 … -0.37043410142174404 -0.4174981055427963; -0.4554502259668284 -0.44929205583854104 … -0.41668671688049436 -0.44402771547231595; … ; -0.37043410142174416 -0.41668671688049447 … -0.25282288628740923 -0.29898071768232404; -0.4174981055427963 -0.44402771547231595 … -0.298980717682324 -0.3606071118484118;;; -0.4779341345698165 -0.4771927853528062 … -0.41219690200391246 -0.455547746345086; -0.4771927853528062 -0.4714768702596602 … -0.44642055977850614 -0.4694595472203729; … ; -0.41219690200391246 -0.44642055977850614 … -0.25282288628740923 -0.34077314533787617; -0.455547746345086 -0.4694595472203729 … -0.34077314533787617 -0.40931538715931787;;; -0.49776016330507167 -0.4931073223734762 … -0.455547746345086 -0.48575109270988753; -0.4931073223734762 -0.48712885529661665 … -0.4694595472203729 -0.4871288552966166; … ; -0.45554774634508605 -0.469459547220373 … -0.34077314533787617 -0.40931538715931787; -0.48575109270988753 -0.4871288552966166 … -0.40931538715931787 -0.45911510923853616])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41256050032724156 -0.48739518584573477 … -0.7029879573778168 -0.48739518584573466; -0.4873951858457344 -0.774176645601195 … -0.4139736467544148 -0.3816736670002253; … ; -0.7029879573778172 -0.413973646754415 … -2.397677410800803 -1.2947879526168287; -0.4873951858457347 -0.3816736670002257 … -1.2947879526168289 -0.7741766456011949;;; -0.48739518584573477 -0.7741766456011949 … -0.4139736467544148 -0.3816736670002252; -0.7741766456011946 -1.4822715854980038 … -0.324410026026995 -0.44996809683200273; … ; -0.4139736467544151 -0.3244100260269952 … -1.0118839387028216 -0.6394631898334671; -0.3816736670002254 -0.449968096832003 … -0.6394631898334675 -0.44996809683200284;;; -0.7029879573778169 -1.2947879526168289 … -0.29831776689483264 -0.41397364675441484; -1.2947879526168284 -2.9244445373157064 … -0.3518817892953182 -0.6394631898334672; … ; -0.2983177668948329 -0.35188178929531855 … -0.49084628003317865 -0.3518817892953183; -0.41397364675441506 -0.6394631898334675 … -0.35188178929531805 -0.324410026026995;;; … ;;; -1.0155348267674735 -0.5341227360947212 … -3.638570535840092 -2.000034714351115; -0.5341227360947208 -0.3217622086089168 … -1.4643700091691778 -0.9065624685606801; … ; -3.6385705358400924 -1.4643700091691778 … -10.994157667774155 -8.087116450366132; -2.000034714351115 -0.9065624685606801 … -8.087116450366132 -4.648617279997691;;; -0.7029879573778168 -0.41397364675441484 … -2.397677410800803 -1.2947879526168293; -0.4139736467544147 -0.324410026026995 … -1.011883938702821 -0.6394631898334671; … ; -2.397677410800803 -1.011883938702821 … -11.00359785809958 -6.074298589663561; -1.2947879526168289 -0.6394631898334673 … -6.074298589663563 -2.9244445373157064;;; -0.4873951858457348 -0.38167366700022526 … -1.2947879526168293 -0.7741766456011949; -0.3816736670002252 -0.4499680968320028 … -0.6394631898334672 -0.4499680968320026; … ; -1.2947879526168293 -0.6394631898334673 … -6.074298589663563 -2.924444537315706; -0.7741766456011949 -0.449968096832003 … -2.9244445373157064 -1.4822715854980033]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39294758274386404 0.37965251754343554 … 0.34515127203704427 0.37965251754343554; 0.37965251754343554 0.36708498216240953 … 0.3281349928932497 0.3648352780451142; … ; 0.3451512720370442 0.32813499289324977 … 0.30664090780433995 0.3342088533615312; 0.3796525175434355 0.36483527804511423 … 0.3342088533615312 0.3670849821624096;;; 0.37965251754343554 0.36708498216240953 … 0.32813499289324977 0.3648352780451142; 0.36708498216240953 0.3510283521250433 … 0.312047585925308 0.35285535399830553; … ; 0.3281349928932497 0.31204758592530807 … 0.2977659148199179 0.3217064897305462; 0.3648352780451142 0.3528553539983056 … 0.3217064897305462 0.35285535399830564;;; 0.3451512720370442 0.3342088533615312 … 0.28725666185842375 0.3281349928932497; 0.3342088533615312 0.3178909610702747 … 0.278560325760289 0.3217064897305462; … ; 0.2872566618584237 0.27856032576028905 … 0.25581958535872573 0.278560325760289; 0.3281349928932497 0.3217064897305462 … 0.278560325760289 0.31204758592530807;;; … ;;; 0.3044896754824695 0.28311254475075753 … 0.2842069767740178 0.3000375484866681; 0.28311254475075753 0.25940947946295373 … 0.27145922828968166 0.28489038845306036; … ; 0.28420697677401774 0.27145922828968166 … 0.27578986744371026 0.27982834249328087; 0.3000375484866681 0.28489038845306036 … 0.27982834249328087 0.2918616839169406;;; 0.34515127203704427 0.32813499289324977 … 0.30664090780433995 0.3342088533615312; 0.3281349928932497 0.312047585925308 … 0.29776591481991777 0.3217064897305463; … ; 0.3066409078043399 0.2977659148199178 … 0.2757898674437103 0.2919361566498494; 0.3342088533615312 0.3217064897305463 … 0.2919361566498495 0.3178909610702748;;; 0.37965251754343554 0.3648352780451142 … 0.3342088533615313 0.36708498216240953; 0.3648352780451142 0.3528553539983056 … 0.3217064897305462 0.3528553539983056; … ; 0.3342088533615312 0.3217064897305462 … 0.2919361566498495 0.3178909610702747; 0.3670849821624095 0.3528553539983056 … 0.3178909610702747 0.35102835212504335]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5045188622000666 -0.49776016330507167 … -0.4779341345698165 -0.49776016330507167; -0.49776016330507167 -0.48575109270988753 … -0.4771927853528062 -0.4931073223734762; … ; -0.4779341345698165 -0.47719278535280624 … -0.41219690200391246 -0.45554774634508605; -0.49776016330507167 -0.4931073223734762 … -0.45554774634508605 -0.48575109270988753;;; -0.49776016330507167 -0.48575109270988753 … -0.4771927853528062 -0.4931073223734762; -0.48575109270988753 -0.45911510923853605 … -0.47147687025966023 -0.4871288552966166; … ; -0.47719278535280624 -0.47147687025966023 … -0.44642055977850614 -0.469459547220373; -0.4931073223734762 -0.4871288552966166 … -0.469459547220373 -0.48712885529661665;;; -0.4779341345698165 -0.455547746345086 … -0.46123206346538 -0.4771927853528062; -0.455547746345086 -0.40931538715931787 … -0.45730346571000213 -0.4694595472203729; … ; -0.46123206346538 -0.4573034657100022 … -0.44530249343287204 -0.4573034657100022; -0.4771927853528062 -0.4694595472203729 … -0.45730346571000213 -0.47147687025966023;;; … ;;; -0.44957757692801376 -0.4554502259668284 … -0.37043410142174404 -0.4174981055427963; -0.4554502259668284 -0.44929205583854104 … -0.41668671688049436 -0.44402771547231595; … ; -0.37043410142174416 -0.41668671688049447 … -0.25282288628740923 -0.29898071768232404; -0.4174981055427963 -0.44402771547231595 … -0.298980717682324 -0.3606071118484118;;; -0.4779341345698165 -0.4771927853528062 … -0.41219690200391246 -0.455547746345086; -0.4771927853528062 -0.4714768702596602 … -0.44642055977850614 -0.4694595472203729; … ; -0.41219690200391246 -0.44642055977850614 … -0.25282288628740923 -0.34077314533787617; -0.455547746345086 -0.4694595472203729 … -0.34077314533787617 -0.40931538715931787;;; -0.49776016330507167 -0.4931073223734762 … -0.455547746345086 -0.48575109270988753; -0.4931073223734762 -0.48712885529661665 … -0.4694595472203729 -0.4871288552966166; … ; -0.45554774634508605 -0.469459547220373 … -0.34077314533787617 -0.40931538715931787; -0.48575109270988753 -0.4871288552966166 … -0.40931538715931787 -0.45911510923853616])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41256050032724156 -0.48739518584573477 … -0.7029879573778168 -0.48739518584573466; -0.4873951858457344 -0.774176645601195 … -0.4139736467544148 -0.3816736670002253; … ; -0.7029879573778172 -0.413973646754415 … -2.397677410800803 -1.2947879526168287; -0.4873951858457347 -0.3816736670002257 … -1.2947879526168289 -0.7741766456011949;;; -0.48739518584573477 -0.7741766456011949 … -0.4139736467544148 -0.3816736670002252; -0.7741766456011946 -1.4822715854980038 … -0.324410026026995 -0.44996809683200273; … ; -0.4139736467544151 -0.3244100260269952 … -1.0118839387028216 -0.6394631898334671; -0.3816736670002254 -0.449968096832003 … -0.6394631898334675 -0.44996809683200284;;; -0.7029879573778169 -1.2947879526168289 … -0.29831776689483264 -0.41397364675441484; -1.2947879526168284 -2.9244445373157064 … -0.3518817892953182 -0.6394631898334672; … ; -0.2983177668948329 -0.35188178929531855 … -0.49084628003317865 -0.3518817892953183; -0.41397364675441506 -0.6394631898334675 … -0.35188178929531805 -0.324410026026995;;; … ;;; -1.0155348267674735 -0.5341227360947212 … -3.638570535840092 -2.000034714351115; -0.5341227360947208 -0.3217622086089168 … -1.4643700091691778 -0.9065624685606801; … ; -3.6385705358400924 -1.4643700091691778 … -10.994157667774155 -8.087116450366132; -2.000034714351115 -0.9065624685606801 … -8.087116450366132 -4.648617279997691;;; -0.7029879573778168 -0.41397364675441484 … -2.397677410800803 -1.2947879526168293; -0.4139736467544147 -0.324410026026995 … -1.011883938702821 -0.6394631898334671; … ; -2.397677410800803 -1.011883938702821 … -11.00359785809958 -6.074298589663561; -1.2947879526168289 -0.6394631898334673 … -6.074298589663563 -2.9244445373157064;;; -0.4873951858457348 -0.38167366700022526 … -1.2947879526168293 -0.7741766456011949; -0.3816736670002252 -0.4499680968320028 … -0.6394631898334672 -0.4499680968320026; … ; -1.2947879526168293 -0.6394631898334673 … -6.074298589663563 -2.924444537315706; -0.7741766456011949 -0.449968096832003 … -2.9244445373157064 -1.4822715854980033]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852324724904205), converged = true, occupation_threshold = 1.0e-6, ρ = [0.0920359000559568 0.08810500350466811 … 0.07723571073132936 0.08810500350466811; 0.08810500350466811 0.08140511183140223 … 0.07684801107025346 0.0854663261735724; … ; 0.07723571073132939 0.07684801107025348 … 0.0477502503405608 0.06610374749393629; 0.08810500350466811 0.0854663261735724 … 0.06610374749393629 0.08140511183140224;;; 0.08810500350466809 0.08140511183140223 … 0.07684801107025346 0.0854663261735724; 0.08140511183140223 0.06779914356006929 … 0.07390318538180568 0.08215551943894311; … ; 0.07684801107025349 0.07390318538180568 … 0.061898007424342545 0.0728825019257524; 0.08546632617357242 0.08215551943894311 … 0.0728825019257524 0.08215551943894314;;; 0.07723571073132937 0.06610374749393627 … 0.06881910992435629 0.07684801107025346; 0.06610374749393627 0.046671175358133525 … 0.06693449988599046 0.07288250192575237; … ; 0.06881910992435629 0.06693449988599047 … 0.061395704099962096 0.06693449988599047; 0.07684801107025346 0.07288250192575237 … 0.06693449988599046 0.07390318538180568;;; … ;;; 0.06333144436642535 0.06605781097353565 … 0.03369445936261253 0.04977972812811692; 0.06605781097353565 0.06320088286859198 … 0.049465357341339965 0.06082639564235334; … ; 0.03369445936261255 0.04946535734133998 … 0.009591281469791655 0.016680751742632546; 0.049779728128116936 0.06082639564235334 … 0.01668075174263253 0.030857758856327192;;; 0.07723571073132936 0.07684801107025346 … 0.0477502503405608 0.06610374749393627; 0.07684801107025346 0.07390318538180567 … 0.06189800742434253 0.07288250192575237; … ; 0.04775025034056081 0.061898007424342545 … 0.009591281469791655 0.025638373217329584; 0.06610374749393627 0.07288250192575237 … 0.02563837321732958 0.046671175358133546;;; 0.08810500350466809 0.08546632617357242 … 0.06610374749393627 0.08140511183140223; 0.08546632617357242 0.08215551943894313 … 0.07288250192575237 0.08215551943894311; … ; 0.06610374749393629 0.07288250192575238 … 0.025638373217329584 0.04667117535813355; 0.08140511183140223 0.08215551943894311 … 0.046671175358133546 0.06779914356006932;;;;], α = 0.8, eigenvalues = [[-0.16686373068103968, 0.264348494152005, 0.2643634804241205, 0.2643990380736213, 0.357365482917127, 0.3573683797894026, 0.3579443427796593], [-0.11617649194075333, 0.07032972296888304, 0.2263049412992424, 0.2263055617328448, 0.33639927724844165, 0.39337551629910206, 0.3933956730889466], [-0.09593344399379909, 0.08792357125650903, 0.17299970476675966, 0.17302637673025562, 0.29148330904102804, 0.33728673003788345, 0.5340389705434869], [-0.04492298681295808, 0.022393495421108505, 0.0978600095223671, 0.184486401980312, 0.3248409115928844, 0.4990748024262251, 0.5031165763775168]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2900299226761449, n_iter = 2, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.9535818508415291 - 0.0732176314125284im 0.00010819807683692636 + 0.00016898007842518605im … 7.634233489689068e-5 - 1.873310412163655e-5im -7.342015523113463e-5 - 0.00023860743951629234im; 0.0949904597870733 - 0.006866077363378645im 0.19584174107858393 - 0.07176349829893958im … -0.4970909958391997 + 0.11665377687911904im 0.05631096958642753 - 0.17477531796281942im; … ; 0.011324170284290301 - 0.0007341649350751376im -0.021137715930866136 - 0.009221795828225273im … -0.08726569540642856 + 0.009685864677918501im -0.048944879721590506 - 0.05546018189370799im; -0.09505983088356854 + 0.006978768335514384im -0.005096707398672884 - 0.1652717772190317im … -0.22161567068253066 - 0.03445713954758854im -0.4520296149099391 - 0.2821013802983193im], [0.8558196949199574 + 0.3625204871106909im -0.1695129018009867 - 0.09949114757125192im … -1.931150810583395e-5 + 2.7452210196082186e-5im -0.00012543451061520204 + 5.733989696155039e-5im; 0.0576203539840342 + 0.024380358812497373im 0.009833005366596828 + 0.005782304277947547im … -0.00017486308663294185 + 0.0004804485943268611im -0.00022454785471294697 + 0.0004603673902088303im; … ; 0.007400900511450042 + 0.0031808872573232568im -0.07374986494770398 - 0.04336067938441263im … -0.029610422599462217 - 0.03248016909328709im -0.07937718435994501 - 0.05155110560303158im; -0.1034073022996211 - 0.04381630424676791im 0.07645145926925746 + 0.04487415198224721im … -0.13119225943621943 - 0.14450087759029348im -0.3551346976718907 - 0.22857598021276904im], [0.9125896669142125 + 0.20119611438019253im 3.270598209955609e-5 + 8.627682156788364e-5im … 0.0007123843246450321 + 0.00012302078805413838im 6.260943015055246e-5 - 6.542289462957546e-5im; 0.06578742486199399 + 0.014493357430462836im 0.021703752791519693 + 0.055435773325496256im … 0.010042947706629595 - 0.0006103451081023049im -0.005432529171852068 + 0.0007076593433292552im; … ; 0.01419953983933904 + 0.0031129667669891224im -6.459522725648682e-6 + 3.498009655109719e-5im … -0.005901065205563936 - 0.0010623640367872448im 0.06311339543181309 - 0.01018264689164698im; -0.14864101909531102 - 0.03276141818795007im 0.1043662034276935 + 0.2669535924673075im … -0.3789118883331736 - 0.04289674567533261im 0.14670104215264004 - 0.02365928932073635im], [-0.21627812605495902 + 0.7802147813875012im -0.0001398778163514226 + 0.00014292848245116535im … 0.19397921802616688 - 0.13152265558910387im -0.006223347484408999 + 0.004107689196847813im; -0.1034303544433515 + 0.37311916944701634im -0.4281801978039582 + 0.45834606992191146im … -0.18242796182502036 + 0.12278584246687205im 0.005436115229223178 - 0.0036247634150610095im; … ; -0.0030127649977058275 + 0.010867411896164214im -0.0008548640061437592 + 0.0009447736319817609im … 0.011122235791182395 - 0.005515852036125311im -0.03996886603317063 + 0.021907647328847243im; 0.017039326949822138 - 0.061482085292633167im -0.009287976469947086 + 0.009996453316948803im … 0.3141257824325367 - 0.2068261898200235im -0.4413667403727475 + 0.24316411053219927im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16686373068103968, 0.264348494152005, 0.2643634804241205, 0.2643990380736213, 0.357365482917127, 0.3573683797894026, 0.3579443427796593], [-0.11617649194075333, 0.07032972296888304, 0.2263049412992424, 0.2263055617328448, 0.33639927724844165, 0.39337551629910206, 0.3933956730889466], [-0.09593344399379909, 0.08792357125650903, 0.17299970476675966, 0.17302637673025562, 0.29148330904102804, 0.33728673003788345, 0.5340389705434869], [-0.04492298681295808, 0.022393495421108505, 0.0978600095223671, 0.184486401980312, 0.3248409115928844, 0.4990748024262251, 0.5031165763775168]], X = [[0.9535818508415291 - 0.0732176314125284im 0.00010819807683692636 + 0.00016898007842518605im … 7.634233489689068e-5 - 1.873310412163655e-5im -7.342015523113463e-5 - 0.00023860743951629234im; 0.0949904597870733 - 0.006866077363378645im 0.19584174107858393 - 0.07176349829893958im … -0.4970909958391997 + 0.11665377687911904im 0.05631096958642753 - 0.17477531796281942im; … ; 0.011324170284290301 - 0.0007341649350751376im -0.021137715930866136 - 0.009221795828225273im … -0.08726569540642856 + 0.009685864677918501im -0.048944879721590506 - 0.05546018189370799im; -0.09505983088356854 + 0.006978768335514384im -0.005096707398672884 - 0.1652717772190317im … -0.22161567068253066 - 0.03445713954758854im -0.4520296149099391 - 0.2821013802983193im], [0.8558196949199574 + 0.3625204871106909im -0.1695129018009867 - 0.09949114757125192im … -1.931150810583395e-5 + 2.7452210196082186e-5im -0.00012543451061520204 + 5.733989696155039e-5im; 0.0576203539840342 + 0.024380358812497373im 0.009833005366596828 + 0.005782304277947547im … -0.00017486308663294185 + 0.0004804485943268611im -0.00022454785471294697 + 0.0004603673902088303im; … ; 0.007400900511450042 + 0.0031808872573232568im -0.07374986494770398 - 0.04336067938441263im … -0.029610422599462217 - 0.03248016909328709im -0.07937718435994501 - 0.05155110560303158im; -0.1034073022996211 - 0.04381630424676791im 0.07645145926925746 + 0.04487415198224721im … -0.13119225943621943 - 0.14450087759029348im -0.3551346976718907 - 0.22857598021276904im], [0.9125896669142125 + 0.20119611438019253im 3.270598209955609e-5 + 8.627682156788364e-5im … 0.0007123843246450321 + 0.00012302078805413838im 6.260943015055246e-5 - 6.542289462957546e-5im; 0.06578742486199399 + 0.014493357430462836im 0.021703752791519693 + 0.055435773325496256im … 0.010042947706629595 - 0.0006103451081023049im -0.005432529171852068 + 0.0007076593433292552im; … ; 0.01419953983933904 + 0.0031129667669891224im -6.459522725648682e-6 + 3.498009655109719e-5im … -0.005901065205563936 - 0.0010623640367872448im 0.06311339543181309 - 0.01018264689164698im; -0.14864101909531102 - 0.03276141818795007im 0.1043662034276935 + 0.2669535924673075im … -0.3789118883331736 - 0.04289674567533261im 0.14670104215264004 - 0.02365928932073635im], [-0.21627812605495902 + 0.7802147813875012im -0.0001398778163514226 + 0.00014292848245116535im … 0.19397921802616688 - 0.13152265558910387im -0.006223347484408999 + 0.004107689196847813im; -0.1034303544433515 + 0.37311916944701634im -0.4281801978039582 + 0.45834606992191146im … -0.18242796182502036 + 0.12278584246687205im 0.005436115229223178 - 0.0036247634150610095im; … ; -0.0030127649977058275 + 0.010867411896164214im -0.0008548640061437592 + 0.0009447736319817609im … 0.011122235791182395 - 0.005515852036125311im -0.03996886603317063 + 0.021907647328847243im; 0.017039326949822138 - 0.061482085292633167im -0.009287976469947086 + 0.009996453316948803im … 0.3141257824325367 - 0.2068261898200235im -0.4413667403727475 + 0.24316411053219927im]], residual_norms = [[0.011251907308311184, 0.006296767812193171, 0.007550671909940538, 0.008941240890200123, 0.004426038707927205, 0.004609506396514517, 0.014064164849778914], [0.00406220064031454, 0.006623333178689467, 0.005996365649365752, 0.006014380938111476, 0.007236079990385996, 0.011222314877908554, 0.012148687318802556], [0.005863375290862527, 0.005698440470860729, 0.004623000374473645, 0.007287182471183382, 0.00768660582393379, 0.017589244698239973, 0.031245950890189146], [0.004836087049410151, 0.004752203094860566, 0.008305832856561305, 0.012514304159989326, 0.04202713611477677, 0.06229229701531272, 0.018463908181730337]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 0.002758021140958647)</code></pre><p>Remove the virtual orbitals (which Newton cannot treat yet)</p><pre><code class="language-julia hljs">ψ, _ = DFTK.select_occupied_orbitals(basis, scfres_start.ψ, scfres_start.occupation)
scfres_newton = newton(basis, ψ; tol)

# Comparison of results

println(&quot;|ρ_newton - ρ_scf|  = &quot;, norm(scfres_newton.ρ - scfres_scf.ρ))
println(&quot;|ρ_newton - ρ_scfv| = &quot;, norm(scfres_newton.ρ - scfres_scfv.ρ))
println(&quot;|ρ_newton - ρ_dm|   = &quot;, norm(scfres_newton.ρ - scfres_dm.ρ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)
---   ---------------   ---------   ---------
  1   -7.852646686707                   -2.54
  2   -7.852646686730      -10.65       -5.89
  3   -7.852646686730      -14.75      -12.56
|ρ_newton - ρ_scf|  = 1.9338073991313445e-13
|ρ_newton - ρ_scfv| = 1.9279257935090416e-14
|ρ_newton - ρ_dm|   = 3.18864529895572e-10</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scf_callbacks/">« Monitoring self-consistent field calculations</a><a class="docs-footer-nextpage" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 26 August 2022 16:56">Friday 26 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
