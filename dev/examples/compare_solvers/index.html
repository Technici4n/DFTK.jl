<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison of DFT solvers · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/compare_solvers/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li class="is-active"><a class="tocitem" href>Comparison of DFT solvers</a><ul class="internal"><li><a class="tocitem" href="#Density-based-self-consistent-field"><span>Density-based self-consistent field</span></a></li><li><a class="tocitem" href="#Potential-based-SCF"><span>Potential-based SCF</span></a></li><li><a class="tocitem" href="#Direct-minimization"><span>Direct minimization</span></a></li></ul></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/compare_solvers.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-of-DFT-solvers"><a class="docs-heading-anchor" href="#Comparison-of-DFT-solvers">Comparison of DFT solvers</a><a id="Comparison-of-DFT-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-DFT-solvers" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/compare_solvers.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/compare_solvers.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compare four different approaches for solving the DFT minimisation problem, namely a density-based SCF, a potential-based SCF, direct minimisation and Newton.</p><p>First we setup our problem</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra

a = 10.26  # Silicon lattice constant in Bohr
lattice = a / 2 * [[0 1 1.];
                   [1 0 1.];
                   [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=[3, 3, 3])

# Convergence we desire
tol = 1e-12
is_converged = DFTK.ScfConvergenceDensity(tol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">#506 (generic function with 1 method)</code></pre><h2 id="Density-based-self-consistent-field"><a class="docs-heading-anchor" href="#Density-based-self-consistent-field">Density-based self-consistent field</a><a id="Density-based-self-consistent-field-1"></a><a class="docs-heading-anchor-permalink" href="#Density-based-self-consistent-field" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scf = self_consistent_field(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3915556370335573 0.3785174208998475 … 0.34469960027028884 0.3785174208998475; 0.3785174208998476 0.3664584406480143 … 0.32735728172233236 0.36364954262063276; … ; 0.34469960027028884 0.32735728172233236 … 0.3075192694186144 0.3343805319866558; 0.37851742089984747 0.3636495426206328 … 0.3343805319866557 0.3664584406480143;;; 0.3785174208998475 0.36645844064801436 … 0.3273572817223324 0.36364954262063276; 0.36645844064801436 0.3510288634178101 … 0.3111940134606561 0.3519170663492775; … ; 0.3273572817223324 0.3111940134606561 … 0.29824122841230516 0.3214260028151663; 0.3636495426206328 0.35191706634927755 … 0.3214260028151662 0.35191706634927755;;; 0.34469960027028884 0.33438053198665574 … 0.2865351537639998 0.32735728172233236; 0.3343805319866558 0.318616047763053 … 0.27805891882354566 0.32142600281516626; … ; 0.2865351537639998 0.27805891882354566 … 0.255901857723173 0.27805891882354566; 0.3273572817223323 0.32142600281516626 … 0.2780589188235456 0.31119401346065606;;; … ;;; 0.30487474928911196 0.28303666896244023 … 0.2855643323176118 0.30095737051848187; 0.28303666896244034 0.25898431622278884 … 0.2726330012866298 0.2854141966266859; … ; 0.2855643323176118 0.2726330012866298 … 0.27716038913777963 0.2812108737838712; 0.3009573705184818 0.2854141966266859 … 0.2812108737838712 0.2930827262717695;;; 0.34469960027028884 0.3273572817223323 … 0.30751926941861435 0.33438053198665574; 0.3273572817223324 0.3111940134606561 … 0.29824122841230516 0.32142600281516626; … ; 0.30751926941861435 0.29824122841230516 … 0.2771603891377797 0.29313119147030486; 0.33438053198665574 0.32142600281516626 … 0.2931311914703048 0.3186160477630531;;; 0.3785174208998476 0.36364954262063276 … 0.33438053198665574 0.36645844064801436; 0.3636495426206329 0.35191706634927755 … 0.3214260028151663 0.3519170663492775; … ; 0.3343805319866558 0.3214260028151663 … 0.2931311914703049 0.318616047763053; 0.36645844064801425 0.3519170663492775 … 0.31861604776305297 0.35102886341781003]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923122416 -0.49665655722573054 … -0.47719190096491576 -0.49665655722573054; -0.49665655722573054 -0.4848182087107669 … -0.47638044576680316 -0.49204131116945327; … ; -0.47719190096491576 -0.47638044576680316 … -0.41228807087393715 -0.45507008155614714; -0.49665655722573054 -0.49204131116945327 … -0.45507008155614714 -0.48481820871076686;;; -0.49665655722573065 -0.4848182087107669 … -0.47638044576680316 -0.49204131116945327; -0.4848182087107669 -0.4583744079148886 … -0.47065601570574 -0.48617902517564804; … ; -0.47638044576680316 -0.47065601570574 … -0.4463984364362354 -0.4688943963915465; -0.49204131116945327 -0.48617902517564804 … -0.4688943963915465 -0.48617902517564804;;; -0.4771919009649158 -0.45507008155614714 … -0.4605141234226868 -0.47638044576680316; -0.45507008155614714 -0.40906618243915327 … -0.45671990832115666 -0.4688943963915465; … ; -0.4605141234226868 -0.45671990832115666 … -0.44514495660350595 -0.45671990832115666; -0.47638044576680316 -0.4688943963915465 … -0.45671990832115666 -0.47065601570574;;; … ;;; -0.4494759508409334 -0.4551499722015092 … -0.371259862617925 -0.41774571520278375; -0.4551499722015092 -0.4488035109977296 … -0.4174380107134356 -0.44412609929879787; … ; -0.371259862617925 -0.4174380107134357 … -0.2536569832840991 -0.29979809105962396; -0.41774571520278375 -0.44412609929879787 … -0.299798091059624 -0.3610634326480467;;; -0.4771919009649158 -0.47638044576680316 … -0.41228807087393715 -0.45507008155614714; -0.47638044576680316 -0.47065601570574 … -0.4463984364362354 -0.4688943963915465; … ; -0.41228807087393715 -0.4463984364362354 … -0.25365698328409914 -0.34106330230086424; -0.45507008155614714 -0.4688943963915465 … -0.34106330230086424 -0.40906618243915327;;; -0.49665655722573065 -0.49204131116945327 … -0.45507008155614714 -0.4848182087107669; -0.49204131116945327 -0.4861790251756482 … -0.4688943963915465 -0.48617902517564804; … ; -0.45507008155614714 -0.4688943963915465 … -0.34106330230086424 -0.40906618243915327; -0.4848182087107669 -0.48617902517564804 … -0.40906618243915327 -0.4583744079148886])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417761497233 -0.48742667640998166 … -0.7026973955396716 -0.48742667640998155; -0.4874266764099812 -0.7738703031164696 … -0.4139390183393291 -0.3817933912206838; … ; -0.7026973955396718 -0.41393901833932933 … -2.3968902180565532 -1.2941386092027654; -0.4874266764099816 -0.3817933912206842 … -1.2941386092027654 -0.7738703031164695;;; -0.4874266764099818 -0.7738703031164695 … -0.4139390183393291 -0.3817933912206837; -0.7738703031164691 -1.4815303728815894 … -0.32444274393772665 -0.4499565543600622; … ; -0.41393901833932933 -0.3244427439377269 … -1.0113865017681636 -0.6391785259200204; -0.38179339122068384 -0.4499565543600625 … -0.639178525920021 -0.4499565543600623;;; -0.7026973955396716 -1.2941386092027658 … -0.29832133494656343 -0.41393901833932917; -1.2941386092027654 -2.9234702459027635 … -0.3517996388432161 -0.6391785259200207; … ; -0.29832133494656365 -0.3517996388432164 … -0.4906064708393653 -0.35179963884321613; -0.41393901833932945 -0.6391785259200211 … -0.35179963884321597 -0.32444274393772676;;; … ;;; -1.0150481268737508 -0.5338983581177194 … -3.6380389414926793 -1.9993625019792887; -0.5338983581177188 -0.32169882700827024 … -1.463947530005171 -0.9061370442135366; … ; -3.6380389414926793 -1.463947530005171 … -10.993621243076776 -8.086551292452842; -1.9993625019792887 -0.9061370442135366 … -8.086551292452842 -4.647852558442496;;; -0.7026973955396716 -0.4139390183393293 … -2.3968902180565532 -1.2941386092027658; -0.413939018339329 -0.32444274393772665 … -1.0113865017681627 -0.6391785259200207; … ; -2.3968902180565532 -1.011386501768163 … -11.0030614334022 -6.073393711806093; -1.2941386092027654 -0.6391785259200209 … -6.073393711806095 -2.9234702459027635;;; -0.4874266764099818 -0.38179339122068373 … -1.2941386092027658 -0.7738703031164695; -0.3817933912206835 -0.4499565543600624 … -0.6391785259200207 -0.44995655436006216; … ; -1.2941386092027658 -0.6391785259200208 … -6.073393711806095 -2.923470245902763; -0.7738703031164695 -0.44995655436006254 … -2.9234702459027635 -1.4815303728815892]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3915556370335573 0.3785174208998475 … 0.34469960027028884 0.3785174208998475; 0.3785174208998476 0.3664584406480143 … 0.32735728172233236 0.36364954262063276; … ; 0.34469960027028884 0.32735728172233236 … 0.3075192694186144 0.3343805319866558; 0.37851742089984747 0.3636495426206328 … 0.3343805319866557 0.3664584406480143;;; 0.3785174208998475 0.36645844064801436 … 0.3273572817223324 0.36364954262063276; 0.36645844064801436 0.3510288634178101 … 0.3111940134606561 0.3519170663492775; … ; 0.3273572817223324 0.3111940134606561 … 0.29824122841230516 0.3214260028151663; 0.3636495426206328 0.35191706634927755 … 0.3214260028151662 0.35191706634927755;;; 0.34469960027028884 0.33438053198665574 … 0.2865351537639998 0.32735728172233236; 0.3343805319866558 0.318616047763053 … 0.27805891882354566 0.32142600281516626; … ; 0.2865351537639998 0.27805891882354566 … 0.255901857723173 0.27805891882354566; 0.3273572817223323 0.32142600281516626 … 0.2780589188235456 0.31119401346065606;;; … ;;; 0.30487474928911196 0.28303666896244023 … 0.2855643323176118 0.30095737051848187; 0.28303666896244034 0.25898431622278884 … 0.2726330012866298 0.2854141966266859; … ; 0.2855643323176118 0.2726330012866298 … 0.27716038913777963 0.2812108737838712; 0.3009573705184818 0.2854141966266859 … 0.2812108737838712 0.2930827262717695;;; 0.34469960027028884 0.3273572817223323 … 0.30751926941861435 0.33438053198665574; 0.3273572817223324 0.3111940134606561 … 0.29824122841230516 0.32142600281516626; … ; 0.30751926941861435 0.29824122841230516 … 0.2771603891377797 0.29313119147030486; 0.33438053198665574 0.32142600281516626 … 0.2931311914703048 0.3186160477630531;;; 0.3785174208998476 0.36364954262063276 … 0.33438053198665574 0.36645844064801436; 0.3636495426206329 0.35191706634927755 … 0.3214260028151663 0.3519170663492775; … ; 0.3343805319866558 0.3214260028151663 … 0.2931311914703049 0.318616047763053; 0.36645844064801425 0.3519170663492775 … 0.31861604776305297 0.35102886341781003]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923122416 -0.49665655722573054 … -0.47719190096491576 -0.49665655722573054; -0.49665655722573054 -0.4848182087107669 … -0.47638044576680316 -0.49204131116945327; … ; -0.47719190096491576 -0.47638044576680316 … -0.41228807087393715 -0.45507008155614714; -0.49665655722573054 -0.49204131116945327 … -0.45507008155614714 -0.48481820871076686;;; -0.49665655722573065 -0.4848182087107669 … -0.47638044576680316 -0.49204131116945327; -0.4848182087107669 -0.4583744079148886 … -0.47065601570574 -0.48617902517564804; … ; -0.47638044576680316 -0.47065601570574 … -0.4463984364362354 -0.4688943963915465; -0.49204131116945327 -0.48617902517564804 … -0.4688943963915465 -0.48617902517564804;;; -0.4771919009649158 -0.45507008155614714 … -0.4605141234226868 -0.47638044576680316; -0.45507008155614714 -0.40906618243915327 … -0.45671990832115666 -0.4688943963915465; … ; -0.4605141234226868 -0.45671990832115666 … -0.44514495660350595 -0.45671990832115666; -0.47638044576680316 -0.4688943963915465 … -0.45671990832115666 -0.47065601570574;;; … ;;; -0.4494759508409334 -0.4551499722015092 … -0.371259862617925 -0.41774571520278375; -0.4551499722015092 -0.4488035109977296 … -0.4174380107134356 -0.44412609929879787; … ; -0.371259862617925 -0.4174380107134357 … -0.2536569832840991 -0.29979809105962396; -0.41774571520278375 -0.44412609929879787 … -0.299798091059624 -0.3610634326480467;;; -0.4771919009649158 -0.47638044576680316 … -0.41228807087393715 -0.45507008155614714; -0.47638044576680316 -0.47065601570574 … -0.4463984364362354 -0.4688943963915465; … ; -0.41228807087393715 -0.4463984364362354 … -0.25365698328409914 -0.34106330230086424; -0.45507008155614714 -0.4688943963915465 … -0.34106330230086424 -0.40906618243915327;;; -0.49665655722573065 -0.49204131116945327 … -0.45507008155614714 -0.4848182087107669; -0.49204131116945327 -0.4861790251756482 … -0.4688943963915465 -0.48617902517564804; … ; -0.45507008155614714 -0.4688943963915465 … -0.34106330230086424 -0.40906618243915327; -0.4848182087107669 -0.48617902517564804 … -0.40906618243915327 -0.4583744079148886])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417761497233 -0.48742667640998166 … -0.7026973955396716 -0.48742667640998155; -0.4874266764099812 -0.7738703031164696 … -0.4139390183393291 -0.3817933912206838; … ; -0.7026973955396718 -0.41393901833932933 … -2.3968902180565532 -1.2941386092027654; -0.4874266764099816 -0.3817933912206842 … -1.2941386092027654 -0.7738703031164695;;; -0.4874266764099818 -0.7738703031164695 … -0.4139390183393291 -0.3817933912206837; -0.7738703031164691 -1.4815303728815894 … -0.32444274393772665 -0.4499565543600622; … ; -0.41393901833932933 -0.3244427439377269 … -1.0113865017681636 -0.6391785259200204; -0.38179339122068384 -0.4499565543600625 … -0.639178525920021 -0.4499565543600623;;; -0.7026973955396716 -1.2941386092027658 … -0.29832133494656343 -0.41393901833932917; -1.2941386092027654 -2.9234702459027635 … -0.3517996388432161 -0.6391785259200207; … ; -0.29832133494656365 -0.3517996388432164 … -0.4906064708393653 -0.35179963884321613; -0.41393901833932945 -0.6391785259200211 … -0.35179963884321597 -0.32444274393772676;;; … ;;; -1.0150481268737508 -0.5338983581177194 … -3.6380389414926793 -1.9993625019792887; -0.5338983581177188 -0.32169882700827024 … -1.463947530005171 -0.9061370442135366; … ; -3.6380389414926793 -1.463947530005171 … -10.993621243076776 -8.086551292452842; -1.9993625019792887 -0.9061370442135366 … -8.086551292452842 -4.647852558442496;;; -0.7026973955396716 -0.4139390183393293 … -2.3968902180565532 -1.2941386092027658; -0.413939018339329 -0.32444274393772665 … -1.0113865017681627 -0.6391785259200207; … ; -2.3968902180565532 -1.011386501768163 … -11.0030614334022 -6.073393711806093; -1.2941386092027654 -0.6391785259200209 … -6.073393711806095 -2.9234702459027635;;; -0.4874266764099818 -0.38179339122068373 … -1.2941386092027658 -0.7738703031164695; -0.3817933912206835 -0.4499565543600624 … -0.6391785259200207 -0.44995655436006216; … ; -1.2941386092027658 -0.6391785259200208 … -6.073393711806095 -2.923470245902763; -0.7738703031164695 -0.44995655436006254 … -2.9234702459027635 -1.4815303728815892]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3915556370335573 0.3785174208998475 … 0.34469960027028884 0.3785174208998475; 0.3785174208998476 0.3664584406480143 … 0.32735728172233236 0.36364954262063276; … ; 0.34469960027028884 0.32735728172233236 … 0.3075192694186144 0.3343805319866558; 0.37851742089984747 0.3636495426206328 … 0.3343805319866557 0.3664584406480143;;; 0.3785174208998475 0.36645844064801436 … 0.3273572817223324 0.36364954262063276; 0.36645844064801436 0.3510288634178101 … 0.3111940134606561 0.3519170663492775; … ; 0.3273572817223324 0.3111940134606561 … 0.29824122841230516 0.3214260028151663; 0.3636495426206328 0.35191706634927755 … 0.3214260028151662 0.35191706634927755;;; 0.34469960027028884 0.33438053198665574 … 0.2865351537639998 0.32735728172233236; 0.3343805319866558 0.318616047763053 … 0.27805891882354566 0.32142600281516626; … ; 0.2865351537639998 0.27805891882354566 … 0.255901857723173 0.27805891882354566; 0.3273572817223323 0.32142600281516626 … 0.2780589188235456 0.31119401346065606;;; … ;;; 0.30487474928911196 0.28303666896244023 … 0.2855643323176118 0.30095737051848187; 0.28303666896244034 0.25898431622278884 … 0.2726330012866298 0.2854141966266859; … ; 0.2855643323176118 0.2726330012866298 … 0.27716038913777963 0.2812108737838712; 0.3009573705184818 0.2854141966266859 … 0.2812108737838712 0.2930827262717695;;; 0.34469960027028884 0.3273572817223323 … 0.30751926941861435 0.33438053198665574; 0.3273572817223324 0.3111940134606561 … 0.29824122841230516 0.32142600281516626; … ; 0.30751926941861435 0.29824122841230516 … 0.2771603891377797 0.29313119147030486; 0.33438053198665574 0.32142600281516626 … 0.2931311914703048 0.3186160477630531;;; 0.3785174208998476 0.36364954262063276 … 0.33438053198665574 0.36645844064801436; 0.3636495426206329 0.35191706634927755 … 0.3214260028151663 0.3519170663492775; … ; 0.3343805319866558 0.3214260028151663 … 0.2931311914703049 0.318616047763053; 0.36645844064801425 0.3519170663492775 … 0.31861604776305297 0.35102886341781003]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923122416 -0.49665655722573054 … -0.47719190096491576 -0.49665655722573054; -0.49665655722573054 -0.4848182087107669 … -0.47638044576680316 -0.49204131116945327; … ; -0.47719190096491576 -0.47638044576680316 … -0.41228807087393715 -0.45507008155614714; -0.49665655722573054 -0.49204131116945327 … -0.45507008155614714 -0.48481820871076686;;; -0.49665655722573065 -0.4848182087107669 … -0.47638044576680316 -0.49204131116945327; -0.4848182087107669 -0.4583744079148886 … -0.47065601570574 -0.48617902517564804; … ; -0.47638044576680316 -0.47065601570574 … -0.4463984364362354 -0.4688943963915465; -0.49204131116945327 -0.48617902517564804 … -0.4688943963915465 -0.48617902517564804;;; -0.4771919009649158 -0.45507008155614714 … -0.4605141234226868 -0.47638044576680316; -0.45507008155614714 -0.40906618243915327 … -0.45671990832115666 -0.4688943963915465; … ; -0.4605141234226868 -0.45671990832115666 … -0.44514495660350595 -0.45671990832115666; -0.47638044576680316 -0.4688943963915465 … -0.45671990832115666 -0.47065601570574;;; … ;;; -0.4494759508409334 -0.4551499722015092 … -0.371259862617925 -0.41774571520278375; -0.4551499722015092 -0.4488035109977296 … -0.4174380107134356 -0.44412609929879787; … ; -0.371259862617925 -0.4174380107134357 … -0.2536569832840991 -0.29979809105962396; -0.41774571520278375 -0.44412609929879787 … -0.299798091059624 -0.3610634326480467;;; -0.4771919009649158 -0.47638044576680316 … -0.41228807087393715 -0.45507008155614714; -0.47638044576680316 -0.47065601570574 … -0.4463984364362354 -0.4688943963915465; … ; -0.41228807087393715 -0.4463984364362354 … -0.25365698328409914 -0.34106330230086424; -0.45507008155614714 -0.4688943963915465 … -0.34106330230086424 -0.40906618243915327;;; -0.49665655722573065 -0.49204131116945327 … -0.45507008155614714 -0.4848182087107669; -0.49204131116945327 -0.4861790251756482 … -0.4688943963915465 -0.48617902517564804; … ; -0.45507008155614714 -0.4688943963915465 … -0.34106330230086424 -0.40906618243915327; -0.4848182087107669 -0.48617902517564804 … -0.40906618243915327 -0.4583744079148886])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417761497233 -0.48742667640998166 … -0.7026973955396716 -0.48742667640998155; -0.4874266764099812 -0.7738703031164696 … -0.4139390183393291 -0.3817933912206838; … ; -0.7026973955396718 -0.41393901833932933 … -2.3968902180565532 -1.2941386092027654; -0.4874266764099816 -0.3817933912206842 … -1.2941386092027654 -0.7738703031164695;;; -0.4874266764099818 -0.7738703031164695 … -0.4139390183393291 -0.3817933912206837; -0.7738703031164691 -1.4815303728815894 … -0.32444274393772665 -0.4499565543600622; … ; -0.41393901833932933 -0.3244427439377269 … -1.0113865017681636 -0.6391785259200204; -0.38179339122068384 -0.4499565543600625 … -0.639178525920021 -0.4499565543600623;;; -0.7026973955396716 -1.2941386092027658 … -0.29832133494656343 -0.41393901833932917; -1.2941386092027654 -2.9234702459027635 … -0.3517996388432161 -0.6391785259200207; … ; -0.29832133494656365 -0.3517996388432164 … -0.4906064708393653 -0.35179963884321613; -0.41393901833932945 -0.6391785259200211 … -0.35179963884321597 -0.32444274393772676;;; … ;;; -1.0150481268737508 -0.5338983581177194 … -3.6380389414926793 -1.9993625019792887; -0.5338983581177188 -0.32169882700827024 … -1.463947530005171 -0.9061370442135366; … ; -3.6380389414926793 -1.463947530005171 … -10.993621243076776 -8.086551292452842; -1.9993625019792887 -0.9061370442135366 … -8.086551292452842 -4.647852558442496;;; -0.7026973955396716 -0.4139390183393293 … -2.3968902180565532 -1.2941386092027658; -0.413939018339329 -0.32444274393772665 … -1.0113865017681627 -0.6391785259200207; … ; -2.3968902180565532 -1.011386501768163 … -11.0030614334022 -6.073393711806093; -1.2941386092027654 -0.6391785259200209 … -6.073393711806095 -2.9234702459027635;;; -0.4874266764099818 -0.38179339122068373 … -1.2941386092027658 -0.7738703031164695; -0.3817933912206835 -0.4499565543600624 … -0.6391785259200207 -0.44995655436006216; … ; -1.2941386092027658 -0.6391785259200208 … -6.073393711806095 -2.923470245902763; -0.7738703031164695 -0.44995655436006254 … -2.9234702459027635 -1.4815303728815892]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3915556370335573 0.3785174208998475 … 0.34469960027028884 0.3785174208998475; 0.3785174208998476 0.3664584406480143 … 0.32735728172233236 0.36364954262063276; … ; 0.34469960027028884 0.32735728172233236 … 0.3075192694186144 0.3343805319866558; 0.37851742089984747 0.3636495426206328 … 0.3343805319866557 0.3664584406480143;;; 0.3785174208998475 0.36645844064801436 … 0.3273572817223324 0.36364954262063276; 0.36645844064801436 0.3510288634178101 … 0.3111940134606561 0.3519170663492775; … ; 0.3273572817223324 0.3111940134606561 … 0.29824122841230516 0.3214260028151663; 0.3636495426206328 0.35191706634927755 … 0.3214260028151662 0.35191706634927755;;; 0.34469960027028884 0.33438053198665574 … 0.2865351537639998 0.32735728172233236; 0.3343805319866558 0.318616047763053 … 0.27805891882354566 0.32142600281516626; … ; 0.2865351537639998 0.27805891882354566 … 0.255901857723173 0.27805891882354566; 0.3273572817223323 0.32142600281516626 … 0.2780589188235456 0.31119401346065606;;; … ;;; 0.30487474928911196 0.28303666896244023 … 0.2855643323176118 0.30095737051848187; 0.28303666896244034 0.25898431622278884 … 0.2726330012866298 0.2854141966266859; … ; 0.2855643323176118 0.2726330012866298 … 0.27716038913777963 0.2812108737838712; 0.3009573705184818 0.2854141966266859 … 0.2812108737838712 0.2930827262717695;;; 0.34469960027028884 0.3273572817223323 … 0.30751926941861435 0.33438053198665574; 0.3273572817223324 0.3111940134606561 … 0.29824122841230516 0.32142600281516626; … ; 0.30751926941861435 0.29824122841230516 … 0.2771603891377797 0.29313119147030486; 0.33438053198665574 0.32142600281516626 … 0.2931311914703048 0.3186160477630531;;; 0.3785174208998476 0.36364954262063276 … 0.33438053198665574 0.36645844064801436; 0.3636495426206329 0.35191706634927755 … 0.3214260028151663 0.3519170663492775; … ; 0.3343805319866558 0.3214260028151663 … 0.2931311914703049 0.318616047763053; 0.36645844064801425 0.3519170663492775 … 0.31861604776305297 0.35102886341781003]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923122416 -0.49665655722573054 … -0.47719190096491576 -0.49665655722573054; -0.49665655722573054 -0.4848182087107669 … -0.47638044576680316 -0.49204131116945327; … ; -0.47719190096491576 -0.47638044576680316 … -0.41228807087393715 -0.45507008155614714; -0.49665655722573054 -0.49204131116945327 … -0.45507008155614714 -0.48481820871076686;;; -0.49665655722573065 -0.4848182087107669 … -0.47638044576680316 -0.49204131116945327; -0.4848182087107669 -0.4583744079148886 … -0.47065601570574 -0.48617902517564804; … ; -0.47638044576680316 -0.47065601570574 … -0.4463984364362354 -0.4688943963915465; -0.49204131116945327 -0.48617902517564804 … -0.4688943963915465 -0.48617902517564804;;; -0.4771919009649158 -0.45507008155614714 … -0.4605141234226868 -0.47638044576680316; -0.45507008155614714 -0.40906618243915327 … -0.45671990832115666 -0.4688943963915465; … ; -0.4605141234226868 -0.45671990832115666 … -0.44514495660350595 -0.45671990832115666; -0.47638044576680316 -0.4688943963915465 … -0.45671990832115666 -0.47065601570574;;; … ;;; -0.4494759508409334 -0.4551499722015092 … -0.371259862617925 -0.41774571520278375; -0.4551499722015092 -0.4488035109977296 … -0.4174380107134356 -0.44412609929879787; … ; -0.371259862617925 -0.4174380107134357 … -0.2536569832840991 -0.29979809105962396; -0.41774571520278375 -0.44412609929879787 … -0.299798091059624 -0.3610634326480467;;; -0.4771919009649158 -0.47638044576680316 … -0.41228807087393715 -0.45507008155614714; -0.47638044576680316 -0.47065601570574 … -0.4463984364362354 -0.4688943963915465; … ; -0.41228807087393715 -0.4463984364362354 … -0.25365698328409914 -0.34106330230086424; -0.45507008155614714 -0.4688943963915465 … -0.34106330230086424 -0.40906618243915327;;; -0.49665655722573065 -0.49204131116945327 … -0.45507008155614714 -0.4848182087107669; -0.49204131116945327 -0.4861790251756482 … -0.4688943963915465 -0.48617902517564804; … ; -0.45507008155614714 -0.4688943963915465 … -0.34106330230086424 -0.40906618243915327; -0.4848182087107669 -0.48617902517564804 … -0.40906618243915327 -0.4583744079148886])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417761497233 -0.48742667640998166 … -0.7026973955396716 -0.48742667640998155; -0.4874266764099812 -0.7738703031164696 … -0.4139390183393291 -0.3817933912206838; … ; -0.7026973955396718 -0.41393901833932933 … -2.3968902180565532 -1.2941386092027654; -0.4874266764099816 -0.3817933912206842 … -1.2941386092027654 -0.7738703031164695;;; -0.4874266764099818 -0.7738703031164695 … -0.4139390183393291 -0.3817933912206837; -0.7738703031164691 -1.4815303728815894 … -0.32444274393772665 -0.4499565543600622; … ; -0.41393901833932933 -0.3244427439377269 … -1.0113865017681636 -0.6391785259200204; -0.38179339122068384 -0.4499565543600625 … -0.639178525920021 -0.4499565543600623;;; -0.7026973955396716 -1.2941386092027658 … -0.29832133494656343 -0.41393901833932917; -1.2941386092027654 -2.9234702459027635 … -0.3517996388432161 -0.6391785259200207; … ; -0.29832133494656365 -0.3517996388432164 … -0.4906064708393653 -0.35179963884321613; -0.41393901833932945 -0.6391785259200211 … -0.35179963884321597 -0.32444274393772676;;; … ;;; -1.0150481268737508 -0.5338983581177194 … -3.6380389414926793 -1.9993625019792887; -0.5338983581177188 -0.32169882700827024 … -1.463947530005171 -0.9061370442135366; … ; -3.6380389414926793 -1.463947530005171 … -10.993621243076776 -8.086551292452842; -1.9993625019792887 -0.9061370442135366 … -8.086551292452842 -4.647852558442496;;; -0.7026973955396716 -0.4139390183393293 … -2.3968902180565532 -1.2941386092027658; -0.413939018339329 -0.32444274393772665 … -1.0113865017681627 -0.6391785259200207; … ; -2.3968902180565532 -1.011386501768163 … -11.0030614334022 -6.073393711806093; -1.2941386092027654 -0.6391785259200209 … -6.073393711806095 -2.9234702459027635;;; -0.4874266764099818 -0.38179339122068373 … -1.2941386092027658 -0.7738703031164695; -0.3817933912206835 -0.4499565543600624 … -0.6391785259200207 -0.44995655436006216; … ; -1.2941386092027658 -0.6391785259200208 … -6.073393711806095 -2.923470245902763; -0.7738703031164695 -0.44995655436006254 … -2.9234702459027635 -1.4815303728815892]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729847), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09132316917748982 0.08747419134081871 … 0.07684754935964469 0.08747419134081871; 0.08747419134081871 0.0808996687216549 … 0.07642471016972711 0.08486944834428076; … ; 0.07684754935964469 0.07642471016972713 … 0.04778466667102758 0.0658789534230458; 0.08747419134081871 0.08486944834428076 … 0.0658789534230458 0.08089966872165488;;; 0.08747419134081873 0.08089966872165491 … 0.07642471016972713 0.08486944834428076; 0.0808996687216549 0.06744471469776059 … 0.07348669934705358 0.08163768629016056; … ; 0.07642471016972713 0.0734866993470536 … 0.0618880411999747 0.07259829028448085; 0.08486944834428076 0.08163768629016056 … 0.07259829028448085 0.08163768629016056;;; 0.0768475493596447 0.06587895342304578 … 0.06847203698974588 0.07642471016972713; 0.0658789534230458 0.046578642649817995 … 0.06665759371632744 0.07259829028448085; … ; 0.06847203698974588 0.06665759371632746 … 0.061325153143816646 0.06665759371632744; 0.07642471016972713 0.07259829028448085 … 0.06665759371632744 0.07348669934705358;;; … ;;; 0.063284952298869 0.0659165144595355 … 0.03394064888052318 0.0498759348599976; 0.06591651445953552 0.06297790960106242 … 0.04975639788528272 0.060870204571471624; … ; 0.03394064888052317 0.04975639788528274 … 0.009696353214075847 0.01683133879259433; 0.0498759348599976 0.060870204571471624 … 0.01683133879259434 0.030985721885055276;;; 0.0768475493596447 0.07642471016972713 … 0.04778466667102758 0.06587895342304578; 0.07642471016972711 0.07348669934705361 … 0.0618880411999747 0.07259829028448085; … ; 0.04778466667102758 0.0618880411999747 … 0.009696353214075852 0.02571001067531; 0.06587895342304578 0.07259829028448085 … 0.02571001067531 0.04657864264981799;;; 0.08747419134081873 0.08486944834428076 … 0.0658789534230458 0.0808996687216549; 0.08486944834428076 0.08163768629016058 … 0.07259829028448085 0.08163768629016056; … ; 0.06587895342304578 0.07259829028448085 … 0.02571001067531 0.04657864264981799; 0.0808996687216549 0.08163768629016056 … 0.04657864264981799 0.06744471469776057;;;;], α = 0.8, eigenvalues = [[-0.16677707596314328, 0.26427771782982035, 0.2642777178298201, 0.2642777178298207, 0.35732037190445554, 0.35732037190445587, 0.357320371904456], [-0.11613218761090871, 0.07040532319996938, 0.2262481360301366, 0.2262481360301368, 0.3361178489459592, 0.39343797761794774, 0.39343797761794747], [-0.09588938143647739, 0.08764319967949133, 0.17312704142734592, 0.1731270414273461, 0.2919724892212759, 0.3377321250728789, 0.5327646516178832], [-0.045051463486029, 0.022269526239728957, 0.09831189251529172, 0.18446409322109136, 0.32292701516244515, 0.4802469605032791, 0.502442233495579]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.289712081838164, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.9361966887189842 + 0.19110841326884453im -8.335435417283095e-16 + 1.7265161895832213e-15im … 8.55106859614669e-12 - 5.163993557122604e-13im -2.334506083583598e-11 + 1.4106380519929465e-12im; 0.09434447206383097 + 0.0192587974023649im -0.07953150156516584 + 0.19473711869960803im … -0.06550400741773463 - 0.016329558319713486im -0.4149538875957724 - 0.20925191367472584im; … ; 0.011555948748572614 + 0.0023589477037983045im 0.003288589151573584 - 0.02172727222010584im … 0.017589282942223103 + 0.0015281693582573869im -0.10379466215363431 - 0.01946429099442996im; -0.09434447206383124 - 0.019258797402365503im -0.04733548472927859 - 0.017977693018900134im … 0.2104275317293142 + 0.028920616910417363im -0.44024233017967257 + 0.04887961954075439im], [0.7714502662602089 - 0.5171265177817249im -0.1891929755459136 + 0.05535510364834511im … 1.0852314329149372e-14 - 4.752532127143759e-14im -4.4821268443962086e-14 + 4.362235122987925e-14im; 0.05259125145042426 - 0.03525351136396897im 0.008420446016149667 - 0.0024636996201579313im … -2.9906574430130747e-13 + 1.5178221323478837e-13im 7.099035013313103e-13 - 2.3660372381891574e-13im; … ; 0.006438120132048854 - 0.004315667244611378im -0.08278781213008084 + 0.024222505661518214im … 0.0791082629811411 - 0.0736925628534737im -0.01777075124003298 + 0.00846773523030468im; -0.09380624518293998 + 0.06288117204598904im 0.08705772433854822 - 0.025471819660555537im … 0.33577968928149504 - 0.31279243058846334im -0.07542900203885133 + 0.03594180174725679im], [0.2530133250830958 + 0.8988186750018928im 1.8287712234981387e-15 - 1.9441194578749837e-15im … -2.9870612032898447e-13 - 1.9121149987741757e-15im -3.323043512285303e-10 + 2.5447158403323036e-10im; 0.018628423826868 + 0.06617665380248788im 0.024782920475415002 - 0.0515416133137916im … -0.022315121634536538 + 0.011668769420239493im -0.009896046485721987 - 0.01764313200836879im; … ; 0.0037583539809986307 + 0.013351386707716026im -1.143896815279533e-16 + 7.523082077426482e-16im … 1.777586016346743e-12 - 5.969544625137003e-13im -0.03967543358627129 - 0.05528093997329282im; -0.041514133074159285 - 0.1474771262395515im 0.1244240787576649 - 0.258767636389502im … 0.3383756262158951 - 0.17693953115080732im -0.08979310072782255 - 0.1238179691592796im], [-0.0051426989594131785 - 0.808996310814165im -3.648337795858824e-16 - 8.034763545745571e-16im … -0.1532417749480804 + 0.10792070929477514im -2.0565231290454984e-6 - 7.851148067674703e-7im; -0.002463077689348247 - 0.38746595506708376im 0.46593638536962334 + 0.41894406713166715im … 0.14571202452827156 - 0.10261731466236655im 1.2432997383481743e-6 + 2.4700994962407245e-7im; … ; -7.242692510855321e-5 - 0.011393456175243925im 0.0012222288088263105 + 0.0010989601246295978im … -0.013224305520571852 + 0.00931328123788148im 0.04077086297035336 + 0.017296777124266027im; 0.00041433194541668443 + 0.06517842439148598im 0.00928406801531733 + 0.00834771727642302im … -0.11067028788059145 + 0.07793757249142512im 0.43326424049171 + 0.18380873273865073im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596314328, 0.26427771782982035, 0.2642777178298201, 0.2642777178298207, 0.35732037190445554, 0.35732037190445587, 0.357320371904456], [-0.11613218761090871, 0.07040532319996938, 0.2262481360301366, 0.2262481360301368, 0.3361178489459592, 0.39343797761794774, 0.39343797761794747], [-0.09588938143647739, 0.08764319967949133, 0.17312704142734592, 0.1731270414273461, 0.2919724892212759, 0.3377321250728789, 0.5327646516178832], [-0.045051463486029, 0.022269526239728957, 0.09831189251529172, 0.18446409322109136, 0.32292701516244515, 0.4802469605032791, 0.502442233495579]], X = [[0.9361966887189842 + 0.19110841326884453im -8.335435417283095e-16 + 1.7265161895832213e-15im … 8.55106859614669e-12 - 5.163993557122604e-13im -2.334506083583598e-11 + 1.4106380519929465e-12im; 0.09434447206383097 + 0.0192587974023649im -0.07953150156516584 + 0.19473711869960803im … -0.06550400741773463 - 0.016329558319713486im -0.4149538875957724 - 0.20925191367472584im; … ; 0.011555948748572614 + 0.0023589477037983045im 0.003288589151573584 - 0.02172727222010584im … 0.017589282942223103 + 0.0015281693582573869im -0.10379466215363431 - 0.01946429099442996im; -0.09434447206383124 - 0.019258797402365503im -0.04733548472927859 - 0.017977693018900134im … 0.2104275317293142 + 0.028920616910417363im -0.44024233017967257 + 0.04887961954075439im], [0.7714502662602089 - 0.5171265177817249im -0.1891929755459136 + 0.05535510364834511im … 1.0852314329149372e-14 - 4.752532127143759e-14im -4.4821268443962086e-14 + 4.362235122987925e-14im; 0.05259125145042426 - 0.03525351136396897im 0.008420446016149667 - 0.0024636996201579313im … -2.9906574430130747e-13 + 1.5178221323478837e-13im 7.099035013313103e-13 - 2.3660372381891574e-13im; … ; 0.006438120132048854 - 0.004315667244611378im -0.08278781213008084 + 0.024222505661518214im … 0.0791082629811411 - 0.0736925628534737im -0.01777075124003298 + 0.00846773523030468im; -0.09380624518293998 + 0.06288117204598904im 0.08705772433854822 - 0.025471819660555537im … 0.33577968928149504 - 0.31279243058846334im -0.07542900203885133 + 0.03594180174725679im], [0.2530133250830958 + 0.8988186750018928im 1.8287712234981387e-15 - 1.9441194578749837e-15im … -2.9870612032898447e-13 - 1.9121149987741757e-15im -3.323043512285303e-10 + 2.5447158403323036e-10im; 0.018628423826868 + 0.06617665380248788im 0.024782920475415002 - 0.0515416133137916im … -0.022315121634536538 + 0.011668769420239493im -0.009896046485721987 - 0.01764313200836879im; … ; 0.0037583539809986307 + 0.013351386707716026im -1.143896815279533e-16 + 7.523082077426482e-16im … 1.777586016346743e-12 - 5.969544625137003e-13im -0.03967543358627129 - 0.05528093997329282im; -0.041514133074159285 - 0.1474771262395515im 0.1244240787576649 - 0.258767636389502im … 0.3383756262158951 - 0.17693953115080732im -0.08979310072782255 - 0.1238179691592796im], [-0.0051426989594131785 - 0.808996310814165im -3.648337795858824e-16 - 8.034763545745571e-16im … -0.1532417749480804 + 0.10792070929477514im -2.0565231290454984e-6 - 7.851148067674703e-7im; -0.002463077689348247 - 0.38746595506708376im 0.46593638536962334 + 0.41894406713166715im … 0.14571202452827156 - 0.10261731466236655im 1.2432997383481743e-6 + 2.4700994962407245e-7im; … ; -7.242692510855321e-5 - 0.011393456175243925im 0.0012222288088263105 + 0.0010989601246295978im … -0.013224305520571852 + 0.00931328123788148im 0.04077086297035336 + 0.017296777124266027im; 0.00041433194541668443 + 0.06517842439148598im 0.00928406801531733 + 0.00834771727642302im … -0.11067028788059145 + 0.07793757249142512im 0.43326424049171 + 0.18380873273865073im]], residual_norms = [[7.151237254114769e-14, 4.361502247239845e-14, 4.701897020840122e-14, 3.220159540439528e-14, 3.796634712717386e-11, 9.6498858681783e-11, 2.634795643305749e-10], [1.595285911712664e-14, 1.9481970196134343e-14, 4.6809719023711194e-14, 4.542710904818344e-14, 8.014732420148864e-14, 1.80288678453306e-12, 2.2679221584373658e-12], [7.565611598222221e-14, 3.570963049447578e-14, 4.764537278685752e-14, 7.826691858098452e-14, 8.906851954667359e-14, 8.223339929990671e-12, 6.373577407702541e-8], [1.3798698139781629e-14, 1.7461622441276825e-14, 3.0445260204625944e-14, 6.201715815358929e-14, 6.2852646206258124e-12, 1.493324107076492e-5, 2.5968641285848085e-6]], iterations = [3, 2, 2, 2], converged = 1, n_matvec = 86)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 1.6136444183992008e-13)</code></pre><h2 id="Potential-based-SCF"><a class="docs-heading-anchor" href="#Potential-based-SCF">Potential-based SCF</a><a id="Potential-based-SCF-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-based-SCF" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scfv = DFTK.scf_potential_mixing(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417761498088 -0.487426676410065 … -0.7026973955397497 -0.487426676410065; -0.48742667641006465 -0.7738703031165542 … -0.4139390183393987 -0.3817933912207616; … ; -0.70269739553975 -0.4139390183393989 … -2.3968902180566376 -1.294138609202848; -0.4874266764100649 -0.38179339122076206 … -1.294138609202848 -0.7738703031165541;;; -0.487426676410065 -0.7738703031165541 … -0.41393901833939883 -0.3817933912207616; -0.7738703031165539 -1.4815303728816778 … -0.32444274393779116 -0.44995655436013826; … ; -0.413939018339399 -0.3244427439377914 … -1.0113865017682349 -0.6391785259200922; -0.3817933912207617 -0.4499565543601387 … -0.6391785259200924 -0.44995655436013837;;; -0.7026973955397497 -1.2941386092028484 … -0.29832133494662205 -0.413939018339399; -1.294138609202848 -2.9234702459028528 … -0.35179963884327337 -0.6391785259200924; … ; -0.2983213349466223 -0.3517996388432737 … -0.49060647083941983 -0.3517996388432735; -0.413939018339399 -0.6391785259200927 … -0.35179963884327314 -0.32444274393779127;;; … ;;; -1.0150481268738236 -0.5338983581177804 … -3.6380389414927654 -1.9993625019793697; -0.5338983581177801 -0.32169882700832286 … -1.4639475300052418 -0.9061370442136036; … ; -3.6380389414927654 -1.4639475300052418 … -10.99362124307688 -8.08655129245294; -1.9993625019793697 -0.9061370442136036 … -8.08655129245294 -4.647852558442587;;; -0.7026973955397497 -0.41393901833939895 … -2.396890218056638 -1.2941386092028486; -0.4139390183393988 -0.32444274393779116 … -1.0113865017682342 -0.6391785259200924; … ; -2.3968902180566376 -1.0113865017682342 … -11.003061433402305 -6.073393711806188; -1.2941386092028482 -0.6391785259200926 … -6.073393711806189 -2.9234702459028528;;; -0.4874266764100651 -0.38179339122076156 … -1.2941386092028486 -0.7738703031165541; -0.38179339122076156 -0.4499565543601383 … -0.6391785259200923 -0.4499565543601382; … ; -1.2941386092028486 -0.6391785259200924 … -6.073393711806189 -2.923470245902852; -0.7738703031165539 -0.4499565543601386 … -2.9234702459028528 -1.4815303728816775])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417761498088 -0.487426676410065 … -0.7026973955397497 -0.487426676410065; -0.48742667641006465 -0.7738703031165542 … -0.4139390183393987 -0.3817933912207616; … ; -0.70269739553975 -0.4139390183393989 … -2.3968902180566376 -1.294138609202848; -0.4874266764100649 -0.38179339122076206 … -1.294138609202848 -0.7738703031165541;;; -0.487426676410065 -0.7738703031165541 … -0.41393901833939883 -0.3817933912207616; -0.7738703031165539 -1.4815303728816778 … -0.32444274393779116 -0.44995655436013826; … ; -0.413939018339399 -0.3244427439377914 … -1.0113865017682349 -0.6391785259200922; -0.3817933912207617 -0.4499565543601387 … -0.6391785259200924 -0.44995655436013837;;; -0.7026973955397497 -1.2941386092028484 … -0.29832133494662205 -0.413939018339399; -1.294138609202848 -2.9234702459028528 … -0.35179963884327337 -0.6391785259200924; … ; -0.2983213349466223 -0.3517996388432737 … -0.49060647083941983 -0.3517996388432735; -0.413939018339399 -0.6391785259200927 … -0.35179963884327314 -0.32444274393779127;;; … ;;; -1.0150481268738236 -0.5338983581177804 … -3.6380389414927654 -1.9993625019793697; -0.5338983581177801 -0.32169882700832286 … -1.4639475300052418 -0.9061370442136036; … ; -3.6380389414927654 -1.4639475300052418 … -10.99362124307688 -8.08655129245294; -1.9993625019793697 -0.9061370442136036 … -8.08655129245294 -4.647852558442587;;; -0.7026973955397497 -0.41393901833939895 … -2.396890218056638 -1.2941386092028486; -0.4139390183393988 -0.32444274393779116 … -1.0113865017682342 -0.6391785259200924; … ; -2.3968902180566376 -1.0113865017682342 … -11.003061433402305 -6.073393711806188; -1.2941386092028482 -0.6391785259200926 … -6.073393711806189 -2.9234702459028528;;; -0.4874266764100651 -0.38179339122076156 … -1.2941386092028486 -0.7738703031165541; -0.38179339122076156 -0.4499565543601383 … -0.6391785259200923 -0.4499565543601382; … ; -1.2941386092028486 -0.6391785259200924 … -6.073393711806189 -2.923470245902852; -0.7738703031165539 -0.4499565543601386 … -2.9234702459028528 -1.4815303728816775]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.010788632368370138 - 0.02869526524384795im 0.053180172434307976 + 0.011129475626748524im … 0.008913552860563069 - 0.1615457337916778im 0.012625461657008619 - 0.08097449768965279im; 0.03951743509337978 + 0.0565736163803075im 0.06103188420027672 + 0.09411313110667742im … 0.027085138830446876 - 0.09235955089463242im 0.04051232666336083 - 0.013351159309220935im; … ; -0.011125035658381143 + 0.02651772953090549im -0.02356322768677621 + 0.03001234105767952im … 0.05636448387218558 - 0.050763806292506375im 0.04924804859240793 - 0.001438808802898401im; -0.039534997577984066 + 0.004234734351125662im -0.01269712061648615 - 0.039111443359309994im … 0.00492179642688128 - 0.08805566432268823im -0.002134753174957719 - 0.06868160391561817im;;; -0.023263833858302354 + 0.04505284396867423im -0.004100774045427122 + 0.04026598224421954im … 0.0003030107809720693 - 0.08500889572242665im -0.024114645762214993 - 0.0010699540962102912im; 0.02581687437111751 + 0.1428322651738231im 0.012298157057220841 + 0.09294772834168342im … 0.014917523609745057 - 0.012194406617458029im 0.0037272445495175367 + 0.09728880867547648im; … ; -0.03066316845640811 + 0.022610755749496707im -0.034506672671971855 - 0.017114517742612995im … 0.04136540950425288 - 0.020812732971732875im 0.02384892545858805 + 0.005062765886465011im; -0.05901808270495656 - 0.01646570948279562im -0.023034089596329757 - 0.05129121952618133im … 0.018812459359616646 - 0.05760321455009833im -0.039404460415467094 - 0.016354050183933357im;;; -0.0067991412877203864 + 0.041084185902078754im 0.008813744381598761 + 0.011524390026693733im … -0.007896534291602643 - 0.027087357527160745im -0.023653618823480407 + 0.01978015291543042im; 0.024680170206916874 + 0.10315051833685634im 0.04534798531260974 + 0.0175097224974772im … -0.005268614715757043 + 0.031457323579889916im -0.004016657219169642 + 0.10478440780288026im; … ; -0.027196615765047654 - 0.02119139424100011im -0.01913667468616122 - 0.034278512549471285im … 0.010606912563706562 - 0.010842933346390412im -0.0072065003604340535 - 0.016268924365130954im; -0.03672072058116931 - 0.02089042480225793im -0.00691191359516882 - 0.030225739577141485im … -0.003125511777471842 - 0.03565960727585804im -0.031533513946020504 - 0.027465764205356263im;;; … ;;; -0.0019669606358949264 - 0.025993897799698528im 0.01815176525292269 - 0.019004854588206235im … -0.07190326619242654 + 0.01011301374816399im -0.04233436352473894 - 0.021431317795731174im; 0.02294103551579758 - 0.02166250869845185im 0.037458120905625995 - 0.014178758087924254im … -0.027944643239509286 - 0.013810913037311603im -0.006897379206293698 - 0.028623335158723784im; … ; 0.004098087111599463 + 0.01192568684796445im 0.005172677545700917 + 0.0046594715410317525im … -0.060724813775371714 + 0.03762523980777134im -0.024337830190245026 + 0.030192761497766334im; -0.023609645421591198 + 0.005113224357502335im -0.004691474478345113 - 0.006733746500673606im … -0.08672360057790893 + 0.0681045676883485im -0.07077170050397655 + 0.02409658104695553im;;; 0.03445395743240677 - 0.07345742737952439im 0.04666248590779064 - 0.03799375419570248im … -0.06167436504595383 - 0.038041529450231586im 0.03184297297701288 - 0.06422735220693997im; 0.07132811341281256 - 0.038284709100573855im 0.07533401165615869 - 0.005531985711729777im … -0.011201711419506127 - 0.061244099775285846im 0.03743319669137009 - 0.059390617682836974im; … ; 0.02627908756448081 + 0.010598927705218449im 0.008669092023530292 + 0.00853574631161301im … -0.0649924059971794 + 0.06714970720440408im 0.009205037591089892 + 0.015926918651712654im; 0.0017735209716455013 - 0.012072636521180234im -0.014316243797042452 - 0.015554342630828537im … -0.11817138560781534 + 0.03984355586128785im -0.017351157197631174 - 0.0004340138181394356im;;; 0.033322725228637794 - 0.0871585136186748im 0.035974131553624236 - 0.03210433055613508im … -0.00632244474710565 - 0.13320963728963514im 0.04259574449267356 - 0.1416096661539626im; 0.060891154343427914 - 0.028900958892912602im 0.07756242355104451 + 0.024198538959193903im … 0.02044326703412081 - 0.10991067225956178im 0.0665496056731366 - 0.0769546164891015im; … ; 0.005934445074094015 + 0.029934688256058398im -0.031825005655997426 + 0.02258380862682234im … 0.0014223362028649024 - 0.015991665238536713im 0.0568113669895252 - 0.012307145730642453im; -0.02746863306594735 - 0.05336779202171641im -0.028891033439223952 - 0.027378233574028254im … -0.025441940250223567 - 0.0579712241282765im 0.019861571398560415 - 0.053452386064598366im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417761498088 -0.487426676410065 … -0.7026973955397497 -0.487426676410065; -0.48742667641006465 -0.7738703031165542 … -0.4139390183393987 -0.3817933912207616; … ; -0.70269739553975 -0.4139390183393989 … -2.3968902180566376 -1.294138609202848; -0.4874266764100649 -0.38179339122076206 … -1.294138609202848 -0.7738703031165541;;; -0.487426676410065 -0.7738703031165541 … -0.41393901833939883 -0.3817933912207616; -0.7738703031165539 -1.4815303728816778 … -0.32444274393779116 -0.44995655436013826; … ; -0.413939018339399 -0.3244427439377914 … -1.0113865017682349 -0.6391785259200922; -0.3817933912207617 -0.4499565543601387 … -0.6391785259200924 -0.44995655436013837;;; -0.7026973955397497 -1.2941386092028484 … -0.29832133494662205 -0.413939018339399; -1.294138609202848 -2.9234702459028528 … -0.35179963884327337 -0.6391785259200924; … ; -0.2983213349466223 -0.3517996388432737 … -0.49060647083941983 -0.3517996388432735; -0.413939018339399 -0.6391785259200927 … -0.35179963884327314 -0.32444274393779127;;; … ;;; -1.0150481268738236 -0.5338983581177804 … -3.6380389414927654 -1.9993625019793697; -0.5338983581177801 -0.32169882700832286 … -1.4639475300052418 -0.9061370442136036; … ; -3.6380389414927654 -1.4639475300052418 … -10.99362124307688 -8.08655129245294; -1.9993625019793697 -0.9061370442136036 … -8.08655129245294 -4.647852558442587;;; -0.7026973955397497 -0.41393901833939895 … -2.396890218056638 -1.2941386092028486; -0.4139390183393988 -0.32444274393779116 … -1.0113865017682342 -0.6391785259200924; … ; -2.3968902180566376 -1.0113865017682342 … -11.003061433402305 -6.073393711806188; -1.2941386092028482 -0.6391785259200926 … -6.073393711806189 -2.9234702459028528;;; -0.4874266764100651 -0.38179339122076156 … -1.2941386092028486 -0.7738703031165541; -0.38179339122076156 -0.4499565543601383 … -0.6391785259200923 -0.4499565543601382; … ; -1.2941386092028486 -0.6391785259200924 … -6.073393711806189 -2.923470245902852; -0.7738703031165539 -0.4499565543601386 … -2.9234702459028528 -1.4815303728816775])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417761498088 -0.487426676410065 … -0.7026973955397497 -0.487426676410065; -0.48742667641006465 -0.7738703031165542 … -0.4139390183393987 -0.3817933912207616; … ; -0.70269739553975 -0.4139390183393989 … -2.3968902180566376 -1.294138609202848; -0.4874266764100649 -0.38179339122076206 … -1.294138609202848 -0.7738703031165541;;; -0.487426676410065 -0.7738703031165541 … -0.41393901833939883 -0.3817933912207616; -0.7738703031165539 -1.4815303728816778 … -0.32444274393779116 -0.44995655436013826; … ; -0.413939018339399 -0.3244427439377914 … -1.0113865017682349 -0.6391785259200922; -0.3817933912207617 -0.4499565543601387 … -0.6391785259200924 -0.44995655436013837;;; -0.7026973955397497 -1.2941386092028484 … -0.29832133494662205 -0.413939018339399; -1.294138609202848 -2.9234702459028528 … -0.35179963884327337 -0.6391785259200924; … ; -0.2983213349466223 -0.3517996388432737 … -0.49060647083941983 -0.3517996388432735; -0.413939018339399 -0.6391785259200927 … -0.35179963884327314 -0.32444274393779127;;; … ;;; -1.0150481268738236 -0.5338983581177804 … -3.6380389414927654 -1.9993625019793697; -0.5338983581177801 -0.32169882700832286 … -1.4639475300052418 -0.9061370442136036; … ; -3.6380389414927654 -1.4639475300052418 … -10.99362124307688 -8.08655129245294; -1.9993625019793697 -0.9061370442136036 … -8.08655129245294 -4.647852558442587;;; -0.7026973955397497 -0.41393901833939895 … -2.396890218056638 -1.2941386092028486; -0.4139390183393988 -0.32444274393779116 … -1.0113865017682342 -0.6391785259200924; … ; -2.3968902180566376 -1.0113865017682342 … -11.003061433402305 -6.073393711806188; -1.2941386092028482 -0.6391785259200926 … -6.073393711806189 -2.9234702459028528;;; -0.4874266764100651 -0.38179339122076156 … -1.2941386092028486 -0.7738703031165541; -0.38179339122076156 -0.4499565543601383 … -0.6391785259200923 -0.4499565543601382; … ; -1.2941386092028486 -0.6391785259200924 … -6.073393711806189 -2.923470245902852; -0.7738703031165539 -0.4499565543601386 … -2.9234702459028528 -1.4815303728816775]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.022884066783868347 + 0.025953050416493997im -0.0077327723732752264 + 0.009854667159052045im … -0.006342269999110448 - 0.05439905930890711im 0.052696426102537726 + 0.033221422119322996im; -0.006182863769229023 + 0.010998105886979189im -0.04037101857410527 - 0.04610344884076089im … 0.04891367214048983 + 0.04133128303066094im 0.07503610944297325 + 0.10556242286589115im; … ; 0.020946272218291446 - 0.002088293543586248im 0.03759833427373299 + 0.01009694186729219im … -0.007406949152039212 + 0.008249827820896557im 0.04768274199482819 + 0.0600146029019838im; 0.016797901730662704 + 0.004863401227395389im 0.05684656413843492 + 0.06614954378811655im … -0.04848406418807783 - 0.05541884500901605im 0.012614795809623967 + 0.005590667108587857im;;; -0.01965892949939412 + 0.009025447132905007im -0.020752988116814523 + 0.002582380091890871im … 0.03458953349879835 + 0.03492979894352544im 0.04776993892922331 + 0.08925433285484347im; -0.024973664410276823 - 0.01719349375469433im -0.021233784779379494 + 0.010650390149085715im … 0.04426887340699912 + 0.05344336139888669im 0.03388272620898149 + 0.06280711854317997im; … ; -0.038103539383250735 + 0.004720318822032684im 0.0020336817421321026 + 0.048231738568306856im … 0.003368498531651903 + 0.006952581661189277im 0.0030552720228594977 + 0.03873405494890612im; -0.049902621561647015 + 0.031327931257112175im -0.0012409522436697443 + 0.06618021775968762im … -0.005580887487561208 + 0.003914447627451042im -0.013492881516639538 + 0.05266509618704481im;;; 0.02083786643985365 - 0.004196907220664822im 0.054442868455577643 + 0.019672072001798276im … 0.013327837860022774 + 0.038442849522875314im 0.005026645313468815 + 0.045288572478654365im; 0.0036958966869328424 - 0.027358426113619883im 0.042485969617422015 + 0.06965721971350519im … 0.007819820093659408 + 0.0218178947894924im -0.005675776049351018 + 0.00013272682117533748im; … ; -0.03337990059812837 + 0.01861316064393513im 1.093843649433053e-5 + 0.038903606816464154im … -0.0003954419240361452 + 0.01491787972799077im -0.019365742693470682 + 0.023021847804419238im; -0.025521153234264838 + 0.02671705053210635im 0.028541730181174396 + 0.054818412194200236im … 0.0002935936964976898 + 0.02450692791787695im -0.02571281074521036 + 0.04124819650539037im;;; … ;;; 0.005787526402266704 - 0.02814734900414821im -0.0004939381523209226 + 0.004955082897874972im … 0.004498055648791938 - 0.03138682690335599im 0.00884293988817634 - 0.05486707990328096im; -0.007256091904460965 + 0.005719593480297518im -0.0061238822725579525 + 0.018158275105471855im … -0.006476780320280166 - 0.03436376762836868im -0.00470823270588108 - 0.024264436573971634im; … ; 0.00432207555260315 - 0.027838750942953357im 0.002956110809433302 - 0.026273977095854495im … -0.02069656889386489 - 0.021627968619857253im -0.00887218248217696 - 0.0011136188170772752im; 0.020505589551469975 - 0.04658736132847864im 0.004271989303027198 - 0.027941033264623945im … 0.014355174677729964 + 0.0167893782069512im 0.024493261597126337 - 0.01866249907734899im;;; 7.691668810229629e-6 - 0.006443997424682209im -0.00012431498174347876 + 0.04322079427853189im … -0.04016716748219194 - 0.10108895128751802im -0.008315385595411957 - 0.07060020511875251im; -0.015530112961584313 + 0.04758106612206076im -0.01540489038296551 + 0.03096385456920023im … -0.019523438571145406 - 0.04596604810469514im -0.014396367032682673 - 0.012125263858112552im; … ; 0.009848971157258673 - 0.027266657549885526im 0.005207336002623202 - 0.033757797138340706im … -0.01375148504878026 - 0.0032044525116604098im 0.010357590360522407 + 0.028497294594516075im; 0.027717105269601472 - 0.04457189069099704im 0.018933665628077016 - 0.003779303568350861im … -0.00865470946180175 + 0.010047036697896496im 0.014769855732528293 - 0.04423501462290136im;;; 0.01128719670619351 + 0.041954884241034135im 0.010787715771612826 + 0.06297679471546729im … -0.059101169296789866 - 0.09772934688854892im 0.0014726375529649617 - 0.03440822220453307im; -0.007714603518963701 + 0.07299521321847578im -0.021833573562826412 + 0.0031467542155549076im … -0.00767135575383943 - 0.03084622171767966im 0.02570776377136475 + 0.06719158835078766im; … ; 0.022096280005719483 + 0.006365780017780602im 0.026168873011244376 - 0.010135259312163131im … -0.024942923073972986 + 0.03365622754633249im 0.032054428477319735 + 0.08954205164718929im; 0.036311605607872215 - 0.0015161078341214653im 0.05899882693625817 + 0.051421448050379334im … -0.07434478959495067 - 0.04920116590383848im 0.009773513748272393 - 0.001260555649747465im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417761498088 -0.487426676410065 … -0.7026973955397497 -0.487426676410065; -0.48742667641006465 -0.7738703031165542 … -0.4139390183393987 -0.3817933912207616; … ; -0.70269739553975 -0.4139390183393989 … -2.3968902180566376 -1.294138609202848; -0.4874266764100649 -0.38179339122076206 … -1.294138609202848 -0.7738703031165541;;; -0.487426676410065 -0.7738703031165541 … -0.41393901833939883 -0.3817933912207616; -0.7738703031165539 -1.4815303728816778 … -0.32444274393779116 -0.44995655436013826; … ; -0.413939018339399 -0.3244427439377914 … -1.0113865017682349 -0.6391785259200922; -0.3817933912207617 -0.4499565543601387 … -0.6391785259200924 -0.44995655436013837;;; -0.7026973955397497 -1.2941386092028484 … -0.29832133494662205 -0.413939018339399; -1.294138609202848 -2.9234702459028528 … -0.35179963884327337 -0.6391785259200924; … ; -0.2983213349466223 -0.3517996388432737 … -0.49060647083941983 -0.3517996388432735; -0.413939018339399 -0.6391785259200927 … -0.35179963884327314 -0.32444274393779127;;; … ;;; -1.0150481268738236 -0.5338983581177804 … -3.6380389414927654 -1.9993625019793697; -0.5338983581177801 -0.32169882700832286 … -1.4639475300052418 -0.9061370442136036; … ; -3.6380389414927654 -1.4639475300052418 … -10.99362124307688 -8.08655129245294; -1.9993625019793697 -0.9061370442136036 … -8.08655129245294 -4.647852558442587;;; -0.7026973955397497 -0.41393901833939895 … -2.396890218056638 -1.2941386092028486; -0.4139390183393988 -0.32444274393779116 … -1.0113865017682342 -0.6391785259200924; … ; -2.3968902180566376 -1.0113865017682342 … -11.003061433402305 -6.073393711806188; -1.2941386092028482 -0.6391785259200926 … -6.073393711806189 -2.9234702459028528;;; -0.4874266764100651 -0.38179339122076156 … -1.2941386092028486 -0.7738703031165541; -0.38179339122076156 -0.4499565543601383 … -0.6391785259200923 -0.4499565543601382; … ; -1.2941386092028486 -0.6391785259200924 … -6.073393711806189 -2.923470245902852; -0.7738703031165539 -0.4499565543601386 … -2.9234702459028528 -1.4815303728816775])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417761498088 -0.487426676410065 … -0.7026973955397497 -0.487426676410065; -0.48742667641006465 -0.7738703031165542 … -0.4139390183393987 -0.3817933912207616; … ; -0.70269739553975 -0.4139390183393989 … -2.3968902180566376 -1.294138609202848; -0.4874266764100649 -0.38179339122076206 … -1.294138609202848 -0.7738703031165541;;; -0.487426676410065 -0.7738703031165541 … -0.41393901833939883 -0.3817933912207616; -0.7738703031165539 -1.4815303728816778 … -0.32444274393779116 -0.44995655436013826; … ; -0.413939018339399 -0.3244427439377914 … -1.0113865017682349 -0.6391785259200922; -0.3817933912207617 -0.4499565543601387 … -0.6391785259200924 -0.44995655436013837;;; -0.7026973955397497 -1.2941386092028484 … -0.29832133494662205 -0.413939018339399; -1.294138609202848 -2.9234702459028528 … -0.35179963884327337 -0.6391785259200924; … ; -0.2983213349466223 -0.3517996388432737 … -0.49060647083941983 -0.3517996388432735; -0.413939018339399 -0.6391785259200927 … -0.35179963884327314 -0.32444274393779127;;; … ;;; -1.0150481268738236 -0.5338983581177804 … -3.6380389414927654 -1.9993625019793697; -0.5338983581177801 -0.32169882700832286 … -1.4639475300052418 -0.9061370442136036; … ; -3.6380389414927654 -1.4639475300052418 … -10.99362124307688 -8.08655129245294; -1.9993625019793697 -0.9061370442136036 … -8.08655129245294 -4.647852558442587;;; -0.7026973955397497 -0.41393901833939895 … -2.396890218056638 -1.2941386092028486; -0.4139390183393988 -0.32444274393779116 … -1.0113865017682342 -0.6391785259200924; … ; -2.3968902180566376 -1.0113865017682342 … -11.003061433402305 -6.073393711806188; -1.2941386092028482 -0.6391785259200926 … -6.073393711806189 -2.9234702459028528;;; -0.4874266764100651 -0.38179339122076156 … -1.2941386092028486 -0.7738703031165541; -0.38179339122076156 -0.4499565543601383 … -0.6391785259200923 -0.4499565543601382; … ; -1.2941386092028486 -0.6391785259200924 … -6.073393711806189 -2.923470245902852; -0.7738703031165539 -0.4499565543601386 … -2.9234702459028528 -1.4815303728816775]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.02556716516327754 - 0.03864304502210219im -0.028719792210725178 - 0.05212648246293662im … 0.005391486390440786 - 0.002333351300597192im -0.010632296329294327 - 0.009429273969120001im; -0.04329076360883714 - 0.039992749696051814im -0.01945718439173698 - 0.03860841451315905im … -0.025530554320149265 - 0.029807809125023437im -0.039221152135800075 - 0.025939904528074435im; … ; 0.030918047790514526 + 0.018734210550064828im 0.021725856914885315 + 0.012129941827325462im … 0.03756044369130568 + 0.03326526249603748im 0.03166933751590164 + 0.028773794478419296im; 0.02977776606818846 + 0.009524276170317116im 0.006272817567987973 - 0.02076728019620106im … 0.04217257000359575 + 0.03802532896942353im 0.02263858855933007 + 0.023071296405024026im;;; -0.040986717358367716 - 0.1150473762990287im -0.06024248765669914 - 0.0035283749247958236im … -0.0283825270770975 - 0.014418120684772148im -0.037495887476961184 - 0.062286636632862144im; -0.033010031268651194 - 0.04549313243974069im -0.03220209232383364 + 0.06069174197494786im … -0.024385372623711488 - 0.036733968489782144im -0.045339393839868895 - 0.0786944256228034im; … ; 0.042400113614904034 - 0.059120707680881526im 0.002827665628467902 + 0.0014432294168951398im … 0.02013720626694792 - 0.0031979095556295793im 0.03580220550315355 - 0.04430631845861739im; 0.01092210738266837 - 0.05389977771270739im -0.03323248050302958 - 0.019487158221365458im … 0.01061972004614703 - 0.004519294190688461im 0.01955416433879128 - 0.057724415995251105im;;; -0.053647476581129366 + 0.0238822040348794im -0.07703198960146032 + 0.1093130368861753im … -0.02233072048723872 - 0.01717201241952291im -0.03186377654318606 - 0.0282921461569314im; -0.016327470694896998 + 0.03986812973368814im -0.018720790737101888 + 0.14204389726886707im … -0.015111417386622347 - 0.02726619876749858im -0.022840158016483692 - 0.020240446327810864im; … ; 0.0012350060046308355 - 0.0039557603487820345im -0.02279429469155493 + 0.031968693092856826im … 0.007663142056327002 - 0.016313165425269765im 0.01780610297970441 - 0.04005233404181721im; -0.02479773546907827 + 0.011287797905236173im -0.060646452753357734 + 0.0628573239153257im … -0.005581287575312853 - 0.0150003062880275im -0.013234197441134445 - 0.015782136235425254im;;; … ;;; 0.010810638675240533 - 0.00606747478041607im 0.01697177621304594 + 0.029949723664920103im … 0.0006829563723273912 - 0.004042055944064352im 0.011667247841601443 - 0.060777837712601035im; 0.01348778910456555 + 0.0092585780965346im 0.009979214049956948 + 0.025205747841946406im … 0.004739718919315173 - 0.016496010803925158im 0.013142561501673783 - 0.02794448630356244im; … ; -0.006820131039770345 - 0.053140650590445926im -0.002900429898063898 - 0.0017557795076709325im … -0.022086143555826082 + 0.028283847438571763im -0.004299690503830317 - 0.07492273087386474im; 0.004298970718174262 - 0.051444569384500455im 0.009316890795423676 + 0.01219306963960169im … 0.009909833242792312 + 0.004011473461725999im 0.01879474818820066 - 0.09979429180181831im;;; 0.020406048017227167 + 0.05235539282714342im 0.025543720650605395 + 0.06807321199888947im … 0.024465584987437693 - 0.03176765280724981im 0.04258215696584062 - 0.08233443773101157im; 0.015147632353040914 + 0.053312757336978836im 0.0048570105899681665 + 0.03255923490912586im … 0.016466994229965434 - 0.05012560226329055im 0.02618689574964457 - 0.039386840741374926im; … ; 0.009173666574680526 + 0.0005492975181476536im 0.008337043615639769 + 0.040554440804420756im … 0.022609054337351307 - 0.04069885471067365im 0.036567777335042004 - 0.10809340674875653im; 0.027152854537276568 - 0.004577633435505083im 0.0333702829328605 + 0.04927936098499836im … 0.03193949186613295 - 0.006660601042256432im 0.043515060875099626 - 0.1039484131396995im;;; 0.0036339030771067116 + 0.08676258422670714im 0.011646210991767901 + 0.027633082658826403im … 0.041407754513999806 - 0.03214395506431181im 0.028662467185466108 - 0.0032091159567210433im; -0.010295846917432357 + 0.04559736677363878im -0.01639515316765973 - 0.006436436331620069im … 0.004027064932500549 - 0.056438541111288286im 0.008347314100223305 - 0.01720079597359995im; … ; 0.026794924799912037 + 0.05391231672329441im 0.03048622681945231 + 0.052773314917895324im … 0.05792625643059271 - 0.01271273911200968im 0.04715018138518831 + 0.006108890180213139im; 0.026084171719984936 + 0.08020387837182774im 0.03867032254065475 + 0.04830072072281635im … 0.058522542483534626 + 0.020111028588488858im 0.06312517320201512 - 0.012714503132219841im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417761498088 -0.487426676410065 … -0.7026973955397497 -0.487426676410065; -0.48742667641006465 -0.7738703031165542 … -0.4139390183393987 -0.3817933912207616; … ; -0.70269739553975 -0.4139390183393989 … -2.3968902180566376 -1.294138609202848; -0.4874266764100649 -0.38179339122076206 … -1.294138609202848 -0.7738703031165541;;; -0.487426676410065 -0.7738703031165541 … -0.41393901833939883 -0.3817933912207616; -0.7738703031165539 -1.4815303728816778 … -0.32444274393779116 -0.44995655436013826; … ; -0.413939018339399 -0.3244427439377914 … -1.0113865017682349 -0.6391785259200922; -0.3817933912207617 -0.4499565543601387 … -0.6391785259200924 -0.44995655436013837;;; -0.7026973955397497 -1.2941386092028484 … -0.29832133494662205 -0.413939018339399; -1.294138609202848 -2.9234702459028528 … -0.35179963884327337 -0.6391785259200924; … ; -0.2983213349466223 -0.3517996388432737 … -0.49060647083941983 -0.3517996388432735; -0.413939018339399 -0.6391785259200927 … -0.35179963884327314 -0.32444274393779127;;; … ;;; -1.0150481268738236 -0.5338983581177804 … -3.6380389414927654 -1.9993625019793697; -0.5338983581177801 -0.32169882700832286 … -1.4639475300052418 -0.9061370442136036; … ; -3.6380389414927654 -1.4639475300052418 … -10.99362124307688 -8.08655129245294; -1.9993625019793697 -0.9061370442136036 … -8.08655129245294 -4.647852558442587;;; -0.7026973955397497 -0.41393901833939895 … -2.396890218056638 -1.2941386092028486; -0.4139390183393988 -0.32444274393779116 … -1.0113865017682342 -0.6391785259200924; … ; -2.3968902180566376 -1.0113865017682342 … -11.003061433402305 -6.073393711806188; -1.2941386092028482 -0.6391785259200926 … -6.073393711806189 -2.9234702459028528;;; -0.4874266764100651 -0.38179339122076156 … -1.2941386092028486 -0.7738703031165541; -0.38179339122076156 -0.4499565543601383 … -0.6391785259200923 -0.4499565543601382; … ; -1.2941386092028486 -0.6391785259200924 … -6.073393711806189 -2.923470245902852; -0.7738703031165539 -0.4499565543601386 … -2.9234702459028528 -1.4815303728816775])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417761498088 -0.487426676410065 … -0.7026973955397497 -0.487426676410065; -0.48742667641006465 -0.7738703031165542 … -0.4139390183393987 -0.3817933912207616; … ; -0.70269739553975 -0.4139390183393989 … -2.3968902180566376 -1.294138609202848; -0.4874266764100649 -0.38179339122076206 … -1.294138609202848 -0.7738703031165541;;; -0.487426676410065 -0.7738703031165541 … -0.41393901833939883 -0.3817933912207616; -0.7738703031165539 -1.4815303728816778 … -0.32444274393779116 -0.44995655436013826; … ; -0.413939018339399 -0.3244427439377914 … -1.0113865017682349 -0.6391785259200922; -0.3817933912207617 -0.4499565543601387 … -0.6391785259200924 -0.44995655436013837;;; -0.7026973955397497 -1.2941386092028484 … -0.29832133494662205 -0.413939018339399; -1.294138609202848 -2.9234702459028528 … -0.35179963884327337 -0.6391785259200924; … ; -0.2983213349466223 -0.3517996388432737 … -0.49060647083941983 -0.3517996388432735; -0.413939018339399 -0.6391785259200927 … -0.35179963884327314 -0.32444274393779127;;; … ;;; -1.0150481268738236 -0.5338983581177804 … -3.6380389414927654 -1.9993625019793697; -0.5338983581177801 -0.32169882700832286 … -1.4639475300052418 -0.9061370442136036; … ; -3.6380389414927654 -1.4639475300052418 … -10.99362124307688 -8.08655129245294; -1.9993625019793697 -0.9061370442136036 … -8.08655129245294 -4.647852558442587;;; -0.7026973955397497 -0.41393901833939895 … -2.396890218056638 -1.2941386092028486; -0.4139390183393988 -0.32444274393779116 … -1.0113865017682342 -0.6391785259200924; … ; -2.3968902180566376 -1.0113865017682342 … -11.003061433402305 -6.073393711806188; -1.2941386092028482 -0.6391785259200926 … -6.073393711806189 -2.9234702459028528;;; -0.4874266764100651 -0.38179339122076156 … -1.2941386092028486 -0.7738703031165541; -0.38179339122076156 -0.4499565543601383 … -0.6391785259200923 -0.4499565543601382; … ; -1.2941386092028486 -0.6391785259200924 … -6.073393711806189 -2.923470245902852; -0.7738703031165539 -0.4499565543601386 … -2.9234702459028528 -1.4815303728816775]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.03840317572301635 + 0.029161953091634083im 0.0013027529961468546 - 0.005579928498991008im … -0.06154204706130186 - 0.06808276848914886im 0.008968841742246023 + 0.006313065613155419im; 0.018018651736712722 + 0.009174637546722944im -0.0098662652306054 - 0.009768602663553928im … -0.006252008024096749 - 0.020629509799979465im 0.058842134256186895 + 0.0560094592318645im; … ; 0.008538073181596401 + 0.009662007415302246im 0.012763285740825692 + 0.022743471092797285im … -0.0224319898030181 - 0.024600397077168486im -0.03130080968803973 - 0.03471227696341023im; 0.019029307617066806 + 0.030470067392829998im 0.014120008114291932 + 0.029036112376972928im … -0.07100786219055244 - 0.06827502760696946im -0.027266838722614907 - 0.021371461968310197im;;; 0.018139364834568905 + 0.05609567718632712im 0.007028786522807159 - 0.03222794401384224im … -0.03657672726977222 + 0.01305851076947129im 0.02290214526739067 + 0.07774358501788678im; 0.03337065902726824 - 0.026052282735742296im -0.03286866478026765 - 0.0037240834187245056im … 0.015303885570236361 + 0.06319642700163156im 0.056461682449025365 + 0.05805089867779925im; … ; -0.02184379120747508 + 0.0661687691993052im -0.009761473802881003 + 0.04402205943918962im … -0.023117538793006626 - 0.01775679256805139im -0.024145238953964768 + 0.013403753560864722im; -0.013120799746866647 + 0.09835032581673014im -0.012182580591000716 + 0.03303723829765951im … -0.04563558241315334 - 0.010806647756422474im -0.027228411290808604 + 0.04268922063201219im;;; 0.024062032018388184 - 0.05892402472164279im 0.035482049252177475 - 0.09873821417074682im … 0.0031138702238698197 + 0.02785816758258043im 0.028350985522738494 + 0.024258682274155223im; 0.019788178592492506 - 0.08557287130952329im 0.017221765963160038 - 0.07954327992165808im … 0.026180725043019 + 0.030169221011278457im 0.04896197000557938 - 0.024602182822426814im; … ; -0.02131028073524737 + 0.04318241309810869im -0.0013003801783141595 + 0.011998534914587664im … -0.015550613875286513 + 0.0032946831633395707im -0.020151189004836874 + 0.025714939869958025im; -0.004842247975376298 + 0.02520351394998433im 0.017837578307753378 - 0.061136040033424974im … -0.018884259450871348 + 0.012696322170728047im -0.010199175624079827 + 0.030614472196784728im;;; … ;;; -0.0070398533948070035 + 0.021419997040149973im 0.002237104684794386 + 0.008149882030728507im … -0.053446168113539125 + 0.03991387818324879im -0.03227838407964029 + 0.023042052017499287im; 0.00037090958401371943 + 0.022532819282021804im -0.003474684770731825 + 0.008635979544431687im … -0.038189974718751116 + 0.02676433875249104im -0.00927800732553484 + 0.017703578647663244im; … ; -0.03315838239697628 + 0.0362523772400203im -0.013241051620123902 + 0.019032233966398623im … 0.010070565242250954 - 0.013637697667265967im -0.03294822991995833 + 0.02469767295446631im; -0.0284941912943195 + 0.03865770130098185im -0.0072693012808790316 + 0.015020582318880182im … -0.036667217236166096 + 0.03570766262438445im -0.0413713922961754 + 0.038751907266226265im;;; 0.0017407090793497865 + 0.01752014804543152im -0.010156038138563979 + 0.0013223680233008677im … -0.08163874906760664 + 0.0377669545544662im -0.00840686927327205 - 0.002382078601431948im; -0.003901952087308321 + 0.05239178111980417im 0.008095926384226954 - 0.0067140786278221025im … -0.01285907381923407 - 0.008520551743293267im 0.03840783042650324 - 0.011998558425680608im; … ; -0.04956636985410649 + 0.04851131493467711im -0.00876968610458305 + 0.013028059838275007im … -0.02619150768273626 + 0.037765270941809426im -0.06657304835365777 + 0.06051088179761856im; -0.014717650079344318 + 0.02774159886605991im 0.009332364074049724 + 0.00010510522262705921im … -0.060142826944237254 + 0.0452601132574683im -0.06346221662826212 + 0.04685534904184317im;;; 0.012001755560315679 + 0.02513320514281464im 0.016922313840983264 - 0.027473551698227988im … -0.049925749386422205 - 0.0575261177423919im 0.02180284743024677 - 0.05031825648193779im; 0.03908078438148473 + 0.028265400713305956im 0.0006153146043430135 - 0.01633517228751792im … 0.02577672264560587 - 0.07330659258705127im 0.0629809245527363 + 0.00469724746631486im; … ; -0.018049408987557886 + 0.002534010717926574im 0.020548582721414778 - 0.011928822954732025im … -0.022420719758229027 + 0.031728454276114884im -0.06426781433921551 + 0.013669702849528622im; 0.02295108285534811 - 0.017014023302562853im 0.015835845209785746 - 0.009990015015673315im … -0.06634525155097097 - 0.007499694290955299im -0.05199716200227275 - 0.01255195579547685im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729847), converged = true, ρ = [0.09132316917746977 0.0874741913407994 … 0.07684754935962762 0.0874741913407994; 0.08747419134079938 0.08089966872163556 … 0.0764247101697129 0.08486944834426362; … ; 0.07684754935962762 0.0764247101697129 … 0.047784666671015115 0.06587895342302937; 0.08747419134079941 0.08486944834426363 … 0.06587895342302937 0.08089966872163556;;; 0.08747419134079938 0.08089966872163556 … 0.0764247101697129 0.08486944834426363; 0.08089966872163556 0.06744471469774264 … 0.07348669934704141 0.08163768629014395; … ; 0.0764247101697129 0.07348669934704141 … 0.061888041199961254 0.07259829028446593; 0.08486944834426363 0.08163768629014397 … 0.07259829028446593 0.08163768629014395;;; 0.0768475493596276 0.06587895342302937 … 0.06847203698973582 0.07642471016971292; 0.06587895342302937 0.04657864264980506 … 0.06665759371631749 0.07259829028446593; … ; 0.06847203698973582 0.06665759371631749 … 0.06132515314380724 0.06665759371631748; 0.07642471016971293 0.07259829028446595 … 0.06665759371631749 0.07348669934704141;;; … ;;; 0.06328495229885527 0.06591651445952426 … 0.03394064888051452 0.049875934859985364; 0.06591651445952426 0.06297790960105419 … 0.04975639788527202 0.0608702045714594; … ; 0.03394064888051452 0.04975639788527202 … 0.009696353214073083 0.01683133879258968; 0.04987593485998537 0.06087020457145941 … 0.016831338792589683 0.03098572188504692;;; 0.07684754935962762 0.07642471016971292 … 0.04778466667101513 0.06587895342302937; 0.07642471016971292 0.0734866993470414 … 0.061888041199961254 0.07259829028446595; … ; 0.04778466667101513 0.06188804119996127 … 0.009696353214073085 0.02571001067530267; 0.06587895342302938 0.07259829028446596 … 0.025710010675302677 0.04657864264980507;;; 0.08747419134079938 0.08486944834426362 … 0.06587895342302937 0.08089966872163556; 0.08486944834426362 0.08163768629014394 … 0.07259829028446593 0.08163768629014395; … ; 0.06587895342302937 0.07259829028446593 … 0.025710010675302677 0.04657864264980507; 0.08089966872163558 0.08163768629014395 … 0.04657864264980508 0.06744471469774267;;;;], eigenvalues = [[-0.16677707596304703, 0.264277717829955, 0.264277717829962, 0.2642777178299661, 0.35732037190452925, 0.3573203719045334, 0.357320371904538], [-0.11613218761080446, 0.07040532320006891, 0.22624813603026284, 0.22624813603026384, 0.33611784894605357, 0.39343797761801413, 0.39343797761801513], [-0.0958893814363732, 0.08764319967962328, 0.17312704142744262, 0.17312704142745916, 0.29197248922131763, 0.3377321250729052, 0.5327646516180078], [-0.045051463485909556, 0.022269526239847313, 0.09831189251535818, 0.18446409322120122, 0.322927015162485, 0.48024696083661067, 0.5024422335836025]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2897120818381951, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.6389276401920578 - 0.7104633250135279im -2.362892372997027e-14 - 3.322723385781357e-14im … 2.1834543719836106e-10 - 2.6017648108571504e-10im -1.3564132215034536e-10 + 1.6168718875387188e-10im; 0.06438742160402544 - 0.07159637299162074im 0.06640635743020397 + 0.0480881598493711im … -0.10633233917268617 - 0.044742021502030944im 0.12044767259851484 + 0.009861675706758347im; … ; 0.007886606685425719 - 0.008769607787030639im -0.009965096261025567 - 0.0467234733307761im … -0.011788838163770937 - 0.029410591747156982im 0.0007154857810414432 - 0.05862170077367349im; -0.0643874216040144 + 0.07159637299163589im -0.031154144110872 - 0.40934500210963226im … 0.009200466631572283 - 0.1975809128884252im -0.11455256418413648 - 0.49286393778167903im], [-0.4494759720888153 + 0.812727936778927im -0.18228547374932588 - 0.07503449577224915im … 8.495435713759055e-11 - 4.996248250216387e-12im -2.1553177056587285e-11 - 4.517956413490693e-12im; -0.030641643282630245 + 0.05540522980322314im 0.008113012583193278 + 0.003339573888432573im … -2.546143160493568e-11 - 4.898815838714119e-13im -1.0582698167898565e-11 + 2.7488739810413448e-11im; … ; -0.0037510911997058515 + 0.0067826019647703965im -0.07976520011518269 - 0.03283389206890875im … 0.02026623590799762 - 0.027704251617757497im -0.08252282702924338 - 0.06393708119425096im; 0.054655050475227236 - 0.09882549716918432im 0.08387921633344018 + 0.034527351927154726im … 0.08602123435611372 - 0.11759233032316815im -0.3502730082027206 - 0.2713847133580208im], [0.6393811764148468 - 0.6805016270724306im 2.0208342893376208e-14 - 5.967619851668715e-15im … 5.202112794724457e-11 - 9.946762961974463e-12im -9.454871027384181e-10 + 2.8280322478445908e-9im; 0.04707524213308874 - 0.05010278695726081im -0.05523654369003171 + 0.01482077229630342im … -0.024855563390689818 + 0.004040516279568832im -0.0037097135407027433 - 0.0022972331456099743im; … ; 0.009497605665506278 - 0.010108424124883195im -4.8098622138919226e-14 + 2.816267232571491e-14im … 1.9003460585406207e-10 - 8.966648980339213e-12im -0.014442232679460215 + 0.0634035338212291im; -0.10490892222403446 + 0.11165591809908085im -0.2773182470244228 + 0.07440854040078254im … 0.3768976555341122 - 0.061268420721685im -0.03264953092597038 + 0.14957149135544898im], [0.6875493556650061 + 0.42635356429641813im -6.817552648870042e-15 + 5.397569285133831e-15im … -0.163770922925369 - 0.09116429202091957im 2.648890104833209e-6 + 3.6375832242545332e-6im; 0.3292993604387902 + 0.204200549221393im 0.39553097474016846 - 0.4859692321714151im … 0.15572333906489488 + 0.08668437508668808im -1.3999407622982727e-6 - 1.7310598827561774e-6im; … ; 0.009683064492853794 + 0.006004527567112733im 0.0010375436804208862 - 0.0012747783054161735im … -0.014132764573297771 - 0.007867356969039622im -0.0201204861196841 + 0.03945531130974637im; -0.05539380476099676 - 0.034350037426694666im 0.007881197062444858 - 0.009683234764455016im … -0.11827761650782348 - 0.06583792640453147im -0.2138069898836942 + 0.41929709152029326im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596304703, 0.264277717829955, 0.264277717829962, 0.2642777178299661, 0.35732037190452925, 0.3573203719045334, 0.357320371904538], [-0.11613218761080446, 0.07040532320006891, 0.22624813603026284, 0.22624813603026384, 0.33611784894605357, 0.39343797761801413, 0.39343797761801513], [-0.0958893814363732, 0.08764319967962328, 0.17312704142744262, 0.17312704142745916, 0.29197248922131763, 0.3377321250729052, 0.5327646516180078], [-0.045051463485909556, 0.022269526239847313, 0.09831189251535818, 0.18446409322120122, 0.322927015162485, 0.48024696083661067, 0.5024422335836025]], X = [[0.6389276401920578 - 0.7104633250135279im -2.362892372997027e-14 - 3.322723385781357e-14im … 2.1834543719836106e-10 - 2.6017648108571504e-10im -1.3564132215034536e-10 + 1.6168718875387188e-10im; 0.06438742160402544 - 0.07159637299162074im 0.06640635743020397 + 0.0480881598493711im … -0.10633233917268617 - 0.044742021502030944im 0.12044767259851484 + 0.009861675706758347im; … ; 0.007886606685425719 - 0.008769607787030639im -0.009965096261025567 - 0.0467234733307761im … -0.011788838163770937 - 0.029410591747156982im 0.0007154857810414432 - 0.05862170077367349im; -0.0643874216040144 + 0.07159637299163589im -0.031154144110872 - 0.40934500210963226im … 0.009200466631572283 - 0.1975809128884252im -0.11455256418413648 - 0.49286393778167903im], [-0.4494759720888153 + 0.812727936778927im -0.18228547374932588 - 0.07503449577224915im … 8.495435713759055e-11 - 4.996248250216387e-12im -2.1553177056587285e-11 - 4.517956413490693e-12im; -0.030641643282630245 + 0.05540522980322314im 0.008113012583193278 + 0.003339573888432573im … -2.546143160493568e-11 - 4.898815838714119e-13im -1.0582698167898565e-11 + 2.7488739810413448e-11im; … ; -0.0037510911997058515 + 0.0067826019647703965im -0.07976520011518269 - 0.03283389206890875im … 0.02026623590799762 - 0.027704251617757497im -0.08252282702924338 - 0.06393708119425096im; 0.054655050475227236 - 0.09882549716918432im 0.08387921633344018 + 0.034527351927154726im … 0.08602123435611372 - 0.11759233032316815im -0.3502730082027206 - 0.2713847133580208im], [0.6393811764148468 - 0.6805016270724306im 2.0208342893376208e-14 - 5.967619851668715e-15im … 5.202112794724457e-11 - 9.946762961974463e-12im -9.454871027384181e-10 + 2.8280322478445908e-9im; 0.04707524213308874 - 0.05010278695726081im -0.05523654369003171 + 0.01482077229630342im … -0.024855563390689818 + 0.004040516279568832im -0.0037097135407027433 - 0.0022972331456099743im; … ; 0.009497605665506278 - 0.010108424124883195im -4.8098622138919226e-14 + 2.816267232571491e-14im … 1.9003460585406207e-10 - 8.966648980339213e-12im -0.014442232679460215 + 0.0634035338212291im; -0.10490892222403446 + 0.11165591809908085im -0.2773182470244228 + 0.07440854040078254im … 0.3768976555341122 - 0.061268420721685im -0.03264953092597038 + 0.14957149135544898im], [0.6875493556650061 + 0.42635356429641813im -6.817552648870042e-15 + 5.397569285133831e-15im … -0.163770922925369 - 0.09116429202091957im 2.648890104833209e-6 + 3.6375832242545332e-6im; 0.3292993604387902 + 0.204200549221393im 0.39553097474016846 - 0.4859692321714151im … 0.15572333906489488 + 0.08668437508668808im -1.3999407622982727e-6 - 1.7310598827561774e-6im; … ; 0.009683064492853794 + 0.006004527567112733im 0.0010375436804208862 - 0.0012747783054161735im … -0.014132764573297771 - 0.007867356969039622im -0.0201204861196841 + 0.03945531130974637im; -0.05539380476099676 - 0.034350037426694666im 0.007881197062444858 - 0.009683234764455016im … -0.11827761650782348 - 0.06583792640453147im -0.2138069898836942 + 0.41929709152029326im]], residual_norms = [[3.9539445320755705e-13, 5.102714876404908e-13, 5.874055459817095e-13, 2.7342642165111893e-13, 3.854905145031666e-9, 3.183500346944078e-9, 1.9786019635322037e-9], [1.183532254832142e-13, 5.195818363918659e-13, 2.978420472988575e-13, 1.4079530905499698e-13, 3.0611614947175076e-10, 4.699243590610776e-10, 4.5355146377288734e-10], [4.558125203803249e-13, 4.563838791513982e-13, 1.8081315462017363e-13, 1.7966167057294776e-13, 2.739390713257718e-11, 7.1018070295833e-10, 1.272084461220066e-7], [1.4447901172025749e-13, 4.777404587898037e-13, 1.1589528996583502e-13, 6.1866364375484e-13, 3.3792817304872354e-9, 2.2118513481365995e-5, 7.293261803942426e-6]], iterations = [30, 21, 21, 19], converged = 1, n_matvec = 629)], stage = :finalize, algorithm = &quot;SCF&quot;, occupation_threshold = 1.0e-6)</code></pre><h2 id="Direct-minimization"><a class="docs-heading-anchor" href="#Direct-minimization">Direct minimization</a><a id="Direct-minimization-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-minimization" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_dm = direct_minimization(basis; tol)

# Newton algorithm</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39155563699173207 0.37851742085476403 … 0.3446996002182903 0.37851742085476403; 0.378517420854764 0.3664584405871118 … 0.3273572816926994 0.36364954258682597; … ; 0.3446996002182904 0.32735728169269956 … 0.30751926932754525 0.334380531911907; 0.3785174208547641 0.3636495425868261 … 0.334380531911907 0.36645844058711186;;; 0.37851742085476403 0.3664584405871118 … 0.3273572816926995 0.3636495425868261; 0.36645844058711174 0.3510288633333048 … 0.3111940134406405 0.3519170663122673; … ; 0.3273572816926995 0.3111940134406406 … 0.29824122835479094 0.3214260027711956; 0.363649542586826 0.3519170663122674 … 0.3214260027711957 0.3519170663122674;;; 0.3446996002182904 0.334380531911907 … 0.28653515374993427 0.3273572816926995; 0.3343805319119069 0.31861604766246004 … 0.27805891880649036 0.32142600277119554; … ; 0.28653515374993427 0.2780589188064904 … 0.25590185769928075 0.2780589188064904; 0.3273572816926995 0.3214260027711956 … 0.2780589188064905 0.3111940134406407;;; … ;;; 0.3048747492316088 0.28303666893263507 … 0.2855643322189328 0.30095737043610277; 0.283036668932635 0.2589843162112329 … 0.27263300122066697 0.28541419657683015; … ; 0.28556433221893285 0.2726330012206671 … 0.2771603890094114 0.2812108736631332; 0.3009573704361028 0.28541419657683026 … 0.2812108736631331 0.2930827261642107;;; 0.3446996002182903 0.3273572816926995 … 0.30751926932754525 0.334380531911907; 0.32735728169269945 0.31119401344064057 … 0.2982412283547909 0.32142600277119554; … ; 0.30751926932754525 0.298241228354791 … 0.2771603890094114 0.29313119135434235; 0.33438053191190703 0.32142600277119565 … 0.29313119135434235 0.31861604766246004;;; 0.3785174208547641 0.363649542586826 … 0.3343805319119069 0.3664584405871118; 0.36364954258682597 0.3519170663122674 … 0.3214260027711955 0.3519170663122673; … ; 0.334380531911907 0.32142600277119565 … 0.29313119135434235 0.3186160476624601; 0.3664584405871119 0.3519170663122674 … 0.31861604766246004 0.35102886333330485]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923000344 -0.49665655721045443 … -0.47719190094368397 -0.49665655721045443; -0.49665655721045443 -0.48481820868415854 … -0.4763804457596029 -0.49204131116114724; … ; -0.47719190094368397 -0.4763804457596029 … -0.41228807082378033 -0.45507008151947; -0.49665655721045443 -0.4920413111611473 … -0.45507008151947 -0.48481820868415854;;; -0.49665655721045443 -0.48481820868415854 … -0.4763804457596029 -0.49204131116114724; -0.48481820868415854 -0.45837440787115713 … -0.4706560157044237 -0.4861790251644598; … ; -0.4763804457596029 -0.47065601570442367 … -0.44639843641052235 -0.4688943963746959; -0.4920413111611473 -0.4861790251644598 … -0.4688943963746959 -0.4861790251644598;;; -0.47719190094368397 -0.45507008151947 … -0.46051412342456444 -0.4763804457596029; -0.45507008151947 -0.40906618238051023 … -0.45671990832059395 -0.4688943963746959; … ; -0.46051412342456444 -0.456719908320594 … -0.44514495659800357 -0.45671990832059395; -0.4763804457596029 -0.4688943963746959 … -0.456719908320594 -0.4706560157044237;;; … ;;; -0.44947595081681596 -0.4551499721933892 … -0.37125986255834165 -0.4177457151615955; -0.4551499721933892 -0.44880351100042465 … -0.41743801068293873 -0.44412609927891034; … ; -0.37125986255834165 -0.41743801068293873 … -0.2536569831231724 -0.29979809095105797; -0.4177457151615956 -0.44412609927891034 … -0.2997980909510579 -0.3610634325786839;;; -0.47719190094368397 -0.4763804457596029 … -0.4122880708237803 -0.45507008151947; -0.4763804457596029 -0.47065601570442367 … -0.44639843641052235 -0.4688943963746959; … ; -0.4122880708237803 -0.44639843641052235 … -0.2536569831231725 -0.3410633022149156; -0.45507008151947 -0.4688943963746959 … -0.3410633022149156 -0.4090661823805104;;; -0.49665655721045443 -0.49204131116114724 … -0.45507008151947 -0.48481820868415854; -0.49204131116114724 -0.4861790251644598 … -0.4688943963746959 -0.48617902516445977; … ; -0.45507008151947 -0.4688943963746959 … -0.3410633022149156 -0.4090661823805104; -0.48481820868415854 -0.4861790251644598 … -0.4090661823805104 -0.45837440787115713])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417761793414 -0.48742667643978904 … -0.7026973955704383 -0.48742667643978893; -0.4874266764397887 -0.7738703031507638 … -0.41393901836176183 -0.38179339124618455; … ; -0.7026973955704385 -0.4139390183617619 … -2.3968902180974654 -1.294138609240837; -0.4874266764397889 -0.38179339124618494 … -1.2941386092408371 -0.7738703031507637;;; -0.48742667643978904 -0.7738703031507637 … -0.4139390183617618 -0.38179339124618433; -0.7738703031507634 -1.4815303729223632 … -0.324442743956426 -0.44995655438588417; … ; -0.413939018361762 -0.324442743956426 … -1.0113865017999646 -0.6391785259471405; -0.38179339124618467 -0.44995655438588444 … -0.6391785259471409 -0.4499565543858843;;; -0.7026973955704383 -1.2941386092408373 … -0.29832133496250657 -0.4139390183617618; -1.294138609240837 -2.9234702459447135 … -0.35179963885970866 -0.6391785259471408; … ; -0.2983213349625068 -0.351799638859709 … -0.49060647085775516 -0.35179963885970866; -0.413939018361762 -0.6391785259471411 … -0.35179963885970844 -0.3244427439564258;;; … ;;; -1.0150481269071365 -0.5338983581394046 … -3.638038941531775 -1.9993625020204795; -0.5338983581394041 -0.32169882702252117 … -1.4639475300406368 -0.9061370442435048; … ; -3.638038941531775 -1.4639475300406368 … -10.993621243044217 -8.086551292465014; -1.9993625020204795 -0.9061370442435046 … -8.086551292465014 -4.647852558480692;;; -0.7026973955704383 -0.41393901836176183 … -2.396890218097466 -1.2941386092408376; -0.4139390183617617 -0.3244427439564259 … -1.0113865017999641 -0.6391785259471408; … ; -2.3968902180974654 -1.0113865017999641 … -11.003061433369641 -6.073393711836108; -1.294138609240837 -0.639178525947141 … -6.073393711836109 -2.9234702459447135;;; -0.48742667643978904 -0.38179339124618444 … -1.2941386092408376 -0.7738703031507637; -0.38179339124618444 -0.44995655438588417 … -0.6391785259471409 -0.44995655438588406; … ; -1.2941386092408376 -0.6391785259471408 … -6.073393711836109 -2.923470245944713; -0.7738703031507634 -0.44995655438588444 … -2.9234702459447135 -1.4815303729223628]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.03349959458924277 - 0.05966292136701992im 0.13718438757825652 - 0.07835134681452362im … 0.12000408574528121 - 0.04702085332212798im 0.1371843806352822 - 0.07835135171368175im; -0.16079641424564015 - 0.03524857794194172im -0.07005250079174105 - 0.056729780950001966im … 0.08272690637895094 - 0.02788633129041493im -0.005408603786448318 - 0.035746738468913845im; … ; -0.1792914722999706 - 0.0037279071945249607im -0.10175630521427165 - 0.0012009315785969509im … -0.004656560908238487 + 0.008293358631204329im -0.06646630750173795 - 0.014096750784021405im; -0.16079642200871794 - 0.03524858483455455im -0.005408604487649565 - 0.03574674013879037im … -0.013616715248256193 - 0.021741417091065203im -0.07005250693139269 - 0.0567297871230299im;;; 0.075381801371108 + 0.056965489583569714im 0.20533452060038984 + 0.05079307751421326im … 0.057396599044081634 - 0.03777636519051871im 0.06344738605719827 - 0.008862416598560255im; -0.14211515432958965 + 0.10105149215838385im -0.02116342764533166 + 0.07325989054581063im … 0.016372875068243448 - 0.007879138265669125im -0.07456157849667083 + 0.04016181500097861im; … ; -0.09512792815558185 - 0.015713772475011774im -0.01902685641520841 - 0.002758586314649849im … -0.021737906307941056 - 0.02060983018869337im -0.06947020975356624 - 0.03385691578688945im; -0.023426688009966473 + 0.0037038719749569434im 0.12269041525694824 + 0.011629415912739235im … -0.0020765435981667728 - 0.04360537434779057im -0.033650614908936484 - 0.04941280310527751im;;; 0.05792881887391209 + 0.08889303236576274im 0.08987472155631519 + 0.04694546571182504im … 0.016149629050024282 + 0.0011894553754049908im 0.01913393673927634 + 0.04599978638708151im; -0.054527680280431486 + 0.06783319757213341im -0.029622345989102763 + 0.007378037509507583im … -0.011370287401951649 + 0.016463909358375613im -0.04654702708497194 + 0.05376281101042338im; … ; -0.008837044748285693 + 0.004803764415676288im 0.031608268461842136 + 0.010247083359661985im … -0.013881115664333537 - 0.016130065856703683im -0.023991220919740344 - 0.01146133311129682im; 0.05109262100149181 + 0.041376979153707236im 0.10047349560054465 + 0.03249636899910868im … 0.003178860719295313 - 0.0153914711286854im 0.009030807817493346 + 0.008196325577950284im;;; … ;;; 0.010929944326090311 + 0.021236448301131im 0.004874646025763714 + 0.02748527581964371im … -0.04453413544196275 - 0.019609440189795116im -0.00393086789544529 - 0.008420129695762626im; 0.030385433546156887 + 0.023795153640253315im 0.013007616429563985 + 0.01718896404939416im … 0.0032895465623922326 - 0.0013661943861486064im 0.032853021195355096 + 0.011072441897248955im; … ; 0.01401424022455098 - 0.02807843219070286im -0.006975857358333459 + 0.00011869113389222804im … -0.001989913067786829 - 0.03517025112190227im 0.020306823099523738 - 0.052611285652084505im; -0.01702923310041802 - 0.006525457840141646im -0.017077144482061768 + 0.018294814559951814im … -0.05932003367171439 - 0.04109330222372729im -0.031577280060888904 - 0.04545371999335884im;;; 0.05792881773960218 + 0.08889302815132157im 0.019133938219241316 + 0.045999783410849884im … -0.00465656312210081 + 0.00829335892905565im 0.08987471744225842 + 0.04694546584153227im; 0.05109262258064223 + 0.04137697641678137im 0.009030810235393701 + 0.008196324640508994im … 0.06016652901517072 + 0.011369161344148983im 0.10047349420030147 + 0.03249636685638836im; … ; -0.0046565628393405445 + 0.008293359586255936im -0.043170475646083444 + 0.026316805653904707im … 0.003471225388780847 - 0.041906929172858626im 0.053984214060345426 - 0.039258793892909254im; -0.05452768432650618 + 0.0678331985317209im -0.04654702858516418 + 0.05376280913828064im … -0.09041818803772099 - 0.018371062010142204im -0.02962234875532468 + 0.007378044853540684im;;; 0.07538180038871442 + 0.05696548194386357im 0.0634473909852505 - 0.008862418871207414im … 0.10083596525539845 + 0.02294580010753721im 0.2053345138588847 + 0.05079307154704307im; -0.023426682398679725 + 0.0037038713703131613im -0.033650610230441136 - 0.04941280058976769im … 0.11445124864970882 + 0.0018920545731252918im 0.12269041430498073 + 0.011629412939225429im; … ; -0.09641602864874668 + 0.051478199108887165im -0.09996294019228436 + 0.03290695539583646im … 0.02403449539581065 + 0.026316154764109714im 0.03923364669944669 + 0.03426236617717847im; -0.14211516128440382 + 0.10105148614025627im -0.07456158017424068 + 0.04016181069938973im … -0.047640427352773594 + 0.046828654717648174im -0.02116343199900821 + 0.07325989180402076im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39155563699173207 0.37851742085476403 … 0.3446996002182903 0.37851742085476403; 0.378517420854764 0.3664584405871118 … 0.3273572816926994 0.36364954258682597; … ; 0.3446996002182904 0.32735728169269956 … 0.30751926932754525 0.334380531911907; 0.3785174208547641 0.3636495425868261 … 0.334380531911907 0.36645844058711186;;; 0.37851742085476403 0.3664584405871118 … 0.3273572816926995 0.3636495425868261; 0.36645844058711174 0.3510288633333048 … 0.3111940134406405 0.3519170663122673; … ; 0.3273572816926995 0.3111940134406406 … 0.29824122835479094 0.3214260027711956; 0.363649542586826 0.3519170663122674 … 0.3214260027711957 0.3519170663122674;;; 0.3446996002182904 0.334380531911907 … 0.28653515374993427 0.3273572816926995; 0.3343805319119069 0.31861604766246004 … 0.27805891880649036 0.32142600277119554; … ; 0.28653515374993427 0.2780589188064904 … 0.25590185769928075 0.2780589188064904; 0.3273572816926995 0.3214260027711956 … 0.2780589188064905 0.3111940134406407;;; … ;;; 0.3048747492316088 0.28303666893263507 … 0.2855643322189328 0.30095737043610277; 0.283036668932635 0.2589843162112329 … 0.27263300122066697 0.28541419657683015; … ; 0.28556433221893285 0.2726330012206671 … 0.2771603890094114 0.2812108736631332; 0.3009573704361028 0.28541419657683026 … 0.2812108736631331 0.2930827261642107;;; 0.3446996002182903 0.3273572816926995 … 0.30751926932754525 0.334380531911907; 0.32735728169269945 0.31119401344064057 … 0.2982412283547909 0.32142600277119554; … ; 0.30751926932754525 0.298241228354791 … 0.2771603890094114 0.29313119135434235; 0.33438053191190703 0.32142600277119565 … 0.29313119135434235 0.31861604766246004;;; 0.3785174208547641 0.363649542586826 … 0.3343805319119069 0.3664584405871118; 0.36364954258682597 0.3519170663122674 … 0.3214260027711955 0.3519170663122673; … ; 0.334380531911907 0.32142600277119565 … 0.29313119135434235 0.3186160476624601; 0.3664584405871119 0.3519170663122674 … 0.31861604766246004 0.35102886333330485]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923000344 -0.49665655721045443 … -0.47719190094368397 -0.49665655721045443; -0.49665655721045443 -0.48481820868415854 … -0.4763804457596029 -0.49204131116114724; … ; -0.47719190094368397 -0.4763804457596029 … -0.41228807082378033 -0.45507008151947; -0.49665655721045443 -0.4920413111611473 … -0.45507008151947 -0.48481820868415854;;; -0.49665655721045443 -0.48481820868415854 … -0.4763804457596029 -0.49204131116114724; -0.48481820868415854 -0.45837440787115713 … -0.4706560157044237 -0.4861790251644598; … ; -0.4763804457596029 -0.47065601570442367 … -0.44639843641052235 -0.4688943963746959; -0.4920413111611473 -0.4861790251644598 … -0.4688943963746959 -0.4861790251644598;;; -0.47719190094368397 -0.45507008151947 … -0.46051412342456444 -0.4763804457596029; -0.45507008151947 -0.40906618238051023 … -0.45671990832059395 -0.4688943963746959; … ; -0.46051412342456444 -0.456719908320594 … -0.44514495659800357 -0.45671990832059395; -0.4763804457596029 -0.4688943963746959 … -0.456719908320594 -0.4706560157044237;;; … ;;; -0.44947595081681596 -0.4551499721933892 … -0.37125986255834165 -0.4177457151615955; -0.4551499721933892 -0.44880351100042465 … -0.41743801068293873 -0.44412609927891034; … ; -0.37125986255834165 -0.41743801068293873 … -0.2536569831231724 -0.29979809095105797; -0.4177457151615956 -0.44412609927891034 … -0.2997980909510579 -0.3610634325786839;;; -0.47719190094368397 -0.4763804457596029 … -0.4122880708237803 -0.45507008151947; -0.4763804457596029 -0.47065601570442367 … -0.44639843641052235 -0.4688943963746959; … ; -0.4122880708237803 -0.44639843641052235 … -0.2536569831231725 -0.3410633022149156; -0.45507008151947 -0.4688943963746959 … -0.3410633022149156 -0.4090661823805104;;; -0.49665655721045443 -0.49204131116114724 … -0.45507008151947 -0.48481820868415854; -0.49204131116114724 -0.4861790251644598 … -0.4688943963746959 -0.48617902516445977; … ; -0.45507008151947 -0.4688943963746959 … -0.3410633022149156 -0.4090661823805104; -0.48481820868415854 -0.4861790251644598 … -0.4090661823805104 -0.45837440787115713])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417761793414 -0.48742667643978904 … -0.7026973955704383 -0.48742667643978893; -0.4874266764397887 -0.7738703031507638 … -0.41393901836176183 -0.38179339124618455; … ; -0.7026973955704385 -0.4139390183617619 … -2.3968902180974654 -1.294138609240837; -0.4874266764397889 -0.38179339124618494 … -1.2941386092408371 -0.7738703031507637;;; -0.48742667643978904 -0.7738703031507637 … -0.4139390183617618 -0.38179339124618433; -0.7738703031507634 -1.4815303729223632 … -0.324442743956426 -0.44995655438588417; … ; -0.413939018361762 -0.324442743956426 … -1.0113865017999646 -0.6391785259471405; -0.38179339124618467 -0.44995655438588444 … -0.6391785259471409 -0.4499565543858843;;; -0.7026973955704383 -1.2941386092408373 … -0.29832133496250657 -0.4139390183617618; -1.294138609240837 -2.9234702459447135 … -0.35179963885970866 -0.6391785259471408; … ; -0.2983213349625068 -0.351799638859709 … -0.49060647085775516 -0.35179963885970866; -0.413939018361762 -0.6391785259471411 … -0.35179963885970844 -0.3244427439564258;;; … ;;; -1.0150481269071365 -0.5338983581394046 … -3.638038941531775 -1.9993625020204795; -0.5338983581394041 -0.32169882702252117 … -1.4639475300406368 -0.9061370442435048; … ; -3.638038941531775 -1.4639475300406368 … -10.993621243044217 -8.086551292465014; -1.9993625020204795 -0.9061370442435046 … -8.086551292465014 -4.647852558480692;;; -0.7026973955704383 -0.41393901836176183 … -2.396890218097466 -1.2941386092408376; -0.4139390183617617 -0.3244427439564259 … -1.0113865017999641 -0.6391785259471408; … ; -2.3968902180974654 -1.0113865017999641 … -11.003061433369641 -6.073393711836108; -1.294138609240837 -0.639178525947141 … -6.073393711836109 -2.9234702459447135;;; -0.48742667643978904 -0.38179339124618444 … -1.2941386092408376 -0.7738703031507637; -0.38179339124618444 -0.44995655438588417 … -0.6391785259471409 -0.44995655438588406; … ; -1.2941386092408376 -0.6391785259471408 … -6.073393711836109 -2.923470245944713; -0.7738703031507634 -0.44995655438588444 … -2.9234702459447135 -1.4815303729223628]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.1978247751009985 + 0.007104289965587687im -0.00624175878886834 - 0.04021884632055595im … -0.04463845676929926 + 0.025903317808457733im 0.0747777944494731 + 0.03141468072966791im; 0.09051475112001728 - 0.03903202060046286im -0.06788121715010892 - 0.0040945479962772174im … -0.00041884132536242665 - 0.010382310656098917im 0.0654137369480574 - 0.03071518658316346im; … ; 0.06346271767907573 + 0.13216898302646377im 0.05448669373534659 + 0.08509136104232021im … -0.04752991563103129 - 0.018362054108760517im -0.06568891406664809 + 0.047332363678639855im; 0.17982941193952143 + 0.1800639961668835im 0.0637303386328458 + 0.09197319345425377im … -0.08433766213467225 + 0.05555411387186076im -0.024388468615239717 + 0.16520262358646717im;;; 0.10502382155735829 + 0.044901137056159696im -0.10951866843341458 + 0.0009452524115864906im … -0.004039438295791583 + 0.0036239868246528226im 0.08106152511814696 + 0.036028101719892076im; 0.011293564601392511 + 0.056475450838550885im -0.13598223248801994 + 0.044525914005922866im … 0.016771041646203817 - 0.002811815256210935im 0.05658278166250802 + 0.01921744900167658im; … ; 0.047821221020144924 + 0.07999216663619842im 0.01977607310671565 + 0.05487904960786989im … -0.026582700069472602 - 0.0022844607977404873im -0.006951556674799285 + 0.03515080701222158im; 0.11359538070100275 + 0.1301207649712174im -0.01801477143267688 + 0.056524605805324875im … -0.03123344405486849 + 0.015219721963786978im 0.02886497207241319 + 0.07471847443090156im;;; 0.008432464078944487 + 0.0474168185880476im -0.07682329957470688 - 0.015213248998108494im … 0.011158414484110351 + 0.010261704876198081im 0.0359111907675565 + 0.037460583937291486im; -0.026774125681001612 + 0.022554800009900105im -0.07523662431868097 - 0.04325545909083496im … 0.016305860422030683 + 0.00993624115150224im 0.020645780370542443 + 0.028074677246110437im; … ; 0.016856474267582137 + 0.037588275673502564im -0.003049345615933404 + 0.022676618967560222im … -0.007854637865802226 + 0.002508662726725593im 0.0065778226097535815 + 0.022084624822951805im; 0.022956068314613352 + 0.05330646970437039im -0.03210566573372117 + 0.0133101989226642im … -0.0023844587715995454 + 0.009536559863514055im 0.022627780333525936 + 0.037589426159993326im;;; … ;;; -0.0015178037488146868 + 0.03183123072617807im 0.009074488533490348 + 0.019248679919560783im … -0.004565341937850112 - 0.0033887854710867326im -0.016741048120952298 + 0.023159550995972722im; 0.002070660742215065 + 0.01263234106236571im 0.00471595985225589 + 0.002209880769027893im … -0.007862645851606873 + 0.012183790117870685im -0.007988029063210169 + 0.018397278977187775im; … ; -0.01679373433467087 - 0.03839065175552199im 0.0007863487910457338 - 0.0004683955262401936im … 0.03390621169641429 - 0.10198767393780939im -0.009333443444890989 - 0.09682276320351058im; -0.00920441742290449 + 0.014901063468720954im 0.009346448370308786 + 0.022915760882446224im … 0.01381657709702364 - 0.06398635677879799im -0.01971781708922344 - 0.027858038570397523im;;; 0.02014429560078785 + 0.07546317834638007im 0.02273876038495074 + 0.024109744143886634im … -0.03456628155116191 + 0.041797916780656426im -0.044477025939464995 + 0.09187386923909002im; 0.016907906583341438 + 0.002872933456242961im 0.00660796650356146 - 0.010586734018077654im … -0.019009774212558506 + 0.023920597385865217im -0.0077663608427721185 + 0.02279561720989598im; … ; -0.02681193258181245 - 0.002512458566303934im 0.01837945678795103 + 0.03211232178428269im … 0.03312158502981209 - 0.1707916547519605im -0.06504551040441495 - 0.11930823192104176im; 0.0010182565089828129 + 0.12085278215723325im 0.03454486703005007 + 0.06554120089012824im … -0.02053396935450723 - 0.03259722614941466im -0.08876956592107765 + 0.07635197438303165im;;; 0.12319876329397188 + 0.06845750940490983im 0.029801724031184924 - 0.0031864837741359927im … -0.0671864952740887 + 0.07450075510308163im -0.03219625336806132 + 0.12826760920746338im; 0.06004780711348605 - 0.03482021109540975im -0.0062912184937700885 - 0.028882186840545707im … -0.020178005970663285 + 0.013300506482587782im 0.019254089237213376 - 0.0049340128107243225im; … ; 0.0005319952784235455 + 0.09799243805090466im 0.047754112587785766 + 0.0770015344638425im … -0.02710400198361932 - 0.09028236125239084im -0.1267600964151941 - 0.01376780209565234im; 0.08155014477368677 + 0.24624738798887702im 0.0734766492195244 + 0.10884713200665516im … -0.09337784844546182 + 0.07282656246618135im -0.13439870235135604 + 0.21472122239164365im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39155563699173207 0.37851742085476403 … 0.3446996002182903 0.37851742085476403; 0.378517420854764 0.3664584405871118 … 0.3273572816926994 0.36364954258682597; … ; 0.3446996002182904 0.32735728169269956 … 0.30751926932754525 0.334380531911907; 0.3785174208547641 0.3636495425868261 … 0.334380531911907 0.36645844058711186;;; 0.37851742085476403 0.3664584405871118 … 0.3273572816926995 0.3636495425868261; 0.36645844058711174 0.3510288633333048 … 0.3111940134406405 0.3519170663122673; … ; 0.3273572816926995 0.3111940134406406 … 0.29824122835479094 0.3214260027711956; 0.363649542586826 0.3519170663122674 … 0.3214260027711957 0.3519170663122674;;; 0.3446996002182904 0.334380531911907 … 0.28653515374993427 0.3273572816926995; 0.3343805319119069 0.31861604766246004 … 0.27805891880649036 0.32142600277119554; … ; 0.28653515374993427 0.2780589188064904 … 0.25590185769928075 0.2780589188064904; 0.3273572816926995 0.3214260027711956 … 0.2780589188064905 0.3111940134406407;;; … ;;; 0.3048747492316088 0.28303666893263507 … 0.2855643322189328 0.30095737043610277; 0.283036668932635 0.2589843162112329 … 0.27263300122066697 0.28541419657683015; … ; 0.28556433221893285 0.2726330012206671 … 0.2771603890094114 0.2812108736631332; 0.3009573704361028 0.28541419657683026 … 0.2812108736631331 0.2930827261642107;;; 0.3446996002182903 0.3273572816926995 … 0.30751926932754525 0.334380531911907; 0.32735728169269945 0.31119401344064057 … 0.2982412283547909 0.32142600277119554; … ; 0.30751926932754525 0.298241228354791 … 0.2771603890094114 0.29313119135434235; 0.33438053191190703 0.32142600277119565 … 0.29313119135434235 0.31861604766246004;;; 0.3785174208547641 0.363649542586826 … 0.3343805319119069 0.3664584405871118; 0.36364954258682597 0.3519170663122674 … 0.3214260027711955 0.3519170663122673; … ; 0.334380531911907 0.32142600277119565 … 0.29313119135434235 0.3186160476624601; 0.3664584405871119 0.3519170663122674 … 0.31861604766246004 0.35102886333330485]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923000344 -0.49665655721045443 … -0.47719190094368397 -0.49665655721045443; -0.49665655721045443 -0.48481820868415854 … -0.4763804457596029 -0.49204131116114724; … ; -0.47719190094368397 -0.4763804457596029 … -0.41228807082378033 -0.45507008151947; -0.49665655721045443 -0.4920413111611473 … -0.45507008151947 -0.48481820868415854;;; -0.49665655721045443 -0.48481820868415854 … -0.4763804457596029 -0.49204131116114724; -0.48481820868415854 -0.45837440787115713 … -0.4706560157044237 -0.4861790251644598; … ; -0.4763804457596029 -0.47065601570442367 … -0.44639843641052235 -0.4688943963746959; -0.4920413111611473 -0.4861790251644598 … -0.4688943963746959 -0.4861790251644598;;; -0.47719190094368397 -0.45507008151947 … -0.46051412342456444 -0.4763804457596029; -0.45507008151947 -0.40906618238051023 … -0.45671990832059395 -0.4688943963746959; … ; -0.46051412342456444 -0.456719908320594 … -0.44514495659800357 -0.45671990832059395; -0.4763804457596029 -0.4688943963746959 … -0.456719908320594 -0.4706560157044237;;; … ;;; -0.44947595081681596 -0.4551499721933892 … -0.37125986255834165 -0.4177457151615955; -0.4551499721933892 -0.44880351100042465 … -0.41743801068293873 -0.44412609927891034; … ; -0.37125986255834165 -0.41743801068293873 … -0.2536569831231724 -0.29979809095105797; -0.4177457151615956 -0.44412609927891034 … -0.2997980909510579 -0.3610634325786839;;; -0.47719190094368397 -0.4763804457596029 … -0.4122880708237803 -0.45507008151947; -0.4763804457596029 -0.47065601570442367 … -0.44639843641052235 -0.4688943963746959; … ; -0.4122880708237803 -0.44639843641052235 … -0.2536569831231725 -0.3410633022149156; -0.45507008151947 -0.4688943963746959 … -0.3410633022149156 -0.4090661823805104;;; -0.49665655721045443 -0.49204131116114724 … -0.45507008151947 -0.48481820868415854; -0.49204131116114724 -0.4861790251644598 … -0.4688943963746959 -0.48617902516445977; … ; -0.45507008151947 -0.4688943963746959 … -0.3410633022149156 -0.4090661823805104; -0.48481820868415854 -0.4861790251644598 … -0.4090661823805104 -0.45837440787115713])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417761793414 -0.48742667643978904 … -0.7026973955704383 -0.48742667643978893; -0.4874266764397887 -0.7738703031507638 … -0.41393901836176183 -0.38179339124618455; … ; -0.7026973955704385 -0.4139390183617619 … -2.3968902180974654 -1.294138609240837; -0.4874266764397889 -0.38179339124618494 … -1.2941386092408371 -0.7738703031507637;;; -0.48742667643978904 -0.7738703031507637 … -0.4139390183617618 -0.38179339124618433; -0.7738703031507634 -1.4815303729223632 … -0.324442743956426 -0.44995655438588417; … ; -0.413939018361762 -0.324442743956426 … -1.0113865017999646 -0.6391785259471405; -0.38179339124618467 -0.44995655438588444 … -0.6391785259471409 -0.4499565543858843;;; -0.7026973955704383 -1.2941386092408373 … -0.29832133496250657 -0.4139390183617618; -1.294138609240837 -2.9234702459447135 … -0.35179963885970866 -0.6391785259471408; … ; -0.2983213349625068 -0.351799638859709 … -0.49060647085775516 -0.35179963885970866; -0.413939018361762 -0.6391785259471411 … -0.35179963885970844 -0.3244427439564258;;; … ;;; -1.0150481269071365 -0.5338983581394046 … -3.638038941531775 -1.9993625020204795; -0.5338983581394041 -0.32169882702252117 … -1.4639475300406368 -0.9061370442435048; … ; -3.638038941531775 -1.4639475300406368 … -10.993621243044217 -8.086551292465014; -1.9993625020204795 -0.9061370442435046 … -8.086551292465014 -4.647852558480692;;; -0.7026973955704383 -0.41393901836176183 … -2.396890218097466 -1.2941386092408376; -0.4139390183617617 -0.3244427439564259 … -1.0113865017999641 -0.6391785259471408; … ; -2.3968902180974654 -1.0113865017999641 … -11.003061433369641 -6.073393711836108; -1.294138609240837 -0.639178525947141 … -6.073393711836109 -2.9234702459447135;;; -0.48742667643978904 -0.38179339124618444 … -1.2941386092408376 -0.7738703031507637; -0.38179339124618444 -0.44995655438588417 … -0.6391785259471409 -0.44995655438588406; … ; -1.2941386092408376 -0.6391785259471408 … -6.073393711836109 -2.923470245944713; -0.7738703031507634 -0.44995655438588444 … -2.9234702459447135 -1.4815303729223628]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.084658752373176 + 0.1057612759983548im 0.03037669574405908 + 0.06987009139188502im … -0.08711253850785322 + 0.007773446581656787im -0.07108163938768518 + 0.05986694101461222im; 0.06305880473392866 + 0.0586914726388034im 0.00040213755644991794 + 0.0019272939057860296im … -0.06585326721323087 + 0.026308291653674418im -0.04591365914042262 + 0.059773953211057156im; … ; 0.08301067082700353 - 0.05041564904395848im 0.07771791202678982 - 0.022798923446933173im … -0.008357965931187343 - 0.010441319864455968im -0.02311376819071176 - 0.04595681145581043im; 0.14865205513472915 - 0.015290969302453083im 0.10631958901344861 + 0.007703956906098767im … -0.015215291435124944 - 0.048658413325061045im -0.013555446655152717 - 0.06496585103981775im;;; 0.1955864177261035 + 0.18721065335344578im 0.02660474649300773 + 0.112578222824012im … -0.0570185137514458 + 0.017870457472913145im 0.049186934955859005 + 0.11401856302012496im; 0.17280343862852984 + 0.06257229000918602im -0.022252221329660586 - 0.0342697481988219im … -0.016425108277279714 + 0.02773826458675098im 0.08660509534726539 + 0.06661892589606672im; … ; 0.06915314755108493 - 0.025285411062602934im 0.057341211205739914 + 0.0025071665362726295im … -0.02867540418395404 - 0.030351004915132193im -0.010732728216884388 - 0.047346785002286514im; 0.17538170539356934 + 0.07085479048638535im 0.07162745899008385 + 0.07174189083742909im … -0.0507980214743451 - 0.033642815994948845im 0.011081269420067971 - 0.012516624458030878im;;; 0.11850249196071325 + 0.1023119428188471im -0.050777348425522825 + 0.01662512750384033im … 0.007558199003660705 + 0.024964179386790804im 0.08822359509387472 + 0.0754413907681056im; 0.04745360784547368 - 0.016973877485434583im -0.13085785460512317 - 0.10976220256547524im … 0.0266712195532648 + 0.020842808208474374im 0.08289533696112512 + 0.028490239434289105im; … ; 0.044818139404959136 + 0.012219755880588549im 0.025846376171159934 + 0.021124938560214582im … -0.014382211494664322 - 0.015793173592616436im 0.012149754095669693 - 0.008502982707800614im; 0.09246527385608491 + 0.073990563270657im 0.012471084444003324 + 0.05257821453764172im … -0.010257532210961071 - 0.0008387743257817623im 0.04750687427979094 + 0.03427601866618735im;;; … ;;; 0.024867552186544142 + 0.013832032008466746im 0.01887880594829181 + 0.00987692072080322im … 0.009603962075203948 - 0.015292984585404581im 0.020816949991266338 + 0.003102969319116346im; 0.011240548997847388 + 0.012489517006106607im 0.0053820132176874425 + 0.006000109557886922im … 0.01465858846223676 + 7.506946303090619e-5im 0.014407267811824706 + 0.01053601687543167im; … ; -0.02933627735995171 - 0.001973830283440424im -0.0008663006212325428 + 0.005385216320599783im … -0.08367729329927535 - 0.044455711544572965im -0.06946446949979865 - 0.026990434503370003im; 0.010308977397702816 + 0.006697125579193192im 0.019207461146258317 + 0.008894154327840145im … -0.039346336382139455 - 0.037292067753562363im -0.015798952547685118 - 0.014813987387512946im;;; 0.054566611800198506 + 0.03603778034126777im 0.028417401820836748 + 0.013304247836412528im … 0.05653250381696533 + 0.00021686807504590642im 0.06059029047233756 + 0.036109102895016974im; 0.004972204249675283 + 0.021323464207073692im -0.0015356023963903924 + 0.004289706447578352im … 0.016550866248020775 + 0.013080998322179793im 0.00685817089901305 + 0.028099838281917654im; … ; -0.0034028271046251096 + 0.02071720203852883im 0.025793554253538114 + 0.009919620744053692im … -0.10142777181399983 - 0.04346319919754402im -0.07013999678896199 + 0.0037910926019808886im; 0.07883307186230244 + 0.02986932530767367im 0.05356107513577389 + 0.012125534869371544im … 0.028090959542451586 - 0.029807911609208596im 0.06594479217185908 + 0.0206833923064867im;;; 0.06450269028178507 + 0.06227438859113863im 0.026610146090700795 + 0.019686146693051722im … 0.04038498552384447 + 0.017553196624932522im 0.01619791670469816 + 0.06270241688645126im; -0.00593292136709987 + 0.030817206305620903im -0.01045282528465615 + 0.0007594883105287939im … -0.023932246658431074 + 0.0246580622594912im -0.040341793402310325 + 0.04543789252973163im; … ; 0.05536262172142035 + 0.012430231927736604im 0.06272509549796035 - 0.004982293084214251im … -0.0008703523963913017 + 0.01928466997692984im -0.012240832396213111 + 0.037278959424812984im; 0.1623966087942761 + 0.012696484657009451im 0.09317930524928975 - 0.00023178382478004748im … 0.11395393814032428 - 0.005884812816505431im 0.08847881611942314 + 0.0010747116510067892im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39155563699173207 0.37851742085476403 … 0.3446996002182903 0.37851742085476403; 0.378517420854764 0.3664584405871118 … 0.3273572816926994 0.36364954258682597; … ; 0.3446996002182904 0.32735728169269956 … 0.30751926932754525 0.334380531911907; 0.3785174208547641 0.3636495425868261 … 0.334380531911907 0.36645844058711186;;; 0.37851742085476403 0.3664584405871118 … 0.3273572816926995 0.3636495425868261; 0.36645844058711174 0.3510288633333048 … 0.3111940134406405 0.3519170663122673; … ; 0.3273572816926995 0.3111940134406406 … 0.29824122835479094 0.3214260027711956; 0.363649542586826 0.3519170663122674 … 0.3214260027711957 0.3519170663122674;;; 0.3446996002182904 0.334380531911907 … 0.28653515374993427 0.3273572816926995; 0.3343805319119069 0.31861604766246004 … 0.27805891880649036 0.32142600277119554; … ; 0.28653515374993427 0.2780589188064904 … 0.25590185769928075 0.2780589188064904; 0.3273572816926995 0.3214260027711956 … 0.2780589188064905 0.3111940134406407;;; … ;;; 0.3048747492316088 0.28303666893263507 … 0.2855643322189328 0.30095737043610277; 0.283036668932635 0.2589843162112329 … 0.27263300122066697 0.28541419657683015; … ; 0.28556433221893285 0.2726330012206671 … 0.2771603890094114 0.2812108736631332; 0.3009573704361028 0.28541419657683026 … 0.2812108736631331 0.2930827261642107;;; 0.3446996002182903 0.3273572816926995 … 0.30751926932754525 0.334380531911907; 0.32735728169269945 0.31119401344064057 … 0.2982412283547909 0.32142600277119554; … ; 0.30751926932754525 0.298241228354791 … 0.2771603890094114 0.29313119135434235; 0.33438053191190703 0.32142600277119565 … 0.29313119135434235 0.31861604766246004;;; 0.3785174208547641 0.363649542586826 … 0.3343805319119069 0.3664584405871118; 0.36364954258682597 0.3519170663122674 … 0.3214260027711955 0.3519170663122673; … ; 0.334380531911907 0.32142600277119565 … 0.29313119135434235 0.3186160476624601; 0.3664584405871119 0.3519170663122674 … 0.31861604766246004 0.35102886333330485]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923000344 -0.49665655721045443 … -0.47719190094368397 -0.49665655721045443; -0.49665655721045443 -0.48481820868415854 … -0.4763804457596029 -0.49204131116114724; … ; -0.47719190094368397 -0.4763804457596029 … -0.41228807082378033 -0.45507008151947; -0.49665655721045443 -0.4920413111611473 … -0.45507008151947 -0.48481820868415854;;; -0.49665655721045443 -0.48481820868415854 … -0.4763804457596029 -0.49204131116114724; -0.48481820868415854 -0.45837440787115713 … -0.4706560157044237 -0.4861790251644598; … ; -0.4763804457596029 -0.47065601570442367 … -0.44639843641052235 -0.4688943963746959; -0.4920413111611473 -0.4861790251644598 … -0.4688943963746959 -0.4861790251644598;;; -0.47719190094368397 -0.45507008151947 … -0.46051412342456444 -0.4763804457596029; -0.45507008151947 -0.40906618238051023 … -0.45671990832059395 -0.4688943963746959; … ; -0.46051412342456444 -0.456719908320594 … -0.44514495659800357 -0.45671990832059395; -0.4763804457596029 -0.4688943963746959 … -0.456719908320594 -0.4706560157044237;;; … ;;; -0.44947595081681596 -0.4551499721933892 … -0.37125986255834165 -0.4177457151615955; -0.4551499721933892 -0.44880351100042465 … -0.41743801068293873 -0.44412609927891034; … ; -0.37125986255834165 -0.41743801068293873 … -0.2536569831231724 -0.29979809095105797; -0.4177457151615956 -0.44412609927891034 … -0.2997980909510579 -0.3610634325786839;;; -0.47719190094368397 -0.4763804457596029 … -0.4122880708237803 -0.45507008151947; -0.4763804457596029 -0.47065601570442367 … -0.44639843641052235 -0.4688943963746959; … ; -0.4122880708237803 -0.44639843641052235 … -0.2536569831231725 -0.3410633022149156; -0.45507008151947 -0.4688943963746959 … -0.3410633022149156 -0.4090661823805104;;; -0.49665655721045443 -0.49204131116114724 … -0.45507008151947 -0.48481820868415854; -0.49204131116114724 -0.4861790251644598 … -0.4688943963746959 -0.48617902516445977; … ; -0.45507008151947 -0.4688943963746959 … -0.3410633022149156 -0.4090661823805104; -0.48481820868415854 -0.4861790251644598 … -0.4090661823805104 -0.45837440787115713])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417761793414 -0.48742667643978904 … -0.7026973955704383 -0.48742667643978893; -0.4874266764397887 -0.7738703031507638 … -0.41393901836176183 -0.38179339124618455; … ; -0.7026973955704385 -0.4139390183617619 … -2.3968902180974654 -1.294138609240837; -0.4874266764397889 -0.38179339124618494 … -1.2941386092408371 -0.7738703031507637;;; -0.48742667643978904 -0.7738703031507637 … -0.4139390183617618 -0.38179339124618433; -0.7738703031507634 -1.4815303729223632 … -0.324442743956426 -0.44995655438588417; … ; -0.413939018361762 -0.324442743956426 … -1.0113865017999646 -0.6391785259471405; -0.38179339124618467 -0.44995655438588444 … -0.6391785259471409 -0.4499565543858843;;; -0.7026973955704383 -1.2941386092408373 … -0.29832133496250657 -0.4139390183617618; -1.294138609240837 -2.9234702459447135 … -0.35179963885970866 -0.6391785259471408; … ; -0.2983213349625068 -0.351799638859709 … -0.49060647085775516 -0.35179963885970866; -0.413939018361762 -0.6391785259471411 … -0.35179963885970844 -0.3244427439564258;;; … ;;; -1.0150481269071365 -0.5338983581394046 … -3.638038941531775 -1.9993625020204795; -0.5338983581394041 -0.32169882702252117 … -1.4639475300406368 -0.9061370442435048; … ; -3.638038941531775 -1.4639475300406368 … -10.993621243044217 -8.086551292465014; -1.9993625020204795 -0.9061370442435046 … -8.086551292465014 -4.647852558480692;;; -0.7026973955704383 -0.41393901836176183 … -2.396890218097466 -1.2941386092408376; -0.4139390183617617 -0.3244427439564259 … -1.0113865017999641 -0.6391785259471408; … ; -2.3968902180974654 -1.0113865017999641 … -11.003061433369641 -6.073393711836108; -1.294138609240837 -0.639178525947141 … -6.073393711836109 -2.9234702459447135;;; -0.48742667643978904 -0.38179339124618444 … -1.2941386092408376 -0.7738703031507637; -0.38179339124618444 -0.44995655438588417 … -0.6391785259471409 -0.44995655438588406; … ; -1.2941386092408376 -0.6391785259471408 … -6.073393711836109 -2.923470245944713; -0.7738703031507634 -0.44995655438588444 … -2.9234702459447135 -1.4815303729223628]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.35209199125986324 - 0.046817147494022535im 0.17344881419992159 + 0.01943028989989196im … 0.0640614215253417 - 0.11788839030881598im 0.24351927664381404 - 0.1858224827907849im; 0.23304532199583167 + 0.0400907046471813im 0.051287783123643516 + 0.02081365613790207im … 0.05712312361037315 - 0.08383291281861044im 0.19381180819745125 - 0.09439825196980843im; … ; 0.01047011832785514 - 0.011985464937941868im 0.03081560101087392 + 0.0037175470736821176im … -0.05517720443257771 + 0.029783282442877375im -0.041955745152303596 - 0.015207483577673im; 0.17614160422882044 - 0.03865062200533986im 0.10889230516615336 + 0.0104217660627609im … -0.03605404149808572 - 0.013986586158791251im 0.05766197883658727 - 0.11667167584660837im;;; 0.20346243031453243 + 0.06283735430391328im 0.03407704176973239 + 0.044706979831607395im … 0.05210182095397771 - 0.08672496638932645im 0.16366454915410025 - 0.08512513935626528im; 0.06249921946166473 + 0.15844508313129235im -0.11770424605303018 + 0.06050894731470777im … 0.0361358726620961 - 0.04111069017544695im 0.10217782551529954 + 0.03627480512643817im; … ; 0.030635477630178768 - 0.009824323569908519im 0.02985151023525571 + 0.0033417986566472227im … -0.011227901037152913 - 0.006926675880902704im 0.006371999929079063 - 0.024673051307108788im; 0.11990765700813519 - 0.007233269212795962im 0.06157197695900358 + 0.014428222966045026im … 0.016298555578845957 - 0.05052132142039237im 0.07628829777346405 - 0.074867095184825im;;; 0.02717500968574205 + 0.0660054900811878im -0.03665333290203043 + 0.024607231531023857im … 0.019898175008760295 - 0.02056489415456774im 0.039074862501792484 + 0.019468438693619132im; -0.02674449978778128 + 0.09950402826093903im -0.11671506237395617 + 0.0054566266818583285im … 0.012444314489151386 + 0.007292114535663512im 0.017653628651774018 + 0.06591762299529501im; … ; 0.018921553819707174 - 0.0010939569948691058im 0.013257584863581771 + 0.00410458398314391im … 0.0021052188883791774 - 0.01244775581196823im 0.011758539144441823 - 0.0128459074615739im; 0.03570218844207622 + 0.015360323834076681im 0.008832749064328734 + 0.01297255973479579im … 0.013544211743595342 - 0.02564601241728978im 0.031171365440840555 - 0.013542631676581613im;;; … ;;; -0.0075079920722052156 + 0.0023512483817925587im 0.0043977289261768375 + 0.008476180901990062im … -0.03268919465278938 + 0.0023796624507751406im -0.02543178086412313 - 0.0033944998695817925im; 0.005282772286452987 + 0.007507582180592827im 0.008389316071069942 + 0.008234783126505904im … -0.008272485320689348 + 0.0031604505160228715im -0.0022599621695299815 + 0.0028901392193193993im; … ; -0.024421154268858263 - 0.009901984568237342im -0.012293306324814568 - 0.004314104144289257im … -0.0043331564035631 - 0.003546894944090659im -0.02536267245706509 - 0.007357649620691936im; -0.027571257005484323 - 0.007626910775544417im -0.007228688023732352 + 0.0016692323415624234im … -0.04534123558279428 - 6.438234831243645e-5im -0.04885985094965064 - 0.009557598522237672im;;; 0.029611438422604403 + 0.013454013916492744im 0.0355721223784943 + 0.018165701991959368im … -0.055029514819388295 + 0.02887782988217051im -0.022182952834953727 + 0.0011158049546259445im; 0.03942410330673576 + 0.011935611955969207im 0.03011255955415193 + 0.009294774419594348im … -0.00020115658336771007 + 0.006377575744682223im 0.020691513981441607 + 0.00039333051766038255im; … ; -0.04750699242216018 - 0.0070987008433538255im -0.012641248265765279 + 0.0006150572238066434im … -0.05884553019971206 + 0.021459147385312162im -0.08057578928258236 + 0.0018616793138088719im; -0.0355502873549258 + 0.0008155790751225464im 0.008895347006137496 + 0.011622371660928506im … -0.1251757882212142 + 0.04853069342795095im -0.1167150622666436 + 0.005456629123506442im;;; 0.20703630264221135 - 0.014247714023340161im 0.11874456662049389 + 0.0178534507169982im … -0.022855163672680416 + 0.004802994892635375im 0.07391588658627754 - 0.08780155962316921im; 0.1597584321978349 - 0.0008739857019909678im 0.07272087066308455 + 0.002078872746629855im … 0.028650385649126225 - 0.02848880433587959im 0.10636143315377561 - 0.053961637550524286im; … ; -0.04110399280861854 - 0.0038287328202643465im 0.005442918802069203 + 0.004978680183884664im … -0.09889878578499794 + 0.06315809526035088im -0.10880583684599643 + 0.012982426034693836im; 0.036527356071201125 - 0.008143995372355366im 0.061508782702659984 + 0.015791250214626778im … -0.14959173131774933 + 0.09241284849629756im -0.1141303735256789 - 0.016576118140646946im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729848), converged = true, ρ = [0.09132316917032238 0.08747419133210832 … 0.07684754934856027 0.08747419133210832; 0.08747419133210832 0.08089966870726882 … 0.0764247101659822 0.08486944833964115; … ; 0.07684754934856029 0.0764247101659822 … 0.04778466665208867 0.06587895340580517; 0.08747419133210833 0.08486944833964118 … 0.06587895340580517 0.08089966870726885;;; 0.08747419133210833 0.08089966870726883 … 0.0764247101659822 0.08486944833964115; 0.08089966870726883 0.06744471467687224 … 0.07348669934638702 0.08163768628407399; … ; 0.07642471016598221 0.073486699346387 … 0.061888041188392015 0.07259829027601804; 0.08486944833964118 0.081637686284074 … 0.07259829027601804 0.081637686284074;;; 0.07684754934856028 0.06587895340580516 … 0.06847203699065199 0.07642471016598218; 0.06587895340580516 0.04657864262805793 … 0.06665759371606084 0.07259829027601802; … ; 0.068472036990652 0.06665759371606082 … 0.061325153141353485 0.06665759371606084; 0.0764247101659822 0.07259829027601804 … 0.06665759371606082 0.07348669934638703;;; … ;;; 0.06328495228783848 0.06591651445571714 … 0.03394064886271495 0.04987593484398368; 0.06591651445571714 0.06297790960229095 … 0.049756397873445005 0.0608702045626138; … ; 0.033940648862714966 0.049756397873445005 … 0.009696353193727632 0.016831338772531144; 0.0498759348439837 0.060870204562613814 … 0.016831338772531134 0.03098572186557678;;; 0.07684754934856027 0.07642471016598218 … 0.04778466665208866 0.06587895340580516; 0.07642471016598218 0.07348669934638699 … 0.06188804118839201 0.07259829027601802; … ; 0.04778466665208868 0.06188804118839201 … 0.009696353193727636 0.02571001065406967; 0.06587895340580517 0.07259829027601804 … 0.02571001065406966 0.04657864262805794;;; 0.08747419133210833 0.08486944833964115 … 0.06587895340580516 0.08089966870726883; 0.08486944833964115 0.08163768628407399 … 0.07259829027601801 0.08163768628407397; … ; 0.06587895340580519 0.07259829027601801 … 0.02571001065406967 0.046578642628057956; 0.08089966870726885 0.081637686284074 … 0.04657864262805795 0.06744471467687224;;;;], ψ = Matrix{ComplexF64}[[-0.4678011670319867 + 0.8331558879910057im 1.3835780438009593e-10 - 7.653670752727493e-10im 2.8570278087780565e-11 + 2.1770296676493217e-10im 2.390304343347083e-10 + 1.2282735939450617e-10im; -0.04714228795320612 + 0.08396061845636729im -0.30053572153762664 + 0.17615088854911276im 0.3011692768956245 + 0.10156001565570894im 0.06403938360418203 + 0.16044875899965744im; … ; -0.005774306445374884 + 0.01028406479597126im 0.028969140010839372 - 0.0017338635455944416im -0.02825842627240686 - 0.016293070159188898im -0.03128699841217954 + 0.024968021803545647im; 0.04714228791994113 - 0.08396061587977763im -0.0169214247119826 + 0.15917598207729478im 0.02451303086757255 - 0.057952731185691525im -0.24226725889062836 + 0.4048912335151107im], [0.9281798721479873 - 0.03220982758143581im -0.06149360073487824 - 0.1872877641101193im -3.3056413162313447e-10 + 3.138526938339936e-10im 2.263324784534948e-9 - 1.7275637864688775e-9im; 0.06327581014216752 - 0.0021958060484516193im 0.00273690690447869 + 0.008335650304356543im -1.609960012527445e-9 - 6.854941874551157e-10im 2.1409678734735094e-9 - 3.073523302185577e-10im; … ; 0.007746104010798652 - 0.00026880652718907355im -0.026908614171390666 - 0.08195412246789885im 0.017222112661779917 - 0.04537937618315102im 0.03187481707371841 - 0.07922058220188655im; -0.11286413599211625 + 0.003916626783648555im 0.02829646673132631 + 0.08618103464087398im 0.10785322587886673 - 0.2841876787151638im 0.19961556740091582 - 0.49611772833226264im], [0.5835185584654174 + 0.7289697145856924im -1.0123530624905897e-9 - 1.545260031043938e-10im -1.6008984650081604e-9 - 8.542792029331281e-10im -4.3430863176652235e-9 - 3.984673119239446e-9im; 0.04296228783339212 + 0.05367131140062825im 0.011681462144369771 + 0.0559845915648295im 0.014031945189640856 - 0.02384541146680235im -0.02243793173578394 + 0.010834682754691568im; … ; 0.008667801803950204 + 0.010828387396570787im -1.1629982081540202e-9 + 8.595004361011682e-10im -0.0984364905073491 + 0.05594905712464339im 0.0014288993225212284 - 0.07031246063369209im; -0.09574304886709623 - 0.1196085055072983im 0.058647457582345575 + 0.2810738627988921im -0.4377872907746756 - 0.030689889925180416im -0.38525737480813516 - 0.29841052799822376im], [-0.7994699886285388 + 0.12389195260317347im -1.9543372475894216e-10 - 3.4491265399339e-10im -0.10123682599800711 + 0.4847900219086111im -1.7625502030105267e-9 + 2.3660147452364555e-10im; -0.3829033558433683 + 0.059337618627817154im 0.029019106445198117 - 0.6259143214641447im 0.11013040432166459 - 0.5273784520687645im 1.6431462579458156e-9 - 2.561461598382664e-9im; … ; -0.01125929311761123 + 0.0017448258273921632im 7.612251878386419e-5 - 0.0016418779459347072im 0.004267169349618535 - 0.02043407461559749im -0.008169304874441893 - 0.004230533138534904im; 0.06441091624705429 - 0.009981604622516743im 0.0005782265504864588 - 0.01247172736001636im 0.025791413944492268 - 0.12350662583781456im -0.1586789459458144 - 0.08217301470420116im]], eigenvalues = Any[[-0.16677707597278282, 0.264277717813249, 0.2642777178132491, 0.2642777178132494], [-0.11613218762210079, 0.07040532318961779, 0.22624813601526544, 0.22624813601526558], [-0.09588938144772355, 0.08764319966362882, 0.17312704141564644, 0.1731270414156466], [-0.045051463499876876, 0.02226952622609807, 0.09831189251055325, 0.1844640932085817]], occupation = [[2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0]], εF = nothing, optim_res =  * Status: success

 * Candidate solution
    Final objective value:     -7.852647e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 1.11e-13 ≤ 1.0e-12
    |x - x&#39;|/|x&#39;|          = 1.41e-13 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 0.00e+00 ≰ -1.0e+00
    |g(x)|                 = 1.02e-08 ≰ -1.0e+00

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    45
    f(x) calls:    54
    ∇f(x) calls:   47
)</code></pre><p>Start not too far from the solution to ensure convergence: We run first a very crude SCF to get close and then switch to Newton.</p><pre><code class="language-julia hljs">scfres_start = self_consistent_field(basis; tol=1e-1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39304643728725364 0.37974837302470704 … 0.345239967900312 0.379748373024707; 0.379748373024707 0.36718157871686163 … 0.3282130044559053 0.36492427536597694; … ; 0.3452399679003119 0.32821300445590523 … 0.3067347266576467 0.33430207037947823; 0.37974837302470693 0.3649242753659769 … 0.33430207037947823 0.3671815787168616;;; 0.37974837302470704 0.3671815787168617 … 0.32821300445590534 0.3649242753659769; 0.3671815787168616 0.3511270351969236 … 0.3121186736002122 0.3529422973322132; … ; 0.3282130044559053 0.31211867360021217 … 0.297849481333812 0.32178857341479394; 0.3649242753659769 0.3529422973322132 … 0.3217885734147939 0.3529422973322132;;; 0.3452399679003119 0.3343020703794783 … 0.28731961265417955 0.3282130044559053; 0.33430207037947823 0.31798769050414233 … 0.2786234325482624 0.321788573414794; … ; 0.2873196126541795 0.27862343254826233 … 0.25588321306678363 0.2786234325482624; 0.3282130044559053 0.321788573414794 … 0.2786234325482624 0.3121186736002123;;; … ;;; 0.3045711214619132 0.28317965446706317 … 0.2843005227969326 0.3001272279543937; 0.2831796544670631 0.2594637535427047 … 0.27154322422003146 0.28496766416614594; … ; 0.2843005227969326 0.2715432242200314 … 0.27588698622789015 0.2799249289951803; 0.3001272279543937 0.2849676641661459 … 0.27992492899518023 0.29195662219668983;;; 0.3452399679003119 0.32821300445590534 … 0.3067347266576468 0.3343020703794783; 0.3282130044559053 0.3121186736002123 … 0.29784948133381206 0.321788573414794; … ; 0.30673472665764673 0.297849481333812 … 0.27588698622789015 0.2920329628532479; 0.3343020703794782 0.32178857341479394 … 0.2920329628532478 0.3179876905041424;;; 0.37974837302470704 0.36492427536597694 … 0.33430207037947834 0.3671815787168616; 0.3649242753659769 0.3529422973322132 … 0.3217885734147939 0.35294229733221333; … ; 0.33430207037947823 0.32178857341479383 … 0.29203296285324787 0.3179876905041424; 0.3671815787168616 0.3529422973322132 … 0.3179876905041423 0.3511270351969236]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.504552097006728 -0.4977911361581241 … -0.477959637458062 -0.4977911361581241; -0.4977911361581241 -0.48577927805465115 … -0.4772163912011235 -0.4931363646646753; … ; -0.477959637458062 -0.4772163912011236 … -0.4122168055140183 -0.4555706740153471; -0.4977911361581241 -0.4931363646646753 … -0.4555706740153471 -0.48577927805465115;;; -0.4977911361581242 -0.48577927805465115 … -0.4772163912011236 -0.4931363646646753; -0.4857792780546511 -0.45913822166658014 … -0.4714980172983697 -0.4871564127594209; … ; -0.4772163912011236 -0.47149801729836976 … -0.4464445094285415 -0.46948368766248294; -0.4931363646646753 -0.4871564127594209 … -0.46948368766248294 -0.48715641275942073;;; -0.477959637458062 -0.4555706740153471 … -0.461249497593637 -0.4772163912011235; -0.4555706740153471 -0.40933227638283065 … -0.45732150733179056 -0.46948368766248294; … ; -0.461249497593637 -0.45732150733179056 … -0.4453224336842922 -0.45732150733179056; -0.4772163912011235 -0.46948368766248294 … -0.45732150733179056 -0.4714980172983697;;; … ;;; -0.4495978654499539 -0.45546798383666603 … -0.37045426548906835 -0.41751767649814786; -0.45546798383666603 -0.4493046013528016 … -0.4167122821318128 -0.4440492183624916; … ; -0.37045426548906835 -0.4167122821318128 … -0.25282853297208596 -0.2989921087195767; -0.41751767649814786 -0.44404921836249156 … -0.2989921087195768 -0.3606215306609587;;; -0.477959637458062 -0.4772163912011235 … -0.4122168055140184 -0.4555706740153471; -0.4772163912011235 -0.47149801729836976 … -0.4464445094285415 -0.46948368766248294; … ; -0.4122168055140184 -0.4464445094285415 … -0.25282853297208596 -0.3407851578856025; -0.4555706740153471 -0.46948368766248294 … -0.34078515788560254 -0.40933227638283054;;; -0.4977911361581241 -0.4931363646646753 … -0.4555706740153472 -0.4857792780546511; -0.4931363646646753 -0.4871564127594209 … -0.46948368766248294 -0.4871564127594209; … ; -0.4555706740153471 -0.46948368766248294 … -0.3407851578856026 -0.4093322763828306; -0.4857792780546511 -0.4871564127594209 … -0.40933227638283065 -0.45913822166658014])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41249488059051337 -0.4873303032175157 … -0.7029247644027947 -0.48733030321751564; -0.48733030321751536 -0.7741082343915066 … -0.41391924104007655 -0.38161371197056165; … ; -0.7029247644027949 -0.4139192410400769 … -2.397603495457602 -1.2947176632691426; -0.4873303032175157 -0.38161371197056215 … -1.294717663269143 -0.7741082343915064;;; -0.4873303032175158 -0.7741082343915064 … -0.4139192410400766 -0.3816137119705616; -0.7741082343915061 -1.4821960148541673 … -0.3243600853908003 -0.44990871096089935; … ; -0.4139192410400769 -0.32436008539080063 … -1.0118243218389629 -0.6394052465913292; -0.3816137119705618 -0.4499087109608997 … -0.6394052465913298 -0.44990871096089935;;; -0.7029247644027947 -1.294717663269143 … -0.29827225022733383 -0.4139192410400766; -1.2947176632691426 -2.924364697105352 … -0.35183672412913325 -0.6394052465913294; … ; -0.29827225022733406 -0.3518367241291336 … -0.4908025925765409 -0.3518367241291333; -0.4139192410400768 -0.6394052465913298 … -0.3518367241291331 -0.3243600853908002;;; … ;;; -1.0154736693099702 -0.5340733842482532 … -3.6384971538845017 -1.9999646058387408; -0.5340733842482529 -0.32172048004342635 … -1.4643115784901464 -0.9065066957377703; … ; -3.6384971538845017 -1.4643115784901466 … -10.994066195674652 -8.087031254901486; -1.9999646058387408 -0.9065066957377703 … -8.087031254901486 -4.648536760530488;;; -0.7029247644027947 -0.4139192410400766 … -2.397603495457602 -1.2947176632691433; -0.4139192410400765 -0.3243600853908003 … -1.011824321838962 -0.6394052465913294; … ; -2.3976034954576018 -1.011824321838962 … -11.003506386000076 -6.074213796007889; -1.294717663269143 -0.6394052465913297 … -6.074213796007891 -2.9243646971053514;;; -0.48733030321751575 -0.3816137119705616 … -1.2947176632691433 -0.7741082343915064; -0.3816137119705616 -0.4499087109608994 … -0.6394052465913296 -0.4499087109608992; … ; -1.2947176632691435 -0.6394052465913297 … -6.074213796007891 -2.924364697105351; -0.7741082343915063 -0.4499087109608997 … -2.924364697105352 -1.4821960148541673]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39304643728725364 0.37974837302470704 … 0.345239967900312 0.379748373024707; 0.379748373024707 0.36718157871686163 … 0.3282130044559053 0.36492427536597694; … ; 0.3452399679003119 0.32821300445590523 … 0.3067347266576467 0.33430207037947823; 0.37974837302470693 0.3649242753659769 … 0.33430207037947823 0.3671815787168616;;; 0.37974837302470704 0.3671815787168617 … 0.32821300445590534 0.3649242753659769; 0.3671815787168616 0.3511270351969236 … 0.3121186736002122 0.3529422973322132; … ; 0.3282130044559053 0.31211867360021217 … 0.297849481333812 0.32178857341479394; 0.3649242753659769 0.3529422973322132 … 0.3217885734147939 0.3529422973322132;;; 0.3452399679003119 0.3343020703794783 … 0.28731961265417955 0.3282130044559053; 0.33430207037947823 0.31798769050414233 … 0.2786234325482624 0.321788573414794; … ; 0.2873196126541795 0.27862343254826233 … 0.25588321306678363 0.2786234325482624; 0.3282130044559053 0.321788573414794 … 0.2786234325482624 0.3121186736002123;;; … ;;; 0.3045711214619132 0.28317965446706317 … 0.2843005227969326 0.3001272279543937; 0.2831796544670631 0.2594637535427047 … 0.27154322422003146 0.28496766416614594; … ; 0.2843005227969326 0.2715432242200314 … 0.27588698622789015 0.2799249289951803; 0.3001272279543937 0.2849676641661459 … 0.27992492899518023 0.29195662219668983;;; 0.3452399679003119 0.32821300445590534 … 0.3067347266576468 0.3343020703794783; 0.3282130044559053 0.3121186736002123 … 0.29784948133381206 0.321788573414794; … ; 0.30673472665764673 0.297849481333812 … 0.27588698622789015 0.2920329628532479; 0.3343020703794782 0.32178857341479394 … 0.2920329628532478 0.3179876905041424;;; 0.37974837302470704 0.36492427536597694 … 0.33430207037947834 0.3671815787168616; 0.3649242753659769 0.3529422973322132 … 0.3217885734147939 0.35294229733221333; … ; 0.33430207037947823 0.32178857341479383 … 0.29203296285324787 0.3179876905041424; 0.3671815787168616 0.3529422973322132 … 0.3179876905041423 0.3511270351969236]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.504552097006728 -0.4977911361581241 … -0.477959637458062 -0.4977911361581241; -0.4977911361581241 -0.48577927805465115 … -0.4772163912011235 -0.4931363646646753; … ; -0.477959637458062 -0.4772163912011236 … -0.4122168055140183 -0.4555706740153471; -0.4977911361581241 -0.4931363646646753 … -0.4555706740153471 -0.48577927805465115;;; -0.4977911361581242 -0.48577927805465115 … -0.4772163912011236 -0.4931363646646753; -0.4857792780546511 -0.45913822166658014 … -0.4714980172983697 -0.4871564127594209; … ; -0.4772163912011236 -0.47149801729836976 … -0.4464445094285415 -0.46948368766248294; -0.4931363646646753 -0.4871564127594209 … -0.46948368766248294 -0.48715641275942073;;; -0.477959637458062 -0.4555706740153471 … -0.461249497593637 -0.4772163912011235; -0.4555706740153471 -0.40933227638283065 … -0.45732150733179056 -0.46948368766248294; … ; -0.461249497593637 -0.45732150733179056 … -0.4453224336842922 -0.45732150733179056; -0.4772163912011235 -0.46948368766248294 … -0.45732150733179056 -0.4714980172983697;;; … ;;; -0.4495978654499539 -0.45546798383666603 … -0.37045426548906835 -0.41751767649814786; -0.45546798383666603 -0.4493046013528016 … -0.4167122821318128 -0.4440492183624916; … ; -0.37045426548906835 -0.4167122821318128 … -0.25282853297208596 -0.2989921087195767; -0.41751767649814786 -0.44404921836249156 … -0.2989921087195768 -0.3606215306609587;;; -0.477959637458062 -0.4772163912011235 … -0.4122168055140184 -0.4555706740153471; -0.4772163912011235 -0.47149801729836976 … -0.4464445094285415 -0.46948368766248294; … ; -0.4122168055140184 -0.4464445094285415 … -0.25282853297208596 -0.3407851578856025; -0.4555706740153471 -0.46948368766248294 … -0.34078515788560254 -0.40933227638283054;;; -0.4977911361581241 -0.4931363646646753 … -0.4555706740153472 -0.4857792780546511; -0.4931363646646753 -0.4871564127594209 … -0.46948368766248294 -0.4871564127594209; … ; -0.4555706740153471 -0.46948368766248294 … -0.3407851578856026 -0.4093322763828306; -0.4857792780546511 -0.4871564127594209 … -0.40933227638283065 -0.45913822166658014])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41249488059051337 -0.4873303032175157 … -0.7029247644027947 -0.48733030321751564; -0.48733030321751536 -0.7741082343915066 … -0.41391924104007655 -0.38161371197056165; … ; -0.7029247644027949 -0.4139192410400769 … -2.397603495457602 -1.2947176632691426; -0.4873303032175157 -0.38161371197056215 … -1.294717663269143 -0.7741082343915064;;; -0.4873303032175158 -0.7741082343915064 … -0.4139192410400766 -0.3816137119705616; -0.7741082343915061 -1.4821960148541673 … -0.3243600853908003 -0.44990871096089935; … ; -0.4139192410400769 -0.32436008539080063 … -1.0118243218389629 -0.6394052465913292; -0.3816137119705618 -0.4499087109608997 … -0.6394052465913298 -0.44990871096089935;;; -0.7029247644027947 -1.294717663269143 … -0.29827225022733383 -0.4139192410400766; -1.2947176632691426 -2.924364697105352 … -0.35183672412913325 -0.6394052465913294; … ; -0.29827225022733406 -0.3518367241291336 … -0.4908025925765409 -0.3518367241291333; -0.4139192410400768 -0.6394052465913298 … -0.3518367241291331 -0.3243600853908002;;; … ;;; -1.0154736693099702 -0.5340733842482532 … -3.6384971538845017 -1.9999646058387408; -0.5340733842482529 -0.32172048004342635 … -1.4643115784901464 -0.9065066957377703; … ; -3.6384971538845017 -1.4643115784901466 … -10.994066195674652 -8.087031254901486; -1.9999646058387408 -0.9065066957377703 … -8.087031254901486 -4.648536760530488;;; -0.7029247644027947 -0.4139192410400766 … -2.397603495457602 -1.2947176632691433; -0.4139192410400765 -0.3243600853908003 … -1.011824321838962 -0.6394052465913294; … ; -2.3976034954576018 -1.011824321838962 … -11.003506386000076 -6.074213796007889; -1.294717663269143 -0.6394052465913297 … -6.074213796007891 -2.9243646971053514;;; -0.48733030321751575 -0.3816137119705616 … -1.2947176632691433 -0.7741082343915064; -0.3816137119705616 -0.4499087109608994 … -0.6394052465913296 -0.4499087109608992; … ; -1.2947176632691435 -0.6394052465913297 … -6.074213796007891 -2.924364697105351; -0.7741082343915063 -0.4499087109608997 … -2.924364697105352 -1.4821960148541673]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39304643728725364 0.37974837302470704 … 0.345239967900312 0.379748373024707; 0.379748373024707 0.36718157871686163 … 0.3282130044559053 0.36492427536597694; … ; 0.3452399679003119 0.32821300445590523 … 0.3067347266576467 0.33430207037947823; 0.37974837302470693 0.3649242753659769 … 0.33430207037947823 0.3671815787168616;;; 0.37974837302470704 0.3671815787168617 … 0.32821300445590534 0.3649242753659769; 0.3671815787168616 0.3511270351969236 … 0.3121186736002122 0.3529422973322132; … ; 0.3282130044559053 0.31211867360021217 … 0.297849481333812 0.32178857341479394; 0.3649242753659769 0.3529422973322132 … 0.3217885734147939 0.3529422973322132;;; 0.3452399679003119 0.3343020703794783 … 0.28731961265417955 0.3282130044559053; 0.33430207037947823 0.31798769050414233 … 0.2786234325482624 0.321788573414794; … ; 0.2873196126541795 0.27862343254826233 … 0.25588321306678363 0.2786234325482624; 0.3282130044559053 0.321788573414794 … 0.2786234325482624 0.3121186736002123;;; … ;;; 0.3045711214619132 0.28317965446706317 … 0.2843005227969326 0.3001272279543937; 0.2831796544670631 0.2594637535427047 … 0.27154322422003146 0.28496766416614594; … ; 0.2843005227969326 0.2715432242200314 … 0.27588698622789015 0.2799249289951803; 0.3001272279543937 0.2849676641661459 … 0.27992492899518023 0.29195662219668983;;; 0.3452399679003119 0.32821300445590534 … 0.3067347266576468 0.3343020703794783; 0.3282130044559053 0.3121186736002123 … 0.29784948133381206 0.321788573414794; … ; 0.30673472665764673 0.297849481333812 … 0.27588698622789015 0.2920329628532479; 0.3343020703794782 0.32178857341479394 … 0.2920329628532478 0.3179876905041424;;; 0.37974837302470704 0.36492427536597694 … 0.33430207037947834 0.3671815787168616; 0.3649242753659769 0.3529422973322132 … 0.3217885734147939 0.35294229733221333; … ; 0.33430207037947823 0.32178857341479383 … 0.29203296285324787 0.3179876905041424; 0.3671815787168616 0.3529422973322132 … 0.3179876905041423 0.3511270351969236]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.504552097006728 -0.4977911361581241 … -0.477959637458062 -0.4977911361581241; -0.4977911361581241 -0.48577927805465115 … -0.4772163912011235 -0.4931363646646753; … ; -0.477959637458062 -0.4772163912011236 … -0.4122168055140183 -0.4555706740153471; -0.4977911361581241 -0.4931363646646753 … -0.4555706740153471 -0.48577927805465115;;; -0.4977911361581242 -0.48577927805465115 … -0.4772163912011236 -0.4931363646646753; -0.4857792780546511 -0.45913822166658014 … -0.4714980172983697 -0.4871564127594209; … ; -0.4772163912011236 -0.47149801729836976 … -0.4464445094285415 -0.46948368766248294; -0.4931363646646753 -0.4871564127594209 … -0.46948368766248294 -0.48715641275942073;;; -0.477959637458062 -0.4555706740153471 … -0.461249497593637 -0.4772163912011235; -0.4555706740153471 -0.40933227638283065 … -0.45732150733179056 -0.46948368766248294; … ; -0.461249497593637 -0.45732150733179056 … -0.4453224336842922 -0.45732150733179056; -0.4772163912011235 -0.46948368766248294 … -0.45732150733179056 -0.4714980172983697;;; … ;;; -0.4495978654499539 -0.45546798383666603 … -0.37045426548906835 -0.41751767649814786; -0.45546798383666603 -0.4493046013528016 … -0.4167122821318128 -0.4440492183624916; … ; -0.37045426548906835 -0.4167122821318128 … -0.25282853297208596 -0.2989921087195767; -0.41751767649814786 -0.44404921836249156 … -0.2989921087195768 -0.3606215306609587;;; -0.477959637458062 -0.4772163912011235 … -0.4122168055140184 -0.4555706740153471; -0.4772163912011235 -0.47149801729836976 … -0.4464445094285415 -0.46948368766248294; … ; -0.4122168055140184 -0.4464445094285415 … -0.25282853297208596 -0.3407851578856025; -0.4555706740153471 -0.46948368766248294 … -0.34078515788560254 -0.40933227638283054;;; -0.4977911361581241 -0.4931363646646753 … -0.4555706740153472 -0.4857792780546511; -0.4931363646646753 -0.4871564127594209 … -0.46948368766248294 -0.4871564127594209; … ; -0.4555706740153471 -0.46948368766248294 … -0.3407851578856026 -0.4093322763828306; -0.4857792780546511 -0.4871564127594209 … -0.40933227638283065 -0.45913822166658014])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41249488059051337 -0.4873303032175157 … -0.7029247644027947 -0.48733030321751564; -0.48733030321751536 -0.7741082343915066 … -0.41391924104007655 -0.38161371197056165; … ; -0.7029247644027949 -0.4139192410400769 … -2.397603495457602 -1.2947176632691426; -0.4873303032175157 -0.38161371197056215 … -1.294717663269143 -0.7741082343915064;;; -0.4873303032175158 -0.7741082343915064 … -0.4139192410400766 -0.3816137119705616; -0.7741082343915061 -1.4821960148541673 … -0.3243600853908003 -0.44990871096089935; … ; -0.4139192410400769 -0.32436008539080063 … -1.0118243218389629 -0.6394052465913292; -0.3816137119705618 -0.4499087109608997 … -0.6394052465913298 -0.44990871096089935;;; -0.7029247644027947 -1.294717663269143 … -0.29827225022733383 -0.4139192410400766; -1.2947176632691426 -2.924364697105352 … -0.35183672412913325 -0.6394052465913294; … ; -0.29827225022733406 -0.3518367241291336 … -0.4908025925765409 -0.3518367241291333; -0.4139192410400768 -0.6394052465913298 … -0.3518367241291331 -0.3243600853908002;;; … ;;; -1.0154736693099702 -0.5340733842482532 … -3.6384971538845017 -1.9999646058387408; -0.5340733842482529 -0.32172048004342635 … -1.4643115784901464 -0.9065066957377703; … ; -3.6384971538845017 -1.4643115784901466 … -10.994066195674652 -8.087031254901486; -1.9999646058387408 -0.9065066957377703 … -8.087031254901486 -4.648536760530488;;; -0.7029247644027947 -0.4139192410400766 … -2.397603495457602 -1.2947176632691433; -0.4139192410400765 -0.3243600853908003 … -1.011824321838962 -0.6394052465913294; … ; -2.3976034954576018 -1.011824321838962 … -11.003506386000076 -6.074213796007889; -1.294717663269143 -0.6394052465913297 … -6.074213796007891 -2.9243646971053514;;; -0.48733030321751575 -0.3816137119705616 … -1.2947176632691433 -0.7741082343915064; -0.3816137119705616 -0.4499087109608994 … -0.6394052465913296 -0.4499087109608992; … ; -1.2947176632691435 -0.6394052465913297 … -6.074213796007891 -2.924364697105351; -0.7741082343915063 -0.4499087109608997 … -2.924364697105352 -1.4821960148541673]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39304643728725364 0.37974837302470704 … 0.345239967900312 0.379748373024707; 0.379748373024707 0.36718157871686163 … 0.3282130044559053 0.36492427536597694; … ; 0.3452399679003119 0.32821300445590523 … 0.3067347266576467 0.33430207037947823; 0.37974837302470693 0.3649242753659769 … 0.33430207037947823 0.3671815787168616;;; 0.37974837302470704 0.3671815787168617 … 0.32821300445590534 0.3649242753659769; 0.3671815787168616 0.3511270351969236 … 0.3121186736002122 0.3529422973322132; … ; 0.3282130044559053 0.31211867360021217 … 0.297849481333812 0.32178857341479394; 0.3649242753659769 0.3529422973322132 … 0.3217885734147939 0.3529422973322132;;; 0.3452399679003119 0.3343020703794783 … 0.28731961265417955 0.3282130044559053; 0.33430207037947823 0.31798769050414233 … 0.2786234325482624 0.321788573414794; … ; 0.2873196126541795 0.27862343254826233 … 0.25588321306678363 0.2786234325482624; 0.3282130044559053 0.321788573414794 … 0.2786234325482624 0.3121186736002123;;; … ;;; 0.3045711214619132 0.28317965446706317 … 0.2843005227969326 0.3001272279543937; 0.2831796544670631 0.2594637535427047 … 0.27154322422003146 0.28496766416614594; … ; 0.2843005227969326 0.2715432242200314 … 0.27588698622789015 0.2799249289951803; 0.3001272279543937 0.2849676641661459 … 0.27992492899518023 0.29195662219668983;;; 0.3452399679003119 0.32821300445590534 … 0.3067347266576468 0.3343020703794783; 0.3282130044559053 0.3121186736002123 … 0.29784948133381206 0.321788573414794; … ; 0.30673472665764673 0.297849481333812 … 0.27588698622789015 0.2920329628532479; 0.3343020703794782 0.32178857341479394 … 0.2920329628532478 0.3179876905041424;;; 0.37974837302470704 0.36492427536597694 … 0.33430207037947834 0.3671815787168616; 0.3649242753659769 0.3529422973322132 … 0.3217885734147939 0.35294229733221333; … ; 0.33430207037947823 0.32178857341479383 … 0.29203296285324787 0.3179876905041424; 0.3671815787168616 0.3529422973322132 … 0.3179876905041423 0.3511270351969236]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.504552097006728 -0.4977911361581241 … -0.477959637458062 -0.4977911361581241; -0.4977911361581241 -0.48577927805465115 … -0.4772163912011235 -0.4931363646646753; … ; -0.477959637458062 -0.4772163912011236 … -0.4122168055140183 -0.4555706740153471; -0.4977911361581241 -0.4931363646646753 … -0.4555706740153471 -0.48577927805465115;;; -0.4977911361581242 -0.48577927805465115 … -0.4772163912011236 -0.4931363646646753; -0.4857792780546511 -0.45913822166658014 … -0.4714980172983697 -0.4871564127594209; … ; -0.4772163912011236 -0.47149801729836976 … -0.4464445094285415 -0.46948368766248294; -0.4931363646646753 -0.4871564127594209 … -0.46948368766248294 -0.48715641275942073;;; -0.477959637458062 -0.4555706740153471 … -0.461249497593637 -0.4772163912011235; -0.4555706740153471 -0.40933227638283065 … -0.45732150733179056 -0.46948368766248294; … ; -0.461249497593637 -0.45732150733179056 … -0.4453224336842922 -0.45732150733179056; -0.4772163912011235 -0.46948368766248294 … -0.45732150733179056 -0.4714980172983697;;; … ;;; -0.4495978654499539 -0.45546798383666603 … -0.37045426548906835 -0.41751767649814786; -0.45546798383666603 -0.4493046013528016 … -0.4167122821318128 -0.4440492183624916; … ; -0.37045426548906835 -0.4167122821318128 … -0.25282853297208596 -0.2989921087195767; -0.41751767649814786 -0.44404921836249156 … -0.2989921087195768 -0.3606215306609587;;; -0.477959637458062 -0.4772163912011235 … -0.4122168055140184 -0.4555706740153471; -0.4772163912011235 -0.47149801729836976 … -0.4464445094285415 -0.46948368766248294; … ; -0.4122168055140184 -0.4464445094285415 … -0.25282853297208596 -0.3407851578856025; -0.4555706740153471 -0.46948368766248294 … -0.34078515788560254 -0.40933227638283054;;; -0.4977911361581241 -0.4931363646646753 … -0.4555706740153472 -0.4857792780546511; -0.4931363646646753 -0.4871564127594209 … -0.46948368766248294 -0.4871564127594209; … ; -0.4555706740153471 -0.46948368766248294 … -0.3407851578856026 -0.4093322763828306; -0.4857792780546511 -0.4871564127594209 … -0.40933227638283065 -0.45913822166658014])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41249488059051337 -0.4873303032175157 … -0.7029247644027947 -0.48733030321751564; -0.48733030321751536 -0.7741082343915066 … -0.41391924104007655 -0.38161371197056165; … ; -0.7029247644027949 -0.4139192410400769 … -2.397603495457602 -1.2947176632691426; -0.4873303032175157 -0.38161371197056215 … -1.294717663269143 -0.7741082343915064;;; -0.4873303032175158 -0.7741082343915064 … -0.4139192410400766 -0.3816137119705616; -0.7741082343915061 -1.4821960148541673 … -0.3243600853908003 -0.44990871096089935; … ; -0.4139192410400769 -0.32436008539080063 … -1.0118243218389629 -0.6394052465913292; -0.3816137119705618 -0.4499087109608997 … -0.6394052465913298 -0.44990871096089935;;; -0.7029247644027947 -1.294717663269143 … -0.29827225022733383 -0.4139192410400766; -1.2947176632691426 -2.924364697105352 … -0.35183672412913325 -0.6394052465913294; … ; -0.29827225022733406 -0.3518367241291336 … -0.4908025925765409 -0.3518367241291333; -0.4139192410400768 -0.6394052465913298 … -0.3518367241291331 -0.3243600853908002;;; … ;;; -1.0154736693099702 -0.5340733842482532 … -3.6384971538845017 -1.9999646058387408; -0.5340733842482529 -0.32172048004342635 … -1.4643115784901464 -0.9065066957377703; … ; -3.6384971538845017 -1.4643115784901466 … -10.994066195674652 -8.087031254901486; -1.9999646058387408 -0.9065066957377703 … -8.087031254901486 -4.648536760530488;;; -0.7029247644027947 -0.4139192410400766 … -2.397603495457602 -1.2947176632691433; -0.4139192410400765 -0.3243600853908003 … -1.011824321838962 -0.6394052465913294; … ; -2.3976034954576018 -1.011824321838962 … -11.003506386000076 -6.074213796007889; -1.294717663269143 -0.6394052465913297 … -6.074213796007891 -2.9243646971053514;;; -0.48733030321751575 -0.3816137119705616 … -1.2947176632691433 -0.7741082343915064; -0.3816137119705616 -0.4499087109608994 … -0.6394052465913296 -0.4499087109608992; … ; -1.2947176632691435 -0.6394052465913297 … -6.074213796007891 -2.924364697105351; -0.7741082343915063 -0.4499087109608997 … -2.924364697105352 -1.4821960148541673]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852315574967248), converged = true, occupation_threshold = 1.0e-6, ρ = [0.0920555188459222 0.08812275185838651 … 0.07724907149679308 0.0881227518583865; 0.0881227518583865 0.08142041622059062 … 0.07686033562627385 0.0854826273092293; … ; 0.07724907149679308 0.07686033562627387 … 0.04775776248900045 0.06611455062656907; 0.0881227518583865 0.0854826273092293 … 0.06611455062656907 0.0814204162205906;;; 0.08812275185838653 0.08142041622059062 … 0.07686033562627388 0.08548262730922931; 0.08142041622059061 0.06781022333408455 … 0.0739139361811748 0.08217057664494161; … ; 0.07686033562627387 0.07391393618117481 … 0.061908797605591544 0.07289465888973139; 0.08548262730922931 0.08217057664494161 … 0.07289465888973139 0.0821705766449416;;; 0.07724907149679308 0.06611455062656907 … 0.06882755296148824 0.07686033562627384; 0.06611455062656907 0.04667745106766762 … 0.06694307335978823 0.07289465888973139; … ; 0.06882755296148822 0.06694307335978825 … 0.061404638043224304 0.06694307335978823; 0.07686033562627384 0.07289465888973139 … 0.06694307335978825 0.0739139361811748;;; … ;;; 0.06334072877983433 0.06606617411475599 … 0.03370045640922488 0.04978732765027974; 0.06606617411475597 0.0632066157539794 … 0.04947524180770782 0.0608359687392554; … ; 0.033700456409224866 0.04947524180770783 … 0.00959199013498097 0.01668284396209653; 0.04978732765027974 0.06083596873925539 … 0.016682843962096537 0.030861796685004144;;; 0.07724907149679308 0.07686033562627385 … 0.04775776248900046 0.06611455062656907; 0.07686033562627384 0.07391393618117481 … 0.06190879760559154 0.07289465888973139; … ; 0.047757762489000447 0.06190879760559154 … 0.009591990134980978 0.025641336303172228; 0.06611455062656907 0.07289465888973139 … 0.025641336303172235 0.0466774510676676;;; 0.08812275185838651 0.08548262730922931 … 0.06611455062656908 0.08142041622059061; 0.08548262730922931 0.08217057664494161 … 0.07289465888973137 0.08217057664494161; … ; 0.06611455062656907 0.07289465888973139 … 0.02564133630317224 0.046677451067667616; 0.08142041622059061 0.08217057664494161 … 0.04667745106766763 0.06781022333408455;;;;], α = 0.8, eigenvalues = [[-0.16691472040419889, 0.26432098558355055, 0.2643369121821585, 0.2645384136412924, 0.3573545334751499, 0.3574693116081042, 0.36390883770393745], [-0.11620423165424759, 0.07030289046136713, 0.2262735187524732, 0.22627512645630327, 0.33636140062709524, 0.3933560566434692, 0.39348548371449665], [-0.09596102292210662, 0.08789016744329106, 0.17297163000138335, 0.17299560100192635, 0.2914667417779867, 0.33733684392205704, 0.5339381671400585], [-0.044953735461666956, 0.02236332676699247, 0.09783771494768939, 0.18445706360906516, 0.32485658868858613, 0.5030827239495319, 0.5064681299894909]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.29000478027452686, n_iter = 2, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.8404114204575666 - 0.456001503662812im 0.00011680663107155407 + 9.423473094004913e-5im … 0.00024193321231975136 + 0.00012513562741821413im 0.0006791069643166362 - 0.0011097421727258626im; 0.0841224228090832 - 0.04561009748353982im 0.19029246224640958 - 0.19744711875330126im … -0.35856203801193 - 0.08689563867609727im -0.03480163824556359 - 0.06608278497237914im; … ; 0.009921289955515205 - 0.005277097801137572im -0.004859003421490613 + 0.034060097550775596im … -0.08768120788452365 + 0.0025415154197716387im 0.03001569366560233 + 0.0012738058792526718im; -0.0840732100301576 + 0.04548628460116628im 0.14327457240231845 + 0.1297620591844625im … -0.37574803158243103 + 0.11071906100607593im 0.268914836590356 + 0.07909717934545964im], [0.7861767106186592 + 0.49572694537674183im 0.19517355341942694 + 0.023547674863094975im … 6.719060574670227e-5 + 5.1818963017443456e-5im -0.0006197136151133362 + 0.00028054511578531807im; 0.05294857798605349 + 0.033372826467812575im -0.011331052036099862 - 0.0013176766471112412im … -0.00046683034937545955 + 0.0004761931591643139im -0.0027234556354363104 + 0.0021561497144114822im; … ; 0.006744309160057765 + 0.00429912207431011im 0.08476271408340467 + 0.010128122516126836im … 0.04464399222362125 + 0.034342736827688625im 0.0847557463268338 - 0.030405986614162397im; -0.09496021591692741 - 0.059908772345355715im -0.08807689923584033 - 0.010651421994308345im … 0.1985114675786937 + 0.15185217281086197im 0.3630225152079137 - 0.13960087895198436im], [0.9270760298977276 + 0.11747727005297097im 9.410209037171997e-5 - 3.0486654706857012e-5im … -0.0006082615921957947 + 0.00018365575381523833im 3.1005456123028133e-5 + 0.0001327550162262587im; 0.06680388593761521 + 0.008485731219110084im 0.058080118889382096 - 0.013299992192074037im … -0.008712654868977284 + 0.002747782577637483im 0.011056530511495253 - 0.006784131312042216im; … ; 0.014414957125726354 + 0.0018172741925742083im -2.3380157226815697e-5 + 2.2193420908126816e-6im … 0.0064577233569453225 - 0.002085726249899588im -0.051272218376040096 - 0.038089712892318335im; -0.15099644524230219 - 0.0191420426718364im 0.2793943430767502 - 0.06400551417518373im … 0.357666158079407 - 0.13208351674993im -0.12110870915187034 - 0.08615768153075039im], [-0.4380841174223013 - 0.6807773403115255im -0.0001066537401827313 - 0.00013235194381116676im … 0.013399302962057248 + 0.011754558705548219im -0.16916220067040025 - 0.14547967526807346im; -0.2095918158298926 - 0.3256901415540865im -0.4112852010812469 - 0.4736550208223251im … -0.014043832619836907 - 0.012161775033485842im 0.16396297340303326 + 0.14058189057308984im; … ; -0.00609650610002056 - 0.009513559036270642im -0.0008230345318776445 - 0.001044430010585493im … 0.013343892956889775 - 0.04266813380646579im -0.009872709761892015 - 0.011663635907004977im; 0.03464984146131172 + 0.05379827277237033im -0.008762359677903621 - 0.010192571887464018im … 0.15636615341287752 - 0.4492555139780177im -0.3283693521221003 - 0.32965393265242293im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16691472040419889, 0.26432098558355055, 0.2643369121821585, 0.2645384136412924, 0.3573545334751499, 0.3574693116081042, 0.36390883770393745], [-0.11620423165424759, 0.07030289046136713, 0.2262735187524732, 0.22627512645630327, 0.33636140062709524, 0.3933560566434692, 0.39348548371449665], [-0.09596102292210662, 0.08789016744329106, 0.17297163000138335, 0.17299560100192635, 0.2914667417779867, 0.33733684392205704, 0.5339381671400585], [-0.044953735461666956, 0.02236332676699247, 0.09783771494768939, 0.18445706360906516, 0.32485658868858613, 0.5030827239495319, 0.5064681299894909]], X = [[0.8404114204575666 - 0.456001503662812im 0.00011680663107155407 + 9.423473094004913e-5im … 0.00024193321231975136 + 0.00012513562741821413im 0.0006791069643166362 - 0.0011097421727258626im; 0.0841224228090832 - 0.04561009748353982im 0.19029246224640958 - 0.19744711875330126im … -0.35856203801193 - 0.08689563867609727im -0.03480163824556359 - 0.06608278497237914im; … ; 0.009921289955515205 - 0.005277097801137572im -0.004859003421490613 + 0.034060097550775596im … -0.08768120788452365 + 0.0025415154197716387im 0.03001569366560233 + 0.0012738058792526718im; -0.0840732100301576 + 0.04548628460116628im 0.14327457240231845 + 0.1297620591844625im … -0.37574803158243103 + 0.11071906100607593im 0.268914836590356 + 0.07909717934545964im], [0.7861767106186592 + 0.49572694537674183im 0.19517355341942694 + 0.023547674863094975im … 6.719060574670227e-5 + 5.1818963017443456e-5im -0.0006197136151133362 + 0.00028054511578531807im; 0.05294857798605349 + 0.033372826467812575im -0.011331052036099862 - 0.0013176766471112412im … -0.00046683034937545955 + 0.0004761931591643139im -0.0027234556354363104 + 0.0021561497144114822im; … ; 0.006744309160057765 + 0.00429912207431011im 0.08476271408340467 + 0.010128122516126836im … 0.04464399222362125 + 0.034342736827688625im 0.0847557463268338 - 0.030405986614162397im; -0.09496021591692741 - 0.059908772345355715im -0.08807689923584033 - 0.010651421994308345im … 0.1985114675786937 + 0.15185217281086197im 0.3630225152079137 - 0.13960087895198436im], [0.9270760298977276 + 0.11747727005297097im 9.410209037171997e-5 - 3.0486654706857012e-5im … -0.0006082615921957947 + 0.00018365575381523833im 3.1005456123028133e-5 + 0.0001327550162262587im; 0.06680388593761521 + 0.008485731219110084im 0.058080118889382096 - 0.013299992192074037im … -0.008712654868977284 + 0.002747782577637483im 0.011056530511495253 - 0.006784131312042216im; … ; 0.014414957125726354 + 0.0018172741925742083im -2.3380157226815697e-5 + 2.2193420908126816e-6im … 0.0064577233569453225 - 0.002085726249899588im -0.051272218376040096 - 0.038089712892318335im; -0.15099644524230219 - 0.0191420426718364im 0.2793943430767502 - 0.06400551417518373im … 0.357666158079407 - 0.13208351674993im -0.12110870915187034 - 0.08615768153075039im], [-0.4380841174223013 - 0.6807773403115255im -0.0001066537401827313 - 0.00013235194381116676im … 0.013399302962057248 + 0.011754558705548219im -0.16916220067040025 - 0.14547967526807346im; -0.2095918158298926 - 0.3256901415540865im -0.4112852010812469 - 0.4736550208223251im … -0.014043832619836907 - 0.012161775033485842im 0.16396297340303326 + 0.14058189057308984im; … ; -0.00609650610002056 - 0.009513559036270642im -0.0008230345318776445 - 0.001044430010585493im … 0.013343892956889775 - 0.04266813380646579im -0.009872709761892015 - 0.011663635907004977im; 0.03464984146131172 + 0.05379827277237033im -0.008762359677903621 - 0.010192571887464018im … 0.15636615341287752 - 0.4492555139780177im -0.3283693521221003 - 0.32965393265242293im]], residual_norms = [[0.008390199278701152, 0.007096148062074597, 0.007861351069337115, 0.013607219667953498, 0.005374977727450427, 0.010969302676508608, 0.03913555001519131], [0.0040244166943430235, 0.0065690570627203945, 0.006039051439862964, 0.0063908423362221784, 0.006707469317094704, 0.011288653141586764, 0.01645328987547577], [0.005867333270360773, 0.005660752320617045, 0.004507107441189736, 0.007014597675441314, 0.007617569428954512, 0.01889715577385469, 0.02993789477970551], [0.004956900643025493, 0.004865705757866586, 0.008037694742658892, 0.012504299416815844, 0.04149143409111815, 0.01894752131039756, 0.04792527849616441]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 0.002736385227645179)</code></pre><p>Remove the virtual orbitals (which Newton cannot treat yet)</p><pre><code class="language-julia hljs">ψ, _ = DFTK.select_occupied_orbitals(basis, scfres_start.ψ, scfres_start.occupation)
scfres_newton = newton(basis, ψ; tol)

# Comparison of results

println(&quot;|ρ_newton - ρ_scf|  = &quot;, norm(scfres_newton.ρ - scfres_scf.ρ))
println(&quot;|ρ_newton - ρ_scfv| = &quot;, norm(scfres_newton.ρ - scfres_scfv.ρ))
println(&quot;|ρ_newton - ρ_dm|   = &quot;, norm(scfres_newton.ρ - scfres_dm.ρ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)
---   ---------------   ---------   ---------
  1   -7.852646686651                   -2.54
  2   -7.852646686730      -10.10       -5.79
  3   -7.852646686730   +  -14.75      -12.03
|ρ_newton - ρ_scf|  = 4.674599287590002e-13
|ρ_newton - ρ_scfv| = 1.1823210330282782e-13
|ρ_newton - ρ_dm|   = 4.905009786123428e-10</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scf_callbacks/">« Monitoring self-consistent field calculations</a><a class="docs-footer-nextpage" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 31 August 2022 05:47">Wednesday 31 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
