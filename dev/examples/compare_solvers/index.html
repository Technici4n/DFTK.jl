<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison of DFT solvers · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/compare_solvers/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li class="is-active"><a class="tocitem" href>Comparison of DFT solvers</a><ul class="internal"><li><a class="tocitem" href="#Density-based-self-consistent-field"><span>Density-based self-consistent field</span></a></li><li><a class="tocitem" href="#Potential-based-SCF"><span>Potential-based SCF</span></a></li><li><a class="tocitem" href="#Direct-minimization"><span>Direct minimization</span></a></li></ul></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/compare_solvers.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-of-DFT-solvers"><a class="docs-heading-anchor" href="#Comparison-of-DFT-solvers">Comparison of DFT solvers</a><a id="Comparison-of-DFT-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-DFT-solvers" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/compare_solvers.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/compare_solvers.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compare four different approaches for solving the DFT minimisation problem, namely a density-based SCF, a potential-based SCF, direct minimisation and Newton.</p><p>First we setup our problem</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra

a = 10.26  # Silicon lattice constant in Bohr
lattice = a / 2 * [[0 1 1.];
                   [1 0 1.];
                   [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=[3, 3, 3])

# Convergence we desire
tol = 1e-12
is_converged = DFTK.ScfConvergenceDensity(tol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">#507 (generic function with 1 method)</code></pre><h2 id="Density-based-self-consistent-field"><a class="docs-heading-anchor" href="#Density-based-self-consistent-field">Density-based self-consistent field</a><a id="Density-based-self-consistent-field-1"></a><a class="docs-heading-anchor-permalink" href="#Density-based-self-consistent-field" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scf = self_consistent_field(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3915556370334806 0.3785174208997725 … 0.34469960027021834 0.3785174208997725; 0.3785174208997726 0.36645844064793714 … 0.3273572817222713 0.36364954262056387; … ; 0.3446996002702183 0.32735728172227124 … 0.3075192694185393 0.33438053198658046; 0.3785174208997726 0.3636495426205638 … 0.33438053198658046 0.36645844064793714;;; 0.3785174208997725 0.36645844064793714 … 0.3273572817222713 0.36364954262056376; 0.36645844064793714 0.35102886341772893 … 0.31119401346060066 0.35191706634920994; … ; 0.32735728172227124 0.3111940134606006 … 0.2982412284122417 0.32142600281510236; 0.3636495426205638 0.35191706634920994 … 0.32142600281510236 0.3519170663492099;;; 0.34469960027021834 0.3343805319865805 … 0.2865351537639504 0.32735728172227135; 0.3343805319865805 0.3186160477629729 … 0.27805891882349704 0.3214260028151024; … ; 0.2865351537639504 0.278058918823497 … 0.25590185772312657 0.278058918823497; 0.3273572817222714 0.3214260028151024 … 0.278058918823497 0.31119401346060066;;; … ;;; 0.3048747492890471 0.28303666896238727 … 0.2855643323175385 0.3009573705184105; 0.28303666896238727 0.2589843162227452 … 0.27263300128656875 0.28541419662662704; … ; 0.2855643323175385 0.2726330012865688 … 0.2771603891376984 0.2812108737837918; 0.3009573705184106 0.285414196626627 … 0.2812108737837918 0.2930827262716919;;; 0.3446996002702183 0.32735728172227135 … 0.30751926941853935 0.33438053198658046; 0.32735728172227135 0.3111940134606006 … 0.29824122841224177 0.3214260028151024; … ; 0.30751926941853935 0.2982412284122417 … 0.2771603891376984 0.2931311914702247; 0.3343805319865805 0.3214260028151024 … 0.29313119147022465 0.3186160477629729;;; 0.3785174208997725 0.36364954262056376 … 0.3343805319865805 0.3664584406479371; 0.3636495426205638 0.35191706634920983 … 0.32142600281510236 0.35191706634920994; … ; 0.3343805319865805 0.3214260028151023 … 0.2931311914702247 0.31861604776297286; 0.36645844064793714 0.3519170663492099 … 0.31861604776297286 0.35102886341772893]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923122178 -0.49665655722570706 … -0.4771919009648934 -0.49665655722570706; -0.49665655722570706 -0.4848182087107416 … -0.4763804457667853 -0.4920413111694325; … ; -0.47719190096489345 -0.4763804457667853 … -0.41228807087391384 -0.4550700815561225; -0.49665655722570706 -0.4920413111694325 … -0.4550700815561226 -0.4848182087107416;;; -0.49665655722570706 -0.48481820871074177 … -0.47638044576678534 -0.4920413111694325; -0.48481820871074166 -0.458374407914861 … -0.4706560157057247 -0.4861790251756276; … ; -0.4763804457667853 -0.4706560157057247 … -0.4463984364362162 -0.46889439639152697; -0.4920413111694325 -0.4861790251756275 … -0.46889439639152697 -0.4861790251756276;;; -0.4771919009648934 -0.4550700815561226 … -0.460514123422674 -0.4763804457667853; -0.4550700815561225 -0.409066182439127 … -0.45671990832114384 -0.46889439639152686; … ; -0.460514123422674 -0.45671990832114384 … -0.4451449566034937 -0.45671990832114384; -0.47638044576678534 -0.46889439639152686 … -0.45671990832114384 -0.4706560157057247;;; … ;;; -0.44947595084091346 -0.4551499722014942 … -0.37125986261790506 -0.41774571520276216; -0.45514997220149417 -0.44880351099771876 … -0.4174380107134192 -0.44412609929878066; … ; -0.37125986261790506 -0.4174380107134192 … -0.2536569832840758 -0.2997980910596023; -0.41774571520276216 -0.44412609929878066 … -0.2997980910596023 -0.36106343264802404;;; -0.47719190096489345 -0.4763804457667853 … -0.4122880708739139 -0.4550700815561226; -0.47638044576678534 -0.4706560157057247 … -0.44639843643621624 -0.46889439639152686; … ; -0.41228807087391395 -0.44639843643621624 … -0.25365698328407593 -0.3410633023008403; -0.4550700815561225 -0.46889439639152686 … -0.34106330230084025 -0.409066182439127;;; -0.49665655722570706 -0.4920413111694325 … -0.4550700815561225 -0.48481820871074177; -0.4920413111694325 -0.4861790251756276 … -0.46889439639152697 -0.4861790251756275; … ; -0.4550700815561225 -0.46889439639152697 … -0.3410633023008403 -0.409066182439127; -0.48481820871074166 -0.4861790251756275 … -0.409066182439127 -0.458374407914861])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4129139212663052 -0.4868367442771864 … -0.7027113226191004 -0.4868367442771865; -0.4868367442771861 -0.7744303950404472 … -0.4136373284393088 -0.38233074979448495; … ; -0.7027113226191009 -0.41363732843930906 … -2.3967616825880595 -1.2958067581749675; -0.486836744277186 -0.3823307497944849 … -1.2958067581749677 -0.774430395040447;;; -0.48683674427718626 -0.7744303950404474 … -0.41363732843930884 -0.38233074979448534; -0.774430395040447 -1.4814477483918769 … -0.3245845694332743 -0.449919396570689; … ; -0.41363732843930895 -0.32458456943327474 … -1.0113572986117039 -0.6373277791931853; -0.38233074979448484 -0.4499193965706889 … -0.6373277791931851 -0.44991939657068897;;; -0.7027113226191004 -1.295806758174968 … -0.29820348937556884 -0.41363732843930895; -1.2958067581749675 -2.9196723936538955 … -0.3537295846614499 -0.6373277791931848; … ; -0.29820348937556884 -0.35372958466145055 … -0.49037260810717864 -0.35372958466145044; -0.4136373284393087 -0.6373277791931848 … -0.35372958466144977 -0.3245845694332743;;; … ;;; -1.0166744212557755 -0.5332878143065953 … -3.636138257122869 -1.9987602620506255; -0.5332878143065951 -0.32174124747388577 … -1.466733940750262 -0.9061938941468847; … ; -3.636138257122869 -1.466733940750262 … -10.988177824465904 -8.08737616820818; -1.9987602620506253 -0.9061938941468848 … -8.08737616820818 -4.6478783711432365;;; -0.7027113226191006 -0.4136373284393087 … -2.39676168258806 -1.2958067581749677; -0.41363732843930867 -0.32458456943327463 … -1.011357298611704 -0.6373277791931848; … ; -2.39676168258806 -1.011357298611704 … -11.00280619087501 -6.077304186394078; -1.2958067581749675 -0.6373277791931847 … -6.077304186394078 -2.9196723936538955;;; -0.4868367442771863 -0.3823307497944852 … -1.2958067581749675 -0.7744303950404474; -0.38233074979448495 -0.4499193965706892 … -0.6373277791931851 -0.4499193965706889; … ; -1.2958067581749675 -0.6373277791931853 … -6.077304186394077 -2.9196723936538955; -0.774430395040447 -0.4499193965706888 … -2.9196723936538955 -1.4814477483918769]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3915556370334806 0.3785174208997725 … 0.34469960027021834 0.3785174208997725; 0.3785174208997726 0.36645844064793714 … 0.3273572817222713 0.36364954262056387; … ; 0.3446996002702183 0.32735728172227124 … 0.3075192694185393 0.33438053198658046; 0.3785174208997726 0.3636495426205638 … 0.33438053198658046 0.36645844064793714;;; 0.3785174208997725 0.36645844064793714 … 0.3273572817222713 0.36364954262056376; 0.36645844064793714 0.35102886341772893 … 0.31119401346060066 0.35191706634920994; … ; 0.32735728172227124 0.3111940134606006 … 0.2982412284122417 0.32142600281510236; 0.3636495426205638 0.35191706634920994 … 0.32142600281510236 0.3519170663492099;;; 0.34469960027021834 0.3343805319865805 … 0.2865351537639504 0.32735728172227135; 0.3343805319865805 0.3186160477629729 … 0.27805891882349704 0.3214260028151024; … ; 0.2865351537639504 0.278058918823497 … 0.25590185772312657 0.278058918823497; 0.3273572817222714 0.3214260028151024 … 0.278058918823497 0.31119401346060066;;; … ;;; 0.3048747492890471 0.28303666896238727 … 0.2855643323175385 0.3009573705184105; 0.28303666896238727 0.2589843162227452 … 0.27263300128656875 0.28541419662662704; … ; 0.2855643323175385 0.2726330012865688 … 0.2771603891376984 0.2812108737837918; 0.3009573705184106 0.285414196626627 … 0.2812108737837918 0.2930827262716919;;; 0.3446996002702183 0.32735728172227135 … 0.30751926941853935 0.33438053198658046; 0.32735728172227135 0.3111940134606006 … 0.29824122841224177 0.3214260028151024; … ; 0.30751926941853935 0.2982412284122417 … 0.2771603891376984 0.2931311914702247; 0.3343805319865805 0.3214260028151024 … 0.29313119147022465 0.3186160477629729;;; 0.3785174208997725 0.36364954262056376 … 0.3343805319865805 0.3664584406479371; 0.3636495426205638 0.35191706634920983 … 0.32142600281510236 0.35191706634920994; … ; 0.3343805319865805 0.3214260028151023 … 0.2931311914702247 0.31861604776297286; 0.36645844064793714 0.3519170663492099 … 0.31861604776297286 0.35102886341772893]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923122178 -0.49665655722570706 … -0.4771919009648934 -0.49665655722570706; -0.49665655722570706 -0.4848182087107416 … -0.4763804457667853 -0.4920413111694325; … ; -0.47719190096489345 -0.4763804457667853 … -0.41228807087391384 -0.4550700815561225; -0.49665655722570706 -0.4920413111694325 … -0.4550700815561226 -0.4848182087107416;;; -0.49665655722570706 -0.48481820871074177 … -0.47638044576678534 -0.4920413111694325; -0.48481820871074166 -0.458374407914861 … -0.4706560157057247 -0.4861790251756276; … ; -0.4763804457667853 -0.4706560157057247 … -0.4463984364362162 -0.46889439639152697; -0.4920413111694325 -0.4861790251756275 … -0.46889439639152697 -0.4861790251756276;;; -0.4771919009648934 -0.4550700815561226 … -0.460514123422674 -0.4763804457667853; -0.4550700815561225 -0.409066182439127 … -0.45671990832114384 -0.46889439639152686; … ; -0.460514123422674 -0.45671990832114384 … -0.4451449566034937 -0.45671990832114384; -0.47638044576678534 -0.46889439639152686 … -0.45671990832114384 -0.4706560157057247;;; … ;;; -0.44947595084091346 -0.4551499722014942 … -0.37125986261790506 -0.41774571520276216; -0.45514997220149417 -0.44880351099771876 … -0.4174380107134192 -0.44412609929878066; … ; -0.37125986261790506 -0.4174380107134192 … -0.2536569832840758 -0.2997980910596023; -0.41774571520276216 -0.44412609929878066 … -0.2997980910596023 -0.36106343264802404;;; -0.47719190096489345 -0.4763804457667853 … -0.4122880708739139 -0.4550700815561226; -0.47638044576678534 -0.4706560157057247 … -0.44639843643621624 -0.46889439639152686; … ; -0.41228807087391395 -0.44639843643621624 … -0.25365698328407593 -0.3410633023008403; -0.4550700815561225 -0.46889439639152686 … -0.34106330230084025 -0.409066182439127;;; -0.49665655722570706 -0.4920413111694325 … -0.4550700815561225 -0.48481820871074177; -0.4920413111694325 -0.4861790251756276 … -0.46889439639152697 -0.4861790251756275; … ; -0.4550700815561225 -0.46889439639152697 … -0.3410633023008403 -0.409066182439127; -0.48481820871074166 -0.4861790251756275 … -0.409066182439127 -0.458374407914861])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4129139212663052 -0.4868367442771864 … -0.7027113226191004 -0.4868367442771865; -0.4868367442771861 -0.7744303950404472 … -0.4136373284393088 -0.38233074979448495; … ; -0.7027113226191009 -0.41363732843930906 … -2.3967616825880595 -1.2958067581749675; -0.486836744277186 -0.3823307497944849 … -1.2958067581749677 -0.774430395040447;;; -0.48683674427718626 -0.7744303950404474 … -0.41363732843930884 -0.38233074979448534; -0.774430395040447 -1.4814477483918769 … -0.3245845694332743 -0.449919396570689; … ; -0.41363732843930895 -0.32458456943327474 … -1.0113572986117039 -0.6373277791931853; -0.38233074979448484 -0.4499193965706889 … -0.6373277791931851 -0.44991939657068897;;; -0.7027113226191004 -1.295806758174968 … -0.29820348937556884 -0.41363732843930895; -1.2958067581749675 -2.9196723936538955 … -0.3537295846614499 -0.6373277791931848; … ; -0.29820348937556884 -0.35372958466145055 … -0.49037260810717864 -0.35372958466145044; -0.4136373284393087 -0.6373277791931848 … -0.35372958466144977 -0.3245845694332743;;; … ;;; -1.0166744212557755 -0.5332878143065953 … -3.636138257122869 -1.9987602620506255; -0.5332878143065951 -0.32174124747388577 … -1.466733940750262 -0.9061938941468847; … ; -3.636138257122869 -1.466733940750262 … -10.988177824465904 -8.08737616820818; -1.9987602620506253 -0.9061938941468848 … -8.08737616820818 -4.6478783711432365;;; -0.7027113226191006 -0.4136373284393087 … -2.39676168258806 -1.2958067581749677; -0.41363732843930867 -0.32458456943327463 … -1.011357298611704 -0.6373277791931848; … ; -2.39676168258806 -1.011357298611704 … -11.00280619087501 -6.077304186394078; -1.2958067581749675 -0.6373277791931847 … -6.077304186394078 -2.9196723936538955;;; -0.4868367442771863 -0.3823307497944852 … -1.2958067581749675 -0.7744303950404474; -0.38233074979448495 -0.4499193965706892 … -0.6373277791931851 -0.4499193965706889; … ; -1.2958067581749675 -0.6373277791931853 … -6.077304186394077 -2.9196723936538955; -0.774430395040447 -0.4499193965706888 … -2.9196723936538955 -1.4814477483918769]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3915556370334806 0.3785174208997725 … 0.34469960027021834 0.3785174208997725; 0.3785174208997726 0.36645844064793714 … 0.3273572817222713 0.36364954262056387; … ; 0.3446996002702183 0.32735728172227124 … 0.3075192694185393 0.33438053198658046; 0.3785174208997726 0.3636495426205638 … 0.33438053198658046 0.36645844064793714;;; 0.3785174208997725 0.36645844064793714 … 0.3273572817222713 0.36364954262056376; 0.36645844064793714 0.35102886341772893 … 0.31119401346060066 0.35191706634920994; … ; 0.32735728172227124 0.3111940134606006 … 0.2982412284122417 0.32142600281510236; 0.3636495426205638 0.35191706634920994 … 0.32142600281510236 0.3519170663492099;;; 0.34469960027021834 0.3343805319865805 … 0.2865351537639504 0.32735728172227135; 0.3343805319865805 0.3186160477629729 … 0.27805891882349704 0.3214260028151024; … ; 0.2865351537639504 0.278058918823497 … 0.25590185772312657 0.278058918823497; 0.3273572817222714 0.3214260028151024 … 0.278058918823497 0.31119401346060066;;; … ;;; 0.3048747492890471 0.28303666896238727 … 0.2855643323175385 0.3009573705184105; 0.28303666896238727 0.2589843162227452 … 0.27263300128656875 0.28541419662662704; … ; 0.2855643323175385 0.2726330012865688 … 0.2771603891376984 0.2812108737837918; 0.3009573705184106 0.285414196626627 … 0.2812108737837918 0.2930827262716919;;; 0.3446996002702183 0.32735728172227135 … 0.30751926941853935 0.33438053198658046; 0.32735728172227135 0.3111940134606006 … 0.29824122841224177 0.3214260028151024; … ; 0.30751926941853935 0.2982412284122417 … 0.2771603891376984 0.2931311914702247; 0.3343805319865805 0.3214260028151024 … 0.29313119147022465 0.3186160477629729;;; 0.3785174208997725 0.36364954262056376 … 0.3343805319865805 0.3664584406479371; 0.3636495426205638 0.35191706634920983 … 0.32142600281510236 0.35191706634920994; … ; 0.3343805319865805 0.3214260028151023 … 0.2931311914702247 0.31861604776297286; 0.36645844064793714 0.3519170663492099 … 0.31861604776297286 0.35102886341772893]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923122178 -0.49665655722570706 … -0.4771919009648934 -0.49665655722570706; -0.49665655722570706 -0.4848182087107416 … -0.4763804457667853 -0.4920413111694325; … ; -0.47719190096489345 -0.4763804457667853 … -0.41228807087391384 -0.4550700815561225; -0.49665655722570706 -0.4920413111694325 … -0.4550700815561226 -0.4848182087107416;;; -0.49665655722570706 -0.48481820871074177 … -0.47638044576678534 -0.4920413111694325; -0.48481820871074166 -0.458374407914861 … -0.4706560157057247 -0.4861790251756276; … ; -0.4763804457667853 -0.4706560157057247 … -0.4463984364362162 -0.46889439639152697; -0.4920413111694325 -0.4861790251756275 … -0.46889439639152697 -0.4861790251756276;;; -0.4771919009648934 -0.4550700815561226 … -0.460514123422674 -0.4763804457667853; -0.4550700815561225 -0.409066182439127 … -0.45671990832114384 -0.46889439639152686; … ; -0.460514123422674 -0.45671990832114384 … -0.4451449566034937 -0.45671990832114384; -0.47638044576678534 -0.46889439639152686 … -0.45671990832114384 -0.4706560157057247;;; … ;;; -0.44947595084091346 -0.4551499722014942 … -0.37125986261790506 -0.41774571520276216; -0.45514997220149417 -0.44880351099771876 … -0.4174380107134192 -0.44412609929878066; … ; -0.37125986261790506 -0.4174380107134192 … -0.2536569832840758 -0.2997980910596023; -0.41774571520276216 -0.44412609929878066 … -0.2997980910596023 -0.36106343264802404;;; -0.47719190096489345 -0.4763804457667853 … -0.4122880708739139 -0.4550700815561226; -0.47638044576678534 -0.4706560157057247 … -0.44639843643621624 -0.46889439639152686; … ; -0.41228807087391395 -0.44639843643621624 … -0.25365698328407593 -0.3410633023008403; -0.4550700815561225 -0.46889439639152686 … -0.34106330230084025 -0.409066182439127;;; -0.49665655722570706 -0.4920413111694325 … -0.4550700815561225 -0.48481820871074177; -0.4920413111694325 -0.4861790251756276 … -0.46889439639152697 -0.4861790251756275; … ; -0.4550700815561225 -0.46889439639152697 … -0.3410633023008403 -0.409066182439127; -0.48481820871074166 -0.4861790251756275 … -0.409066182439127 -0.458374407914861])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4129139212663052 -0.4868367442771864 … -0.7027113226191004 -0.4868367442771865; -0.4868367442771861 -0.7744303950404472 … -0.4136373284393088 -0.38233074979448495; … ; -0.7027113226191009 -0.41363732843930906 … -2.3967616825880595 -1.2958067581749675; -0.486836744277186 -0.3823307497944849 … -1.2958067581749677 -0.774430395040447;;; -0.48683674427718626 -0.7744303950404474 … -0.41363732843930884 -0.38233074979448534; -0.774430395040447 -1.4814477483918769 … -0.3245845694332743 -0.449919396570689; … ; -0.41363732843930895 -0.32458456943327474 … -1.0113572986117039 -0.6373277791931853; -0.38233074979448484 -0.4499193965706889 … -0.6373277791931851 -0.44991939657068897;;; -0.7027113226191004 -1.295806758174968 … -0.29820348937556884 -0.41363732843930895; -1.2958067581749675 -2.9196723936538955 … -0.3537295846614499 -0.6373277791931848; … ; -0.29820348937556884 -0.35372958466145055 … -0.49037260810717864 -0.35372958466145044; -0.4136373284393087 -0.6373277791931848 … -0.35372958466144977 -0.3245845694332743;;; … ;;; -1.0166744212557755 -0.5332878143065953 … -3.636138257122869 -1.9987602620506255; -0.5332878143065951 -0.32174124747388577 … -1.466733940750262 -0.9061938941468847; … ; -3.636138257122869 -1.466733940750262 … -10.988177824465904 -8.08737616820818; -1.9987602620506253 -0.9061938941468848 … -8.08737616820818 -4.6478783711432365;;; -0.7027113226191006 -0.4136373284393087 … -2.39676168258806 -1.2958067581749677; -0.41363732843930867 -0.32458456943327463 … -1.011357298611704 -0.6373277791931848; … ; -2.39676168258806 -1.011357298611704 … -11.00280619087501 -6.077304186394078; -1.2958067581749675 -0.6373277791931847 … -6.077304186394078 -2.9196723936538955;;; -0.4868367442771863 -0.3823307497944852 … -1.2958067581749675 -0.7744303950404474; -0.38233074979448495 -0.4499193965706892 … -0.6373277791931851 -0.4499193965706889; … ; -1.2958067581749675 -0.6373277791931853 … -6.077304186394077 -2.9196723936538955; -0.774430395040447 -0.4499193965706888 … -2.9196723936538955 -1.4814477483918769]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3915556370334806 0.3785174208997725 … 0.34469960027021834 0.3785174208997725; 0.3785174208997726 0.36645844064793714 … 0.3273572817222713 0.36364954262056387; … ; 0.3446996002702183 0.32735728172227124 … 0.3075192694185393 0.33438053198658046; 0.3785174208997726 0.3636495426205638 … 0.33438053198658046 0.36645844064793714;;; 0.3785174208997725 0.36645844064793714 … 0.3273572817222713 0.36364954262056376; 0.36645844064793714 0.35102886341772893 … 0.31119401346060066 0.35191706634920994; … ; 0.32735728172227124 0.3111940134606006 … 0.2982412284122417 0.32142600281510236; 0.3636495426205638 0.35191706634920994 … 0.32142600281510236 0.3519170663492099;;; 0.34469960027021834 0.3343805319865805 … 0.2865351537639504 0.32735728172227135; 0.3343805319865805 0.3186160477629729 … 0.27805891882349704 0.3214260028151024; … ; 0.2865351537639504 0.278058918823497 … 0.25590185772312657 0.278058918823497; 0.3273572817222714 0.3214260028151024 … 0.278058918823497 0.31119401346060066;;; … ;;; 0.3048747492890471 0.28303666896238727 … 0.2855643323175385 0.3009573705184105; 0.28303666896238727 0.2589843162227452 … 0.27263300128656875 0.28541419662662704; … ; 0.2855643323175385 0.2726330012865688 … 0.2771603891376984 0.2812108737837918; 0.3009573705184106 0.285414196626627 … 0.2812108737837918 0.2930827262716919;;; 0.3446996002702183 0.32735728172227135 … 0.30751926941853935 0.33438053198658046; 0.32735728172227135 0.3111940134606006 … 0.29824122841224177 0.3214260028151024; … ; 0.30751926941853935 0.2982412284122417 … 0.2771603891376984 0.2931311914702247; 0.3343805319865805 0.3214260028151024 … 0.29313119147022465 0.3186160477629729;;; 0.3785174208997725 0.36364954262056376 … 0.3343805319865805 0.3664584406479371; 0.3636495426205638 0.35191706634920983 … 0.32142600281510236 0.35191706634920994; … ; 0.3343805319865805 0.3214260028151023 … 0.2931311914702247 0.31861604776297286; 0.36645844064793714 0.3519170663492099 … 0.31861604776297286 0.35102886341772893]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923122178 -0.49665655722570706 … -0.4771919009648934 -0.49665655722570706; -0.49665655722570706 -0.4848182087107416 … -0.4763804457667853 -0.4920413111694325; … ; -0.47719190096489345 -0.4763804457667853 … -0.41228807087391384 -0.4550700815561225; -0.49665655722570706 -0.4920413111694325 … -0.4550700815561226 -0.4848182087107416;;; -0.49665655722570706 -0.48481820871074177 … -0.47638044576678534 -0.4920413111694325; -0.48481820871074166 -0.458374407914861 … -0.4706560157057247 -0.4861790251756276; … ; -0.4763804457667853 -0.4706560157057247 … -0.4463984364362162 -0.46889439639152697; -0.4920413111694325 -0.4861790251756275 … -0.46889439639152697 -0.4861790251756276;;; -0.4771919009648934 -0.4550700815561226 … -0.460514123422674 -0.4763804457667853; -0.4550700815561225 -0.409066182439127 … -0.45671990832114384 -0.46889439639152686; … ; -0.460514123422674 -0.45671990832114384 … -0.4451449566034937 -0.45671990832114384; -0.47638044576678534 -0.46889439639152686 … -0.45671990832114384 -0.4706560157057247;;; … ;;; -0.44947595084091346 -0.4551499722014942 … -0.37125986261790506 -0.41774571520276216; -0.45514997220149417 -0.44880351099771876 … -0.4174380107134192 -0.44412609929878066; … ; -0.37125986261790506 -0.4174380107134192 … -0.2536569832840758 -0.2997980910596023; -0.41774571520276216 -0.44412609929878066 … -0.2997980910596023 -0.36106343264802404;;; -0.47719190096489345 -0.4763804457667853 … -0.4122880708739139 -0.4550700815561226; -0.47638044576678534 -0.4706560157057247 … -0.44639843643621624 -0.46889439639152686; … ; -0.41228807087391395 -0.44639843643621624 … -0.25365698328407593 -0.3410633023008403; -0.4550700815561225 -0.46889439639152686 … -0.34106330230084025 -0.409066182439127;;; -0.49665655722570706 -0.4920413111694325 … -0.4550700815561225 -0.48481820871074177; -0.4920413111694325 -0.4861790251756276 … -0.46889439639152697 -0.4861790251756275; … ; -0.4550700815561225 -0.46889439639152697 … -0.3410633023008403 -0.409066182439127; -0.48481820871074166 -0.4861790251756275 … -0.409066182439127 -0.458374407914861])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4129139212663052 -0.4868367442771864 … -0.7027113226191004 -0.4868367442771865; -0.4868367442771861 -0.7744303950404472 … -0.4136373284393088 -0.38233074979448495; … ; -0.7027113226191009 -0.41363732843930906 … -2.3967616825880595 -1.2958067581749675; -0.486836744277186 -0.3823307497944849 … -1.2958067581749677 -0.774430395040447;;; -0.48683674427718626 -0.7744303950404474 … -0.41363732843930884 -0.38233074979448534; -0.774430395040447 -1.4814477483918769 … -0.3245845694332743 -0.449919396570689; … ; -0.41363732843930895 -0.32458456943327474 … -1.0113572986117039 -0.6373277791931853; -0.38233074979448484 -0.4499193965706889 … -0.6373277791931851 -0.44991939657068897;;; -0.7027113226191004 -1.295806758174968 … -0.29820348937556884 -0.41363732843930895; -1.2958067581749675 -2.9196723936538955 … -0.3537295846614499 -0.6373277791931848; … ; -0.29820348937556884 -0.35372958466145055 … -0.49037260810717864 -0.35372958466145044; -0.4136373284393087 -0.6373277791931848 … -0.35372958466144977 -0.3245845694332743;;; … ;;; -1.0166744212557755 -0.5332878143065953 … -3.636138257122869 -1.9987602620506255; -0.5332878143065951 -0.32174124747388577 … -1.466733940750262 -0.9061938941468847; … ; -3.636138257122869 -1.466733940750262 … -10.988177824465904 -8.08737616820818; -1.9987602620506253 -0.9061938941468848 … -8.08737616820818 -4.6478783711432365;;; -0.7027113226191006 -0.4136373284393087 … -2.39676168258806 -1.2958067581749677; -0.41363732843930867 -0.32458456943327463 … -1.011357298611704 -0.6373277791931848; … ; -2.39676168258806 -1.011357298611704 … -11.00280619087501 -6.077304186394078; -1.2958067581749675 -0.6373277791931847 … -6.077304186394078 -2.9196723936538955;;; -0.4868367442771863 -0.3823307497944852 … -1.2958067581749675 -0.7744303950404474; -0.38233074979448495 -0.4499193965706892 … -0.6373277791931851 -0.4499193965706889; … ; -1.2958067581749675 -0.6373277791931853 … -6.077304186394077 -2.9196723936538955; -0.774430395040447 -0.4499193965706888 … -2.9196723936538955 -1.4814477483918769]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729846), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09132316917747592 0.08747419134080534 … 0.076847549359633 0.08747419134080534; 0.08747419134080532 0.08089966872164125 … 0.07642471016971783 0.08486944834426917; … ; 0.07684754935963302 0.07642471016971783 … 0.04778466667101878 0.06587895342303424; 0.08747419134080532 0.08486944834426917 … 0.06587895342303422 0.08089966872164125;;; 0.08747419134080534 0.08089966872164128 … 0.07642471016971782 0.08486944834426918; 0.08089966872164127 0.06744471469774742 … 0.07348669934704584 0.08163768629014938; … ; 0.07642471016971783 0.07348669934704584 … 0.061888041199966076 0.07259829028447101; 0.08486944834426917 0.08163768629014936 … 0.07259829028447101 0.08163768629014938;;; 0.076847549359633 0.06587895342303425 … 0.06847203698973968 0.07642471016971783; 0.06587895342303424 0.04657864264980827 … 0.06665759371632136 0.072598290284471; … ; 0.06847203698973968 0.06665759371632136 … 0.06132515314381116 0.06665759371632136; 0.07642471016971782 0.072598290284471 … 0.06665759371632136 0.07348669934704583;;; … ;;; 0.06328495229885989 0.06591651445952847 … 0.03394064888051722 0.0498759348599892; 0.06591651445952844 0.0629779096010575 … 0.04975639788527634 0.06087020457146392; … ; 0.033940648880517225 0.04975639788527634 … 0.009696353214072907 0.016831338792590335; 0.04987593485998918 0.06087020457146392 … 0.016831338792590328 0.030985721885048917;;; 0.07684754935963302 0.07642471016971783 … 0.047784666671018786 0.06587895342303425; 0.07642471016971782 0.07348669934704584 … 0.06188804119996609 0.072598290284471; … ; 0.04778466667101879 0.06188804119996609 … 0.00969635321407292 0.025710010675304068; 0.06587895342303424 0.072598290284471 … 0.025710010675304065 0.04657864264980827;;; 0.08747419134080534 0.08486944834426918 … 0.06587895342303424 0.08089966872164128; 0.08486944834426915 0.08163768629014938 … 0.07259829028447103 0.08163768629014936; … ; 0.06587895342303424 0.07259829028447103 … 0.02571001067530407 0.04657864264980827; 0.08089966872164127 0.08163768629014936 … 0.04657864264980827 0.06744471469774742;;;;], α = 0.8, eigenvalues = [[-0.1667770759631048, 0.26427771782988047, 0.2642777178298813, 0.2642777178298815, 0.35732037190448834, 0.35732037190448845, 0.35732037190448873], [-0.11613218761086537, 0.0704053232000099, 0.22624813603019123, 0.22624813603019125, 0.3361178489459985, 0.3934379776179738, 0.3934379776179735], [-0.09588938143643412, 0.0876431996795505, 0.17312704142738924, 0.1731270414273893, 0.2919724892212835, 0.33773212507287814, 0.5327646516179523], [-0.04505146348597673, 0.022269526239780506, 0.09831189251531314, 0.18446409322113744, 0.3229270151624524, 0.48024696048029086, 0.5024422335903523]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.28971208183818126, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.8882918070108363 - 0.3520288783438021im 1.6032812882946577e-15 + 4.508097547897313e-16im … 3.347870011631315e-12 + 1.4371118543256786e-11im -5.593349781843952e-13 - 2.4077641954669123e-12im; -0.08951689594811987 - 0.03547542848501183im -0.3285894091583175 + 0.06645025627885635im … -0.20364040413692586 - 0.10546240555976759im 0.04301152280414358 + 0.5071978358188901im; … ; -0.010964634589397917 - 0.004345270310374449im 0.047058869245778734 + 0.009277242680693973im … -0.001867358759956193 + 0.0031717194107730375im -0.012733947940810179 + 0.09650474522975992im; 0.08951689594812111 + 0.03547542848501325im 0.13212735316206403 + 0.15727651877969412im … 0.18825465968774202 + 0.13159517947330246im -0.1479304453348001 + 0.28793450927011144im], [0.4285778526611642 + 0.8239395444536014im 0.1808957980134592 + 0.0783254732312582im … -4.395609891267789e-14 + 7.259687788109943e-14im 4.0184519714859756e-14 - 4.108555701575836e-13im; 0.02921697820475648 + 0.05616954670630231im -0.008051162033508984 - 0.0034860460179893383im … -6.805636952157511e-13 - 5.833806136888398e-13im 1.6270400555358708e-12 - 8.507239756640937e-13im; … ; 0.003576686433394596 + 0.006876168174080086im 0.07915710029848759 + 0.03427397102961976im … -0.0518073189224531 - 0.09392428783404544im -0.023593864369042414 - 0.0037111529753089414im; -0.052113896235456494 - 0.10018879803826786im -0.08323975280800124 - 0.0360417052354886im … -0.21989922158278163 - 0.39866718085429254im -0.10014554925632685 - 0.015752207747891853im], [-0.2281957314518094 - 0.9054377180949474im 7.743746765503406e-16 + 1.613616443785078e-16im … -2.0437955999509973e-13 - 1.8473462054377852e-12im 7.243508228473587e-9 - 1.1261916486335234e-8im; -0.01680119732654525 - 0.06666398916327937im -0.045910890336477855 - 0.03410163044182908im … 0.004579683215729913 - 0.02476189277939507im 0.0026109190987588203 + 0.004545951236120635im; … ; -0.0033897042199945468 - 0.013449708434256172im -1.6916238585231318e-15 + 3.2142943309374867e-17im … 1.643744731952732e-12 + 1.3319925444733076e-13im 0.06118344835485075 - 0.02295631256749513im; 0.037442091080902504 + 0.1485631711571025im -0.23049826757611275 - 0.1712091985312145im … -0.0694440839064145 + 0.3754772713662852im 0.14271434897421043 - 0.05540110431596161im], [-0.7935959154389673 + 0.15718460885902283im 3.121475014499017e-17 - 5.248406092253054e-16im … 0.16789449573655568 + 0.08331510996199946im 2.3228041763492325e-6 + 3.875770441664274e-6im; -0.3800899895370397 + 0.07528301894492856im 0.3335850914733428 + 0.5304072334941233im … -0.15964142483762536 - 0.07921931779159744im -1.5699079500876588e-6 - 2.4089628319458026e-6im; … ; -0.011176565532550474 + 0.0022137010126236363im 0.000875049302428478 + 0.001391346590526051im … 0.014489007999098245 + 0.007189827956985625im 0.04036120696766882 - 0.018231382465396913im; 0.06393766038285137 - 0.012663895999364414im 0.006646887376440142 + 0.010568689173467451im … 0.12123293287889965 + 0.06015990337458713im 0.42892553391067484 - 0.19373614283376758im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.1667770759631048, 0.26427771782988047, 0.2642777178298813, 0.2642777178298815, 0.35732037190448834, 0.35732037190448845, 0.35732037190448873], [-0.11613218761086537, 0.0704053232000099, 0.22624813603019123, 0.22624813603019125, 0.3361178489459985, 0.3934379776179738, 0.3934379776179735], [-0.09588938143643412, 0.0876431996795505, 0.17312704142738924, 0.1731270414273893, 0.2919724892212835, 0.33773212507287814, 0.5327646516179523], [-0.04505146348597673, 0.022269526239780506, 0.09831189251531314, 0.18446409322113744, 0.3229270151624524, 0.48024696048029086, 0.5024422335903523]], X = [[-0.8882918070108363 - 0.3520288783438021im 1.6032812882946577e-15 + 4.508097547897313e-16im … 3.347870011631315e-12 + 1.4371118543256786e-11im -5.593349781843952e-13 - 2.4077641954669123e-12im; -0.08951689594811987 - 0.03547542848501183im -0.3285894091583175 + 0.06645025627885635im … -0.20364040413692586 - 0.10546240555976759im 0.04301152280414358 + 0.5071978358188901im; … ; -0.010964634589397917 - 0.004345270310374449im 0.047058869245778734 + 0.009277242680693973im … -0.001867358759956193 + 0.0031717194107730375im -0.012733947940810179 + 0.09650474522975992im; 0.08951689594812111 + 0.03547542848501325im 0.13212735316206403 + 0.15727651877969412im … 0.18825465968774202 + 0.13159517947330246im -0.1479304453348001 + 0.28793450927011144im], [0.4285778526611642 + 0.8239395444536014im 0.1808957980134592 + 0.0783254732312582im … -4.395609891267789e-14 + 7.259687788109943e-14im 4.0184519714859756e-14 - 4.108555701575836e-13im; 0.02921697820475648 + 0.05616954670630231im -0.008051162033508984 - 0.0034860460179893383im … -6.805636952157511e-13 - 5.833806136888398e-13im 1.6270400555358708e-12 - 8.507239756640937e-13im; … ; 0.003576686433394596 + 0.006876168174080086im 0.07915710029848759 + 0.03427397102961976im … -0.0518073189224531 - 0.09392428783404544im -0.023593864369042414 - 0.0037111529753089414im; -0.052113896235456494 - 0.10018879803826786im -0.08323975280800124 - 0.0360417052354886im … -0.21989922158278163 - 0.39866718085429254im -0.10014554925632685 - 0.015752207747891853im], [-0.2281957314518094 - 0.9054377180949474im 7.743746765503406e-16 + 1.613616443785078e-16im … -2.0437955999509973e-13 - 1.8473462054377852e-12im 7.243508228473587e-9 - 1.1261916486335234e-8im; -0.01680119732654525 - 0.06666398916327937im -0.045910890336477855 - 0.03410163044182908im … 0.004579683215729913 - 0.02476189277939507im 0.0026109190987588203 + 0.004545951236120635im; … ; -0.0033897042199945468 - 0.013449708434256172im -1.6916238585231318e-15 + 3.2142943309374867e-17im … 1.643744731952732e-12 + 1.3319925444733076e-13im 0.06118344835485075 - 0.02295631256749513im; 0.037442091080902504 + 0.1485631711571025im -0.23049826757611275 - 0.1712091985312145im … -0.0694440839064145 + 0.3754772713662852im 0.14271434897421043 - 0.05540110431596161im], [-0.7935959154389673 + 0.15718460885902283im 3.121475014499017e-17 - 5.248406092253054e-16im … 0.16789449573655568 + 0.08331510996199946im 2.3228041763492325e-6 + 3.875770441664274e-6im; -0.3800899895370397 + 0.07528301894492856im 0.3335850914733428 + 0.5304072334941233im … -0.15964142483762536 - 0.07921931779159744im -1.5699079500876588e-6 - 2.4089628319458026e-6im; … ; -0.011176565532550474 + 0.0022137010126236363im 0.000875049302428478 + 0.001391346590526051im … 0.014489007999098245 + 0.007189827956985625im 0.04036120696766882 - 0.018231382465396913im; 0.06393766038285137 - 0.012663895999364414im 0.006646887376440142 + 0.010568689173467451im … 0.12123293287889965 + 0.06015990337458713im 0.42892553391067484 - 0.19373614283376758im]], residual_norms = [[4.614840711861544e-14, 1.2000957015564236e-14, 1.2430375355412257e-14, 4.790439973715961e-15, 5.793173800166225e-11, 6.209546392488554e-11, 1.0400631741127277e-11], [2.20439662187603e-14, 4.428530784596353e-14, 2.069342874863038e-14, 2.1432032778767118e-14, 9.16937131782362e-14, 5.804897521454513e-12, 6.2924271440275375e-12], [2.877612100445855e-14, 2.1989193304609162e-14, 4.3470698577499217e-14, 3.662320647646911e-14, 3.1739689136948286e-13, 5.149377679335105e-11, 1.9997773397447255e-7], [1.1228011565049853e-14, 2.4105381996481434e-14, 3.279317503909023e-14, 4.2814906028893965e-14, 2.9267782610365353e-12, 2.0908645881077968e-5, 1.19365471469322e-5]], iterations = [4, 3, 2, 2], converged = 1, n_matvec = 101)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 1.234043938403142e-13)</code></pre><h2 id="Potential-based-SCF"><a class="docs-heading-anchor" href="#Potential-based-SCF">Potential-based SCF</a><a id="Potential-based-SCF-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-based-SCF" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scfv = DFTK.scf_potential_mixing(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4129139212663025 -0.48683674427718304 … -0.7027113226190955 -0.4868367442771831; -0.48683674427718276 -0.774430395040442 … -0.4136373284393058 -0.3823307497944822; … ; -0.7027113226190957 -0.413637328439306 … -2.396761682588052 -1.2958067581749606; -0.48683674427718265 -0.3823307497944822 … -1.2958067581749608 -0.7744303950404418;;; -0.4868367442771829 -0.7744303950404421 … -0.4136373284393058 -0.38233074979448256; -0.7744303950404418 -1.4814477483918695 … -0.32458456943327196 -0.44991939657068575; … ; -0.4136373284393059 -0.32458456943327235 … -1.0113572986116983 -0.6373277791931806; -0.38233074979448217 -0.44991939657068586 … -0.6373277791931806 -0.4499193965706857;;; -0.7027113226190955 -1.295806758174961 … -0.2982034893755665 -0.413637328439306; -1.2958067581749608 -2.919672393653887 … -0.3537295846614472 -0.6373277791931804; … ; -0.2982034893755665 -0.35372958466144777 … -0.4903726081071751 -0.35372958466144766; -0.4136373284393058 -0.6373277791931806 … -0.353729584661447 -0.32458456943327185;;; … ;;; -1.0166744212557695 -0.5332878143065914 … -3.6361382571228615 -1.998760262050618; -0.5332878143065911 -0.3217412474738834 … -1.466733940750256 -0.9061938941468792; … ; -3.6361382571228615 -1.466733940750256 … -10.988177824465897 -8.087376168208174; -1.9987602620506177 -0.9061938941468793 … -8.087376168208174 -4.6478783711432285;;; -0.7027113226190955 -0.4136373284393058 … -2.3967616825880524 -1.2958067581749608; -0.4136373284393056 -0.3245845694332722 … -1.0113572986116983 -0.6373277791931804; … ; -2.3967616825880524 -1.0113572986116985 … -11.002806190875003 -6.077304186394069; -1.2958067581749604 -0.6373277791931804 … -6.077304186394069 -2.919672393653887;;; -0.486836744277183 -0.38233074979448245 … -1.2958067581749608 -0.7744303950404421; -0.3823307497944822 -0.44991939657068586 … -0.6373277791931805 -0.44991939657068575; … ; -1.2958067581749608 -0.6373277791931806 … -6.077304186394068 -2.9196723936538866; -0.7744303950404416 -0.4499193965706857 … -2.9196723936538866 -1.4814477483918695])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4129139212663025 -0.48683674427718304 … -0.7027113226190955 -0.4868367442771831; -0.48683674427718276 -0.774430395040442 … -0.4136373284393058 -0.3823307497944822; … ; -0.7027113226190957 -0.413637328439306 … -2.396761682588052 -1.2958067581749606; -0.48683674427718265 -0.3823307497944822 … -1.2958067581749608 -0.7744303950404418;;; -0.4868367442771829 -0.7744303950404421 … -0.4136373284393058 -0.38233074979448256; -0.7744303950404418 -1.4814477483918695 … -0.32458456943327196 -0.44991939657068575; … ; -0.4136373284393059 -0.32458456943327235 … -1.0113572986116983 -0.6373277791931806; -0.38233074979448217 -0.44991939657068586 … -0.6373277791931806 -0.4499193965706857;;; -0.7027113226190955 -1.295806758174961 … -0.2982034893755665 -0.413637328439306; -1.2958067581749608 -2.919672393653887 … -0.3537295846614472 -0.6373277791931804; … ; -0.2982034893755665 -0.35372958466144777 … -0.4903726081071751 -0.35372958466144766; -0.4136373284393058 -0.6373277791931806 … -0.353729584661447 -0.32458456943327185;;; … ;;; -1.0166744212557695 -0.5332878143065914 … -3.6361382571228615 -1.998760262050618; -0.5332878143065911 -0.3217412474738834 … -1.466733940750256 -0.9061938941468792; … ; -3.6361382571228615 -1.466733940750256 … -10.988177824465897 -8.087376168208174; -1.9987602620506177 -0.9061938941468793 … -8.087376168208174 -4.6478783711432285;;; -0.7027113226190955 -0.4136373284393058 … -2.3967616825880524 -1.2958067581749608; -0.4136373284393056 -0.3245845694332722 … -1.0113572986116983 -0.6373277791931804; … ; -2.3967616825880524 -1.0113572986116985 … -11.002806190875003 -6.077304186394069; -1.2958067581749604 -0.6373277791931804 … -6.077304186394069 -2.919672393653887;;; -0.486836744277183 -0.38233074979448245 … -1.2958067581749608 -0.7744303950404421; -0.3823307497944822 -0.44991939657068586 … -0.6373277791931805 -0.44991939657068575; … ; -1.2958067581749608 -0.6373277791931806 … -6.077304186394068 -2.9196723936538866; -0.7744303950404416 -0.4499193965706857 … -2.9196723936538866 -1.4814477483918695]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0741155040439548 - 0.02694842590072513im 0.012910138359199724 + 0.055952936784918im … -0.01557262213086841 - 0.05905104196520044im 0.026511286883124985 - 0.06416759155990942im; 0.04536194646987176 + 0.07194725363483188im 0.01488973301016865 + 0.0892768876375266im … 0.0394110220913263 - 0.017360202440682794im 0.0620267884014907 - 0.003695042956427171im; … ; 0.022667281211666956 - 0.05895790009675704im -0.03975742857059536 - 0.026485446331023815im … 0.02775771826480663 + 0.00808524506934323im 0.021246909474500492 - 0.01426776812766964im; 0.0006580787745202924 - 0.05210350907318938im -0.039097705549078474 - 0.007482540064549304im … -0.0029010250359757786 - 0.01776617761362263im -0.0004384780325629961 - 0.054285726234403295im;;; 0.023965891264209664 + 0.05127803238489098im 0.0002684570638665754 + 0.07678690209187757im … 0.019907988330273185 - 0.014238489318329182im 0.009489581737870602 + 0.015544167642951684im; 0.008356731523952332 + 0.06773159216323656im 0.007726131190461592 + 0.03271348431365114im … 0.01944004051987573 + 0.02386417943070407im 0.027465319259429216 + 0.07041686518006839im; … ; -0.021123553311722516 - 0.05930831188181788im -0.04347388423168306 - 0.017080155072060038im … 0.03370342257480195 - 0.006231053798496164im 0.017674068389703854 - 0.03553602630706905im; -0.03354483180660743 - 0.021426987191346787im -0.0222774144140458 + 0.042096736491611025im … 0.01748692278322498 - 0.030863600913526155im 0.0017200328327533418 - 0.029937177922003833im;;; -0.018039650483830535 + 0.006385189106915125im 0.010374010292219257 + 0.034000278944497246im … -0.016062678995399537 + 5.600925006445448e-5im -0.035136439132662386 + 0.004323034467142203im; 0.013121023574145296 + 0.01313718852891824im 0.004372730319025574 - 0.016751584619145728im … -0.002360469167142837 + 0.022383294389339108im -0.007123646388668166 + 0.03428570912521986im; … ; -0.039371181897801165 - 0.025429218168837246im -0.02223115008982445 + 0.007641360692247533im … 0.009488690752799669 - 0.008900305873771516im -0.018384886019931504 - 0.01989772604551641im; -0.028317715815790984 + 0.0019884759332134717im -0.02078319154892936 + 0.05779872355725694im … -0.00222511258252704 - 0.008748664377733846im -0.03833948855750884 - 0.01364055663501746im;;; … ;;; -0.04723029443669288 - 0.031942914441543305im -0.00798715860132962 - 0.039223924014659545im … -0.016577994852712656 + 0.08674238969448078im -0.04578573933954396 + 0.032430079903826445im; -0.012080798735331128 - 0.07254021863789367im 0.009255142017379975 - 0.03224642130727097im … -0.022480865067905947 + 0.01254262673906285im -0.02647365592154781 - 0.057389969047889816im; … ; -0.01534990244608895 + 0.0011071119900978896im -0.00741069505519714 + 0.008882846765096632im … 0.05486693262830139 + 0.01553255607183077im 0.020502982326166083 + 0.010039816769304797im; -0.04340173148063568 + 0.02519918305560733im -0.01651872243280523 + 0.009465313009758416im … 0.03688956646650818 + 0.05080166130847501im -0.018019652988354368 + 0.06188150325166697im;;; -0.027156395507128873 - 0.10128391161092447im 0.009730133595272058 - 0.044319309100101005im … -0.058658537592754356 + 0.04050487412254572im -0.06717178427024911 - 0.05427148112895202im; 0.020553398603532266 - 0.10649276827631485im 0.029337568079458955 + 0.009914719590605175im … -0.023883195544959136 - 0.035888041951071176im -0.014041617736410411 - 0.10722875968442801im; … ; -0.009924757546350717 - 0.0002819405481296591im -0.0014762051474535472 + 0.02413817138637799im … 0.03357815748656487 + 0.019757888443152717im -0.029130690886395125 + 0.010827204276458306im; -0.05038337192373282 - 0.011774387726670265im -0.005789984878393023 - 0.011069852583941987im … -0.033846582604633 + 0.07442030357263649im -0.07870227635600471 + 0.03933953570252956im;;; 0.0331735442382664 - 0.07949532448083232im 0.02884168358050082 + 0.011509098328876095im … -0.059817698638128435 - 0.010511586092415608im -0.03722110321995521 - 0.07265909571299937im; 0.05454019790053259 - 0.018578675486996876im 0.04119592811398293 + 0.09350098651250856im … -0.014765570194039571 - 0.038988084607009865im 0.03999711477108099 - 0.09289881674417487im; … ; 0.02625168529270122 - 0.0029889301612469653im 0.0045845743937602025 + 0.0146440650498629im … 0.019909272011110087 + 0.04259864502551627im 0.00840311982251056 + 0.016966333274683755im; 0.0006595316258289664 - 0.04458970197911258im 0.0015079574314199723 - 0.0046215983749472635im … -0.06200819118391546 + 0.030589234027688823im -0.01918797462572048 - 0.029093428399507945im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4129139212663025 -0.48683674427718304 … -0.7027113226190955 -0.4868367442771831; -0.48683674427718276 -0.774430395040442 … -0.4136373284393058 -0.3823307497944822; … ; -0.7027113226190957 -0.413637328439306 … -2.396761682588052 -1.2958067581749606; -0.48683674427718265 -0.3823307497944822 … -1.2958067581749608 -0.7744303950404418;;; -0.4868367442771829 -0.7744303950404421 … -0.4136373284393058 -0.38233074979448256; -0.7744303950404418 -1.4814477483918695 … -0.32458456943327196 -0.44991939657068575; … ; -0.4136373284393059 -0.32458456943327235 … -1.0113572986116983 -0.6373277791931806; -0.38233074979448217 -0.44991939657068586 … -0.6373277791931806 -0.4499193965706857;;; -0.7027113226190955 -1.295806758174961 … -0.2982034893755665 -0.413637328439306; -1.2958067581749608 -2.919672393653887 … -0.3537295846614472 -0.6373277791931804; … ; -0.2982034893755665 -0.35372958466144777 … -0.4903726081071751 -0.35372958466144766; -0.4136373284393058 -0.6373277791931806 … -0.353729584661447 -0.32458456943327185;;; … ;;; -1.0166744212557695 -0.5332878143065914 … -3.6361382571228615 -1.998760262050618; -0.5332878143065911 -0.3217412474738834 … -1.466733940750256 -0.9061938941468792; … ; -3.6361382571228615 -1.466733940750256 … -10.988177824465897 -8.087376168208174; -1.9987602620506177 -0.9061938941468793 … -8.087376168208174 -4.6478783711432285;;; -0.7027113226190955 -0.4136373284393058 … -2.3967616825880524 -1.2958067581749608; -0.4136373284393056 -0.3245845694332722 … -1.0113572986116983 -0.6373277791931804; … ; -2.3967616825880524 -1.0113572986116985 … -11.002806190875003 -6.077304186394069; -1.2958067581749604 -0.6373277791931804 … -6.077304186394069 -2.919672393653887;;; -0.486836744277183 -0.38233074979448245 … -1.2958067581749608 -0.7744303950404421; -0.3823307497944822 -0.44991939657068586 … -0.6373277791931805 -0.44991939657068575; … ; -1.2958067581749608 -0.6373277791931806 … -6.077304186394068 -2.9196723936538866; -0.7744303950404416 -0.4499193965706857 … -2.9196723936538866 -1.4814477483918695])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4129139212663025 -0.48683674427718304 … -0.7027113226190955 -0.4868367442771831; -0.48683674427718276 -0.774430395040442 … -0.4136373284393058 -0.3823307497944822; … ; -0.7027113226190957 -0.413637328439306 … -2.396761682588052 -1.2958067581749606; -0.48683674427718265 -0.3823307497944822 … -1.2958067581749608 -0.7744303950404418;;; -0.4868367442771829 -0.7744303950404421 … -0.4136373284393058 -0.38233074979448256; -0.7744303950404418 -1.4814477483918695 … -0.32458456943327196 -0.44991939657068575; … ; -0.4136373284393059 -0.32458456943327235 … -1.0113572986116983 -0.6373277791931806; -0.38233074979448217 -0.44991939657068586 … -0.6373277791931806 -0.4499193965706857;;; -0.7027113226190955 -1.295806758174961 … -0.2982034893755665 -0.413637328439306; -1.2958067581749608 -2.919672393653887 … -0.3537295846614472 -0.6373277791931804; … ; -0.2982034893755665 -0.35372958466144777 … -0.4903726081071751 -0.35372958466144766; -0.4136373284393058 -0.6373277791931806 … -0.353729584661447 -0.32458456943327185;;; … ;;; -1.0166744212557695 -0.5332878143065914 … -3.6361382571228615 -1.998760262050618; -0.5332878143065911 -0.3217412474738834 … -1.466733940750256 -0.9061938941468792; … ; -3.6361382571228615 -1.466733940750256 … -10.988177824465897 -8.087376168208174; -1.9987602620506177 -0.9061938941468793 … -8.087376168208174 -4.6478783711432285;;; -0.7027113226190955 -0.4136373284393058 … -2.3967616825880524 -1.2958067581749608; -0.4136373284393056 -0.3245845694332722 … -1.0113572986116983 -0.6373277791931804; … ; -2.3967616825880524 -1.0113572986116985 … -11.002806190875003 -6.077304186394069; -1.2958067581749604 -0.6373277791931804 … -6.077304186394069 -2.919672393653887;;; -0.486836744277183 -0.38233074979448245 … -1.2958067581749608 -0.7744303950404421; -0.3823307497944822 -0.44991939657068586 … -0.6373277791931805 -0.44991939657068575; … ; -1.2958067581749608 -0.6373277791931806 … -6.077304186394068 -2.9196723936538866; -0.7744303950404416 -0.4499193965706857 … -2.9196723936538866 -1.4814477483918695]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.04355769909032013 + 0.045435668946026145im 0.07319745299494229 - 0.03488312407225579im … -0.12536132731418037 + 0.08616194934108248im -0.16892891874839996 + 0.11474791489755948im; 0.04014091347056527 - 0.017943576109616576im 0.04283956365658773 - 0.0072163116547976445im … -0.10938543919789673 + 0.06230468376803542im -0.07690009814882269 + 0.040146145862372806im; … ; -0.09081651233826428 + 0.033959190930183014im 0.0068150772964802285 + 0.012816038025517857im … 0.00553248968789951 - 0.051794493721205453im -0.08995735142150815 - 0.005958101659238753im; -0.06351859120656525 + 0.0457393877952673im 0.07063687712011946 - 0.017090700359960003im … -0.01574177214206154 - 0.008398489108372213im -0.12380235285939824 + 0.06058013255516545im;;; 0.06719582530230311 - 0.04485591474180834im 0.035872287906913096 + 0.011510465001548599im … -0.10482640912571109 + 0.05581422533225515im -0.0800779547961307 + 0.0337948673739122im; 0.07994658880938452 - 0.03868652020405513im -0.019006096998783716 + 0.0441162225463483im … -0.043896185697661606 + 0.007535497317235461im 0.01702739040508798 - 0.03509634412121079im; … ; -0.003513193895428311 + 0.006900553679624078im 0.07469654809636928 - 0.022959079536758343im … -0.025835266194798256 - 0.01404761733651093im -0.06937348896293377 + 0.02005282834866822im; 0.043384619102382976 - 0.012874368520779285im 0.12742196738263611 - 0.05840719750542958im … -0.07640395134789574 + 0.03507702549982884im -0.08573999093971879 + 0.046525914974060625im;;; 0.04071785984951941 + 0.0005806154964826619im -0.008394109990969158 + 0.05592759281149161im … -0.033472204251954046 + 0.008531141183857237im -0.0005638369627124695 - 0.011013787752688124im; 0.05056969018581982 + 0.014624622217195892im -0.024873047954605813 + 0.058460514564469046im … 0.005815080042682904 - 0.016524340127333958im 0.058829521662284855 - 0.037807795916027im; … ; 0.02878269817917834 - 0.006319376183653556im 0.046223358003960276 - 0.013957608848121923im … -0.025219319197982832 + 0.006543994372654428im -0.014160044353777866 + 0.009046445494779311im; 0.04111526428337863 - 0.012399542393863754im 0.025324327428368647 + 0.01090848195408946im … -0.03534724051436766 + 0.01774052222631761im -0.019408843182122243 + 0.013222776127953648im;;; … ;;; -0.010119980078218484 + 0.012983090101775134im -0.024541371227180312 + 0.016781758938293888im … 0.04180711201646503 - 0.029388262405765975im 0.037311084442315734 - 0.024979465269990862im; -0.015913715812053933 + 0.010607152214354137im -0.012377231729151082 + 0.007429478867609085im … 0.026574082304806138 - 0.016750212752094748im 0.008215814979518253 - 0.006938369459467299im; … ; 0.018164361099022364 - 0.02402286203514975im -0.004186133137010898 - 0.004840085163023822im … -0.01756654096542397 + 0.008238620857371802im 0.032620159534690746 - 0.03835080859221804im; 0.013783648569565533 - 0.006258969478574684im -0.013806144872645736 + 0.010155206132960438im … 0.0062076883241216334 - 0.020797178483769607im 0.043404091813317 - 0.037778570409638265im;;; -0.06369843492609292 + 0.0620099146126746im -0.04705815789218537 + 0.03583337601178373im … 0.08968063539573601 - 0.06215361333103492im 0.027074755416504108 - 0.008528753845835787im; -0.03297115680545314 + 0.025576552319601722im 0.0036920510559282516 + 0.0004392605995415446im … 0.023180821250864955 - 0.017571298289853064im -0.025881237064422538 + 0.02122761258023082im; … ; -0.02556068535396938 - 0.011328355377482956im -0.03797654656017661 + 0.019031125821889594im … 0.03578608438719505 - 0.03421219128310701im 0.03675030784300841 - 0.05135700234001704im; -0.03215262071285073 + 0.024487266287189592im -0.04923258627379919 + 0.04864050686909213im … 0.10166924823861348 - 0.0910431102261903im 0.06040281862487082 - 0.04984592448663287im;;; -0.08750779549724634 + 0.07972205937570788im -0.02186095870192968 + 0.029366241778583727im … 0.03523036927133191 - 0.01671023554799047im -0.0866988722027946 + 0.07488043839114897im; -0.019850930655801766 + 0.02598098876561239im 0.03749628036464727 - 0.00846567071997034im … -0.057743396066383464 + 0.0390319175711778im -0.0923348126370809 + 0.0637112937709381im; … ; -0.11288370810804212 + 0.03260718406141419im -0.06246283217109071 + 0.05469919110971568im … 0.0632956797069805 - 0.06773133916161164im -0.04026996968706821 - 0.030607243164066947im; -0.09507502132162318 + 0.07700238376507265im -0.03791566548575766 + 0.049176399444535585im … 0.09337282046006831 - 0.08173230129994716im -0.040875939070544556 + 0.01388546161111219im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4129139212663025 -0.48683674427718304 … -0.7027113226190955 -0.4868367442771831; -0.48683674427718276 -0.774430395040442 … -0.4136373284393058 -0.3823307497944822; … ; -0.7027113226190957 -0.413637328439306 … -2.396761682588052 -1.2958067581749606; -0.48683674427718265 -0.3823307497944822 … -1.2958067581749608 -0.7744303950404418;;; -0.4868367442771829 -0.7744303950404421 … -0.4136373284393058 -0.38233074979448256; -0.7744303950404418 -1.4814477483918695 … -0.32458456943327196 -0.44991939657068575; … ; -0.4136373284393059 -0.32458456943327235 … -1.0113572986116983 -0.6373277791931806; -0.38233074979448217 -0.44991939657068586 … -0.6373277791931806 -0.4499193965706857;;; -0.7027113226190955 -1.295806758174961 … -0.2982034893755665 -0.413637328439306; -1.2958067581749608 -2.919672393653887 … -0.3537295846614472 -0.6373277791931804; … ; -0.2982034893755665 -0.35372958466144777 … -0.4903726081071751 -0.35372958466144766; -0.4136373284393058 -0.6373277791931806 … -0.353729584661447 -0.32458456943327185;;; … ;;; -1.0166744212557695 -0.5332878143065914 … -3.6361382571228615 -1.998760262050618; -0.5332878143065911 -0.3217412474738834 … -1.466733940750256 -0.9061938941468792; … ; -3.6361382571228615 -1.466733940750256 … -10.988177824465897 -8.087376168208174; -1.9987602620506177 -0.9061938941468793 … -8.087376168208174 -4.6478783711432285;;; -0.7027113226190955 -0.4136373284393058 … -2.3967616825880524 -1.2958067581749608; -0.4136373284393056 -0.3245845694332722 … -1.0113572986116983 -0.6373277791931804; … ; -2.3967616825880524 -1.0113572986116985 … -11.002806190875003 -6.077304186394069; -1.2958067581749604 -0.6373277791931804 … -6.077304186394069 -2.919672393653887;;; -0.486836744277183 -0.38233074979448245 … -1.2958067581749608 -0.7744303950404421; -0.3823307497944822 -0.44991939657068586 … -0.6373277791931805 -0.44991939657068575; … ; -1.2958067581749608 -0.6373277791931806 … -6.077304186394068 -2.9196723936538866; -0.7744303950404416 -0.4499193965706857 … -2.9196723936538866 -1.4814477483918695])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4129139212663025 -0.48683674427718304 … -0.7027113226190955 -0.4868367442771831; -0.48683674427718276 -0.774430395040442 … -0.4136373284393058 -0.3823307497944822; … ; -0.7027113226190957 -0.413637328439306 … -2.396761682588052 -1.2958067581749606; -0.48683674427718265 -0.3823307497944822 … -1.2958067581749608 -0.7744303950404418;;; -0.4868367442771829 -0.7744303950404421 … -0.4136373284393058 -0.38233074979448256; -0.7744303950404418 -1.4814477483918695 … -0.32458456943327196 -0.44991939657068575; … ; -0.4136373284393059 -0.32458456943327235 … -1.0113572986116983 -0.6373277791931806; -0.38233074979448217 -0.44991939657068586 … -0.6373277791931806 -0.4499193965706857;;; -0.7027113226190955 -1.295806758174961 … -0.2982034893755665 -0.413637328439306; -1.2958067581749608 -2.919672393653887 … -0.3537295846614472 -0.6373277791931804; … ; -0.2982034893755665 -0.35372958466144777 … -0.4903726081071751 -0.35372958466144766; -0.4136373284393058 -0.6373277791931806 … -0.353729584661447 -0.32458456943327185;;; … ;;; -1.0166744212557695 -0.5332878143065914 … -3.6361382571228615 -1.998760262050618; -0.5332878143065911 -0.3217412474738834 … -1.466733940750256 -0.9061938941468792; … ; -3.6361382571228615 -1.466733940750256 … -10.988177824465897 -8.087376168208174; -1.9987602620506177 -0.9061938941468793 … -8.087376168208174 -4.6478783711432285;;; -0.7027113226190955 -0.4136373284393058 … -2.3967616825880524 -1.2958067581749608; -0.4136373284393056 -0.3245845694332722 … -1.0113572986116983 -0.6373277791931804; … ; -2.3967616825880524 -1.0113572986116985 … -11.002806190875003 -6.077304186394069; -1.2958067581749604 -0.6373277791931804 … -6.077304186394069 -2.919672393653887;;; -0.486836744277183 -0.38233074979448245 … -1.2958067581749608 -0.7744303950404421; -0.3823307497944822 -0.44991939657068586 … -0.6373277791931805 -0.44991939657068575; … ; -1.2958067581749608 -0.6373277791931806 … -6.077304186394068 -2.9196723936538866; -0.7744303950404416 -0.4499193965706857 … -2.9196723936538866 -1.4814477483918695]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.014175131521138713 - 0.03798045280517531im 0.0007335261787648323 - 0.007676827133051568im … 0.0030562173349666685 - 0.00651988261616273im 0.0003286414475531475 - 0.0229618898228085im; -0.01035275712825969 - 0.0006601495006050308im 0.01165555213702762 + 0.021556942987353726im … -0.0019054630492143648 - 0.017965738600934984im -0.012466205639210836 - 0.015918727153514896im; … ; 0.011475016566950762 - 0.01646768092539197im -0.004351094188403074 - 0.037678111867101925im … 0.012650058958273007 + 0.05074429694168397im 0.021647824597952073 + 0.01626635955861093im; -0.012079930968083671 - 0.046397319367453824im -0.012270173778423134 - 0.04886574452290558im … 0.004363308402370945 + 0.0308492756786427im 0.005525028282144203 - 0.0188098051033985im;;; -0.002259436541975613 + 0.028045729704846853im -0.031104255254287665 - 0.0058340640738573845im … 0.006849253060408768 - 0.03980369585073723im 0.0189973535518769 - 0.018765279607952514im; 0.016698621117545852 + 0.018612473879072295im -0.0011914306087714766 - 0.007967575549221667im … 0.025451440601177 - 0.0037551154881992777im 0.054590218533337356 + 0.05661949554407428im; … ; -0.003093376448773569 - 0.016040818046890507im 0.002240583981396421 - 0.0014903602480959076im … -0.002345782117215844 + 0.0020961646103029394im -0.005904410182444539 - 0.03504787526017596im; -0.03782760869562917 - 0.04558073011727637im -0.046544902975262314 - 0.02908875516332241im … -0.023887331038418527 - 0.041268519422901176im -0.012549420667001494 - 0.0489409158169956im;;; 0.015020421910396762 + 0.06130786435828119im -0.0013168148945020236 + 0.022866300204715105im … 0.017837122464301025 - 0.008402012461615779im 0.04189591262367849 + 0.05285788452963359im; 0.005490315380346621 + 0.033047884651665846im 0.023588520747556362 + 0.02935791489666277im … 0.030746409378911585 + 0.025203150409721167im 0.043766930660991375 + 0.07650068640736057im; … ; -0.011264300548325586 - 0.001248495622080032im -0.010016435493771089 + 0.0021275968860291683im … -0.0070140793972738955 - 0.01573531963980156im -0.015016773797079873 - 0.0325683278004826im; -0.016654681749230585 + 0.022855639017148013im -0.020447450222641727 + 0.013339704211659887im … -0.006075812262646281 - 0.02622520933833179im -0.01833077659773214 - 0.02716755104897963im;;; … ;;; -0.02447421969095259 - 0.05242508280956519im -0.03237469707148652 - 0.062295704058075656im … 0.013779952291758577 + 0.02881533342633278im -0.00034182510355508554 + 0.004227755798455321im; -0.026273315970949056 - 0.05438840644716044im -0.017703773359906458 - 0.037216700753009424im … 0.006775476160450364 + 0.003805822809256043im -0.008724860320944508 - 0.023776056079559727im; … ; 0.021263670080498044 + 0.038582661444198446im -0.0051900819461225284 - 0.0033498824856811535im … 0.025029234572916795 + 0.05737378440461306im 0.04404395735121221 + 0.08817912162107057im; -0.008680375407989379 - 0.003687495595903835im -0.026353895896319333 - 0.03957744871344499im … 0.018380883086132477 + 0.05830911192877451im 0.028739048899561664 + 0.07021454115285479im;;; -0.056130810918168766 - 0.12575409179431607im -0.03270669025365516 - 0.08131003222423216im … 0.03422577003126166 + 0.028880167666904242im 0.007345904900365723 - 0.021703148348830498im; -0.026696385454853668 - 0.06707886446451158im -0.008818673981799693 - 0.02102567716293366im … 0.016758345895037868 + 0.009835450170284362im -0.014910330340753779 - 0.03868752090263122im; … ; -0.012335783326266028 - 0.015605846160459154im -0.0296444075176914 - 0.03555368130367477im … -0.008638254264217183 + 0.015667893821157526im 0.02996380636962437 + 0.05005012531583602im; -0.06598319330554459 - 0.0888453932484504im -0.05396798840036027 - 0.08263494935920418im … 0.00994480960488105 + 0.025983428694925606im -0.013445093729955837 - 0.011130085119912128im;;; -0.01498363294180731 - 0.054047433235798914im 0.005981674232039387 - 0.026429191572791694im … 0.07355784682731908 + 0.08919277929574743im 0.024176910512790604 + 0.006350146543008462im; -0.007082172608906643 - 0.01875476701007229im 0.023227663887930572 + 0.04420103056086716im … 0.028406135553978494 + 0.04027413616343719im 0.008467734057656398 + 0.006568588839120633im; … ; -0.016758772394684762 - 0.0007756198305005479im -0.018121569435412585 - 0.033212031081203484im … 0.013069709159299434 + 0.0445650544516167im 0.006802946144020234 + 0.031638323565128024im; -0.03434962704638317 - 0.05999872882815743im -0.028992798802248705 - 0.06201431568434768im … 0.03741969869403847 + 0.06894690558717206im 0.02764675816043497 + 0.03613069787326138im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4129139212663025 -0.48683674427718304 … -0.7027113226190955 -0.4868367442771831; -0.48683674427718276 -0.774430395040442 … -0.4136373284393058 -0.3823307497944822; … ; -0.7027113226190957 -0.413637328439306 … -2.396761682588052 -1.2958067581749606; -0.48683674427718265 -0.3823307497944822 … -1.2958067581749608 -0.7744303950404418;;; -0.4868367442771829 -0.7744303950404421 … -0.4136373284393058 -0.38233074979448256; -0.7744303950404418 -1.4814477483918695 … -0.32458456943327196 -0.44991939657068575; … ; -0.4136373284393059 -0.32458456943327235 … -1.0113572986116983 -0.6373277791931806; -0.38233074979448217 -0.44991939657068586 … -0.6373277791931806 -0.4499193965706857;;; -0.7027113226190955 -1.295806758174961 … -0.2982034893755665 -0.413637328439306; -1.2958067581749608 -2.919672393653887 … -0.3537295846614472 -0.6373277791931804; … ; -0.2982034893755665 -0.35372958466144777 … -0.4903726081071751 -0.35372958466144766; -0.4136373284393058 -0.6373277791931806 … -0.353729584661447 -0.32458456943327185;;; … ;;; -1.0166744212557695 -0.5332878143065914 … -3.6361382571228615 -1.998760262050618; -0.5332878143065911 -0.3217412474738834 … -1.466733940750256 -0.9061938941468792; … ; -3.6361382571228615 -1.466733940750256 … -10.988177824465897 -8.087376168208174; -1.9987602620506177 -0.9061938941468793 … -8.087376168208174 -4.6478783711432285;;; -0.7027113226190955 -0.4136373284393058 … -2.3967616825880524 -1.2958067581749608; -0.4136373284393056 -0.3245845694332722 … -1.0113572986116983 -0.6373277791931804; … ; -2.3967616825880524 -1.0113572986116985 … -11.002806190875003 -6.077304186394069; -1.2958067581749604 -0.6373277791931804 … -6.077304186394069 -2.919672393653887;;; -0.486836744277183 -0.38233074979448245 … -1.2958067581749608 -0.7744303950404421; -0.3823307497944822 -0.44991939657068586 … -0.6373277791931805 -0.44991939657068575; … ; -1.2958067581749608 -0.6373277791931806 … -6.077304186394068 -2.9196723936538866; -0.7744303950404416 -0.4499193965706857 … -2.9196723936538866 -1.4814477483918695])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4129139212663025 -0.48683674427718304 … -0.7027113226190955 -0.4868367442771831; -0.48683674427718276 -0.774430395040442 … -0.4136373284393058 -0.3823307497944822; … ; -0.7027113226190957 -0.413637328439306 … -2.396761682588052 -1.2958067581749606; -0.48683674427718265 -0.3823307497944822 … -1.2958067581749608 -0.7744303950404418;;; -0.4868367442771829 -0.7744303950404421 … -0.4136373284393058 -0.38233074979448256; -0.7744303950404418 -1.4814477483918695 … -0.32458456943327196 -0.44991939657068575; … ; -0.4136373284393059 -0.32458456943327235 … -1.0113572986116983 -0.6373277791931806; -0.38233074979448217 -0.44991939657068586 … -0.6373277791931806 -0.4499193965706857;;; -0.7027113226190955 -1.295806758174961 … -0.2982034893755665 -0.413637328439306; -1.2958067581749608 -2.919672393653887 … -0.3537295846614472 -0.6373277791931804; … ; -0.2982034893755665 -0.35372958466144777 … -0.4903726081071751 -0.35372958466144766; -0.4136373284393058 -0.6373277791931806 … -0.353729584661447 -0.32458456943327185;;; … ;;; -1.0166744212557695 -0.5332878143065914 … -3.6361382571228615 -1.998760262050618; -0.5332878143065911 -0.3217412474738834 … -1.466733940750256 -0.9061938941468792; … ; -3.6361382571228615 -1.466733940750256 … -10.988177824465897 -8.087376168208174; -1.9987602620506177 -0.9061938941468793 … -8.087376168208174 -4.6478783711432285;;; -0.7027113226190955 -0.4136373284393058 … -2.3967616825880524 -1.2958067581749608; -0.4136373284393056 -0.3245845694332722 … -1.0113572986116983 -0.6373277791931804; … ; -2.3967616825880524 -1.0113572986116985 … -11.002806190875003 -6.077304186394069; -1.2958067581749604 -0.6373277791931804 … -6.077304186394069 -2.919672393653887;;; -0.486836744277183 -0.38233074979448245 … -1.2958067581749608 -0.7744303950404421; -0.3823307497944822 -0.44991939657068586 … -0.6373277791931805 -0.44991939657068575; … ; -1.2958067581749608 -0.6373277791931806 … -6.077304186394068 -2.9196723936538866; -0.7744303950404416 -0.4499193965706857 … -2.9196723936538866 -1.4814477483918695]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.005758255171267395 - 0.008019319432657823im 0.0236135971347503 - 0.022963921528693414im … 0.020759059756688278 + 0.04794578403821963im 0.03414021207743907 + 0.007539034562858303im; 0.012349790578796338 - 0.017392026412448934im -0.0009025085380267499 - 0.005964181928175566im … 0.005915199319480993 + 0.022082384553469978im 0.009824353959886692 - 0.01411764140824063im; … ; -0.059748668047510466 + 0.026344899148367948im -0.037799372139615844 + 0.012813230341938594im … -0.03446612802846647 - 0.012441980133141456im -0.012933651742708364 - 0.0010937658642557564im; -0.04382749883263788 + 0.032006313636166434im -0.0077684242118868764 - 0.0014331911190894253im … -0.008578483663612867 + 0.04737326812488127im -0.002512328594138898 + 0.040364345979113425im;;; 0.005627740493254791 - 0.06297930876415704im 0.04642784149622857 - 0.029727831421831625im … 0.09238287843466537 + 0.05257174777166723im 0.04089555208580342 - 0.031043235010600672im; 0.010295102641764876 - 0.05403366472762326im 0.03829619141476931 + 0.03853919580403499im … 0.030074565485428535 - 0.00019784581522608823im 0.016681340407289993 - 0.06282789097266012im; … ; -0.032001724353630336 + 0.006981372621965925im -0.01594818040503388 - 0.01222479437374344im … 0.003024180716379927 + 0.02156240021954738im 0.002952493357329984 + 0.03281705519558819im; -0.021944870649254933 - 0.027057777900522564im 0.010783034794567454 - 0.035893567691633106im … 0.06400648765763106 + 0.055951453394695226im 0.05028766215397737 + 0.029437333576846816im;;; -0.003752217448123436 - 0.027231868191172612im 0.07523579041205379 + 0.06085178570558057im … 0.03669592404230306 + 0.003207579166376505im -0.006482204037715638 - 0.06455067002916628im; -0.013321676716446303 + 0.0018115592320472377im 0.032493065407202495 + 0.07847220126644194im … -0.009662071036926954 - 0.0368291991788853im -0.04731443746801618 - 0.06778296717478893im; … ; -0.002437977848632592 - 0.006232295890272105im 0.00456084145797734 - 0.010391551781691679im … 0.01582381335999935 + 0.017385191926837386im 0.008440409414999952 + 0.0072510638607566295im; -0.006004180638914672 - 0.041429308068734835im 0.04311524939008871 - 0.003656642214859438im … 0.04021503480768349 + 0.019679213155601914im 0.020311668854959327 - 0.01147958414883088im;;; … ;;; -0.03939099554355026 - 0.023484509966844723im -0.015749314789921844 - 0.0034146666690276573im … 0.04315991879409309 + 0.01632894746744023im -0.0022312686651576345 + 0.011434590085625316im; -0.020966623273803178 - 0.002211353485230369im 0.010133510367798367 + 0.018320432841979904im … 0.012044643376868308 + 0.026980402059124057im -0.019406254174451347 + 0.0068599807516557705im; … ; 0.003050263212927362 - 0.05465548178821951im -0.014142150905941073 - 0.0297369011906607im … 0.06847488106166841 + 0.03242060771210892im 0.04791286200743604 - 0.014152795335812016im; -0.035945346528515235 - 0.04673329765093444im -0.024988025535342323 - 0.015843718063964247im … 0.0581523342461578 + 0.012250816587901975im 0.011838600588292211 - 0.03230693829710569im;;; -0.04214691584227723 - 0.007626012020698404im 0.030513132574172156 + 0.058549830174170786im … -0.0056576220091970435 + 0.04109149741301605im -0.04331060928079537 + 0.017400783059695828im; -0.021373285904972908 + 0.0012491719512015792im 0.025546288165838236 + 0.0345996939910289im … -0.03694412750029382 + 0.009744049393081468im -0.06618648465300692 - 0.003631068221082997im; … ; -0.0376800207638799 - 0.08111637253311027im -0.0271674388971181 - 0.01694585700181582im … 0.04992040638979592 + 0.013273237873465675im 0.010781411453813049 - 0.07983290434663298im; -0.07860080049252365 - 0.048141696692421604im -0.03109518562990652 + 0.007617488116752691im … 0.014900757933460585 + 0.010487168765665246im -0.05021976214851632 - 0.049667002719937875im;;; 0.0031245552037567686 + 0.025722283582159687im 0.04320502955700994 + 0.04841628404790066im … -0.04857093011128287 + 0.03386143376091483im -0.05659239311048277 - 0.0009668218702227492im; -0.010415706567830009 - 0.018111098156713287im 0.017469027543275416 + 0.025996875455591456im … -0.06253914404875376 - 0.0025992365995570984im -0.05250632930635965 - 0.008047265947379159im; … ; -0.05314982354913038 - 0.03531524747006559im -0.04022040795998756 + 0.011222604830888275im … -0.016313381463467436 - 0.017202752800175594im -0.024055118826089586 - 0.07528472520370505im; -0.06715907151199488 + 0.01793909772107457im -0.003915052917959943 + 0.06691665061203814im … -0.03539686916114823 + 0.017000088493472384im -0.05032053483496414 - 0.0015592159612466596im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729846), converged = true, ρ = [0.09132316917747349 0.0874741913408036 … 0.0768475493596329 0.0874741913408036; 0.0874741913408036 0.08089966872164121 … 0.07642471016971625 0.08486944834426689; … ; 0.0768475493596329 0.07642471016971625 … 0.04778466667102173 0.06587895342303599; 0.08747419134080359 0.08486944834426689 … 0.06587895342303599 0.0808996687216412;;; 0.0874741913408036 0.08089966872164121 … 0.07642471016971623 0.08486944834426688; 0.08089966872164121 0.06744471469774925 … 0.07348669934704379 0.08163768629014775; … ; 0.07642471016971625 0.07348669934704379 … 0.061888041199967804 0.07259829028447094; 0.08486944834426687 0.08163768629014775 … 0.07259829028447096 0.08163768629014775;;; 0.07684754935963291 0.06587895342303599 … 0.0684720369897377 0.07642471016971623; 0.06587895342303599 0.046578642649811104 … 0.06665759371631998 0.07259829028447096; … ; 0.06847203698973772 0.06665759371631996 … 0.0613251531438111 0.06665759371631996; 0.07642471016971622 0.07259829028447096 … 0.06665759371631996 0.07348669934704377;;; … ;;; 0.06328495229886144 0.06591651445952829 … 0.03394064888052051 0.049875934859992095; 0.06591651445952829 0.0629779096010561 … 0.04975639788527933 0.06087020457146549; … ; 0.033940648880520514 0.04975639788527933 … 0.009696353214074633 0.016831338792592694; 0.04987593485999208 0.06087020457146549 … 0.016831338792592694 0.030985721885051897;;; 0.07684754935963291 0.07642471016971623 … 0.04778466667102172 0.06587895342303599; 0.07642471016971625 0.0734866993470438 … 0.061888041199967804 0.07259829028447096; … ; 0.047784666671021735 0.06188804119996782 … 0.009696353214074629 0.025710010675306753; 0.06587895342303597 0.07259829028447096 … 0.025710010675306746 0.04657864264981108;;; 0.08747419134080361 0.08486944834426688 … 0.06587895342303599 0.08089966872164121; 0.08486944834426688 0.08163768629014775 … 0.07259829028447096 0.08163768629014775; … ; 0.06587895342303599 0.07259829028447096 … 0.025710010675306757 0.0465786426498111; 0.0808996687216412 0.08163768629014775 … 0.04657864264981109 0.06744471469774924;;;;], eigenvalues = [[-0.16677707596309546, 0.26427771782985354, 0.2642777178298949, 0.26427771782992704, 0.3573203719044863, 0.3573203719044949, 0.35732037190449933], [-0.11613218761085632, 0.0704053232000189, 0.22624813603020139, 0.2262481360302025, 0.3361178489460033, 0.39343797761798116, 0.39343797761798144], [-0.09588938143642531, 0.087643199679558, 0.1731270414273941, 0.1731270414274042, 0.2919724892212929, 0.33773212507288686, 0.5327646516179471], [-0.0450514634859686, 0.02226952623978861, 0.09831189251532406, 0.18446409322114793, 0.3229270151624607, 0.4802469603986834, 0.5024422335104981]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2897120818381799, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.9550595227237386 - 0.029119987040777787im -4.860626757122111e-15 + 6.081123649263093e-16im … 4.249778103444992e-12 + 1.2253828828644542e-11im -1.2301159163724086e-12 - 3.614501550828999e-12im; 0.09624535906464028 - 0.0029345433891955846im 0.08129463999968035 + 0.30942218531412125im … 0.09548113594480723 - 0.1414023806670029im 0.31918720653644705 - 0.09274603496756349im; … ; 0.011788782239280036 - 0.00035944271312035673im -0.020300678013527 - 0.04338978914377322im … 0.0020128740580561705 - 0.06711865465778123im 0.06737136227081235 - 0.04089452455517021im; -0.09624535906463785 + 0.002934543389196177im -0.11745349817694466 - 0.11537346941502924im … -0.07889644627721291 - 0.41160890517918im 0.23590621557239075 - 0.2441965593174968im], [0.5824228501864606 - 0.723421711235394im -0.11149067033166514 + 0.16256690907075944im … -2.589084573785253e-12 - 8.041360701901755e-12im -7.06415713060761e-12 - 1.6220779494535407e-11im; 0.039704888188204356 - 0.049317052289973im 0.004962135449942013 - 0.007235394854894693im … -1.563429129412912e-11 - 7.762311992704685e-12im -1.433141920620857e-11 - 2.5171233505490482e-11im; … ; 0.004860596257651661 - 0.006037298950769075im -0.04878652943134716 + 0.07113667242604185im … -0.017952480303664538 + 0.00045530049805382595im -0.039591954215069385 - 0.10092666415580495im; -0.07082102771131829 + 0.08796610408051272im 0.05130277176540879 - 0.07480565869641805im … -0.07620036188814296 + 0.001932549733452425im -0.16805038544606157 - 0.42838918036419793im], [-0.62685291447743 - 0.6920593737628015im -2.441902565789945e-16 + 5.447832136871738e-15im … -4.905260168821837e-12 - 3.816104458572183e-11im -3.7295431691660636e-11 + 2.2091553126672164e-9im; -0.04615283311327432 - 0.05095374057306352im 0.011036846183317022 - 0.056115230344421556im … 0.003181930250469965 + 0.024979994797357026im 0.0014667221677454293 - 0.0010558550187906941im; … ; -0.009311506205664535 - 0.010280107190460774im 2.5106677400494046e-15 - 4.509391407353787e-15im … -2.210080022780516e-12 - 1.00512129846666e-11im -0.03429932259789001 - 0.055511220996312276im; 0.10285329952874357 + 0.1135522997777538im 0.05541112154682748 - 0.28172974395013983im … -0.04824923966978181 - 0.3787844677641864im -0.080988578538886 - 0.1299239994219883im], [-0.6533069384437369 + 0.477170328546159im -3.629172462832263e-16 + 6.858654221404615e-16im … 0.10045467597172032 + 0.15823930499108224im 1.5555659942979016e-6 - 1.0759432128533389e-6im; -0.31289907441144527 + 0.2285390608193527im 0.03117466532462971 + 0.6258106637299024im … -0.09551628128324101 - 0.15046316315476838im -9.163856071987006e-7 + 7.185267326653657e-7im; … ; -0.00920081324556059 + 0.006720202742273056im 8.177634385612745e-5 + 0.0016416056914617973im … 0.008668777710348428 + 0.013656489709050278im 0.040867067703953555 + 0.017068402491000046im; 0.05263499514469647 - 0.03844419284149753im 0.0006211743111656743 + 0.0124696609863964im … 0.07254134210064318 + 0.11427304166264998im 0.4343000288572852 + 0.1813828993777103im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596309546, 0.26427771782985354, 0.2642777178298949, 0.26427771782992704, 0.3573203719044863, 0.3573203719044949, 0.35732037190449933], [-0.11613218761085632, 0.0704053232000189, 0.22624813603020139, 0.2262481360302025, 0.3361178489460033, 0.39343797761798116, 0.39343797761798144], [-0.09588938143642531, 0.087643199679558, 0.1731270414273941, 0.1731270414274042, 0.2919724892212929, 0.33773212507288686, 0.5327646516179471], [-0.0450514634859686, 0.02226952623978861, 0.09831189251532406, 0.18446409322114793, 0.3229270151624607, 0.4802469603986834, 0.5024422335104981]], X = [[0.9550595227237386 - 0.029119987040777787im -4.860626757122111e-15 + 6.081123649263093e-16im … 4.249778103444992e-12 + 1.2253828828644542e-11im -1.2301159163724086e-12 - 3.614501550828999e-12im; 0.09624535906464028 - 0.0029345433891955846im 0.08129463999968035 + 0.30942218531412125im … 0.09548113594480723 - 0.1414023806670029im 0.31918720653644705 - 0.09274603496756349im; … ; 0.011788782239280036 - 0.00035944271312035673im -0.020300678013527 - 0.04338978914377322im … 0.0020128740580561705 - 0.06711865465778123im 0.06737136227081235 - 0.04089452455517021im; -0.09624535906463785 + 0.002934543389196177im -0.11745349817694466 - 0.11537346941502924im … -0.07889644627721291 - 0.41160890517918im 0.23590621557239075 - 0.2441965593174968im], [0.5824228501864606 - 0.723421711235394im -0.11149067033166514 + 0.16256690907075944im … -2.589084573785253e-12 - 8.041360701901755e-12im -7.06415713060761e-12 - 1.6220779494535407e-11im; 0.039704888188204356 - 0.049317052289973im 0.004962135449942013 - 0.007235394854894693im … -1.563429129412912e-11 - 7.762311992704685e-12im -1.433141920620857e-11 - 2.5171233505490482e-11im; … ; 0.004860596257651661 - 0.006037298950769075im -0.04878652943134716 + 0.07113667242604185im … -0.017952480303664538 + 0.00045530049805382595im -0.039591954215069385 - 0.10092666415580495im; -0.07082102771131829 + 0.08796610408051272im 0.05130277176540879 - 0.07480565869641805im … -0.07620036188814296 + 0.001932549733452425im -0.16805038544606157 - 0.42838918036419793im], [-0.62685291447743 - 0.6920593737628015im -2.441902565789945e-16 + 5.447832136871738e-15im … -4.905260168821837e-12 - 3.816104458572183e-11im -3.7295431691660636e-11 + 2.2091553126672164e-9im; -0.04615283311327432 - 0.05095374057306352im 0.011036846183317022 - 0.056115230344421556im … 0.003181930250469965 + 0.024979994797357026im 0.0014667221677454293 - 0.0010558550187906941im; … ; -0.009311506205664535 - 0.010280107190460774im 2.5106677400494046e-15 - 4.509391407353787e-15im … -2.210080022780516e-12 - 1.00512129846666e-11im -0.03429932259789001 - 0.055511220996312276im; 0.10285329952874357 + 0.1135522997777538im 0.05541112154682748 - 0.28172974395013983im … -0.04824923966978181 - 0.3787844677641864im -0.080988578538886 - 0.1299239994219883im], [-0.6533069384437369 + 0.477170328546159im -3.629172462832263e-16 + 6.858654221404615e-16im … 0.10045467597172032 + 0.15823930499108224im 1.5555659942979016e-6 - 1.0759432128533389e-6im; -0.31289907441144527 + 0.2285390608193527im 0.03117466532462971 + 0.6258106637299024im … -0.09551628128324101 - 0.15046316315476838im -9.163856071987006e-7 + 7.185267326653657e-7im; … ; -0.00920081324556059 + 0.006720202742273056im 8.177634385612745e-5 + 0.0016416056914617973im … 0.008668777710348428 + 0.013656489709050278im 0.040867067703953555 + 0.017068402491000046im; 0.05263499514469647 - 0.03844419284149753im 0.0006211743111656743 + 0.0124696609863964im … 0.07254134210064318 + 0.11427304166264998im 0.4343000288572852 + 0.1813828993777103im]], residual_norms = [[9.372273149911908e-14, 1.3175189317835612e-13, 1.046799755573308e-13, 6.383282831647301e-14, 7.012361327598235e-11, 4.61086446926738e-10, 1.3677315984483436e-10], [1.180522191416316e-13, 1.2193698259913704e-13, 1.2046756177081567e-13, 5.812185661312018e-14, 1.2357665777889883e-10, 2.3770543247921825e-10, 1.8118975069981028e-10], [7.34642895382055e-14, 1.1674349939614878e-13, 9.272184996328411e-14, 9.507035154644753e-14, 1.975133744127143e-11, 5.633098010693137e-10, 9.531492410673753e-8], [1.4311435507076568e-13, 7.692247217741324e-14, 1.2140209644119983e-13, 1.032404769263227e-13, 1.3456792055732204e-9, 1.0411137729113649e-5, 3.94084858904169e-6]], iterations = [32, 22, 22, 20], converged = 1, n_matvec = 660)], stage = :finalize, algorithm = &quot;SCF&quot;, occupation_threshold = 1.0e-6)</code></pre><h2 id="Direct-minimization"><a class="docs-heading-anchor" href="#Direct-minimization">Direct minimization</a><a id="Direct-minimization-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-minimization" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_dm = direct_minimization(basis; tol)

# Newton algorithm</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3915556365712025 0.3785174204827321 … 0.34469959997331306 0.3785174204827322; 0.3785174204827322 0.3664584402989882 … 0.32735728141432974 0.3636495422201065; … ; 0.3446995999733131 0.32735728141432974 … 0.3075192693027155 0.33438053176539934; 0.3785174204827321 0.36364954222010637 … 0.33438053176539934 0.3664584402989882;;; 0.3785174204827322 0.36645844029898816 … 0.3273572814143296 0.3636495422201064; 0.3664584402989882 0.3510288631503096 … 0.3111940131642293 0.35191706599025635; … ; 0.32735728141432974 0.31119401316422923 … 0.298241228272315 0.3214260025664263; 0.3636495422201064 0.35191706599025624 … 0.3214260025664263 0.35191706599025624;;; 0.34469959997331306 0.33438053176539934 … 0.28653515351121744 0.3273572814143297; 0.3343805317653994 0.31861604761030793 … 0.27805891860290555 0.32142600256642634; … ; 0.2865351535112175 0.2780589186029055 … 0.25590185758798834 0.2780589186029055; 0.3273572814143296 0.3214260025664263 … 0.2780589186029055 0.31119401316422923;;; … ;;; 0.30487474913873486 0.2830366687882853 … 0.28556433227786343 0.30095737042332693; 0.2830366687882854 0.25898431603615374 … 0.2726330012533779 0.28541419651262123; … ; 0.2855643322778635 0.2726330012533779 … 0.2771603890765679 0.2812108737304586; 0.300957370423327 0.2854141965126212 … 0.28121087373045855 0.2930827262022484;;; 0.3446995999733131 0.3273572814143296 … 0.3075192693027155 0.3343805317653994; 0.3273572814143297 0.3111940131642293 … 0.29824122827231503 0.3214260025664264; … ; 0.30751926930271556 0.29824122827231503 … 0.277160389076568 0.29313119138758603; 0.3343805317653994 0.32142600256642634 … 0.293131191387586 0.31861604761030793;;; 0.3785174204827322 0.3636495422201064 … 0.33438053176539934 0.3664584402989882; 0.3636495422201065 0.35191706599025624 … 0.3214260025664263 0.35191706599025635; … ; 0.33438053176539934 0.32142600256642634 … 0.29313119138758603 0.318616047610308; 0.36645844029898816 0.3519170659902563 … 0.318616047610308 0.3510288631503096]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081920320465 -0.4966565569652615 … -0.477191900770388 -0.4966565569652615; -0.4966565569652615 -0.48481820847339957 … -0.4763804455803998 -0.4920413109279808; … ; -0.477191900770388 -0.4763804455803998 … -0.4122880708157049 -0.45507008139957267; -0.49665655696526156 -0.4920413109279808 … -0.45507008139957267 -0.4848182084733995;;; -0.4966565569652615 -0.48481820847339957 … -0.4763804455803998 -0.4920413109279808; -0.48481820847339957 -0.4583744077079642 … -0.4706560155312527 -0.48617902495353255; … ; -0.4763804455803998 -0.4706560155312527 … -0.4463984363601503 -0.46889439623369206; -0.4920413109279808 -0.48617902495353255 … -0.46889439623369206 -0.48617902495353255;;; -0.477191900770388 -0.45507008139957283 … -0.4605141232770139 -0.47638044558039994; -0.45507008139957267 -0.4090661823246692 … -0.45671990819309505 -0.46889439623369206; … ; -0.4605141232770139 -0.45671990819309505 … -0.4451449565327359 -0.45671990819309505; -0.4763804455803998 -0.46889439623369206 … -0.45671990819309505 -0.4706560155312527;;; … ;;; -0.4494759507616207 -0.4551499721073651 … -0.37125986268508815 -0.4177457151777524; -0.4551499721073651 -0.44880351089776616 … -0.41743801075997783 -0.4441260992516665; … ; -0.37125986268508826 -0.4174380107599777 … -0.25365698331036785 -0.299798091116242; -0.4177457151777524 -0.4441260992516665 … -0.299798091116242 -0.3610634326611559;;; -0.477191900770388 -0.47638044558039994 … -0.41228807081570495 -0.45507008139957283; -0.47638044558039994 -0.4706560155312527 … -0.4463984363601503 -0.46889439623369206; … ; -0.41228807081570495 -0.4463984363601503 … -0.25365698331036785 -0.3410633022778508; -0.45507008139957267 -0.46889439623369206 … -0.34106330227785087 -0.4090661823246692;;; -0.4966565569652615 -0.4920413109279808 … -0.45507008139957283 -0.48481820847339957; -0.4920413109279808 -0.48617902495353255 … -0.46889439623369206 -0.48617902495353255; … ; -0.45507008139957283 -0.46889439623369206 … -0.34106330227785076 -0.4090661823246692; -0.4848182084733995 -0.48617902495353255 … -0.4090661823246692 -0.4583744077079641])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.412913921448412 -0.4868367444337812 … -0.7027113227215003 -0.4868367444337813; -0.48683674443378094 -0.7744303951520541 … -0.4136373285608649 -0.38233074995349065; … ; -0.7027113227215005 -0.4136373285608651 … -2.3967616826456744 -1.2958067582395987; -0.48683674443378094 -0.38233074995349065 … -1.295806758239599 -0.7744303951520538;;; -0.48683674443378105 -0.7744303951520541 … -0.413637328560865 -0.382330749953491; -0.7744303951520539 -1.4814477484523993 … -0.3245845695551737 -0.44991939670754755; … ; -0.413637328560865 -0.3245845695551741 … -1.0113572986755648 -0.6373277792840264; -0.38233074995349053 -0.44991939670754766 … -0.6373277792840262 -0.44991939670754755;;; -0.7027113227215003 -1.2958067582395993 … -0.29820348948264164 -0.41363732856086527; -1.295806758239599 -2.919672393692103 … -0.35372958475399263 -0.6373277792840262; … ; -0.29820348948264164 -0.35372958475399324 … -0.4903726081715591 -0.35372958475399313; -0.413637328560865 -0.6373277792840262 … -0.3537295847539925 -0.3245845695551738;;; … ;;; -1.0166744213267949 -0.5332878143865682 … -3.636138257229727 -1.9987602621206995; -0.5332878143865679 -0.32174124756052463 … -1.4667339408300113 -0.9061938942137764; … ; -3.636138257229727 -1.4667339408300113 … -10.988177824553325 -8.087376168318155; -1.998760262120699 -0.9061938942137764 … -8.087376168318155 -4.647878371225811;;; -0.7027113227215003 -0.4136373285608651 … -2.396761682645675 -1.295806758239599; -0.41363732856086494 -0.32458456955517395 … -1.0113572986755648 -0.6373277792840262; … ; -2.396761682645675 -1.011357298675565 … -11.002806190962431 -6.077304186453727; -1.2958067582395987 -0.637327779284026 … -6.077304186453727 -2.919672393692103;;; -0.4868367444337811 -0.38233074995349087 … -1.295806758239599 -0.7744303951520541; -0.3823307499534906 -0.4499193967075477 … -0.6373277792840262 -0.44991939670754755; … ; -1.295806758239599 -0.6373277792840263 … -6.077304186453725 -2.9196723936921023; -0.7744303951520537 -0.44991939670754744 … -2.9196723936921023 -1.4814477484523993]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.26297592103922734 - 0.023797369417749244im 0.256913900716426 - 0.04329321351789626im … 0.11842844952287092 - 0.030849754938180242im 0.2569138977538958 - 0.04329322239495502im; 0.11734345847220894 + 0.08741489155456131im 0.10259765045739254 + 0.08165212976083415im … 0.0817259503344616 - 0.028169718696348246im 0.12069327685654022 + 0.011815314427599366im; … ; -0.02175780160766687 + 0.10043506841733882im -0.004683648908252672 + 0.05275312063030565im … -0.03655458714081565 + 0.003307920987583414im -0.005890452628203626 + 0.05571398704615815im; 0.11734346396153905 + 0.08741489065569023im 0.12069328388713826 + 0.011815321086799144im … 0.01886362894899459 + 0.032531721683684im 0.10259765143651861 + 0.08165212753958986im;;; 0.06624588790375695 - 0.08830149492073987im 0.04301718778184405 - 0.12323556764584839im … 0.08720620638498537 - 0.009323993406156694im 0.1057961621218731 - 0.0394134849228641im; -0.11972384469134584 + 0.029171868644279897im -0.13203127367321998 + 0.007630307890452719im … 0.0326132308279014 - 0.005522294930564791im -0.025981391688888404 + 0.013527470055329636im; … ; 0.015765650053860464 + 0.05758029404159048im 0.01603244724335618 + 0.010005660555380654im … 0.018297902123733282 + 0.02603906788503737im 0.03506946602897172 + 0.05845403507823481im; 0.06510544867609933 - 0.0013065102592957544im 0.06640895001670753 - 0.07299634054436926im … 0.06663580614579476 + 0.028892067413707076im 0.10023360411839362 + 0.04332124083651004im;;; -0.07308082819606251 - 0.07605661444986397im -0.039715105173885545 - 0.06060359742487695im … 0.013951050965517367 - 0.009844949872889194im -0.030838467773081992 - 0.03718911342429163im; -0.10735136168429116 + 0.0027379511903015434im -0.06938756644568807 + 0.029016227109878723im … -0.01629881014303164 - 0.0034685797735869613im -0.07056070536380842 - 0.0034939533410095177im; … ; 0.002247610213036778 + 0.0011153573951783336im 0.003831802543546615 - 0.022320954134367424im … 0.01935477082428736 + 0.017170819798588755im 0.01586084943298032 + 0.01904501559530819im; -0.015869423657101357 - 0.05120766445390139im -0.001698152805260883 - 0.06798392929531599im … 0.02858697147871629 + 0.007126965527972194im 0.009962120540536266 - 0.010869219049252189im;;; … ;;; -0.02605729441326822 - 0.015161590881692694im -0.029975426007707445 - 0.017254838491157404im … -0.006239501057024325 + 0.033046247574125914im -0.0044726480929534644 + 0.009301578468749468im; -0.01802649572418028 - 0.02844504510996733im -0.013141017530407223 - 0.016543444873569978im … -0.0036004574403636887 - 0.0002159744627810135im -0.006322184572055654 - 0.021768986631188765im; … ; 0.021183816546078996 + 0.007364231973731157im -0.008408643704181585 + 0.004286903807381051im … 0.023283760138111377 + 0.008930436398884585im 0.04231627521224214 + 0.01155975625122998im; -0.010607757376185183 + 0.015047124246338937im -0.029708843193183468 + 0.00013268373453470815im … 0.0050200630108408915 + 0.04648776407084306im 0.017444699907019287 + 0.041013985787904744im;;; -0.07308082496143906 - 0.07605661249523207im -0.030838463382189166 - 0.03718910908597787im … -0.03655458751277445 + 0.0033079190877864303im -0.03971510730178417 - 0.060603599013597076im; -0.015869420417729572 - 0.051207660944586716im 0.009962122887028153 - 0.010869215167151672im … 0.0005777340295299981 - 0.03489776073472407im -0.0016981510773912802 - 0.06798392861013729im; … ; -0.036554590244863905 + 0.0033079165053912507im -0.0478240131657152 + 0.010430609111789375im … -0.007005180338161133 + 0.00497051112814083im 0.0038323217091626323 - 0.007202332772740223im; -0.10735136708170928 + 0.0027379456268826928im -0.07056070449177443 - 0.0034939542814545373im … -0.06380393455030677 + 0.05613921521468392im -0.06938757728713016 + 0.029016221744892462im;;; 0.06624589454271235 - 0.08830149008947463im 0.10579617014214762 - 0.039413473611049674im … -0.005898408939589397 - 0.05262097261833819im 0.04301718862062545 - 0.1232355695615365im; 0.06510544971450818 - 0.0013065055696913283im 0.10023360460707757 + 0.04332124575227049im … 0.04142481463167439 - 0.05780450662054124im 0.06640895030519237 - 0.07299634158647789im; … ; -0.0982887503226904 + 0.0339028373682214im -0.05900407890963835 + 0.03624743535400034im … -0.0885659719959358 - 0.029013476608248295im -0.08428469106585819 - 0.022212572926161443im; -0.11972384351221038 + 0.029171866028915035im -0.02598138562563057 + 0.01352747359454989im … -0.12497540453057637 + 0.015894401712298962im -0.13203128002108266 + 0.007630306283966732im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3915556365712025 0.3785174204827321 … 0.34469959997331306 0.3785174204827322; 0.3785174204827322 0.3664584402989882 … 0.32735728141432974 0.3636495422201065; … ; 0.3446995999733131 0.32735728141432974 … 0.3075192693027155 0.33438053176539934; 0.3785174204827321 0.36364954222010637 … 0.33438053176539934 0.3664584402989882;;; 0.3785174204827322 0.36645844029898816 … 0.3273572814143296 0.3636495422201064; 0.3664584402989882 0.3510288631503096 … 0.3111940131642293 0.35191706599025635; … ; 0.32735728141432974 0.31119401316422923 … 0.298241228272315 0.3214260025664263; 0.3636495422201064 0.35191706599025624 … 0.3214260025664263 0.35191706599025624;;; 0.34469959997331306 0.33438053176539934 … 0.28653515351121744 0.3273572814143297; 0.3343805317653994 0.31861604761030793 … 0.27805891860290555 0.32142600256642634; … ; 0.2865351535112175 0.2780589186029055 … 0.25590185758798834 0.2780589186029055; 0.3273572814143296 0.3214260025664263 … 0.2780589186029055 0.31119401316422923;;; … ;;; 0.30487474913873486 0.2830366687882853 … 0.28556433227786343 0.30095737042332693; 0.2830366687882854 0.25898431603615374 … 0.2726330012533779 0.28541419651262123; … ; 0.2855643322778635 0.2726330012533779 … 0.2771603890765679 0.2812108737304586; 0.300957370423327 0.2854141965126212 … 0.28121087373045855 0.2930827262022484;;; 0.3446995999733131 0.3273572814143296 … 0.3075192693027155 0.3343805317653994; 0.3273572814143297 0.3111940131642293 … 0.29824122827231503 0.3214260025664264; … ; 0.30751926930271556 0.29824122827231503 … 0.277160389076568 0.29313119138758603; 0.3343805317653994 0.32142600256642634 … 0.293131191387586 0.31861604761030793;;; 0.3785174204827322 0.3636495422201064 … 0.33438053176539934 0.3664584402989882; 0.3636495422201065 0.35191706599025624 … 0.3214260025664263 0.35191706599025635; … ; 0.33438053176539934 0.32142600256642634 … 0.29313119138758603 0.318616047610308; 0.36645844029898816 0.3519170659902563 … 0.318616047610308 0.3510288631503096]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081920320465 -0.4966565569652615 … -0.477191900770388 -0.4966565569652615; -0.4966565569652615 -0.48481820847339957 … -0.4763804455803998 -0.4920413109279808; … ; -0.477191900770388 -0.4763804455803998 … -0.4122880708157049 -0.45507008139957267; -0.49665655696526156 -0.4920413109279808 … -0.45507008139957267 -0.4848182084733995;;; -0.4966565569652615 -0.48481820847339957 … -0.4763804455803998 -0.4920413109279808; -0.48481820847339957 -0.4583744077079642 … -0.4706560155312527 -0.48617902495353255; … ; -0.4763804455803998 -0.4706560155312527 … -0.4463984363601503 -0.46889439623369206; -0.4920413109279808 -0.48617902495353255 … -0.46889439623369206 -0.48617902495353255;;; -0.477191900770388 -0.45507008139957283 … -0.4605141232770139 -0.47638044558039994; -0.45507008139957267 -0.4090661823246692 … -0.45671990819309505 -0.46889439623369206; … ; -0.4605141232770139 -0.45671990819309505 … -0.4451449565327359 -0.45671990819309505; -0.4763804455803998 -0.46889439623369206 … -0.45671990819309505 -0.4706560155312527;;; … ;;; -0.4494759507616207 -0.4551499721073651 … -0.37125986268508815 -0.4177457151777524; -0.4551499721073651 -0.44880351089776616 … -0.41743801075997783 -0.4441260992516665; … ; -0.37125986268508826 -0.4174380107599777 … -0.25365698331036785 -0.299798091116242; -0.4177457151777524 -0.4441260992516665 … -0.299798091116242 -0.3610634326611559;;; -0.477191900770388 -0.47638044558039994 … -0.41228807081570495 -0.45507008139957283; -0.47638044558039994 -0.4706560155312527 … -0.4463984363601503 -0.46889439623369206; … ; -0.41228807081570495 -0.4463984363601503 … -0.25365698331036785 -0.3410633022778508; -0.45507008139957267 -0.46889439623369206 … -0.34106330227785087 -0.4090661823246692;;; -0.4966565569652615 -0.4920413109279808 … -0.45507008139957283 -0.48481820847339957; -0.4920413109279808 -0.48617902495353255 … -0.46889439623369206 -0.48617902495353255; … ; -0.45507008139957283 -0.46889439623369206 … -0.34106330227785076 -0.4090661823246692; -0.4848182084733995 -0.48617902495353255 … -0.4090661823246692 -0.4583744077079641])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.412913921448412 -0.4868367444337812 … -0.7027113227215003 -0.4868367444337813; -0.48683674443378094 -0.7744303951520541 … -0.4136373285608649 -0.38233074995349065; … ; -0.7027113227215005 -0.4136373285608651 … -2.3967616826456744 -1.2958067582395987; -0.48683674443378094 -0.38233074995349065 … -1.295806758239599 -0.7744303951520538;;; -0.48683674443378105 -0.7744303951520541 … -0.413637328560865 -0.382330749953491; -0.7744303951520539 -1.4814477484523993 … -0.3245845695551737 -0.44991939670754755; … ; -0.413637328560865 -0.3245845695551741 … -1.0113572986755648 -0.6373277792840264; -0.38233074995349053 -0.44991939670754766 … -0.6373277792840262 -0.44991939670754755;;; -0.7027113227215003 -1.2958067582395993 … -0.29820348948264164 -0.41363732856086527; -1.295806758239599 -2.919672393692103 … -0.35372958475399263 -0.6373277792840262; … ; -0.29820348948264164 -0.35372958475399324 … -0.4903726081715591 -0.35372958475399313; -0.413637328560865 -0.6373277792840262 … -0.3537295847539925 -0.3245845695551738;;; … ;;; -1.0166744213267949 -0.5332878143865682 … -3.636138257229727 -1.9987602621206995; -0.5332878143865679 -0.32174124756052463 … -1.4667339408300113 -0.9061938942137764; … ; -3.636138257229727 -1.4667339408300113 … -10.988177824553325 -8.087376168318155; -1.998760262120699 -0.9061938942137764 … -8.087376168318155 -4.647878371225811;;; -0.7027113227215003 -0.4136373285608651 … -2.396761682645675 -1.295806758239599; -0.41363732856086494 -0.32458456955517395 … -1.0113572986755648 -0.6373277792840262; … ; -2.396761682645675 -1.011357298675565 … -11.002806190962431 -6.077304186453727; -1.2958067582395987 -0.637327779284026 … -6.077304186453727 -2.919672393692103;;; -0.4868367444337811 -0.38233074995349087 … -1.295806758239599 -0.7744303951520541; -0.3823307499534906 -0.4499193967075477 … -0.6373277792840262 -0.44991939670754755; … ; -1.295806758239599 -0.6373277792840263 … -6.077304186453725 -2.9196723936921023; -0.7744303951520537 -0.44991939670754744 … -2.9196723936921023 -1.4814477484523993]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.2039032321910936 - 0.050565104026084454im -0.24801423176005644 - 0.20051450005050128im … -0.07093347989767396 - 0.047431047966536105im -0.1594639489147873 - 0.053629872424532314im; -0.1192726571297845 - 0.07211322454543098im -0.09462740369176585 - 0.09542089444236622im … -0.04173488931016687 - 0.036160828091561785im -0.07665094718809126 - 0.04750664863340073im; … ; 0.01438638407810108 + 0.13423383626670374im 0.008684653384971529 + 0.09170249210818773im … -0.0040456331461578374 - 0.036150490802369234im -0.03857790493651018 - 0.018366457765427682im; -0.07869848295444358 + 0.155127437970223im -0.11361208514205254 + 0.017778315561256627im … -0.05342685932807577 - 0.030091413417911494im -0.09170135460345702 + 0.05028270806046876im;;; -0.05119110924023176 - 0.08256714657507262im -0.07272087557985694 - 0.2130957125292638im … -0.044590275630465206 - 0.026527395715206663im -0.04035618708425816 - 0.019245850295534522im; 0.04542873706210293 - 0.011491472638992698im 0.0843120895954294 - 0.02078646152703355im … -0.012658699373109253 - 0.01268351811551639im 0.010630867215197671 - 7.317304646740355e-5im; … ; -0.003106226565031145 + 0.0846367417311763im -0.005841745931321514 + 0.033177404169335484im … -0.03521407793421451 - 0.01701551232531265im -0.04172725102766316 + 0.02163532923736447im; -0.02540337478261345 + 0.07063787768387582im -0.06420038533235164 - 0.08340592642559445im … -0.0581574786195227 - 0.01872899428663834im -0.06477840605200037 + 0.031044397444068415im;;; 0.046973541159135164 - 0.0344576757038709im 0.005891214334860432 - 0.0893552495217568im … 0.001334935193336127 - 0.001768148340719369im 0.03456281373992718 + 0.005098993394808902im; 0.04879777469429192 + 0.012125452096404829im 0.04750848019801119 + 0.026328144858600317im … 0.013490370409927097 + 0.005858348707650304im 0.03808959543848122 + 0.016787237524623924im; … ; 0.009689452360915306 + 0.024409130912053628im 0.001141645934770881 - 0.009006921646650057im … -0.01901793684543488 - 0.0020093953043947834im -0.007287661965323334 + 0.017761863873705153im; 0.02676105516225597 - 0.0041839354721889856im -0.006230429084746632 - 0.06912363972521104im … -0.015008575102045382 - 0.0017246250269319272im 0.010313743845896742 + 0.015143042988897515im;;; … ;;; 0.028414123445953676 + 0.013716333109717455im 0.020558386675156227 + 0.010205867182688903im … 0.011275764277890813 + 0.015985644221160833im 0.01819442640989272 + 0.011136452127404342im; 0.010190133838627224 - 0.0009693203013668651im 0.0002528134043232968 - 0.004463193616384085im … 0.008259473058033085 + 0.006158959516148426im 0.010960877639871988 + 0.0012110709080525228im; … ; -0.012362584434642119 - 0.018483469912814306im 0.010777451078481728 + 0.0027967452840553094im … -0.00618669753557969 + 0.013687017790717754im -0.027244323820109273 - 0.02034577668872746im; 0.02162626556917517 + 0.010952886379357004im 0.029224926760482536 + 0.01884529513641484im … 0.0025846696721429875 + 0.0162935259525661im 0.0009303754567291548 + 0.0018141613392509961im;;; 0.04366389595241502 + 0.021242066112085047im 0.0027789882154802548 + 0.0018588978626840945im … 0.027227533483275515 + 0.013106028664011529im 0.03825258627768907 + 0.00499557863068141im; -0.011084758252675693 - 0.017793567713835126im -0.030636659677194894 - 0.023456911963012445im … 0.004717509264658385 - 0.005879131403904536im 0.00026063985214042936 - 0.016134298252178256im; … ; 0.03260341973375074 - 0.01418834093887194im 0.04432167820805238 + 0.030646732769040022im … 0.026690001016892364 + 0.010132079830110512im -0.003784919961920244 - 0.06808398686015368im; 0.09756339540194975 + 0.060390337877523466im 0.05820098947514738 + 0.05099946524198677im … 0.04367112624539354 + 0.0233954791041917im 0.058626575156246724 + 0.0018869936679744154im;;; -0.07380973157405799 - 0.002301107967890581im -0.13103215471463098 - 0.07358393157658616im … -0.0019193034907038515 - 0.019077650071455052im -0.02825597039186223 - 0.02625980206194372im; -0.08614300268242017 - 0.05319481718309782im -0.10059002429026581 - 0.066722912260327im … -0.021694925671300262 - 0.02929129268863475im -0.049507491531301864 - 0.04572149166532914im; … ; 0.0785634970955052 + 0.05183118001261615im 0.05504427991349893 + 0.07962620816136864im … 0.0633316674302799 - 0.027863999154331083im 0.036218950160755686 - 0.09441399492134438im; 0.09569863455375734 + 0.16258319450139858im 0.01413736843383414 + 0.0783351134783719im … 0.050474759011931575 - 0.00299802890900626im 0.07532427235856852 + 0.029514680549601983im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3915556365712025 0.3785174204827321 … 0.34469959997331306 0.3785174204827322; 0.3785174204827322 0.3664584402989882 … 0.32735728141432974 0.3636495422201065; … ; 0.3446995999733131 0.32735728141432974 … 0.3075192693027155 0.33438053176539934; 0.3785174204827321 0.36364954222010637 … 0.33438053176539934 0.3664584402989882;;; 0.3785174204827322 0.36645844029898816 … 0.3273572814143296 0.3636495422201064; 0.3664584402989882 0.3510288631503096 … 0.3111940131642293 0.35191706599025635; … ; 0.32735728141432974 0.31119401316422923 … 0.298241228272315 0.3214260025664263; 0.3636495422201064 0.35191706599025624 … 0.3214260025664263 0.35191706599025624;;; 0.34469959997331306 0.33438053176539934 … 0.28653515351121744 0.3273572814143297; 0.3343805317653994 0.31861604761030793 … 0.27805891860290555 0.32142600256642634; … ; 0.2865351535112175 0.2780589186029055 … 0.25590185758798834 0.2780589186029055; 0.3273572814143296 0.3214260025664263 … 0.2780589186029055 0.31119401316422923;;; … ;;; 0.30487474913873486 0.2830366687882853 … 0.28556433227786343 0.30095737042332693; 0.2830366687882854 0.25898431603615374 … 0.2726330012533779 0.28541419651262123; … ; 0.2855643322778635 0.2726330012533779 … 0.2771603890765679 0.2812108737304586; 0.300957370423327 0.2854141965126212 … 0.28121087373045855 0.2930827262022484;;; 0.3446995999733131 0.3273572814143296 … 0.3075192693027155 0.3343805317653994; 0.3273572814143297 0.3111940131642293 … 0.29824122827231503 0.3214260025664264; … ; 0.30751926930271556 0.29824122827231503 … 0.277160389076568 0.29313119138758603; 0.3343805317653994 0.32142600256642634 … 0.293131191387586 0.31861604761030793;;; 0.3785174204827322 0.3636495422201064 … 0.33438053176539934 0.3664584402989882; 0.3636495422201065 0.35191706599025624 … 0.3214260025664263 0.35191706599025635; … ; 0.33438053176539934 0.32142600256642634 … 0.29313119138758603 0.318616047610308; 0.36645844029898816 0.3519170659902563 … 0.318616047610308 0.3510288631503096]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081920320465 -0.4966565569652615 … -0.477191900770388 -0.4966565569652615; -0.4966565569652615 -0.48481820847339957 … -0.4763804455803998 -0.4920413109279808; … ; -0.477191900770388 -0.4763804455803998 … -0.4122880708157049 -0.45507008139957267; -0.49665655696526156 -0.4920413109279808 … -0.45507008139957267 -0.4848182084733995;;; -0.4966565569652615 -0.48481820847339957 … -0.4763804455803998 -0.4920413109279808; -0.48481820847339957 -0.4583744077079642 … -0.4706560155312527 -0.48617902495353255; … ; -0.4763804455803998 -0.4706560155312527 … -0.4463984363601503 -0.46889439623369206; -0.4920413109279808 -0.48617902495353255 … -0.46889439623369206 -0.48617902495353255;;; -0.477191900770388 -0.45507008139957283 … -0.4605141232770139 -0.47638044558039994; -0.45507008139957267 -0.4090661823246692 … -0.45671990819309505 -0.46889439623369206; … ; -0.4605141232770139 -0.45671990819309505 … -0.4451449565327359 -0.45671990819309505; -0.4763804455803998 -0.46889439623369206 … -0.45671990819309505 -0.4706560155312527;;; … ;;; -0.4494759507616207 -0.4551499721073651 … -0.37125986268508815 -0.4177457151777524; -0.4551499721073651 -0.44880351089776616 … -0.41743801075997783 -0.4441260992516665; … ; -0.37125986268508826 -0.4174380107599777 … -0.25365698331036785 -0.299798091116242; -0.4177457151777524 -0.4441260992516665 … -0.299798091116242 -0.3610634326611559;;; -0.477191900770388 -0.47638044558039994 … -0.41228807081570495 -0.45507008139957283; -0.47638044558039994 -0.4706560155312527 … -0.4463984363601503 -0.46889439623369206; … ; -0.41228807081570495 -0.4463984363601503 … -0.25365698331036785 -0.3410633022778508; -0.45507008139957267 -0.46889439623369206 … -0.34106330227785087 -0.4090661823246692;;; -0.4966565569652615 -0.4920413109279808 … -0.45507008139957283 -0.48481820847339957; -0.4920413109279808 -0.48617902495353255 … -0.46889439623369206 -0.48617902495353255; … ; -0.45507008139957283 -0.46889439623369206 … -0.34106330227785076 -0.4090661823246692; -0.4848182084733995 -0.48617902495353255 … -0.4090661823246692 -0.4583744077079641])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.412913921448412 -0.4868367444337812 … -0.7027113227215003 -0.4868367444337813; -0.48683674443378094 -0.7744303951520541 … -0.4136373285608649 -0.38233074995349065; … ; -0.7027113227215005 -0.4136373285608651 … -2.3967616826456744 -1.2958067582395987; -0.48683674443378094 -0.38233074995349065 … -1.295806758239599 -0.7744303951520538;;; -0.48683674443378105 -0.7744303951520541 … -0.413637328560865 -0.382330749953491; -0.7744303951520539 -1.4814477484523993 … -0.3245845695551737 -0.44991939670754755; … ; -0.413637328560865 -0.3245845695551741 … -1.0113572986755648 -0.6373277792840264; -0.38233074995349053 -0.44991939670754766 … -0.6373277792840262 -0.44991939670754755;;; -0.7027113227215003 -1.2958067582395993 … -0.29820348948264164 -0.41363732856086527; -1.295806758239599 -2.919672393692103 … -0.35372958475399263 -0.6373277792840262; … ; -0.29820348948264164 -0.35372958475399324 … -0.4903726081715591 -0.35372958475399313; -0.413637328560865 -0.6373277792840262 … -0.3537295847539925 -0.3245845695551738;;; … ;;; -1.0166744213267949 -0.5332878143865682 … -3.636138257229727 -1.9987602621206995; -0.5332878143865679 -0.32174124756052463 … -1.4667339408300113 -0.9061938942137764; … ; -3.636138257229727 -1.4667339408300113 … -10.988177824553325 -8.087376168318155; -1.998760262120699 -0.9061938942137764 … -8.087376168318155 -4.647878371225811;;; -0.7027113227215003 -0.4136373285608651 … -2.396761682645675 -1.295806758239599; -0.41363732856086494 -0.32458456955517395 … -1.0113572986755648 -0.6373277792840262; … ; -2.396761682645675 -1.011357298675565 … -11.002806190962431 -6.077304186453727; -1.2958067582395987 -0.637327779284026 … -6.077304186453727 -2.919672393692103;;; -0.4868367444337811 -0.38233074995349087 … -1.295806758239599 -0.7744303951520541; -0.3823307499534906 -0.4499193967075477 … -0.6373277792840262 -0.44991939670754755; … ; -1.295806758239599 -0.6373277792840263 … -6.077304186453725 -2.9196723936921023; -0.7744303951520537 -0.44991939670754744 … -2.9196723936921023 -1.4814477484523993]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.10731152081680254 + 0.17018629024992216im 0.03413048225426768 + 0.0766470608262946im … 0.024320126600593087 - 0.012272660149488697im 0.09008494860754218 + 0.07063430530578989im; 0.046692571877852196 + 0.09166428454057843im -0.004018578607183378 - 0.001541433398053026im … -0.0020970076783463536 - 0.011731546332103476im 0.0217157254859278 + 0.03232495630145006im; … ; 0.0897107356835814 + 0.06589788052907812im 0.05308774264718171 + 0.054238503659660486im … -0.010594371285432311 - 0.016801707709504687im 0.048445771613685754 - 0.001807277442160585im; 0.17454444202379332 + 0.17160055004969876im 0.08022993316692859 + 0.10227517136931599im … 0.05148172505527983 + 0.0018220222355514793im 0.1354595629114213 + 0.0519591363939695im;;; -0.05479159252544051 - 0.09980694015438146im -0.10639200494449522 - 0.16286004914928962im … 0.009964400836408718 - 0.009511993174307612im -0.008019435232199862 - 0.06161734459364597im; -0.05019731177891298 - 0.09568267293098764im -0.07966968196235177 - 0.12139873255713686im … -0.008488893891049142 - 0.02337066973653374im -0.01907590408739996 - 0.05111152964030583im; … ; 0.058461262466058185 + 0.048463088140957525im 0.019864818327699842 + 0.010524487728421336im … 0.030521538267057922 + 0.03550086020969564im 0.06355009248865212 + 0.057823907492031604im; 0.040486308761885165 - 0.0036316451674084206im -0.024832889434013045 - 0.057993659875829905im … 0.048150112954987584 + 0.03941415815899814im 0.08041037257899811 + 0.04463963827232484im;;; -0.07939362947766095 - 0.140989992574919im -0.0600376538782725 - 0.0690702464158065im … -0.011195976923563562 - 0.03219366489688215im -0.04312955157972126 - 0.09361881917404324im; -0.022280418410691817 - 0.023933742505527204im -0.0010705720940047013 + 0.0551768746796416im … -0.011895123368338107 - 0.02805518418379553im -0.02073772469516478 - 0.04477012849940736im; … ; 0.003125703072123312 - 0.015072957823772586im -0.012212170311007143 - 0.028434194779045924im … 0.018563645877006367 + 0.020495297603318956im 0.018450262362119878 + 0.009844380956311568im; -0.04149916899252153 - 0.09166979484377191im -0.047806840185161195 - 0.07712962798410158im … 0.00983752752580638 - 0.0004516255480442044im -0.008768777781034996 - 0.04341856312998718im;;; … ;;; -0.015418043271012882 - 0.04491650016583236im -0.0058649341064498026 - 0.0168294517935198im … 0.0036142062659787816 + 0.007723661541992391im -0.012130963040288701 - 0.03943482987525697im; -0.008800866662956108 - 0.020339182703068212im -0.00041643610315979506 + 0.0004473697208251882im … -0.003787629516680627 - 0.014352638253521734im -0.011504000990714448 - 0.03084818131076833im; … ; -0.011353333798111515 - 0.010169132606499667im -0.00975496316756952 - 0.021486226604798875im … 0.019415258097890693 + 0.11637709093273692im 0.0023783729838377002 + 0.056207140536260046im; -0.016169934167308407 - 0.044263176808418285im -0.009658940844690708 - 0.028642522593764083im … 0.013954941830973507 + 0.0700462327154649im -0.006054298776335171 - 0.003965899368784215im;;; -0.014321557622121254 - 0.062368201897027103im 0.009070074415846664 + 0.011013105281202131im … -0.014696524043368624 - 0.05552712495380478im -0.03747968275680391 - 0.13164793934198576im; 5.839545172355602e-5 + 0.0002401850248777665im 0.012642412595292946 + 0.02828762796950175im … -0.013249675347429268 - 0.03896931905340906im -0.017591535035006177 - 0.04573652869598366im; … ; -0.03773399073577617 - 0.0830670305628087im -0.00969704435849615 - 0.034722361837930454im … -0.01819313449746022 + 0.11344361540668435im -0.054649565956224985 - 0.04666992663491497im; -0.030467667352688195 - 0.12326549595154668im 0.00035975650412830814 - 0.024276838747808758im … -0.016892330887138693 - 0.0015334225314328532im -0.055835293024165705 - 0.17250078518933432im;;; 0.06791254833894232 + 0.07251988004317937im 0.05187681304985135 + 0.09488201933022489im … -0.01626191458402001 - 0.09580115019801969im -0.002396525046338017 - 0.12296980256472984im; 0.03936816691334956 + 0.07992868584222114im 0.031119264613735004 + 0.0632462301533029im … -0.012702784111024379 - 0.037666319279957255im 0.0006760560847584254 - 0.00916559336803351im; … ; -0.010504929510626794 - 0.0889190199396484im 0.020605877222785215 + 0.0021521826517494147im … -0.08325178794839355 - 0.05645247588003226im -0.08588389114938226 - 0.1851032763669259im; 0.053798167745479866 - 0.05579242621983892im 0.05199783622605843 + 0.052186508287465364im … -0.03737814722550971 - 0.12711757685993347im -0.024255886745666446 - 0.22882333185459208im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3915556365712025 0.3785174204827321 … 0.34469959997331306 0.3785174204827322; 0.3785174204827322 0.3664584402989882 … 0.32735728141432974 0.3636495422201065; … ; 0.3446995999733131 0.32735728141432974 … 0.3075192693027155 0.33438053176539934; 0.3785174204827321 0.36364954222010637 … 0.33438053176539934 0.3664584402989882;;; 0.3785174204827322 0.36645844029898816 … 0.3273572814143296 0.3636495422201064; 0.3664584402989882 0.3510288631503096 … 0.3111940131642293 0.35191706599025635; … ; 0.32735728141432974 0.31119401316422923 … 0.298241228272315 0.3214260025664263; 0.3636495422201064 0.35191706599025624 … 0.3214260025664263 0.35191706599025624;;; 0.34469959997331306 0.33438053176539934 … 0.28653515351121744 0.3273572814143297; 0.3343805317653994 0.31861604761030793 … 0.27805891860290555 0.32142600256642634; … ; 0.2865351535112175 0.2780589186029055 … 0.25590185758798834 0.2780589186029055; 0.3273572814143296 0.3214260025664263 … 0.2780589186029055 0.31119401316422923;;; … ;;; 0.30487474913873486 0.2830366687882853 … 0.28556433227786343 0.30095737042332693; 0.2830366687882854 0.25898431603615374 … 0.2726330012533779 0.28541419651262123; … ; 0.2855643322778635 0.2726330012533779 … 0.2771603890765679 0.2812108737304586; 0.300957370423327 0.2854141965126212 … 0.28121087373045855 0.2930827262022484;;; 0.3446995999733131 0.3273572814143296 … 0.3075192693027155 0.3343805317653994; 0.3273572814143297 0.3111940131642293 … 0.29824122827231503 0.3214260025664264; … ; 0.30751926930271556 0.29824122827231503 … 0.277160389076568 0.29313119138758603; 0.3343805317653994 0.32142600256642634 … 0.293131191387586 0.31861604761030793;;; 0.3785174204827322 0.3636495422201064 … 0.33438053176539934 0.3664584402989882; 0.3636495422201065 0.35191706599025624 … 0.3214260025664263 0.35191706599025635; … ; 0.33438053176539934 0.32142600256642634 … 0.29313119138758603 0.318616047610308; 0.36645844029898816 0.3519170659902563 … 0.318616047610308 0.3510288631503096]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081920320465 -0.4966565569652615 … -0.477191900770388 -0.4966565569652615; -0.4966565569652615 -0.48481820847339957 … -0.4763804455803998 -0.4920413109279808; … ; -0.477191900770388 -0.4763804455803998 … -0.4122880708157049 -0.45507008139957267; -0.49665655696526156 -0.4920413109279808 … -0.45507008139957267 -0.4848182084733995;;; -0.4966565569652615 -0.48481820847339957 … -0.4763804455803998 -0.4920413109279808; -0.48481820847339957 -0.4583744077079642 … -0.4706560155312527 -0.48617902495353255; … ; -0.4763804455803998 -0.4706560155312527 … -0.4463984363601503 -0.46889439623369206; -0.4920413109279808 -0.48617902495353255 … -0.46889439623369206 -0.48617902495353255;;; -0.477191900770388 -0.45507008139957283 … -0.4605141232770139 -0.47638044558039994; -0.45507008139957267 -0.4090661823246692 … -0.45671990819309505 -0.46889439623369206; … ; -0.4605141232770139 -0.45671990819309505 … -0.4451449565327359 -0.45671990819309505; -0.4763804455803998 -0.46889439623369206 … -0.45671990819309505 -0.4706560155312527;;; … ;;; -0.4494759507616207 -0.4551499721073651 … -0.37125986268508815 -0.4177457151777524; -0.4551499721073651 -0.44880351089776616 … -0.41743801075997783 -0.4441260992516665; … ; -0.37125986268508826 -0.4174380107599777 … -0.25365698331036785 -0.299798091116242; -0.4177457151777524 -0.4441260992516665 … -0.299798091116242 -0.3610634326611559;;; -0.477191900770388 -0.47638044558039994 … -0.41228807081570495 -0.45507008139957283; -0.47638044558039994 -0.4706560155312527 … -0.4463984363601503 -0.46889439623369206; … ; -0.41228807081570495 -0.4463984363601503 … -0.25365698331036785 -0.3410633022778508; -0.45507008139957267 -0.46889439623369206 … -0.34106330227785087 -0.4090661823246692;;; -0.4966565569652615 -0.4920413109279808 … -0.45507008139957283 -0.48481820847339957; -0.4920413109279808 -0.48617902495353255 … -0.46889439623369206 -0.48617902495353255; … ; -0.45507008139957283 -0.46889439623369206 … -0.34106330227785076 -0.4090661823246692; -0.4848182084733995 -0.48617902495353255 … -0.4090661823246692 -0.4583744077079641])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.412913921448412 -0.4868367444337812 … -0.7027113227215003 -0.4868367444337813; -0.48683674443378094 -0.7744303951520541 … -0.4136373285608649 -0.38233074995349065; … ; -0.7027113227215005 -0.4136373285608651 … -2.3967616826456744 -1.2958067582395987; -0.48683674443378094 -0.38233074995349065 … -1.295806758239599 -0.7744303951520538;;; -0.48683674443378105 -0.7744303951520541 … -0.413637328560865 -0.382330749953491; -0.7744303951520539 -1.4814477484523993 … -0.3245845695551737 -0.44991939670754755; … ; -0.413637328560865 -0.3245845695551741 … -1.0113572986755648 -0.6373277792840264; -0.38233074995349053 -0.44991939670754766 … -0.6373277792840262 -0.44991939670754755;;; -0.7027113227215003 -1.2958067582395993 … -0.29820348948264164 -0.41363732856086527; -1.295806758239599 -2.919672393692103 … -0.35372958475399263 -0.6373277792840262; … ; -0.29820348948264164 -0.35372958475399324 … -0.4903726081715591 -0.35372958475399313; -0.413637328560865 -0.6373277792840262 … -0.3537295847539925 -0.3245845695551738;;; … ;;; -1.0166744213267949 -0.5332878143865682 … -3.636138257229727 -1.9987602621206995; -0.5332878143865679 -0.32174124756052463 … -1.4667339408300113 -0.9061938942137764; … ; -3.636138257229727 -1.4667339408300113 … -10.988177824553325 -8.087376168318155; -1.998760262120699 -0.9061938942137764 … -8.087376168318155 -4.647878371225811;;; -0.7027113227215003 -0.4136373285608651 … -2.396761682645675 -1.295806758239599; -0.41363732856086494 -0.32458456955517395 … -1.0113572986755648 -0.6373277792840262; … ; -2.396761682645675 -1.011357298675565 … -11.002806190962431 -6.077304186453727; -1.2958067582395987 -0.637327779284026 … -6.077304186453727 -2.919672393692103;;; -0.4868367444337811 -0.38233074995349087 … -1.295806758239599 -0.7744303951520541; -0.3823307499534906 -0.4499193967075477 … -0.6373277792840262 -0.44991939670754755; … ; -1.295806758239599 -0.6373277792840263 … -6.077304186453725 -2.9196723936921023; -0.7744303951520537 -0.44991939670754744 … -2.9196723936921023 -1.4814477484523993]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.04438334769326038 + 0.02313206809298758im 0.05557604973437895 + 0.024235838275490577im … -0.21292979894024805 - 0.03102892060912727im -0.3248112553275101 - 0.036090886548310816im; 0.21535517130670526 + 0.08232187927603538im 0.1331057072324573 + 0.046981218441658895im … -0.12661086047511405 - 0.01156660288332643im -0.06557758833674966 + 0.025165933164371556im; … ; -0.011597237136601872 + 0.0010551641474725597im 0.0017100371417407632 + 0.0009680143087110453im … 0.05686715394260114 + 0.0067170362540796445im -0.00581229982854719 + 0.0015474259952800553im; -0.0832974670528179 - 0.006207367392949545im 0.0012031803152520743 + 0.002642979905900441im … -0.02219521772252901 - 0.005084898398972041im -0.19562658787663517 - 0.025081943495795594im;;; 0.14713886897113088 + 0.025016795268892167im 0.11196889222660436 + 0.012541887334647948im … -0.14444571186667554 - 0.013060230767526083im -0.12613227063130011 - 0.007455043993146028im; 0.38864921680903275 + 0.06200601802443368im 0.16062350735269262 + 0.012074858354502133im … -0.04819750796403023 - 0.0007085918332478335im 0.1420777779164462 + 0.030189393122168656im; … ; -0.019807358418978772 - 0.0003168197018434358im -0.0027298892913712085 - 0.0009505382422674983im … -0.004969825786339292 + 0.0025155315731576087im -0.03495227859299771 + 0.00019464883170072897im; -0.026132056734115963 - 0.00248749516781597im 0.01601749615616267 - 0.0003790544605809597im … -0.08303208618687548 - 0.005481481591818822im -0.12989939794260544 - 0.010643276827748958im;;; 0.1334062979111436 + 0.008406872308920732im 0.062284714255634394 + 0.0027623369811877294im … -0.03162882146550117 - 0.003655428520244182im 0.04336138202389023 + 0.001124811113532835im; 0.20393356186288397 + 0.016397318793255674im 0.008679366928027017 - 0.0058450537727658715im … 0.024001703734519757 + 0.0021477973596898225im 0.1396658924203292 + 0.012536471601517675im; … ; -0.007221573529677707 - 0.0018547379579945393im 0.0019032801161415684 - 0.0018877843734403568im … -0.018925682605537668 + 3.873919156608427e-5im -0.022643678037518017 - 0.0013062008166158797im; 0.021795621299365874 - 0.0020625424958472536im 0.023366919028481457 - 0.0013050278552499534im … -0.04368207866253579 - 0.0034274160869665147im -0.0264278234524083 - 0.004277066657037231im;;; … ;;; -0.003593411026720723 - 0.008067791922297101im 0.011880249811587956 - 0.002824496880325482im … -0.004980674558127561 + 0.00522049292459939im -0.017914083696453822 - 0.0062375904335426405im; 0.006817434232554624 - 0.006158849171223876im 0.014632331957120397 - 0.00010560071574531853im … -0.006566485285191248 - 0.003962180334286494im -0.008141409822938886 - 0.009603998032175914im; … ; -0.017000604168885776 + 0.00015080478610099188im -0.004651888220602113 - 0.0005400182479210415im … -0.018671221579263382 + 0.0050521756918938746im -0.021199430224186362 + 0.003887617315498467im; -0.012954611696750041 - 0.002714115177497585im 0.003679128508312674 - 0.001976414928100335im … -0.006517123766858052 + 0.013627741594834543im -0.020211954038509106 + 0.00428833239780408im;;; 0.007753859914310483 - 0.01913806933823757im 0.028503381925961673 - 0.0005920986323272356im … 0.019863762393898532 - 0.007521358108052414im -0.031316164359501214 - 0.03517302920417635im; 0.025350129012546754 - 0.002823531641122529im 0.0281772247486339 + 0.007693197434806697im … -0.01216712374839534 - 0.015408885772976489im -0.017005009237284683 - 0.02180819263511939im; … ; -0.002054968805884877 - 0.0006907493691915773im 0.007344746855716288 - 0.0002085409030625962im … 0.014533277643000851 + 0.011596684594228888im 0.0015876407793681971 + 0.004391068912060878im; 0.00539802868172168 - 0.009708096944638471im 0.020138571699743986 - 0.0020127313261320877im … 0.06790994949334074 + 0.02004734661356536im 0.008679367152572195 - 0.005845053556166314im;;; -0.03717425408800488 - 0.015387468522690372im 0.03385118187395171 + 0.010661750718234709im … -0.03246065041021375 - 0.03313083569824787im -0.2001352203769447 - 0.06706456141583109im; 0.07531522247043161 + 0.036705336545429845im 0.05408113645009936 + 0.029688078505611247im … -0.06428256431133098 - 0.023166414125414855im -0.07368074855098092 - 0.017108184617584447im; … ; 0.012267505016684582 - 0.0003799386789773924im 0.012700400401108897 + 0.0009001749663285921im … 0.09865363986597513 + 0.011481718610739943im 0.04147382159716238 + 0.002075817956298392im; -0.014399660326098022 - 0.01516003826749117im 0.019276543784936765 + 0.0003353783059559999im … 0.14557970031663908 + 0.006933195837110697im -0.02368961542493043 - 0.028329405208737737im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729845), converged = true, ρ = [0.09132316901297283 0.08747419119230067 … 0.07684754925808819 0.08747419119230067; 0.08747419119230067 0.0808996685933202 … 0.07642471007277711 0.0848694482093986; … ; 0.07684754925808818 0.07642471007277711 … 0.04778466664903945 0.06587895334944574; 0.08747419119230064 0.0848694482093986 … 0.06587895334944574 0.08089966859332019;;; 0.08747419119230067 0.0808996685933202 … 0.07642471007277711 0.08486944820939861; 0.0808996685933202 0.06744471459892312 … 0.0734866992586924 0.08163768616932704; … ; 0.07642471007277711 0.0734866992586924 … 0.061888041165701464 0.07259829020520221; 0.08486944820939858 0.08163768616932704 … 0.07259829020520223 0.08163768616932703;;; 0.07684754925808819 0.06587895334944575 … 0.06847203691944467 0.07642471007277714; 0.06587895334944574 0.04657864260733752 … 0.06665759365564623 0.07259829020520223; … ; 0.06847203691944467 0.06665759365564623 … 0.06132515311213558 0.06665759365564623; 0.0764247100727771 0.07259829020520223 … 0.06665759365564623 0.07348669925869239;;; … ;;; 0.063284952262594 0.06591651441526455 … 0.03394064890059686 0.04987593485026547; 0.06591651441526454 0.06297790955549377 … 0.04975639790334859 0.06087020455047955; … ; 0.033940648900596865 0.049756397903348584 … 0.009696353217397372 0.01683133880305746; 0.04987593485026545 0.06087020455047955 … 0.016831338803057455 0.030985721888736627;;; 0.07684754925808819 0.07642471007277712 … 0.04778466664903947 0.06587895334944575; 0.07642471007277712 0.0734866992586924 … 0.061888041165701464 0.07259829020520223; … ; 0.04778466664903947 0.061888041165701464 … 0.009696353217397376 0.025710010669622727; 0.06587895334944574 0.07259829020520223 … 0.025710010669622724 0.04657864260733752;;; 0.08747419119230067 0.08486944820939861 … 0.06587895334944575 0.0808996685933202; 0.08486944820939861 0.08163768616932704 … 0.07259829020520221 0.08163768616932704; … ; 0.06587895334944575 0.07259829020520221 … 0.025710010669622717 0.04657864260733752; 0.08089966859332018 0.08163768616932704 … 0.04657864260733752 0.06744471459892311;;;;], ψ = Matrix{ComplexF64}[[0.9516149582170483 - 0.08611409270339244im 4.785290566577949e-10 + 7.199479068464854e-10im -4.3260961479774096e-10 - 5.4169821406269136e-11im -1.4040107965129778e-10 - 4.33322544513004e-10im; 0.09589823546114158 - 0.008678077558959732im 0.17105026814381064 + 0.04030695329401607im 0.1902194526523308 - 0.41838853258994935im 0.09921964387711953 - 0.01591492166741275im; … ; 0.011746264328442946 - 0.0010629496788089644im -0.01767930989459169 - 0.03956312083686288im 0.00035287344322526733 + 0.0347909487603915im 0.017875330517979064 - 0.01003183238542273im; -0.09589823545165124 + 0.008678078340205932im -0.002034081424311123 - 0.3470247690191473im 0.19367416862400505 - 0.07777744012530012im 0.274223144992764 - 0.11412878873807128im], [0.8860525524315804 + 0.2783275471685977im 0.04840342006676071 + 0.1910897133069097im -2.3595095322015425e-9 + 3.403123338685532e-9im -4.070211265250201e-9 - 2.6200202402591743e-10im; 0.06040391069720586 + 0.01897412604205332im -0.0021542999381374793 - 0.008504863330352132im -3.3316504381708523e-9 + 3.1730075095159904e-9im -5.08865609198661e-9 - 2.7496601906181264e-9im; … ; 0.0073945306404880826 + 0.002322775870913938im 0.02118056036420268 + 0.08361779490427625im -0.0028127822996948625 - 0.04986186069897628im -0.03553404820873087 - 0.07675290311583147im; -0.10774156998708898 - 0.03384386960329962im -0.022272981908086853 - 0.08793051235217093im -0.01761500381304831 - 0.3122591694656831im -0.22253145011261552 - 0.480663920318959im], [-0.4980371885129091 - 0.789841573856678im 1.0817950008013e-9 - 1.2062649733246555e-9im -1.0106569470202942e-9 + 2.305190482942976e-9im -2.740361521036405e-9 + 2.1391415444549366e-9im; -0.03666861295331626 - 0.05815307725113963im -0.053396880678667 - 0.020481801883462585im -0.008669618818697756 - 0.010364008631641709im -0.03381207245391317 - 0.007779416854539127im; … ; -0.007398029527105138 - 0.011732599856247958im 6.357357799913199e-10 - 9.944416540230705e-10im 0.042484470229162505 + 0.11162325622973267im 0.0591377366512468 - 0.0019923222104312813im; 0.0817173643073945 + 0.12959628963338532im -0.26808211091339645 - 0.10283006311295105im 0.1429135733963289 + 0.5941457903982924im -0.18404567523877632 - 0.15088185342228289im], [-0.7234753357493667 + 0.36205651004965234im -1.283817357977668e-10 - 4.369661577019457e-11im 0.4728221081685984 - 0.14734148676498282im 4.679945320162915e-11 + 2.64723767212649e-10im; -0.34650598304492836 + 0.17340570038982978im -0.61205300489002 - 0.13417140741239253im -0.514359167554962 + 0.16028532235138415im -2.0289946112139745e-10 - 1.0185448040544998e-9im; … ; -0.010189026066344137 + 0.0050990031979820365im -0.001605517200043364 - 0.00035195423261953716im -0.01992962357431862 + 0.0062104969787044086im -0.009196414627930588 + 0.00024677446554932463im; 0.05828825366973728 - 0.02916981447567708im -0.012195531740821327 - 0.002673447333897336im -0.12045764642053777 + 0.037537179850550384im -0.17862932759975275 + 0.004793298217711211im]], eigenvalues = Any[[-0.16677707600165315, 0.2642777177676697, 0.2642777177676698, 0.2642777177676703], [-0.11613218765380026, 0.07040532315983936, 0.22624813597436919, 0.2262481359743693], [-0.09588938147955486, 0.08764319962300775, 0.17312704138204843, 0.17312704138204876], [-0.04505146353686523, 0.022269526189821393, 0.09831189249163008, 0.18446409317315188]], occupation = [[2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0]], εF = nothing, optim_res =  * Status: success

 * Candidate solution
    Final objective value:     -7.852647e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 1.30e-08 ≰ 1.0e-12
    |x - x&#39;|/|x&#39;|          = 1.88e-08 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 0.00e+00 ≰ -1.0e+00
    |g(x)|                 = 1.37e-08 ≰ -1.0e+00

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    40
    f(x) calls:    44
    ∇f(x) calls:   42
)</code></pre><p>Start not too far from the solution to ensure convergence: We run first a very crude SCF to get close and then switch to Newton.</p><pre><code class="language-julia hljs">scfres_start = self_consistent_field(basis; tol=1e-1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39299406531326236 0.3796996243148763 … 0.34520016130233183 0.37969962431487636; 0.37969962431487636 0.3671387526602761 … 0.3281717223730257 0.36487613240863603; … ; 0.34520016130233194 0.3281717223730258 … 0.3067083671261115 0.33426846065189253; 0.37969962431487636 0.364876132408636 … 0.33426846065189253 0.3671387526602761;;; 0.3796996243148763 0.36713875266027607 … 0.3281717223730258 0.3648761324086361; 0.3671387526602761 0.35109154160050654 … 0.3120782646592722 0.3528973242584148; … ; 0.32817172237302583 0.3120782646592723 … 0.2978193323728761 0.321751462617338; 0.3648761324086361 0.3528973242584148 … 0.32175146261733795 0.35289732425841486;;; 0.3452001613023319 0.3342684606518925 … 0.287282737348887 0.3281717223730257; 0.33426846065189253 0.3179604552305686 … 0.27858858420244614 0.32175146261733795; … ; 0.28728273734888704 0.2785885842024462 … 0.2558535046270577 0.27858858420244625; 0.3281717223730257 0.3217514626173379 … 0.2785885842024462 0.31207826465927224;;; … ;;; 0.3045410626009347 0.28314800606185475 … 0.28427876678867203 0.30010147802557285; 0.2831480060618548 0.25943237836624256 … 0.27151924572921055 0.28493919404249235; … ; 0.2842787667886721 0.2715192457292105 … 0.2758676109938596 0.2799049944345782; 0.30010147802557285 0.2849391940424923 … 0.27990499443457817 0.29193452001986925;;; 0.34520016130233194 0.3281717223730257 … 0.3067083671261114 0.3342684606518925; 0.3281717223730258 0.31207826465927224 … 0.2978193323728761 0.32175146261733795; … ; 0.3067083671261115 0.29781933237287617 … 0.2758676109938596 0.29201106100286345; 0.3342684606518925 0.3217514626173379 … 0.2920110610028634 0.3179604552305686;;; 0.37969962431487636 0.3648761324086361 … 0.3342684606518925 0.36713875266027607; 0.3648761324086361 0.35289732425841486 … 0.3217514626173379 0.35289732425841486; … ; 0.3342684606518926 0.32175146261733795 … 0.29201106100286345 0.31796045523056865; 0.36713875266027607 0.35289732425841475 … 0.31796045523056854 0.3510915416005066]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5045317794066653 -0.49777301685533176 … -0.4779471585966819 -0.49777301685533176; -0.49777301685533176 -0.4857656524188779 … -0.4772011465618634 -0.4931176670010844; … ; -0.477947158596682 -0.4772011465618633 … -0.41221738149263654 -0.4555639355260448; -0.49777301685533176 -0.4931176670010844 … -0.4555639355260448 -0.4857656524188779;;; -0.49777301685533176 -0.4857656524188779 … -0.4772011465618633 -0.4931176670010844; -0.4857656524188779 -0.45913091526166533 … -0.4714823650077671 -0.4871396373815192; … ; -0.4772011465618633 -0.471482365007767 … -0.4464381207769059 -0.469471852293673; -0.4931176670010844 -0.4871396373815192 … -0.469471852293673 -0.4871396373815192;;; -0.4779471585966819 -0.45556393552604485 … -0.46123525452122655 -0.4772011465618634; -0.4555639355260448 -0.4093328579284352 … -0.4573083409677039 -0.469471852293673; … ; -0.46123525452122655 -0.4573083409677039 … -0.44531216166942433 -0.4573083409677039; -0.4772011465618633 -0.469471852293673 … -0.4573083409677039 -0.471482365007767;;; … ;;; -0.44959216824690335 -0.4554584369460895 … -0.37046134684923904 -0.41751799377486415; -0.4554584369460895 -0.4492936459844143 … -0.4167115860699846 -0.4440433257019234; … ; -0.3704613468492389 -0.4167115860699846 … -0.25284959616808916 -0.2990072434529609; -0.41751799377486415 -0.44404332570192334 … -0.2990072434529609 -0.36062928564992514;;; -0.4779471585966819 -0.4772011465618634 … -0.4122173814926366 -0.45556393552604485; -0.4772011465618634 -0.471482365007767 … -0.4464381207769059 -0.469471852293673; … ; -0.4122173814926366 -0.4464381207769059 … -0.2528495961680892 -0.34079427719122585; -0.4555639355260448 -0.469471852293673 … -0.34079427719122585 -0.4093328579284352;;; -0.49777301685533176 -0.49311766700108445 … -0.45556393552604485 -0.4857656524188779; -0.49311766700108445 -0.4871396373815192 … -0.469471852293673 -0.4871396373815192; … ; -0.45556393552604485 -0.469471852293673 … -0.3407942771912259 -0.4093328579284352; -0.4857656524188779 -0.4871396373815192 … -0.4093328579284352 -0.45913091526166533])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41269908008097095 -0.4867710004917073 … -0.7029660192187754 -0.48677100049170735; -0.486771000491707 -0.7746975267362446 … -0.4136435885836325 -0.38218051583806467; … ; -0.7029660192187757 -0.41364358858363254 … -2.39750189549921 -1.2964126834795775; -0.4867710004917069 -0.3821805158380646 … -1.296412683479578 -0.7746975267362444;;; -0.4867710004917072 -0.7746975267362446 … -0.4136435885836323 -0.3821805158380649; -0.7746975267362444 -1.4821415775559037 … -0.32452666753664516 -0.44989975086737577; … ; -0.41364358858363237 -0.3245266675366454 … -1.0118188789917593 -0.6375797752930956; -0.38218051583806445 -0.44989975086737577 … -0.6375797752930955 -0.4498997508673756;;; -0.7029660192187754 -1.2964126834795782 … -0.29817703688918473 -0.4136435885836327; -1.296412683479578 -2.920594661675608 … -0.3537883519290609 -0.6375797752930955; … ; -0.29817703688918473 -0.3537883519290614 … -0.49058816626917817 -0.3537883519290612; -0.41364358858363237 -0.6375797752930956 … -0.35378835192906066 -0.32452666753664505;;; … ;;; -1.0171243253498778 -0.5334849419517231 … -3.6366253068830696 -1.9993884331155651; -0.5334849419517229 -0.32178332031708395 … -1.4671212716641855 -0.9065861231341621; … ; -3.636625306883069 -1.4671212716641857 … -10.988663215493755 -8.087891199950754; -1.999388433115565 -0.9065861231341621 … -8.087891199950754 -4.648592430396961;;; -0.7029660192187754 -0.4136435885836325 … -2.397501895499211 -1.296412683479578; -0.4136435885836323 -0.32452666753664533 … -1.0118188789917593 -0.6375797752930955; … ; -2.3975018954992104 -1.0118188789917595 … -11.003291581902861 -6.078155291751824; -1.2964126834795777 -0.6375797752930954 … -6.078155291751824 -2.920594661675608;;; -0.4867710004917072 -0.38218051583806484 … -1.296412683479578 -0.7746975267362446; -0.3821805158380646 -0.44989975086737577 … -0.6375797752930955 -0.4498997508673757; … ; -1.2964126834795777 -0.6375797752930956 … -6.078155291751823 -2.920594661675608; -0.7746975267362443 -0.44989975086737566 … -2.920594661675608 -1.4821415775559037]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39299406531326236 0.3796996243148763 … 0.34520016130233183 0.37969962431487636; 0.37969962431487636 0.3671387526602761 … 0.3281717223730257 0.36487613240863603; … ; 0.34520016130233194 0.3281717223730258 … 0.3067083671261115 0.33426846065189253; 0.37969962431487636 0.364876132408636 … 0.33426846065189253 0.3671387526602761;;; 0.3796996243148763 0.36713875266027607 … 0.3281717223730258 0.3648761324086361; 0.3671387526602761 0.35109154160050654 … 0.3120782646592722 0.3528973242584148; … ; 0.32817172237302583 0.3120782646592723 … 0.2978193323728761 0.321751462617338; 0.3648761324086361 0.3528973242584148 … 0.32175146261733795 0.35289732425841486;;; 0.3452001613023319 0.3342684606518925 … 0.287282737348887 0.3281717223730257; 0.33426846065189253 0.3179604552305686 … 0.27858858420244614 0.32175146261733795; … ; 0.28728273734888704 0.2785885842024462 … 0.2558535046270577 0.27858858420244625; 0.3281717223730257 0.3217514626173379 … 0.2785885842024462 0.31207826465927224;;; … ;;; 0.3045410626009347 0.28314800606185475 … 0.28427876678867203 0.30010147802557285; 0.2831480060618548 0.25943237836624256 … 0.27151924572921055 0.28493919404249235; … ; 0.2842787667886721 0.2715192457292105 … 0.2758676109938596 0.2799049944345782; 0.30010147802557285 0.2849391940424923 … 0.27990499443457817 0.29193452001986925;;; 0.34520016130233194 0.3281717223730257 … 0.3067083671261114 0.3342684606518925; 0.3281717223730258 0.31207826465927224 … 0.2978193323728761 0.32175146261733795; … ; 0.3067083671261115 0.29781933237287617 … 0.2758676109938596 0.29201106100286345; 0.3342684606518925 0.3217514626173379 … 0.2920110610028634 0.3179604552305686;;; 0.37969962431487636 0.3648761324086361 … 0.3342684606518925 0.36713875266027607; 0.3648761324086361 0.35289732425841486 … 0.3217514626173379 0.35289732425841486; … ; 0.3342684606518926 0.32175146261733795 … 0.29201106100286345 0.31796045523056865; 0.36713875266027607 0.35289732425841475 … 0.31796045523056854 0.3510915416005066]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5045317794066653 -0.49777301685533176 … -0.4779471585966819 -0.49777301685533176; -0.49777301685533176 -0.4857656524188779 … -0.4772011465618634 -0.4931176670010844; … ; -0.477947158596682 -0.4772011465618633 … -0.41221738149263654 -0.4555639355260448; -0.49777301685533176 -0.4931176670010844 … -0.4555639355260448 -0.4857656524188779;;; -0.49777301685533176 -0.4857656524188779 … -0.4772011465618633 -0.4931176670010844; -0.4857656524188779 -0.45913091526166533 … -0.4714823650077671 -0.4871396373815192; … ; -0.4772011465618633 -0.471482365007767 … -0.4464381207769059 -0.469471852293673; -0.4931176670010844 -0.4871396373815192 … -0.469471852293673 -0.4871396373815192;;; -0.4779471585966819 -0.45556393552604485 … -0.46123525452122655 -0.4772011465618634; -0.4555639355260448 -0.4093328579284352 … -0.4573083409677039 -0.469471852293673; … ; -0.46123525452122655 -0.4573083409677039 … -0.44531216166942433 -0.4573083409677039; -0.4772011465618633 -0.469471852293673 … -0.4573083409677039 -0.471482365007767;;; … ;;; -0.44959216824690335 -0.4554584369460895 … -0.37046134684923904 -0.41751799377486415; -0.4554584369460895 -0.4492936459844143 … -0.4167115860699846 -0.4440433257019234; … ; -0.3704613468492389 -0.4167115860699846 … -0.25284959616808916 -0.2990072434529609; -0.41751799377486415 -0.44404332570192334 … -0.2990072434529609 -0.36062928564992514;;; -0.4779471585966819 -0.4772011465618634 … -0.4122173814926366 -0.45556393552604485; -0.4772011465618634 -0.471482365007767 … -0.4464381207769059 -0.469471852293673; … ; -0.4122173814926366 -0.4464381207769059 … -0.2528495961680892 -0.34079427719122585; -0.4555639355260448 -0.469471852293673 … -0.34079427719122585 -0.4093328579284352;;; -0.49777301685533176 -0.49311766700108445 … -0.45556393552604485 -0.4857656524188779; -0.49311766700108445 -0.4871396373815192 … -0.469471852293673 -0.4871396373815192; … ; -0.45556393552604485 -0.469471852293673 … -0.3407942771912259 -0.4093328579284352; -0.4857656524188779 -0.4871396373815192 … -0.4093328579284352 -0.45913091526166533])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41269908008097095 -0.4867710004917073 … -0.7029660192187754 -0.48677100049170735; -0.486771000491707 -0.7746975267362446 … -0.4136435885836325 -0.38218051583806467; … ; -0.7029660192187757 -0.41364358858363254 … -2.39750189549921 -1.2964126834795775; -0.4867710004917069 -0.3821805158380646 … -1.296412683479578 -0.7746975267362444;;; -0.4867710004917072 -0.7746975267362446 … -0.4136435885836323 -0.3821805158380649; -0.7746975267362444 -1.4821415775559037 … -0.32452666753664516 -0.44989975086737577; … ; -0.41364358858363237 -0.3245266675366454 … -1.0118188789917593 -0.6375797752930956; -0.38218051583806445 -0.44989975086737577 … -0.6375797752930955 -0.4498997508673756;;; -0.7029660192187754 -1.2964126834795782 … -0.29817703688918473 -0.4136435885836327; -1.296412683479578 -2.920594661675608 … -0.3537883519290609 -0.6375797752930955; … ; -0.29817703688918473 -0.3537883519290614 … -0.49058816626917817 -0.3537883519290612; -0.41364358858363237 -0.6375797752930956 … -0.35378835192906066 -0.32452666753664505;;; … ;;; -1.0171243253498778 -0.5334849419517231 … -3.6366253068830696 -1.9993884331155651; -0.5334849419517229 -0.32178332031708395 … -1.4671212716641855 -0.9065861231341621; … ; -3.636625306883069 -1.4671212716641857 … -10.988663215493755 -8.087891199950754; -1.999388433115565 -0.9065861231341621 … -8.087891199950754 -4.648592430396961;;; -0.7029660192187754 -0.4136435885836325 … -2.397501895499211 -1.296412683479578; -0.4136435885836323 -0.32452666753664533 … -1.0118188789917593 -0.6375797752930955; … ; -2.3975018954992104 -1.0118188789917595 … -11.003291581902861 -6.078155291751824; -1.2964126834795777 -0.6375797752930954 … -6.078155291751824 -2.920594661675608;;; -0.4867710004917072 -0.38218051583806484 … -1.296412683479578 -0.7746975267362446; -0.3821805158380646 -0.44989975086737577 … -0.6375797752930955 -0.4498997508673757; … ; -1.2964126834795777 -0.6375797752930956 … -6.078155291751823 -2.920594661675608; -0.7746975267362443 -0.44989975086737566 … -2.920594661675608 -1.4821415775559037]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39299406531326236 0.3796996243148763 … 0.34520016130233183 0.37969962431487636; 0.37969962431487636 0.3671387526602761 … 0.3281717223730257 0.36487613240863603; … ; 0.34520016130233194 0.3281717223730258 … 0.3067083671261115 0.33426846065189253; 0.37969962431487636 0.364876132408636 … 0.33426846065189253 0.3671387526602761;;; 0.3796996243148763 0.36713875266027607 … 0.3281717223730258 0.3648761324086361; 0.3671387526602761 0.35109154160050654 … 0.3120782646592722 0.3528973242584148; … ; 0.32817172237302583 0.3120782646592723 … 0.2978193323728761 0.321751462617338; 0.3648761324086361 0.3528973242584148 … 0.32175146261733795 0.35289732425841486;;; 0.3452001613023319 0.3342684606518925 … 0.287282737348887 0.3281717223730257; 0.33426846065189253 0.3179604552305686 … 0.27858858420244614 0.32175146261733795; … ; 0.28728273734888704 0.2785885842024462 … 0.2558535046270577 0.27858858420244625; 0.3281717223730257 0.3217514626173379 … 0.2785885842024462 0.31207826465927224;;; … ;;; 0.3045410626009347 0.28314800606185475 … 0.28427876678867203 0.30010147802557285; 0.2831480060618548 0.25943237836624256 … 0.27151924572921055 0.28493919404249235; … ; 0.2842787667886721 0.2715192457292105 … 0.2758676109938596 0.2799049944345782; 0.30010147802557285 0.2849391940424923 … 0.27990499443457817 0.29193452001986925;;; 0.34520016130233194 0.3281717223730257 … 0.3067083671261114 0.3342684606518925; 0.3281717223730258 0.31207826465927224 … 0.2978193323728761 0.32175146261733795; … ; 0.3067083671261115 0.29781933237287617 … 0.2758676109938596 0.29201106100286345; 0.3342684606518925 0.3217514626173379 … 0.2920110610028634 0.3179604552305686;;; 0.37969962431487636 0.3648761324086361 … 0.3342684606518925 0.36713875266027607; 0.3648761324086361 0.35289732425841486 … 0.3217514626173379 0.35289732425841486; … ; 0.3342684606518926 0.32175146261733795 … 0.29201106100286345 0.31796045523056865; 0.36713875266027607 0.35289732425841475 … 0.31796045523056854 0.3510915416005066]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5045317794066653 -0.49777301685533176 … -0.4779471585966819 -0.49777301685533176; -0.49777301685533176 -0.4857656524188779 … -0.4772011465618634 -0.4931176670010844; … ; -0.477947158596682 -0.4772011465618633 … -0.41221738149263654 -0.4555639355260448; -0.49777301685533176 -0.4931176670010844 … -0.4555639355260448 -0.4857656524188779;;; -0.49777301685533176 -0.4857656524188779 … -0.4772011465618633 -0.4931176670010844; -0.4857656524188779 -0.45913091526166533 … -0.4714823650077671 -0.4871396373815192; … ; -0.4772011465618633 -0.471482365007767 … -0.4464381207769059 -0.469471852293673; -0.4931176670010844 -0.4871396373815192 … -0.469471852293673 -0.4871396373815192;;; -0.4779471585966819 -0.45556393552604485 … -0.46123525452122655 -0.4772011465618634; -0.4555639355260448 -0.4093328579284352 … -0.4573083409677039 -0.469471852293673; … ; -0.46123525452122655 -0.4573083409677039 … -0.44531216166942433 -0.4573083409677039; -0.4772011465618633 -0.469471852293673 … -0.4573083409677039 -0.471482365007767;;; … ;;; -0.44959216824690335 -0.4554584369460895 … -0.37046134684923904 -0.41751799377486415; -0.4554584369460895 -0.4492936459844143 … -0.4167115860699846 -0.4440433257019234; … ; -0.3704613468492389 -0.4167115860699846 … -0.25284959616808916 -0.2990072434529609; -0.41751799377486415 -0.44404332570192334 … -0.2990072434529609 -0.36062928564992514;;; -0.4779471585966819 -0.4772011465618634 … -0.4122173814926366 -0.45556393552604485; -0.4772011465618634 -0.471482365007767 … -0.4464381207769059 -0.469471852293673; … ; -0.4122173814926366 -0.4464381207769059 … -0.2528495961680892 -0.34079427719122585; -0.4555639355260448 -0.469471852293673 … -0.34079427719122585 -0.4093328579284352;;; -0.49777301685533176 -0.49311766700108445 … -0.45556393552604485 -0.4857656524188779; -0.49311766700108445 -0.4871396373815192 … -0.469471852293673 -0.4871396373815192; … ; -0.45556393552604485 -0.469471852293673 … -0.3407942771912259 -0.4093328579284352; -0.4857656524188779 -0.4871396373815192 … -0.4093328579284352 -0.45913091526166533])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41269908008097095 -0.4867710004917073 … -0.7029660192187754 -0.48677100049170735; -0.486771000491707 -0.7746975267362446 … -0.4136435885836325 -0.38218051583806467; … ; -0.7029660192187757 -0.41364358858363254 … -2.39750189549921 -1.2964126834795775; -0.4867710004917069 -0.3821805158380646 … -1.296412683479578 -0.7746975267362444;;; -0.4867710004917072 -0.7746975267362446 … -0.4136435885836323 -0.3821805158380649; -0.7746975267362444 -1.4821415775559037 … -0.32452666753664516 -0.44989975086737577; … ; -0.41364358858363237 -0.3245266675366454 … -1.0118188789917593 -0.6375797752930956; -0.38218051583806445 -0.44989975086737577 … -0.6375797752930955 -0.4498997508673756;;; -0.7029660192187754 -1.2964126834795782 … -0.29817703688918473 -0.4136435885836327; -1.296412683479578 -2.920594661675608 … -0.3537883519290609 -0.6375797752930955; … ; -0.29817703688918473 -0.3537883519290614 … -0.49058816626917817 -0.3537883519290612; -0.41364358858363237 -0.6375797752930956 … -0.35378835192906066 -0.32452666753664505;;; … ;;; -1.0171243253498778 -0.5334849419517231 … -3.6366253068830696 -1.9993884331155651; -0.5334849419517229 -0.32178332031708395 … -1.4671212716641855 -0.9065861231341621; … ; -3.636625306883069 -1.4671212716641857 … -10.988663215493755 -8.087891199950754; -1.999388433115565 -0.9065861231341621 … -8.087891199950754 -4.648592430396961;;; -0.7029660192187754 -0.4136435885836325 … -2.397501895499211 -1.296412683479578; -0.4136435885836323 -0.32452666753664533 … -1.0118188789917593 -0.6375797752930955; … ; -2.3975018954992104 -1.0118188789917595 … -11.003291581902861 -6.078155291751824; -1.2964126834795777 -0.6375797752930954 … -6.078155291751824 -2.920594661675608;;; -0.4867710004917072 -0.38218051583806484 … -1.296412683479578 -0.7746975267362446; -0.3821805158380646 -0.44989975086737577 … -0.6375797752930955 -0.4498997508673757; … ; -1.2964126834795777 -0.6375797752930956 … -6.078155291751823 -2.920594661675608; -0.7746975267362443 -0.44989975086737566 … -2.920594661675608 -1.4821415775559037]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39299406531326236 0.3796996243148763 … 0.34520016130233183 0.37969962431487636; 0.37969962431487636 0.3671387526602761 … 0.3281717223730257 0.36487613240863603; … ; 0.34520016130233194 0.3281717223730258 … 0.3067083671261115 0.33426846065189253; 0.37969962431487636 0.364876132408636 … 0.33426846065189253 0.3671387526602761;;; 0.3796996243148763 0.36713875266027607 … 0.3281717223730258 0.3648761324086361; 0.3671387526602761 0.35109154160050654 … 0.3120782646592722 0.3528973242584148; … ; 0.32817172237302583 0.3120782646592723 … 0.2978193323728761 0.321751462617338; 0.3648761324086361 0.3528973242584148 … 0.32175146261733795 0.35289732425841486;;; 0.3452001613023319 0.3342684606518925 … 0.287282737348887 0.3281717223730257; 0.33426846065189253 0.3179604552305686 … 0.27858858420244614 0.32175146261733795; … ; 0.28728273734888704 0.2785885842024462 … 0.2558535046270577 0.27858858420244625; 0.3281717223730257 0.3217514626173379 … 0.2785885842024462 0.31207826465927224;;; … ;;; 0.3045410626009347 0.28314800606185475 … 0.28427876678867203 0.30010147802557285; 0.2831480060618548 0.25943237836624256 … 0.27151924572921055 0.28493919404249235; … ; 0.2842787667886721 0.2715192457292105 … 0.2758676109938596 0.2799049944345782; 0.30010147802557285 0.2849391940424923 … 0.27990499443457817 0.29193452001986925;;; 0.34520016130233194 0.3281717223730257 … 0.3067083671261114 0.3342684606518925; 0.3281717223730258 0.31207826465927224 … 0.2978193323728761 0.32175146261733795; … ; 0.3067083671261115 0.29781933237287617 … 0.2758676109938596 0.29201106100286345; 0.3342684606518925 0.3217514626173379 … 0.2920110610028634 0.3179604552305686;;; 0.37969962431487636 0.3648761324086361 … 0.3342684606518925 0.36713875266027607; 0.3648761324086361 0.35289732425841486 … 0.3217514626173379 0.35289732425841486; … ; 0.3342684606518926 0.32175146261733795 … 0.29201106100286345 0.31796045523056865; 0.36713875266027607 0.35289732425841475 … 0.31796045523056854 0.3510915416005066]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5045317794066653 -0.49777301685533176 … -0.4779471585966819 -0.49777301685533176; -0.49777301685533176 -0.4857656524188779 … -0.4772011465618634 -0.4931176670010844; … ; -0.477947158596682 -0.4772011465618633 … -0.41221738149263654 -0.4555639355260448; -0.49777301685533176 -0.4931176670010844 … -0.4555639355260448 -0.4857656524188779;;; -0.49777301685533176 -0.4857656524188779 … -0.4772011465618633 -0.4931176670010844; -0.4857656524188779 -0.45913091526166533 … -0.4714823650077671 -0.4871396373815192; … ; -0.4772011465618633 -0.471482365007767 … -0.4464381207769059 -0.469471852293673; -0.4931176670010844 -0.4871396373815192 … -0.469471852293673 -0.4871396373815192;;; -0.4779471585966819 -0.45556393552604485 … -0.46123525452122655 -0.4772011465618634; -0.4555639355260448 -0.4093328579284352 … -0.4573083409677039 -0.469471852293673; … ; -0.46123525452122655 -0.4573083409677039 … -0.44531216166942433 -0.4573083409677039; -0.4772011465618633 -0.469471852293673 … -0.4573083409677039 -0.471482365007767;;; … ;;; -0.44959216824690335 -0.4554584369460895 … -0.37046134684923904 -0.41751799377486415; -0.4554584369460895 -0.4492936459844143 … -0.4167115860699846 -0.4440433257019234; … ; -0.3704613468492389 -0.4167115860699846 … -0.25284959616808916 -0.2990072434529609; -0.41751799377486415 -0.44404332570192334 … -0.2990072434529609 -0.36062928564992514;;; -0.4779471585966819 -0.4772011465618634 … -0.4122173814926366 -0.45556393552604485; -0.4772011465618634 -0.471482365007767 … -0.4464381207769059 -0.469471852293673; … ; -0.4122173814926366 -0.4464381207769059 … -0.2528495961680892 -0.34079427719122585; -0.4555639355260448 -0.469471852293673 … -0.34079427719122585 -0.4093328579284352;;; -0.49777301685533176 -0.49311766700108445 … -0.45556393552604485 -0.4857656524188779; -0.49311766700108445 -0.4871396373815192 … -0.469471852293673 -0.4871396373815192; … ; -0.45556393552604485 -0.469471852293673 … -0.3407942771912259 -0.4093328579284352; -0.4857656524188779 -0.4871396373815192 … -0.4093328579284352 -0.45913091526166533])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41269908008097095 -0.4867710004917073 … -0.7029660192187754 -0.48677100049170735; -0.486771000491707 -0.7746975267362446 … -0.4136435885836325 -0.38218051583806467; … ; -0.7029660192187757 -0.41364358858363254 … -2.39750189549921 -1.2964126834795775; -0.4867710004917069 -0.3821805158380646 … -1.296412683479578 -0.7746975267362444;;; -0.4867710004917072 -0.7746975267362446 … -0.4136435885836323 -0.3821805158380649; -0.7746975267362444 -1.4821415775559037 … -0.32452666753664516 -0.44989975086737577; … ; -0.41364358858363237 -0.3245266675366454 … -1.0118188789917593 -0.6375797752930956; -0.38218051583806445 -0.44989975086737577 … -0.6375797752930955 -0.4498997508673756;;; -0.7029660192187754 -1.2964126834795782 … -0.29817703688918473 -0.4136435885836327; -1.296412683479578 -2.920594661675608 … -0.3537883519290609 -0.6375797752930955; … ; -0.29817703688918473 -0.3537883519290614 … -0.49058816626917817 -0.3537883519290612; -0.41364358858363237 -0.6375797752930956 … -0.35378835192906066 -0.32452666753664505;;; … ;;; -1.0171243253498778 -0.5334849419517231 … -3.6366253068830696 -1.9993884331155651; -0.5334849419517229 -0.32178332031708395 … -1.4671212716641855 -0.9065861231341621; … ; -3.636625306883069 -1.4671212716641857 … -10.988663215493755 -8.087891199950754; -1.999388433115565 -0.9065861231341621 … -8.087891199950754 -4.648592430396961;;; -0.7029660192187754 -0.4136435885836325 … -2.397501895499211 -1.296412683479578; -0.4136435885836323 -0.32452666753664533 … -1.0118188789917593 -0.6375797752930955; … ; -2.3975018954992104 -1.0118188789917595 … -11.003291581902861 -6.078155291751824; -1.2964126834795777 -0.6375797752930954 … -6.078155291751824 -2.920594661675608;;; -0.4867710004917072 -0.38218051583806484 … -1.296412683479578 -0.7746975267362446; -0.3821805158380646 -0.44989975086737577 … -0.6375797752930955 -0.4498997508673757; … ; -1.2964126834795777 -0.6375797752930956 … -6.078155291751823 -2.920594661675608; -0.7746975267362443 -0.44989975086737566 … -2.920594661675608 -1.4821415775559037]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852301071340516), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09204352485520001 0.08811236867081661 … 0.07724253372139912 0.08811236867081661; 0.08811236867081661 0.08141301737809718 … 0.07685237628322843 0.08547213226269923; … ; 0.07724253372139914 0.07685237628322841 … 0.0477579798916564 0.0661113754388863; 0.0881123686708166 0.08547213226269922 … 0.0661113754388863 0.08141301737809718;;; 0.08811236867081661 0.0814130173780972 … 0.07685237628322841 0.08547213226269923; 0.0814130173780972 0.06780672061261701 … 0.07390597871703784 0.08216141047141275; … ; 0.07685237628322841 0.07390597871703783 … 0.061905919162168366 0.07288869850515273; 0.08547213226269923 0.08216141047141273 … 0.07288869850515273 0.08216141047141273;;; 0.07724253372139912 0.06611137543888632 … 0.06882065524297495 0.07685237628322843; 0.0661113754388863 0.04667766716905324 … 0.06693681656036427 0.07288869850515274; … ; 0.06882065524297495 0.06693681656036425 … 0.06140003570380225 0.06693681656036425; 0.07685237628322841 0.07288869850515273 … 0.06693681656036425 0.07390597871703783;;; … ;;; 0.06333812153770083 0.06606167787801419 … 0.03370256266781046 0.04978745085730003; 0.06606167787801419 0.06320160949308289 … 0.04947497266675276 0.06083334522179374; … ; 0.033702562667810444 0.04947497266675275 … 0.009594633907886974 0.016685624074180234; 0.04978745085730001 0.06083334522179371 … 0.016685624074180228 0.030863968533270995;;; 0.07724253372139912 0.07685237628322843 … 0.04775797989165641 0.06611137543888632; 0.07685237628322843 0.07390597871703783 … 0.06190591916216838 0.07288869850515274; … ; 0.04775797989165641 0.061905919162168366 … 0.00959463390788698 0.02564358588152393; 0.0661113754388863 0.07288869850515273 … 0.02564358588152393 0.04667766716905324;;; 0.08811236867081661 0.08547213226269924 … 0.06611137543888632 0.0814130173780972; 0.08547213226269924 0.08216141047141273 … 0.07288869850515274 0.08216141047141273; … ; 0.06611137543888632 0.07288869850515273 … 0.025643585881523937 0.04667766716905324; 0.08141301737809717 0.08216141047141273 … 0.046677667169053236 0.06780672061261701;;;;], α = 0.8, eigenvalues = [[-0.16691555300388972, 0.2643064198344028, 0.264369719985348, 0.2646333687475202, 0.35734013239308915, 0.35738526308560514, 0.36943883144908074], [-0.11620768046642262, 0.07030144492738732, 0.22626897232195303, 0.22627221027236155, 0.3363494755796689, 0.3933563994841558, 0.3934706475015238], [-0.09596482851335708, 0.08788497316156788, 0.17296823261295746, 0.17299517980941345, 0.2914692779073034, 0.33732629605429454, 0.533967385557759], [-0.044957497863853, 0.022359311842007915, 0.09783721344797192, 0.18445330298490165, 0.32484630059939396, 0.5030748703387342, 0.5044518275806006]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2900120679371205, n_iter = 2, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.9372811366257167 - 0.18927387386465847im 1.5758460433643863e-5 + 7.90294787250932e-5im … 0.00011342579839989926 + 0.0001939686233799788im 0.0012214761505215143 - 0.0009793599968729808im; -0.09346558981582008 - 0.018955900987362433im -0.44642627445996147 + 0.1568298130841564im … -0.3585876572388445 + 0.09976020002364im -0.12367828590026674 - 0.087432850367113im; … ; -0.011035681264864998 - 0.0022642245394207555im 0.03594715248187706 - 0.007572790639864531im … -0.06895089236169441 + 0.0427765500016072im 0.002721267069791731 - 0.06349261648827191im; 0.09364360845504294 + 0.01894238521034553im -0.0977045116089963 + 0.08133205967720762im … -0.20721300932532538 + 0.24677489800367974im 0.13461283805775898 - 0.5145290618709388im], [0.35728397673143336 + 0.8580032951143616im -0.07622374325134079 - 0.18125029481647376im … -0.0001518615089886018 + 8.806030746974158e-5im 0.00038522503100422523 + 0.0012827847523322238im; 0.024046678039001564 + 0.05781683452198999im 0.004336055774873156 + 0.010540725943559849im … -0.00010985258656430322 + 7.693255486006018e-5im 0.0002920619780010052 + 0.004255203829552624im; … ; 0.003072969868263988 + 0.007344729501139548im -0.032963086285273856 - 0.07858851444328266im … 0.01296461790196376 + 0.06192822304928272im -0.03284699368385151 + 0.07323078058488175im; -0.04316781358856796 - 0.1035832456668865im 0.0344142892189762 + 0.08161614322241392im … 0.05693604734822525 + 0.2759532762155459im -0.14059508789913824 + 0.3460805825159139im], [-0.2641545072705249 - 0.8963634459175619im -9.465185988192636e-5 - 4.349789604678829e-5im … 0.0003538933345975336 - 0.0007481831158003683im 0.0001321672874652142 - 6.973843880308411e-5im; -0.01908464517865059 - 0.06461148498076529im -0.05277108559637858 - 0.02738410082726994im … 0.002753850656653561 - 0.007622605542900318im -0.004517349705484977 + 0.0036980386434002474im; … ; -0.004128477485330073 - 0.013959629087810904im 4.494616178062592e-5 + 4.905534090253027e-5im … -0.0024238313052878896 + 0.006275411899104198im 0.03934158034829521 + 0.050252252734312844im; 0.043039393257896415 + 0.14602185356690286im -0.2545191375524587 - 0.13181167911669045im … -0.13859145487984792 + 0.35511186465988076im 0.0922509866580505 + 0.11681976757397666im], [0.8007113630002783 - 0.11941605209859225im 0.00017853859076307247 - 3.0653724119437514e-5im … -0.019306599184019006 + 0.008247554759427836im -0.20778193750005383 + 0.09074148345323671im; 0.383045344440129 - 0.05711078362730376im 0.6261196276397469 - 0.03819642688423546im … 0.01902355698137212 - 0.008380784901589299im 0.1996160465513084 - 0.0887481405779881im; … ; 0.01117296685993809 - 0.0016865273117552047im 0.0013180848905760842 - 9.597739030072392e-5im … 0.01743945588760515 + 0.04170684218664191im -0.01494303942927812 + 0.0012034104872337848im; -0.06323663200504216 + 0.009413311245518788im 0.0134774914040783 - 0.0007944172824714645im … 0.16750567586189877 + 0.4609863088516702im -0.4183352792662001 + 0.1367443444138014im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16691555300388972, 0.2643064198344028, 0.264369719985348, 0.2646333687475202, 0.35734013239308915, 0.35738526308560514, 0.36943883144908074], [-0.11620768046642262, 0.07030144492738732, 0.22626897232195303, 0.22627221027236155, 0.3363494755796689, 0.3933563994841558, 0.3934706475015238], [-0.09596482851335708, 0.08788497316156788, 0.17296823261295746, 0.17299517980941345, 0.2914692779073034, 0.33732629605429454, 0.533967385557759], [-0.044957497863853, 0.022359311842007915, 0.09783721344797192, 0.18445330298490165, 0.32484630059939396, 0.5030748703387342, 0.5044518275806006]], X = [[-0.9372811366257167 - 0.18927387386465847im 1.5758460433643863e-5 + 7.90294787250932e-5im … 0.00011342579839989926 + 0.0001939686233799788im 0.0012214761505215143 - 0.0009793599968729808im; -0.09346558981582008 - 0.018955900987362433im -0.44642627445996147 + 0.1568298130841564im … -0.3585876572388445 + 0.09976020002364im -0.12367828590026674 - 0.087432850367113im; … ; -0.011035681264864998 - 0.0022642245394207555im 0.03594715248187706 - 0.007572790639864531im … -0.06895089236169441 + 0.0427765500016072im 0.002721267069791731 - 0.06349261648827191im; 0.09364360845504294 + 0.01894238521034553im -0.0977045116089963 + 0.08133205967720762im … -0.20721300932532538 + 0.24677489800367974im 0.13461283805775898 - 0.5145290618709388im], [0.35728397673143336 + 0.8580032951143616im -0.07622374325134079 - 0.18125029481647376im … -0.0001518615089886018 + 8.806030746974158e-5im 0.00038522503100422523 + 0.0012827847523322238im; 0.024046678039001564 + 0.05781683452198999im 0.004336055774873156 + 0.010540725943559849im … -0.00010985258656430322 + 7.693255486006018e-5im 0.0002920619780010052 + 0.004255203829552624im; … ; 0.003072969868263988 + 0.007344729501139548im -0.032963086285273856 - 0.07858851444328266im … 0.01296461790196376 + 0.06192822304928272im -0.03284699368385151 + 0.07323078058488175im; -0.04316781358856796 - 0.1035832456668865im 0.0344142892189762 + 0.08161614322241392im … 0.05693604734822525 + 0.2759532762155459im -0.14059508789913824 + 0.3460805825159139im], [-0.2641545072705249 - 0.8963634459175619im -9.465185988192636e-5 - 4.349789604678829e-5im … 0.0003538933345975336 - 0.0007481831158003683im 0.0001321672874652142 - 6.973843880308411e-5im; -0.01908464517865059 - 0.06461148498076529im -0.05277108559637858 - 0.02738410082726994im … 0.002753850656653561 - 0.007622605542900318im -0.004517349705484977 + 0.0036980386434002474im; … ; -0.004128477485330073 - 0.013959629087810904im 4.494616178062592e-5 + 4.905534090253027e-5im … -0.0024238313052878896 + 0.006275411899104198im 0.03934158034829521 + 0.050252252734312844im; 0.043039393257896415 + 0.14602185356690286im -0.2545191375524587 - 0.13181167911669045im … -0.13859145487984792 + 0.35511186465988076im 0.0922509866580505 + 0.11681976757397666im], [0.8007113630002783 - 0.11941605209859225im 0.00017853859076307247 - 3.0653724119437514e-5im … -0.019306599184019006 + 0.008247554759427836im -0.20778193750005383 + 0.09074148345323671im; 0.383045344440129 - 0.05711078362730376im 0.6261196276397469 - 0.03819642688423546im … 0.01902355698137212 - 0.008380784901589299im 0.1996160465513084 - 0.0887481405779881im; … ; 0.01117296685993809 - 0.0016865273117552047im 0.0013180848905760842 - 9.597739030072392e-5im … 0.01743945588760515 + 0.04170684218664191im -0.01494303942927812 + 0.0012034104872337848im; -0.06323663200504216 + 0.009413311245518788im 0.0134774914040783 - 0.0007944172824714645im … 0.16750567586189877 + 0.4609863088516702im -0.4183352792662001 + 0.1367443444138014im]], residual_norms = [[0.008753130940418885, 0.005659444662967312, 0.01031165708966735, 0.014350341082810414, 0.004111833944675078, 0.007622893670569051, 0.050052767334150636], [0.003989297451784541, 0.006843297800980028, 0.006023735925490771, 0.006307107714194348, 0.006096669260020809, 0.011131061454262134, 0.01522337979182702], [0.005813764182621044, 0.005699014732390284, 0.004593811438429094, 0.007388010719907256, 0.00773806734911368, 0.01867726769561861, 0.029926381775963178], [0.0049255649202359884, 0.004893281714020581, 0.008234865308791705, 0.012507582545800656, 0.041915030349135435, 0.01892637136445169, 0.05234758903993811]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 0.002735144361262968)</code></pre><p>Remove the virtual orbitals (which Newton cannot treat yet)</p><pre><code class="language-julia hljs">ψ, _ = DFTK.select_occupied_orbitals(basis, scfres_start.ψ, scfres_start.occupation)
scfres_newton = newton(basis, ψ; tol)

# Comparison of results

println(&quot;|ρ_newton - ρ_scf|  = &quot;, norm(scfres_newton.ρ - scfres_scf.ρ))
println(&quot;|ρ_newton - ρ_scfv| = &quot;, norm(scfres_newton.ρ - scfres_scfv.ρ))
println(&quot;|ρ_newton - ρ_dm|   = &quot;, norm(scfres_newton.ρ - scfres_dm.ρ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)
---   ---------------   ---------   ---------
  1   -7.852646686531                   -2.54
  2   -7.852646686730       -9.70       -5.66
  3   -7.852646686730   +    -Inf      -11.18
  4   -7.852646686730   +    -Inf      -15.86
|ρ_newton - ρ_scf|  = 1.5994248259647183e-13
|ρ_newton - ρ_scfv| = 1.691769661176488e-13
|ρ_newton - ρ_dm|   = 2.3549448444930497e-9</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scf_callbacks/">« Monitoring self-consistent field calculations</a><a class="docs-footer-nextpage" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 16 September 2022 18:19">Friday 16 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
