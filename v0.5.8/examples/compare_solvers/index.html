<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison of DFT solvers · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/compare_solvers/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../energy_cutoff_smearing/">Energy cutoff smearing</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li class="is-active"><a class="tocitem" href>Comparison of DFT solvers</a><ul class="internal"><li><a class="tocitem" href="#Density-based-self-consistent-field"><span>Density-based self-consistent field</span></a></li><li><a class="tocitem" href="#Potential-based-SCF"><span>Potential-based SCF</span></a></li><li><a class="tocitem" href="#Direct-minimization"><span>Direct minimization</span></a></li></ul></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/compare_solvers.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-of-DFT-solvers"><a class="docs-heading-anchor" href="#Comparison-of-DFT-solvers">Comparison of DFT solvers</a><a id="Comparison-of-DFT-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-DFT-solvers" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=v0.5.8/examples/compare_solvers.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/v0.5.8/examples/compare_solvers.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compare four different approaches for solving the DFT minimisation problem, namely a density-based SCF, a potential-based SCF, direct minimisation and Newton.</p><p>First we setup our problem</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra

a = 10.26  # Silicon lattice constant in Bohr
lattice = a / 2 * [[0 1 1.];
                   [1 0 1.];
                   [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=[3, 3, 3])

# Convergence we desire
tol = 1e-12
is_converged = DFTK.ScfConvergenceDensity(tol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">#512 (generic function with 1 method)</code></pre><h2 id="Density-based-self-consistent-field"><a class="docs-heading-anchor" href="#Density-based-self-consistent-field">Density-based self-consistent field</a><a id="Density-based-self-consistent-field-1"></a><a class="docs-heading-anchor-permalink" href="#Density-based-self-consistent-field" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scf = self_consistent_field(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39155563703347324 0.37851742089976637 … 0.34469960027021523 0.37851742089976637; 0.3785174208997663 0.36645844064793354 … 0.32735728172226614 0.363649542620557; … ; 0.344699600270215 0.32735728172226614 … 0.307519269418542 0.3343805319865804; 0.37851742089976625 0.363649542620557 … 0.33438053198658035 0.36645844064793354;;; 0.37851742089976637 0.36645844064793354 … 0.32735728172226636 0.3636495426205571; 0.3664584406479335 0.3510288634177285 … 0.31119401346059494 0.3519170663492043; … ; 0.32735728172226614 0.31119401346059494 … 0.29824122841224215 0.32142600281509975; 0.36364954262055693 0.3519170663492043 … 0.3214260028150997 0.3519170663492042;;; 0.3446996002702152 0.3343805319865804 … 0.28653515376394545 0.32735728172226625; 0.3343805319865804 0.3186160477629755 … 0.2780589188234929 0.3214260028150997; … ; 0.2865351537639453 0.2780589188234929 … 0.2559018577231249 0.2780589188234929; 0.32735728172226614 0.3214260028150997 … 0.2780589188234929 0.31119401346059505;;; … ;;; 0.30487474928904734 0.2830366689623851 … 0.2855643323175431 0.30095737051841326; 0.2830366689623851 0.2589843162227414 … 0.2726330012865718 0.2854141966266274; … ; 0.2855643323175429 0.2726330012865718 … 0.2771603891377035 0.2812108737837968; 0.30095737051841326 0.2854141966266274 … 0.2812108737837968 0.29308272627169624;;; 0.3446996002702151 0.3273572817222662 … 0.30751926941854213 0.33438053198658046; 0.32735728172226614 0.31119401346059505 … 0.2982412284122421 0.3214260028150997; … ; 0.30751926941854196 0.29824122841224215 … 0.2771603891377035 0.29313119147022915; 0.33438053198658035 0.3214260028150997 … 0.29313119147022915 0.3186160477629755;;; 0.37851742089976637 0.3636495426205571 … 0.3343805319865805 0.36645844064793354; 0.36364954262055704 0.3519170663492042 … 0.3214260028150997 0.3519170663492043; … ; 0.3343805319865803 0.3214260028150997 … 0.2931311914702291 0.31861604776297553; 0.36645844064793354 0.3519170663492043 … 0.3186160477629755 0.3510288634177285]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923122129 -0.4966565572257029 … -0.4771919009648911 -0.4966565572257029; -0.4966565572257029 -0.48481820871073905 … -0.4763804457667817 -0.4920413111694279; … ; -0.4771919009648911 -0.47638044576678173 … -0.41228807087391595 -0.4550700815561223; -0.4966565572257029 -0.4920413111694279 … -0.4550700815561223 -0.48481820871073905;;; -0.4966565572257029 -0.48481820871073905 … -0.4763804457667817 -0.49204131116942795; -0.48481820871073905 -0.45837440791486045 … -0.4706560157057207 -0.4861790251756236; … ; -0.4763804457667817 -0.4706560157057207 … -0.44639843643621663 -0.46889439639152497; -0.4920413111694279 -0.4861790251756236 … -0.468894396391525 -0.48617902517562367;;; -0.4771919009648911 -0.4550700815561223 … -0.4605141234226702 -0.4763804457667817; -0.4550700815561223 -0.40906618243912846 … -0.4567199083211408 -0.46889439639152497; … ; -0.46051412342267023 -0.45671990832114084 … -0.4451449566034925 -0.4567199083211408; -0.4763804457667817 -0.46889439639152497 … -0.4567199083211408 -0.4706560157057207;;; … ;;; -0.4494759508409138 -0.45514997220149267 … -0.3712598626179091 -0.41774571520276443; -0.45514997220149267 -0.44880351099771604 … -0.41743801071342207 -0.4441260992987813; … ; -0.3712598626179091 -0.41743801071342207 … -0.25365698328408026 -0.2997980910596068; -0.41774571520276443 -0.4441260992987813 … -0.29979809105960675 -0.36106343264802754;;; -0.47719190096489106 -0.4763804457667817 … -0.41228807087391595 -0.4550700815561223; -0.4763804457667817 -0.4706560157057206 … -0.44639843643621663 -0.46889439639152497; … ; -0.41228807087391595 -0.4463984364362167 … -0.25365698328408026 -0.3410633023008436; -0.4550700815561223 -0.46889439639152497 … -0.3410633023008436 -0.40906618243912857;;; -0.4966565572257029 -0.49204131116942795 … -0.4550700815561223 -0.48481820871073905; -0.4920413111694279 -0.4861790251756236 … -0.46889439639152497 -0.48617902517562367; … ; -0.4550700815561223 -0.468894396391525 … -0.34106330230084353 -0.4090661824391285; -0.48481820871073905 -0.4861790251756236 … -0.4090661824391285 -0.45837440791486045])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4129139212663077 -0.48683674427718837 … -0.7027113226191013 -0.4868367442771885; -0.4868367442771882 -0.7744303950404483 … -0.41363732843931034 -0.3823307497944872; … ; -0.7027113226191017 -0.4136373284393106 … -2.396761682588059 -1.295806758174967; -0.48683674427718815 -0.3823307497944871 … -1.2958067581749675 -0.7744303950404481;;; -0.48683674427718826 -0.7744303950404483 … -0.4136373284393101 -0.38233074979448745; -0.7744303950404481 -1.4814477483918767 … -0.32458456943327607 -0.4499193965706907; … ; -0.41363732843931045 -0.3245845694332764 … -1.0113572986117039 -0.637327779193186; -0.3823307497944871 -0.4499193965706907 … -0.6373277791931857 -0.4499193965706907;;; -0.7027113226191013 -1.2958067581749675 … -0.29820348937556995 -0.41363732843931045; -1.2958067581749675 -2.9196723936538946 … -0.353729584661451 -0.6373277791931857; … ; -0.2982034893755702 -0.35372958466145166 … -0.49037260810717914 -0.3537295846614515; -0.41363732843931034 -0.6373277791931857 … -0.3537295846614509 -0.32458456943327596;;; … ;;; -1.0166744212557757 -0.533287814306596 … -3.6361382571228686 -1.998760262050625; -0.5332878143065958 -0.3217412474738869 … -1.4667339407502618 -0.9061938941468849; … ; -3.6361382571228686 -1.4667339407502618 … -10.988177824465904 -8.08737616820818; -1.9987602620506248 -0.9061938941468849 … -8.08737616820818 -4.647878371143236;;; -0.7027113226191013 -0.4136373284393103 … -2.396761682588059 -1.2958067581749675; -0.4136373284393102 -0.32458456943327607 … -1.011357298611704 -0.6373277791931857; … ; -2.3967616825880595 -1.011357298611704 … -11.00280619087501 -6.077304186394077; -1.2958067581749673 -0.6373277791931855 … -6.077304186394077 -2.9196723936538946;;; -0.4868367442771883 -0.38233074979448733 … -1.2958067581749675 -0.7744303950404483; -0.3823307497944871 -0.4499193965706908 … -0.6373277791931857 -0.44991939657069074; … ; -1.2958067581749675 -0.637327779193186 … -6.077304186394075 -2.919672393653894; -0.7744303950404479 -0.4499193965706905 … -2.919672393653894 -1.4814477483918767]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39155563703347324 0.37851742089976637 … 0.34469960027021523 0.37851742089976637; 0.3785174208997663 0.36645844064793354 … 0.32735728172226614 0.363649542620557; … ; 0.344699600270215 0.32735728172226614 … 0.307519269418542 0.3343805319865804; 0.37851742089976625 0.363649542620557 … 0.33438053198658035 0.36645844064793354;;; 0.37851742089976637 0.36645844064793354 … 0.32735728172226636 0.3636495426205571; 0.3664584406479335 0.3510288634177285 … 0.31119401346059494 0.3519170663492043; … ; 0.32735728172226614 0.31119401346059494 … 0.29824122841224215 0.32142600281509975; 0.36364954262055693 0.3519170663492043 … 0.3214260028150997 0.3519170663492042;;; 0.3446996002702152 0.3343805319865804 … 0.28653515376394545 0.32735728172226625; 0.3343805319865804 0.3186160477629755 … 0.2780589188234929 0.3214260028150997; … ; 0.2865351537639453 0.2780589188234929 … 0.2559018577231249 0.2780589188234929; 0.32735728172226614 0.3214260028150997 … 0.2780589188234929 0.31119401346059505;;; … ;;; 0.30487474928904734 0.2830366689623851 … 0.2855643323175431 0.30095737051841326; 0.2830366689623851 0.2589843162227414 … 0.2726330012865718 0.2854141966266274; … ; 0.2855643323175429 0.2726330012865718 … 0.2771603891377035 0.2812108737837968; 0.30095737051841326 0.2854141966266274 … 0.2812108737837968 0.29308272627169624;;; 0.3446996002702151 0.3273572817222662 … 0.30751926941854213 0.33438053198658046; 0.32735728172226614 0.31119401346059505 … 0.2982412284122421 0.3214260028150997; … ; 0.30751926941854196 0.29824122841224215 … 0.2771603891377035 0.29313119147022915; 0.33438053198658035 0.3214260028150997 … 0.29313119147022915 0.3186160477629755;;; 0.37851742089976637 0.3636495426205571 … 0.3343805319865805 0.36645844064793354; 0.36364954262055704 0.3519170663492042 … 0.3214260028150997 0.3519170663492043; … ; 0.3343805319865803 0.3214260028150997 … 0.2931311914702291 0.31861604776297553; 0.36645844064793354 0.3519170663492043 … 0.3186160477629755 0.3510288634177285]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923122129 -0.4966565572257029 … -0.4771919009648911 -0.4966565572257029; -0.4966565572257029 -0.48481820871073905 … -0.4763804457667817 -0.4920413111694279; … ; -0.4771919009648911 -0.47638044576678173 … -0.41228807087391595 -0.4550700815561223; -0.4966565572257029 -0.4920413111694279 … -0.4550700815561223 -0.48481820871073905;;; -0.4966565572257029 -0.48481820871073905 … -0.4763804457667817 -0.49204131116942795; -0.48481820871073905 -0.45837440791486045 … -0.4706560157057207 -0.4861790251756236; … ; -0.4763804457667817 -0.4706560157057207 … -0.44639843643621663 -0.46889439639152497; -0.4920413111694279 -0.4861790251756236 … -0.468894396391525 -0.48617902517562367;;; -0.4771919009648911 -0.4550700815561223 … -0.4605141234226702 -0.4763804457667817; -0.4550700815561223 -0.40906618243912846 … -0.4567199083211408 -0.46889439639152497; … ; -0.46051412342267023 -0.45671990832114084 … -0.4451449566034925 -0.4567199083211408; -0.4763804457667817 -0.46889439639152497 … -0.4567199083211408 -0.4706560157057207;;; … ;;; -0.4494759508409138 -0.45514997220149267 … -0.3712598626179091 -0.41774571520276443; -0.45514997220149267 -0.44880351099771604 … -0.41743801071342207 -0.4441260992987813; … ; -0.3712598626179091 -0.41743801071342207 … -0.25365698328408026 -0.2997980910596068; -0.41774571520276443 -0.4441260992987813 … -0.29979809105960675 -0.36106343264802754;;; -0.47719190096489106 -0.4763804457667817 … -0.41228807087391595 -0.4550700815561223; -0.4763804457667817 -0.4706560157057206 … -0.44639843643621663 -0.46889439639152497; … ; -0.41228807087391595 -0.4463984364362167 … -0.25365698328408026 -0.3410633023008436; -0.4550700815561223 -0.46889439639152497 … -0.3410633023008436 -0.40906618243912857;;; -0.4966565572257029 -0.49204131116942795 … -0.4550700815561223 -0.48481820871073905; -0.4920413111694279 -0.4861790251756236 … -0.46889439639152497 -0.48617902517562367; … ; -0.4550700815561223 -0.468894396391525 … -0.34106330230084353 -0.4090661824391285; -0.48481820871073905 -0.4861790251756236 … -0.4090661824391285 -0.45837440791486045])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4129139212663077 -0.48683674427718837 … -0.7027113226191013 -0.4868367442771885; -0.4868367442771882 -0.7744303950404483 … -0.41363732843931034 -0.3823307497944872; … ; -0.7027113226191017 -0.4136373284393106 … -2.396761682588059 -1.295806758174967; -0.48683674427718815 -0.3823307497944871 … -1.2958067581749675 -0.7744303950404481;;; -0.48683674427718826 -0.7744303950404483 … -0.4136373284393101 -0.38233074979448745; -0.7744303950404481 -1.4814477483918767 … -0.32458456943327607 -0.4499193965706907; … ; -0.41363732843931045 -0.3245845694332764 … -1.0113572986117039 -0.637327779193186; -0.3823307497944871 -0.4499193965706907 … -0.6373277791931857 -0.4499193965706907;;; -0.7027113226191013 -1.2958067581749675 … -0.29820348937556995 -0.41363732843931045; -1.2958067581749675 -2.9196723936538946 … -0.353729584661451 -0.6373277791931857; … ; -0.2982034893755702 -0.35372958466145166 … -0.49037260810717914 -0.3537295846614515; -0.41363732843931034 -0.6373277791931857 … -0.3537295846614509 -0.32458456943327596;;; … ;;; -1.0166744212557757 -0.533287814306596 … -3.6361382571228686 -1.998760262050625; -0.5332878143065958 -0.3217412474738869 … -1.4667339407502618 -0.9061938941468849; … ; -3.6361382571228686 -1.4667339407502618 … -10.988177824465904 -8.08737616820818; -1.9987602620506248 -0.9061938941468849 … -8.08737616820818 -4.647878371143236;;; -0.7027113226191013 -0.4136373284393103 … -2.396761682588059 -1.2958067581749675; -0.4136373284393102 -0.32458456943327607 … -1.011357298611704 -0.6373277791931857; … ; -2.3967616825880595 -1.011357298611704 … -11.00280619087501 -6.077304186394077; -1.2958067581749673 -0.6373277791931855 … -6.077304186394077 -2.9196723936538946;;; -0.4868367442771883 -0.38233074979448733 … -1.2958067581749675 -0.7744303950404483; -0.3823307497944871 -0.4499193965706908 … -0.6373277791931857 -0.44991939657069074; … ; -1.2958067581749675 -0.637327779193186 … -6.077304186394075 -2.919672393653894; -0.7744303950404479 -0.4499193965706905 … -2.919672393653894 -1.4814477483918767]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39155563703347324 0.37851742089976637 … 0.34469960027021523 0.37851742089976637; 0.3785174208997663 0.36645844064793354 … 0.32735728172226614 0.363649542620557; … ; 0.344699600270215 0.32735728172226614 … 0.307519269418542 0.3343805319865804; 0.37851742089976625 0.363649542620557 … 0.33438053198658035 0.36645844064793354;;; 0.37851742089976637 0.36645844064793354 … 0.32735728172226636 0.3636495426205571; 0.3664584406479335 0.3510288634177285 … 0.31119401346059494 0.3519170663492043; … ; 0.32735728172226614 0.31119401346059494 … 0.29824122841224215 0.32142600281509975; 0.36364954262055693 0.3519170663492043 … 0.3214260028150997 0.3519170663492042;;; 0.3446996002702152 0.3343805319865804 … 0.28653515376394545 0.32735728172226625; 0.3343805319865804 0.3186160477629755 … 0.2780589188234929 0.3214260028150997; … ; 0.2865351537639453 0.2780589188234929 … 0.2559018577231249 0.2780589188234929; 0.32735728172226614 0.3214260028150997 … 0.2780589188234929 0.31119401346059505;;; … ;;; 0.30487474928904734 0.2830366689623851 … 0.2855643323175431 0.30095737051841326; 0.2830366689623851 0.2589843162227414 … 0.2726330012865718 0.2854141966266274; … ; 0.2855643323175429 0.2726330012865718 … 0.2771603891377035 0.2812108737837968; 0.30095737051841326 0.2854141966266274 … 0.2812108737837968 0.29308272627169624;;; 0.3446996002702151 0.3273572817222662 … 0.30751926941854213 0.33438053198658046; 0.32735728172226614 0.31119401346059505 … 0.2982412284122421 0.3214260028150997; … ; 0.30751926941854196 0.29824122841224215 … 0.2771603891377035 0.29313119147022915; 0.33438053198658035 0.3214260028150997 … 0.29313119147022915 0.3186160477629755;;; 0.37851742089976637 0.3636495426205571 … 0.3343805319865805 0.36645844064793354; 0.36364954262055704 0.3519170663492042 … 0.3214260028150997 0.3519170663492043; … ; 0.3343805319865803 0.3214260028150997 … 0.2931311914702291 0.31861604776297553; 0.36645844064793354 0.3519170663492043 … 0.3186160477629755 0.3510288634177285]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923122129 -0.4966565572257029 … -0.4771919009648911 -0.4966565572257029; -0.4966565572257029 -0.48481820871073905 … -0.4763804457667817 -0.4920413111694279; … ; -0.4771919009648911 -0.47638044576678173 … -0.41228807087391595 -0.4550700815561223; -0.4966565572257029 -0.4920413111694279 … -0.4550700815561223 -0.48481820871073905;;; -0.4966565572257029 -0.48481820871073905 … -0.4763804457667817 -0.49204131116942795; -0.48481820871073905 -0.45837440791486045 … -0.4706560157057207 -0.4861790251756236; … ; -0.4763804457667817 -0.4706560157057207 … -0.44639843643621663 -0.46889439639152497; -0.4920413111694279 -0.4861790251756236 … -0.468894396391525 -0.48617902517562367;;; -0.4771919009648911 -0.4550700815561223 … -0.4605141234226702 -0.4763804457667817; -0.4550700815561223 -0.40906618243912846 … -0.4567199083211408 -0.46889439639152497; … ; -0.46051412342267023 -0.45671990832114084 … -0.4451449566034925 -0.4567199083211408; -0.4763804457667817 -0.46889439639152497 … -0.4567199083211408 -0.4706560157057207;;; … ;;; -0.4494759508409138 -0.45514997220149267 … -0.3712598626179091 -0.41774571520276443; -0.45514997220149267 -0.44880351099771604 … -0.41743801071342207 -0.4441260992987813; … ; -0.3712598626179091 -0.41743801071342207 … -0.25365698328408026 -0.2997980910596068; -0.41774571520276443 -0.4441260992987813 … -0.29979809105960675 -0.36106343264802754;;; -0.47719190096489106 -0.4763804457667817 … -0.41228807087391595 -0.4550700815561223; -0.4763804457667817 -0.4706560157057206 … -0.44639843643621663 -0.46889439639152497; … ; -0.41228807087391595 -0.4463984364362167 … -0.25365698328408026 -0.3410633023008436; -0.4550700815561223 -0.46889439639152497 … -0.3410633023008436 -0.40906618243912857;;; -0.4966565572257029 -0.49204131116942795 … -0.4550700815561223 -0.48481820871073905; -0.4920413111694279 -0.4861790251756236 … -0.46889439639152497 -0.48617902517562367; … ; -0.4550700815561223 -0.468894396391525 … -0.34106330230084353 -0.4090661824391285; -0.48481820871073905 -0.4861790251756236 … -0.4090661824391285 -0.45837440791486045])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4129139212663077 -0.48683674427718837 … -0.7027113226191013 -0.4868367442771885; -0.4868367442771882 -0.7744303950404483 … -0.41363732843931034 -0.3823307497944872; … ; -0.7027113226191017 -0.4136373284393106 … -2.396761682588059 -1.295806758174967; -0.48683674427718815 -0.3823307497944871 … -1.2958067581749675 -0.7744303950404481;;; -0.48683674427718826 -0.7744303950404483 … -0.4136373284393101 -0.38233074979448745; -0.7744303950404481 -1.4814477483918767 … -0.32458456943327607 -0.4499193965706907; … ; -0.41363732843931045 -0.3245845694332764 … -1.0113572986117039 -0.637327779193186; -0.3823307497944871 -0.4499193965706907 … -0.6373277791931857 -0.4499193965706907;;; -0.7027113226191013 -1.2958067581749675 … -0.29820348937556995 -0.41363732843931045; -1.2958067581749675 -2.9196723936538946 … -0.353729584661451 -0.6373277791931857; … ; -0.2982034893755702 -0.35372958466145166 … -0.49037260810717914 -0.3537295846614515; -0.41363732843931034 -0.6373277791931857 … -0.3537295846614509 -0.32458456943327596;;; … ;;; -1.0166744212557757 -0.533287814306596 … -3.6361382571228686 -1.998760262050625; -0.5332878143065958 -0.3217412474738869 … -1.4667339407502618 -0.9061938941468849; … ; -3.6361382571228686 -1.4667339407502618 … -10.988177824465904 -8.08737616820818; -1.9987602620506248 -0.9061938941468849 … -8.08737616820818 -4.647878371143236;;; -0.7027113226191013 -0.4136373284393103 … -2.396761682588059 -1.2958067581749675; -0.4136373284393102 -0.32458456943327607 … -1.011357298611704 -0.6373277791931857; … ; -2.3967616825880595 -1.011357298611704 … -11.00280619087501 -6.077304186394077; -1.2958067581749673 -0.6373277791931855 … -6.077304186394077 -2.9196723936538946;;; -0.4868367442771883 -0.38233074979448733 … -1.2958067581749675 -0.7744303950404483; -0.3823307497944871 -0.4499193965706908 … -0.6373277791931857 -0.44991939657069074; … ; -1.2958067581749675 -0.637327779193186 … -6.077304186394075 -2.919672393653894; -0.7744303950404479 -0.4499193965706905 … -2.919672393653894 -1.4814477483918767]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39155563703347324 0.37851742089976637 … 0.34469960027021523 0.37851742089976637; 0.3785174208997663 0.36645844064793354 … 0.32735728172226614 0.363649542620557; … ; 0.344699600270215 0.32735728172226614 … 0.307519269418542 0.3343805319865804; 0.37851742089976625 0.363649542620557 … 0.33438053198658035 0.36645844064793354;;; 0.37851742089976637 0.36645844064793354 … 0.32735728172226636 0.3636495426205571; 0.3664584406479335 0.3510288634177285 … 0.31119401346059494 0.3519170663492043; … ; 0.32735728172226614 0.31119401346059494 … 0.29824122841224215 0.32142600281509975; 0.36364954262055693 0.3519170663492043 … 0.3214260028150997 0.3519170663492042;;; 0.3446996002702152 0.3343805319865804 … 0.28653515376394545 0.32735728172226625; 0.3343805319865804 0.3186160477629755 … 0.2780589188234929 0.3214260028150997; … ; 0.2865351537639453 0.2780589188234929 … 0.2559018577231249 0.2780589188234929; 0.32735728172226614 0.3214260028150997 … 0.2780589188234929 0.31119401346059505;;; … ;;; 0.30487474928904734 0.2830366689623851 … 0.2855643323175431 0.30095737051841326; 0.2830366689623851 0.2589843162227414 … 0.2726330012865718 0.2854141966266274; … ; 0.2855643323175429 0.2726330012865718 … 0.2771603891377035 0.2812108737837968; 0.30095737051841326 0.2854141966266274 … 0.2812108737837968 0.29308272627169624;;; 0.3446996002702151 0.3273572817222662 … 0.30751926941854213 0.33438053198658046; 0.32735728172226614 0.31119401346059505 … 0.2982412284122421 0.3214260028150997; … ; 0.30751926941854196 0.29824122841224215 … 0.2771603891377035 0.29313119147022915; 0.33438053198658035 0.3214260028150997 … 0.29313119147022915 0.3186160477629755;;; 0.37851742089976637 0.3636495426205571 … 0.3343805319865805 0.36645844064793354; 0.36364954262055704 0.3519170663492042 … 0.3214260028150997 0.3519170663492043; … ; 0.3343805319865803 0.3214260028150997 … 0.2931311914702291 0.31861604776297553; 0.36645844064793354 0.3519170663492043 … 0.3186160477629755 0.3510288634177285]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923122129 -0.4966565572257029 … -0.4771919009648911 -0.4966565572257029; -0.4966565572257029 -0.48481820871073905 … -0.4763804457667817 -0.4920413111694279; … ; -0.4771919009648911 -0.47638044576678173 … -0.41228807087391595 -0.4550700815561223; -0.4966565572257029 -0.4920413111694279 … -0.4550700815561223 -0.48481820871073905;;; -0.4966565572257029 -0.48481820871073905 … -0.4763804457667817 -0.49204131116942795; -0.48481820871073905 -0.45837440791486045 … -0.4706560157057207 -0.4861790251756236; … ; -0.4763804457667817 -0.4706560157057207 … -0.44639843643621663 -0.46889439639152497; -0.4920413111694279 -0.4861790251756236 … -0.468894396391525 -0.48617902517562367;;; -0.4771919009648911 -0.4550700815561223 … -0.4605141234226702 -0.4763804457667817; -0.4550700815561223 -0.40906618243912846 … -0.4567199083211408 -0.46889439639152497; … ; -0.46051412342267023 -0.45671990832114084 … -0.4451449566034925 -0.4567199083211408; -0.4763804457667817 -0.46889439639152497 … -0.4567199083211408 -0.4706560157057207;;; … ;;; -0.4494759508409138 -0.45514997220149267 … -0.3712598626179091 -0.41774571520276443; -0.45514997220149267 -0.44880351099771604 … -0.41743801071342207 -0.4441260992987813; … ; -0.3712598626179091 -0.41743801071342207 … -0.25365698328408026 -0.2997980910596068; -0.41774571520276443 -0.4441260992987813 … -0.29979809105960675 -0.36106343264802754;;; -0.47719190096489106 -0.4763804457667817 … -0.41228807087391595 -0.4550700815561223; -0.4763804457667817 -0.4706560157057206 … -0.44639843643621663 -0.46889439639152497; … ; -0.41228807087391595 -0.4463984364362167 … -0.25365698328408026 -0.3410633023008436; -0.4550700815561223 -0.46889439639152497 … -0.3410633023008436 -0.40906618243912857;;; -0.4966565572257029 -0.49204131116942795 … -0.4550700815561223 -0.48481820871073905; -0.4920413111694279 -0.4861790251756236 … -0.46889439639152497 -0.48617902517562367; … ; -0.4550700815561223 -0.468894396391525 … -0.34106330230084353 -0.4090661824391285; -0.48481820871073905 -0.4861790251756236 … -0.4090661824391285 -0.45837440791486045])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4129139212663077 -0.48683674427718837 … -0.7027113226191013 -0.4868367442771885; -0.4868367442771882 -0.7744303950404483 … -0.41363732843931034 -0.3823307497944872; … ; -0.7027113226191017 -0.4136373284393106 … -2.396761682588059 -1.295806758174967; -0.48683674427718815 -0.3823307497944871 … -1.2958067581749675 -0.7744303950404481;;; -0.48683674427718826 -0.7744303950404483 … -0.4136373284393101 -0.38233074979448745; -0.7744303950404481 -1.4814477483918767 … -0.32458456943327607 -0.4499193965706907; … ; -0.41363732843931045 -0.3245845694332764 … -1.0113572986117039 -0.637327779193186; -0.3823307497944871 -0.4499193965706907 … -0.6373277791931857 -0.4499193965706907;;; -0.7027113226191013 -1.2958067581749675 … -0.29820348937556995 -0.41363732843931045; -1.2958067581749675 -2.9196723936538946 … -0.353729584661451 -0.6373277791931857; … ; -0.2982034893755702 -0.35372958466145166 … -0.49037260810717914 -0.3537295846614515; -0.41363732843931034 -0.6373277791931857 … -0.3537295846614509 -0.32458456943327596;;; … ;;; -1.0166744212557757 -0.533287814306596 … -3.6361382571228686 -1.998760262050625; -0.5332878143065958 -0.3217412474738869 … -1.4667339407502618 -0.9061938941468849; … ; -3.6361382571228686 -1.4667339407502618 … -10.988177824465904 -8.08737616820818; -1.9987602620506248 -0.9061938941468849 … -8.08737616820818 -4.647878371143236;;; -0.7027113226191013 -0.4136373284393103 … -2.396761682588059 -1.2958067581749675; -0.4136373284393102 -0.32458456943327607 … -1.011357298611704 -0.6373277791931857; … ; -2.3967616825880595 -1.011357298611704 … -11.00280619087501 -6.077304186394077; -1.2958067581749673 -0.6373277791931855 … -6.077304186394077 -2.9196723936538946;;; -0.4868367442771883 -0.38233074979448733 … -1.2958067581749675 -0.7744303950404483; -0.3823307497944871 -0.4499193965706908 … -0.6373277791931857 -0.44991939657069074; … ; -1.2958067581749675 -0.637327779193186 … -6.077304186394075 -2.919672393653894; -0.7744303950404479 -0.4499193965706905 … -2.919672393653894 -1.4814477483918767]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729846), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09132316917747298 0.08747419134080289 … 0.07684754935963183 0.08747419134080289; 0.08747419134080289 0.08089966872163985 … 0.07642471016971594 0.08486944834426657; … ; 0.07684754935963183 0.07642471016971596 … 0.04778466667101955 0.06587895342303411; 0.08747419134080289 0.08486944834426657 … 0.06587895342303411 0.08089966872163985;;; 0.08747419134080289 0.08089966872163985 … 0.07642471016971594 0.08486944834426659; 0.08089966872163985 0.06744471469774711 … 0.07348669934704379 0.08163768629014725; … ; 0.07642471016971594 0.07348669934704379 … 0.06188804119996628 0.07259829028447004; 0.08486944834426657 0.08163768629014725 … 0.07259829028447005 0.08163768629014727;;; 0.07684754935963181 0.0658789534230341 … 0.06847203698973786 0.07642471016971594; 0.0658789534230341 0.04657864264980882 … 0.06665759371631992 0.07259829028447003; … ; 0.06847203698973785 0.06665759371631994 … 0.06132515314381063 0.06665759371631992; 0.07642471016971593 0.07259829028447003 … 0.06665759371631992 0.07348669934704379;;; … ;;; 0.06328495229886001 0.06591651445952777 … 0.03394064888051844 0.04987593485999007; 0.06591651445952777 0.0629779096010562 … 0.04975639788527746 0.06087020457146419; … ; 0.03394064888051844 0.04975639788527747 … 0.00969635321407347 0.016831338792591168; 0.04987593485999007 0.06087020457146419 … 0.016831338792591164 0.03098572188504991;;; 0.0768475493596318 0.07642471016971593 … 0.047784666671019556 0.0658789534230341; 0.07642471016971594 0.07348669934704377 … 0.06188804119996628 0.07259829028447003; … ; 0.047784666671019556 0.06188804119996629 … 0.00969635321407347 0.02571001067530488; 0.0658789534230341 0.07259829028447004 … 0.025710010675304883 0.046578642649808835;;; 0.08747419134080289 0.08486944834426659 … 0.06587895342303411 0.08089966872163985; 0.08486944834426657 0.08163768629014725 … 0.07259829028447004 0.08163768629014724; … ; 0.06587895342303411 0.07259829028447005 … 0.025710010675304873 0.04657864264980883; 0.08089966872163985 0.08163768629014725 … 0.04657864264980883 0.06744471469774713;;;;], α = 0.8, eigenvalues = [[-0.16677707596309452, 0.2642777178298943, 0.2642777178298943, 0.26427771782989445, 0.35732037190449406, 0.35732037190449556, 0.3573203719044959], [-0.11613218761085484, 0.0704053232000203, 0.22624813603020327, 0.2262481360302035, 0.3361178489460068, 0.3934379776179813, 0.39343797761798116], [-0.09588938143642373, 0.08764319967956168, 0.1731270414274, 0.17312704142740024, 0.2919724892212921, 0.33773212507288514, 0.5327646516179361], [-0.045051463485966135, 0.022269526239791074, 0.09831189251532267, 0.1844640932211488, 0.32292701516246036, 0.48024696050853444, 0.5024422334948822]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2897120818381772, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.9462859056098638 + 0.13239958623308018im -7.075641299059141e-18 + 6.314018109655072e-17im … -1.276741389302698e-12 - 2.8734186355755347e-13im 1.2361326298909645e-12 + 2.781113115682851e-13im; -0.09536120482153544 + 0.013342462342733842im -0.01747543548011837 - 0.05657606930854801im … 0.23286180663922532 + 0.21444726218183824im -0.368580987607035 + 0.22153131276982577im; … ; -0.011680485050309214 + 0.0016342749886626951im -0.019903744893175146 + 0.03597195216590721im … -0.014533978098855226 + 0.0205923011449038im -0.08586318545664132 + 0.06371257872881413im; 0.0953612048215357 - 0.013342462342733724im -0.2123375104131569 + 0.2955973169592888im … -0.35261173256751455 - 0.04478094526737293im -0.3388722660334442 + 0.30341626392082727im], [-0.8866504446209424 + 0.2764169635886127im -0.1966459104762346 + 0.013731547210669335im … 2.78291832488429e-14 + 1.1813384708925919e-14im 3.422895481328603e-14 - 1.4296678719369862e-15im; -0.06044466963207589 + 0.018843877140283887im 0.008752155140444445 - 0.0006111524578114729im … 2.1452204968190623e-12 + 2.4995734759039533e-12im 1.9198462609572997e-12 - 1.0201133485508112e-12im; … ; -0.007399520522928406 + 0.0023068312967848862im -0.08604909693755276 + 0.006008704855198649im … 0.01853978122947962 + 0.026172867139926122im 0.10493469613255962 - 0.006015007601661182im; 0.10781427220558662 - 0.03361154774734826im 0.0904872150624972 - 0.006318613301357002im … 0.07869319519576164 + 0.11109227866653817im 0.4454015084473309 - 0.02553105462454826im], [-0.7953977422766917 - 0.4891146949161873im 6.127109740673344e-16 + 1.533090178197454e-16im … -4.3898731325151425e-15 + 3.60186002623346e-15im -4.559398552435175e-10 - 5.8046474884659005e-11im; -0.05856215774089503 - 0.03601168370818371im 0.02485450655114767 - 0.05150713110218841im … -0.021472147449119284 - 0.013155672441760344im 0.008962119698004862 - 0.005852500017956984im; … ; -0.011815133729346415 - 0.007265491492196012im -3.7609632114149554e-16 - 3.5855344962502685e-16im … -1.2935988395349635e-13 + 4.9369487228324864e-14im 0.06647955107455791 + 0.0007584026187595804im; 0.1305079394885925 + 0.08025337213604714im 0.12478348077137358 - 0.2585945164613326im … 0.32559317657031783 + 0.19948620371303777im 0.15301257348867067 + 0.003743598326102557im], [-0.6495423252484858 + 0.48228233014943506im -8.652223552419831e-17 - 3.7064913653323403e-16im … 0.0732503702161395 + 0.1725243049265504im -4.260449743190338e-7 - 5.748770359690204e-7im; -0.31109602608148385 + 0.23098743611728534im -0.5910626074741845 - 0.2079803852337698im … -0.06965050615890261 - 0.16404402548713698im 5.935383860274454e-7 + 8.922382653988709e-7im; … ; -0.00914779451742647 + 0.006792197342805717im -0.0015504557475213218 - 0.0005455672200875979im … 0.006320722691716551 + 0.014889337850070425im -0.006988450131996624 - 0.04373350589056652im; 0.052331691466750214 - 0.03885605159231231im -0.0117772846710677 - 0.004144136631081693im … 0.05289313007650759 + 0.12458145482385884im -0.0742679899441715 - 0.46475581471950167im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596309452, 0.2642777178298943, 0.2642777178298943, 0.26427771782989445, 0.35732037190449406, 0.35732037190449556, 0.3573203719044959], [-0.11613218761085484, 0.0704053232000203, 0.22624813603020327, 0.2262481360302035, 0.3361178489460068, 0.3934379776179813, 0.39343797761798116], [-0.09588938143642373, 0.08764319967956168, 0.1731270414274, 0.17312704142740024, 0.2919724892212921, 0.33773212507288514, 0.5327646516179361], [-0.045051463485966135, 0.022269526239791074, 0.09831189251532267, 0.1844640932211488, 0.32292701516246036, 0.48024696050853444, 0.5024422334948822]], X = [[-0.9462859056098638 + 0.13239958623308018im -7.075641299059141e-18 + 6.314018109655072e-17im … -1.276741389302698e-12 - 2.8734186355755347e-13im 1.2361326298909645e-12 + 2.781113115682851e-13im; -0.09536120482153544 + 0.013342462342733842im -0.01747543548011837 - 0.05657606930854801im … 0.23286180663922532 + 0.21444726218183824im -0.368580987607035 + 0.22153131276982577im; … ; -0.011680485050309214 + 0.0016342749886626951im -0.019903744893175146 + 0.03597195216590721im … -0.014533978098855226 + 0.0205923011449038im -0.08586318545664132 + 0.06371257872881413im; 0.0953612048215357 - 0.013342462342733724im -0.2123375104131569 + 0.2955973169592888im … -0.35261173256751455 - 0.04478094526737293im -0.3388722660334442 + 0.30341626392082727im], [-0.8866504446209424 + 0.2764169635886127im -0.1966459104762346 + 0.013731547210669335im … 2.78291832488429e-14 + 1.1813384708925919e-14im 3.422895481328603e-14 - 1.4296678719369862e-15im; -0.06044466963207589 + 0.018843877140283887im 0.008752155140444445 - 0.0006111524578114729im … 2.1452204968190623e-12 + 2.4995734759039533e-12im 1.9198462609572997e-12 - 1.0201133485508112e-12im; … ; -0.007399520522928406 + 0.0023068312967848862im -0.08604909693755276 + 0.006008704855198649im … 0.01853978122947962 + 0.026172867139926122im 0.10493469613255962 - 0.006015007601661182im; 0.10781427220558662 - 0.03361154774734826im 0.0904872150624972 - 0.006318613301357002im … 0.07869319519576164 + 0.11109227866653817im 0.4454015084473309 - 0.02553105462454826im], [-0.7953977422766917 - 0.4891146949161873im 6.127109740673344e-16 + 1.533090178197454e-16im … -4.3898731325151425e-15 + 3.60186002623346e-15im -4.559398552435175e-10 - 5.8046474884659005e-11im; -0.05856215774089503 - 0.03601168370818371im 0.02485450655114767 - 0.05150713110218841im … -0.021472147449119284 - 0.013155672441760344im 0.008962119698004862 - 0.005852500017956984im; … ; -0.011815133729346415 - 0.007265491492196012im -3.7609632114149554e-16 - 3.5855344962502685e-16im … -1.2935988395349635e-13 + 4.9369487228324864e-14im 0.06647955107455791 + 0.0007584026187595804im; 0.1305079394885925 + 0.08025337213604714im 0.12478348077137358 - 0.2585945164613326im … 0.32559317657031783 + 0.19948620371303777im 0.15301257348867067 + 0.003743598326102557im], [-0.6495423252484858 + 0.48228233014943506im -8.652223552419831e-17 - 3.7064913653323403e-16im … 0.0732503702161395 + 0.1725243049265504im -4.260449743190338e-7 - 5.748770359690204e-7im; -0.31109602608148385 + 0.23098743611728534im -0.5910626074741845 - 0.2079803852337698im … -0.06965050615890261 - 0.16404402548713698im 5.935383860274454e-7 + 8.922382653988709e-7im; … ; -0.00914779451742647 + 0.006792197342805717im -0.0015504557475213218 - 0.0005455672200875979im … 0.006320722691716551 + 0.014889337850070425im -0.006988450131996624 - 0.04373350589056652im; 0.052331691466750214 - 0.03885605159231231im -0.0117772846710677 - 0.004144136631081693im … 0.05289313007650759 + 0.12458145482385884im -0.0742679899441715 - 0.46475581471950167im]], residual_norms = [[9.330406663090313e-15, 1.4578010710724874e-14, 1.643810863249621e-14, 9.942160262806501e-15, 9.469673616170248e-11, 2.2732393661495545e-10, 2.2007262358154942e-10], [4.450834390264318e-15, 4.961670616683947e-15, 1.0211545480079026e-14, 1.3474968734672649e-14, 3.833879340276872e-14, 6.0796530386695175e-12, 5.2956877589847146e-12], [7.203881796138941e-15, 7.0938087720133744e-15, 8.310955202883753e-15, 7.587896637854553e-15, 9.892876989601479e-15, 1.1318590037094783e-12, 2.4298328715541858e-8], [2.414116839838523e-15, 3.3652521807219683e-15, 6.3269534379050996e-15, 9.0050157034143e-15, 2.972393169759339e-12, 1.9300007227058048e-5, 3.4910253119058345e-6]], iterations = [4, 2, 2, 2], converged = 1, n_matvec = 94)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 7.332157108907581e-14)</code></pre><h2 id="Potential-based-SCF"><a class="docs-heading-anchor" href="#Potential-based-SCF">Potential-based SCF</a><a id="Potential-based-SCF-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-based-SCF" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scfv = DFTK.scf_potential_mixing(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392126602683 -0.48683674427690926 … -0.7027113226188287 -0.4868367442769094; -0.48683674427690904 -0.7744303950401494 … -0.4136373284390824 -0.38233074979423365; … ; -0.702711322618829 -0.41363732843908263 … -2.3967616825877496 -1.2958067581746637; -0.4868367442769088 -0.38233074979423354 … -1.2958067581746642 -0.7744303950401493;;; -0.486836744276909 -0.7744303950401494 … -0.4136373284390824 -0.382330749794234; -0.7744303950401493 -1.4814477483915465 … -0.32458456943307135 -0.4499193965704385; … ; -0.4136373284390825 -0.3245845694330717 … -1.0113572986114496 -0.637327779192939; -0.3823307497942335 -0.4499193965704385 … -0.6373277791929388 -0.4499193965704387;;; -0.7027113226188287 -1.2958067581746644 … -0.2982034893753869 -0.41363732843908263; -1.2958067581746642 -2.9196723936535585 … -0.353729584661268 -0.6373277791929388; … ; -0.2982034893753869 -0.3537295846612686 … -0.4903726081069969 -0.35372958466126847; -0.41363732843908235 -0.6373277791929388 … -0.3537295846612678 -0.32458456943307123;;; … ;;; -1.016674421255516 -0.53328781430639 … -3.636138257122572 -1.9987602620503342; -0.5332878143063898 -0.32174124747372107 … -1.4667339407500135 -0.9061938941466477; … ; -3.636138257122572 -1.4667339407500135 … -10.988177824465513 -8.087376168207834; -1.998760262050334 -0.9061938941466479 … -8.087376168207834 -4.647878371142912;;; -0.7027113226188286 -0.4136373284390824 … -2.39676168258775 -1.2958067581746642; -0.4136373284390823 -0.32458456943307135 … -1.0113572986114496 -0.6373277791929387; … ; -2.39676168258775 -1.0113572986114499 … -11.002806190874619 -6.077304186393729; -1.2958067581746637 -0.6373277791929386 … -6.077304186393729 -2.9196723936535585;;; -0.48683674427690904 -0.3823307497942339 … -1.2958067581746642 -0.7744303950401494; -0.3823307497942337 -0.44991939657043867 … -0.6373277791929388 -0.4499193965704386; … ; -1.2958067581746642 -0.6373277791929388 … -6.077304186393728 -2.919672393653558; -0.7744303950401492 -0.44991939657043845 … -2.919672393653558 -1.4814477483915465])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392126602683 -0.48683674427690926 … -0.7027113226188287 -0.4868367442769094; -0.48683674427690904 -0.7744303950401494 … -0.4136373284390824 -0.38233074979423365; … ; -0.702711322618829 -0.41363732843908263 … -2.3967616825877496 -1.2958067581746637; -0.4868367442769088 -0.38233074979423354 … -1.2958067581746642 -0.7744303950401493;;; -0.486836744276909 -0.7744303950401494 … -0.4136373284390824 -0.382330749794234; -0.7744303950401493 -1.4814477483915465 … -0.32458456943307135 -0.4499193965704385; … ; -0.4136373284390825 -0.3245845694330717 … -1.0113572986114496 -0.637327779192939; -0.3823307497942335 -0.4499193965704385 … -0.6373277791929388 -0.4499193965704387;;; -0.7027113226188287 -1.2958067581746644 … -0.2982034893753869 -0.41363732843908263; -1.2958067581746642 -2.9196723936535585 … -0.353729584661268 -0.6373277791929388; … ; -0.2982034893753869 -0.3537295846612686 … -0.4903726081069969 -0.35372958466126847; -0.41363732843908235 -0.6373277791929388 … -0.3537295846612678 -0.32458456943307123;;; … ;;; -1.016674421255516 -0.53328781430639 … -3.636138257122572 -1.9987602620503342; -0.5332878143063898 -0.32174124747372107 … -1.4667339407500135 -0.9061938941466477; … ; -3.636138257122572 -1.4667339407500135 … -10.988177824465513 -8.087376168207834; -1.998760262050334 -0.9061938941466479 … -8.087376168207834 -4.647878371142912;;; -0.7027113226188286 -0.4136373284390824 … -2.39676168258775 -1.2958067581746642; -0.4136373284390823 -0.32458456943307135 … -1.0113572986114496 -0.6373277791929387; … ; -2.39676168258775 -1.0113572986114499 … -11.002806190874619 -6.077304186393729; -1.2958067581746637 -0.6373277791929386 … -6.077304186393729 -2.9196723936535585;;; -0.48683674427690904 -0.3823307497942339 … -1.2958067581746642 -0.7744303950401494; -0.3823307497942337 -0.44991939657043867 … -0.6373277791929388 -0.4499193965704386; … ; -1.2958067581746642 -0.6373277791929388 … -6.077304186393728 -2.919672393653558; -0.7744303950401492 -0.44991939657043845 … -2.919672393653558 -1.4814477483915465]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.0448593147806504 - 0.11167307210819949im 0.004151024764521193 - 0.011045260348232005im … -0.01154333251075569 - 0.030701770650091015im -0.04018564689397655 - 0.10125711838275733im; 0.001707356842765591 - 0.06547643655391208im -0.023094444893281094 + 0.05685298154568173im … 0.0564658215944379 - 0.03780003195848285im 0.043255861973742635 - 0.08904283722182213im; … ; -0.012877716220490436 - 0.005117263466424731im -0.0381232866653126 + 0.0365192917194177im … 0.03534471915262426 + 0.09571296236703714im 0.023980488378597037 + 0.03450515146259724im; -0.09557250224513666 - 0.05409549695267468im -0.04535712189644823 + 0.010168093151900943im … -0.007908461119724038 + 0.07108744543585897im -0.048256300991792525 - 0.048630459499310955im;;; -0.010928878129111417 - 0.014417825883511032im 0.04799987060271822 + 0.047314402604770316im … -0.04624490222527455 - 0.10821057428393521im -0.08140498666681964 - 0.160795414216263im; 0.024092076309140807 + 0.08646005311069674im 0.05787106124175195 + 0.10324722425989105im … 0.012524200160282141 - 0.08111511706305732im 0.017838099765085692 - 0.042502783722292964im; … ; -0.05230419413301754 + 0.012908443948933741im -0.02933344285907742 + 0.03401351802584922im … 0.012653069846243951 + 0.06799014260118771im -0.03288991825978968 + 0.02330938301216815im; -0.1020137714171554 - 0.0506427805354642im -0.005309033513632158 + 0.03959244600094748im … -0.05422949849056627 - 0.009654453453872131im -0.11952424693252006 - 0.08916844804117705im;;; 0.08099002825184104 + 0.03785537411336583im 0.15078619965546453 + 0.05217088889551498im … -0.035062830063029536 - 0.08010268066000079im -0.008572359257490135 - 0.07300823000833001im; 0.11623086314774486 + 0.1584706240765039im 0.1159743984195091 + 0.09296789001406025im … 0.004814237731011989 - 0.02657005918277939im 0.043598820032033955 + 0.06647248212159115im; … ; -0.03840122440280641 - 0.026813584607849314im -0.0053953917085094935 - 0.003063089313366252im … -0.016031763505891777 + 0.006682693441923606im -0.0441024370902479 - 0.028016099326004292im; -0.03374746040707014 - 0.049508683589281934im 0.041103900259288007 - 0.0010498197770062974im … -0.045734509137384444 - 0.054038441335421544im -0.07510347466214501 - 0.09349611727302116im;;; … ;;; -0.02937254516137134 + 0.030958986040321275im -0.02311180376183336 - 0.019168016450264697im … -0.03531437571144276 + 0.00252684272651096im -0.03253810595600756 + 0.02860487082677772im; 0.0034233812966906153 + 0.0012754663058115912im 0.007950542700215113 - 0.035913574376442214im … -0.033934876454187385 + 0.012515948138350576im -0.011835787329464529 + 0.028358216184810936im; … ; 0.05529837943921806 + 0.04560600508611441im 0.01830290732524228 + 0.016312253206318808im … -0.017102346453680927 + 0.026551820879964314im 0.021089023988494007 + 0.03243719496561824im; 0.019685645215831653 + 0.044106160807950996im -0.014942990650870114 + 0.0065987984271688085im … 0.0033760668597522555 + 0.010902052784017291im 0.03474953704962486 + 0.04148714641127021im;;; -0.04239375358972907 - 0.03375020233099347im -0.04948279126400604 - 0.09845914851349984im … -0.04079589031767432 + 0.012333728041853415im -0.02951206235425388 + 0.0416243512820233im; 0.046251705630501364 - 0.0658666934485807im 0.018782975282485227 - 0.09504671523888641im … -0.019794427360140858 + 0.03452716718092509im 0.015189068409791638 + 0.02035815201976706im; … ; 0.048169700977197846 + 0.027027728245196704im -0.003229767772635273 + 0.0006668166676792733im … -0.022743165269114046 + 0.04091106392245819im 0.050581456514411115 + 0.039900327231466345im; -0.013256876196589978 + 0.021075703210682573im -0.05468210337659164 - 0.0378320546890195im … -0.014614553486243362 + 0.008542677514594808im 0.017817830102506878 + 0.03535046878900641im;;; -0.02529863482231793 - 0.08599525068157524im -0.04664928964094086 - 0.11823764628024659im … -0.002228415631862662 + 0.05243433153077719im -0.008823977900018095 - 0.024745728195883207im; 0.05939208759241214 - 0.12768178012650683im 0.006195834745032977 - 0.09027922512846526im … 0.04593895508287791 + 0.03237137815346801im 0.1035926829953607 - 0.0071111305678124145im; … ; 0.0064469877466665874 + 0.0212276529205546im -0.03754095857029428 + 0.007196950827947506im … 0.015637353382554058 + 0.08307156295022484im 0.01271933398535463 + 0.056800426225925446im; -0.05119095548249705 - 0.05072935332750189im -0.0875812151438363 - 0.0340570794353859im … 0.015724009044893118 + 0.08969309292012664im 0.007113272387650015 + 0.029962836377902598im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392126602683 -0.48683674427690926 … -0.7027113226188287 -0.4868367442769094; -0.48683674427690904 -0.7744303950401494 … -0.4136373284390824 -0.38233074979423365; … ; -0.702711322618829 -0.41363732843908263 … -2.3967616825877496 -1.2958067581746637; -0.4868367442769088 -0.38233074979423354 … -1.2958067581746642 -0.7744303950401493;;; -0.486836744276909 -0.7744303950401494 … -0.4136373284390824 -0.382330749794234; -0.7744303950401493 -1.4814477483915465 … -0.32458456943307135 -0.4499193965704385; … ; -0.4136373284390825 -0.3245845694330717 … -1.0113572986114496 -0.637327779192939; -0.3823307497942335 -0.4499193965704385 … -0.6373277791929388 -0.4499193965704387;;; -0.7027113226188287 -1.2958067581746644 … -0.2982034893753869 -0.41363732843908263; -1.2958067581746642 -2.9196723936535585 … -0.353729584661268 -0.6373277791929388; … ; -0.2982034893753869 -0.3537295846612686 … -0.4903726081069969 -0.35372958466126847; -0.41363732843908235 -0.6373277791929388 … -0.3537295846612678 -0.32458456943307123;;; … ;;; -1.016674421255516 -0.53328781430639 … -3.636138257122572 -1.9987602620503342; -0.5332878143063898 -0.32174124747372107 … -1.4667339407500135 -0.9061938941466477; … ; -3.636138257122572 -1.4667339407500135 … -10.988177824465513 -8.087376168207834; -1.998760262050334 -0.9061938941466479 … -8.087376168207834 -4.647878371142912;;; -0.7027113226188286 -0.4136373284390824 … -2.39676168258775 -1.2958067581746642; -0.4136373284390823 -0.32458456943307135 … -1.0113572986114496 -0.6373277791929387; … ; -2.39676168258775 -1.0113572986114499 … -11.002806190874619 -6.077304186393729; -1.2958067581746637 -0.6373277791929386 … -6.077304186393729 -2.9196723936535585;;; -0.48683674427690904 -0.3823307497942339 … -1.2958067581746642 -0.7744303950401494; -0.3823307497942337 -0.44991939657043867 … -0.6373277791929388 -0.4499193965704386; … ; -1.2958067581746642 -0.6373277791929388 … -6.077304186393728 -2.919672393653558; -0.7744303950401492 -0.44991939657043845 … -2.919672393653558 -1.4814477483915465])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392126602683 -0.48683674427690926 … -0.7027113226188287 -0.4868367442769094; -0.48683674427690904 -0.7744303950401494 … -0.4136373284390824 -0.38233074979423365; … ; -0.702711322618829 -0.41363732843908263 … -2.3967616825877496 -1.2958067581746637; -0.4868367442769088 -0.38233074979423354 … -1.2958067581746642 -0.7744303950401493;;; -0.486836744276909 -0.7744303950401494 … -0.4136373284390824 -0.382330749794234; -0.7744303950401493 -1.4814477483915465 … -0.32458456943307135 -0.4499193965704385; … ; -0.4136373284390825 -0.3245845694330717 … -1.0113572986114496 -0.637327779192939; -0.3823307497942335 -0.4499193965704385 … -0.6373277791929388 -0.4499193965704387;;; -0.7027113226188287 -1.2958067581746644 … -0.2982034893753869 -0.41363732843908263; -1.2958067581746642 -2.9196723936535585 … -0.353729584661268 -0.6373277791929388; … ; -0.2982034893753869 -0.3537295846612686 … -0.4903726081069969 -0.35372958466126847; -0.41363732843908235 -0.6373277791929388 … -0.3537295846612678 -0.32458456943307123;;; … ;;; -1.016674421255516 -0.53328781430639 … -3.636138257122572 -1.9987602620503342; -0.5332878143063898 -0.32174124747372107 … -1.4667339407500135 -0.9061938941466477; … ; -3.636138257122572 -1.4667339407500135 … -10.988177824465513 -8.087376168207834; -1.998760262050334 -0.9061938941466479 … -8.087376168207834 -4.647878371142912;;; -0.7027113226188286 -0.4136373284390824 … -2.39676168258775 -1.2958067581746642; -0.4136373284390823 -0.32458456943307135 … -1.0113572986114496 -0.6373277791929387; … ; -2.39676168258775 -1.0113572986114499 … -11.002806190874619 -6.077304186393729; -1.2958067581746637 -0.6373277791929386 … -6.077304186393729 -2.9196723936535585;;; -0.48683674427690904 -0.3823307497942339 … -1.2958067581746642 -0.7744303950401494; -0.3823307497942337 -0.44991939657043867 … -0.6373277791929388 -0.4499193965704386; … ; -1.2958067581746642 -0.6373277791929388 … -6.077304186393728 -2.919672393653558; -0.7744303950401492 -0.44991939657043845 … -2.919672393653558 -1.4814477483915465]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.00202884668185298 - 0.03184159760096073im 0.036271527413013704 + 0.036390848793980954im … 0.050411459974499376 - 0.017829499612287095im -0.039944826168640285 - 0.09877676200299035im; 0.004715016472841612 + 0.004356818833835427im 0.0038343996067133463 + 0.03194066394125358im … -0.009330536469657223 - 0.04895230780812137im -0.0504702865901446 - 0.07793852434010953im; … ; -0.00133685420610108 - 0.0163272859979im 0.028708380701870713 + 0.011995129506152308im … 0.07759459273812655 + 0.038966770062223384im 0.028228232239716582 + 0.03472734574000427im; 0.0028655429372226927 - 0.009990534607217699im 0.04573185584956129 + 0.03641349636105899im … 0.0992226382307575 + 0.06196845520668881im 0.02306275110254912 - 0.00795656512936903im;;; 7.086391878943711e-5 - 0.03872955434353238im -0.008673691003572093 + 0.01725525658427475im … -0.006603274870469929 - 0.07971882928543464im -0.050953192467711315 - 0.1313786584777507im; -0.014041525139325347 + 0.07601036759876849im -0.057972815755921406 + 0.051746224835509905im … -0.034287685428404636 - 0.0581400295745489im -0.05860630269664191 - 0.04827501379312083im; … ; -0.0031592289304088654 - 0.01829867530437081im 0.017042156701587673 - 0.0003111570261709307im … 0.04254232910835368 + 0.03208081981396877im 0.011735985610899549 - 0.0006998894163845939im; 0.010023626176783929 - 0.07049967715153205im 0.023520074710317383 - 0.012506374984830584im … 0.04198792003425415 + 0.0003012933347314082im -0.006254487895672909 - 0.08561232557462015im;;; -0.02376960666085105 + 0.03947816485726725im -0.047561505560592014 + 0.05273124552468246im … -0.02142758995130193 - 0.06907627890732489im -0.04103859231083837 - 0.08153582174031512im; -0.031486348903751765 + 0.13917266262014458im -0.07516317030883576 + 0.0460867362300965im … -0.030226901790663424 - 0.04146689446571145im -0.03468962541911133 - 0.006626823601603526im; … ; -0.0004836510337385587 - 0.02984066153625617im 0.0014642227835683233 - 0.006403403351224384im … 0.010463420667279904 - 0.00291921983278664im -0.001511780420395964 - 0.033258438807972426im; -0.007053505175675951 - 0.020500643321778807im 0.0002704466638987521 + 0.0021198980028829945im … -0.0027415283098387996 - 0.04045463920190068im -0.014827621112165928 - 0.08172839157620199im;;; … ;;; -0.005660157896694603 + 0.023852236798021648im 0.013051641718659263 - 0.009178303630966587im … 0.005630684474270196 + 0.02814402826389735im 0.016310209293692035 + 0.03529854361037306im; 0.00015094583961494106 - 0.0038373385038957646im 0.010568261912217528 - 0.01185954009931759im … 0.01073166243012223 + 0.01709150705517614im 0.0079098793713295 + 0.019530774075253502im; … ; -0.021111573033105235 + 0.067121097970676im -0.007686195807147229 + 0.025702084920018575im … -0.02563351877160014 + 0.034467141054268416im 0.006730286405755062 + 0.05781991651110975im; -0.009875306313057447 + 0.04095108485108983im 0.002194535270425515 + 0.002375912391771577im … -0.008562382529232807 + 0.033831996360313615im 0.013263949093095716 + 0.036292146757055076im;;; -0.0033133496765881806 + 0.013645972583181683im 0.038451214308585877 - 0.01420519940296359im … 0.06023135961509794 + 0.03796982583612679im 0.024852595381417916 + 0.025830809067330457im; 0.002155357753783703 - 0.006359774857298436im 0.028022488905689154 - 0.020396732282462998im … 0.03279962365620492 + 0.01592727260815458im 0.00043194752740246525 - 0.006478908106595892im; … ; -0.013925994489062274 + 0.04030165230237599im 0.019775514828404984 - 0.011637718220646171im … 0.0183018687683238 + 0.02363652615160141im 0.022235766553694053 + 0.06699038310686727im; 0.0010138227889058154 - 0.002251456292707386im 0.043427640229769485 - 0.030951839269656518im … 0.053619664758506505 + 0.01602842214228352im 0.04156375283490635 + 0.030930087384438934im;;; -0.004501431412068248 + 0.007095240179756195im 0.04934782848660332 + 0.005343114892875985im … 0.09244525452447536 + 0.013942643934331329im 0.002065078386998409 - 0.02138364161017005im; 0.004822763249654367 - 0.03394101197196643im 0.033651678878631054 - 0.003177993870635555im … 0.021862317833316755 - 0.016530807273631577im -0.018235712062630246 - 0.0448278181942002im; … ; 0.006558785993727801 - 0.05099543249484452im 0.047162185658672785 - 0.05130933101640927im … 0.06747209764478695 - 0.02933953461193866im 0.04288388625189034 + 0.007497399430793545im; 0.016862180037636308 - 0.051666548148882524im 0.06599145376063761 - 0.02215742110003495im … 0.11884550512055835 + 0.02643244361951734im 0.0467236074202898 + 0.00616108124448585im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392126602683 -0.48683674427690926 … -0.7027113226188287 -0.4868367442769094; -0.48683674427690904 -0.7744303950401494 … -0.4136373284390824 -0.38233074979423365; … ; -0.702711322618829 -0.41363732843908263 … -2.3967616825877496 -1.2958067581746637; -0.4868367442769088 -0.38233074979423354 … -1.2958067581746642 -0.7744303950401493;;; -0.486836744276909 -0.7744303950401494 … -0.4136373284390824 -0.382330749794234; -0.7744303950401493 -1.4814477483915465 … -0.32458456943307135 -0.4499193965704385; … ; -0.4136373284390825 -0.3245845694330717 … -1.0113572986114496 -0.637327779192939; -0.3823307497942335 -0.4499193965704385 … -0.6373277791929388 -0.4499193965704387;;; -0.7027113226188287 -1.2958067581746644 … -0.2982034893753869 -0.41363732843908263; -1.2958067581746642 -2.9196723936535585 … -0.353729584661268 -0.6373277791929388; … ; -0.2982034893753869 -0.3537295846612686 … -0.4903726081069969 -0.35372958466126847; -0.41363732843908235 -0.6373277791929388 … -0.3537295846612678 -0.32458456943307123;;; … ;;; -1.016674421255516 -0.53328781430639 … -3.636138257122572 -1.9987602620503342; -0.5332878143063898 -0.32174124747372107 … -1.4667339407500135 -0.9061938941466477; … ; -3.636138257122572 -1.4667339407500135 … -10.988177824465513 -8.087376168207834; -1.998760262050334 -0.9061938941466479 … -8.087376168207834 -4.647878371142912;;; -0.7027113226188286 -0.4136373284390824 … -2.39676168258775 -1.2958067581746642; -0.4136373284390823 -0.32458456943307135 … -1.0113572986114496 -0.6373277791929387; … ; -2.39676168258775 -1.0113572986114499 … -11.002806190874619 -6.077304186393729; -1.2958067581746637 -0.6373277791929386 … -6.077304186393729 -2.9196723936535585;;; -0.48683674427690904 -0.3823307497942339 … -1.2958067581746642 -0.7744303950401494; -0.3823307497942337 -0.44991939657043867 … -0.6373277791929388 -0.4499193965704386; … ; -1.2958067581746642 -0.6373277791929388 … -6.077304186393728 -2.919672393653558; -0.7744303950401492 -0.44991939657043845 … -2.919672393653558 -1.4814477483915465])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392126602683 -0.48683674427690926 … -0.7027113226188287 -0.4868367442769094; -0.48683674427690904 -0.7744303950401494 … -0.4136373284390824 -0.38233074979423365; … ; -0.702711322618829 -0.41363732843908263 … -2.3967616825877496 -1.2958067581746637; -0.4868367442769088 -0.38233074979423354 … -1.2958067581746642 -0.7744303950401493;;; -0.486836744276909 -0.7744303950401494 … -0.4136373284390824 -0.382330749794234; -0.7744303950401493 -1.4814477483915465 … -0.32458456943307135 -0.4499193965704385; … ; -0.4136373284390825 -0.3245845694330717 … -1.0113572986114496 -0.637327779192939; -0.3823307497942335 -0.4499193965704385 … -0.6373277791929388 -0.4499193965704387;;; -0.7027113226188287 -1.2958067581746644 … -0.2982034893753869 -0.41363732843908263; -1.2958067581746642 -2.9196723936535585 … -0.353729584661268 -0.6373277791929388; … ; -0.2982034893753869 -0.3537295846612686 … -0.4903726081069969 -0.35372958466126847; -0.41363732843908235 -0.6373277791929388 … -0.3537295846612678 -0.32458456943307123;;; … ;;; -1.016674421255516 -0.53328781430639 … -3.636138257122572 -1.9987602620503342; -0.5332878143063898 -0.32174124747372107 … -1.4667339407500135 -0.9061938941466477; … ; -3.636138257122572 -1.4667339407500135 … -10.988177824465513 -8.087376168207834; -1.998760262050334 -0.9061938941466479 … -8.087376168207834 -4.647878371142912;;; -0.7027113226188286 -0.4136373284390824 … -2.39676168258775 -1.2958067581746642; -0.4136373284390823 -0.32458456943307135 … -1.0113572986114496 -0.6373277791929387; … ; -2.39676168258775 -1.0113572986114499 … -11.002806190874619 -6.077304186393729; -1.2958067581746637 -0.6373277791929386 … -6.077304186393729 -2.9196723936535585;;; -0.48683674427690904 -0.3823307497942339 … -1.2958067581746642 -0.7744303950401494; -0.3823307497942337 -0.44991939657043867 … -0.6373277791929388 -0.4499193965704386; … ; -1.2958067581746642 -0.6373277791929388 … -6.077304186393728 -2.919672393653558; -0.7744303950401492 -0.44991939657043845 … -2.919672393653558 -1.4814477483915465]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0010731040209829854 + 0.06962858979821884im -0.007940309858043674 + 0.012648172042854266im … -0.026659145355123183 - 0.011302396635312479im -0.004490757819095596 + 0.03425052344501357im; 0.00783053089910216 + 0.03803510276967145im -0.007876638057900908 - 0.022397058061533137im … -0.0009491935817786141 - 0.01448848513869773im 0.01865429287941328 + 0.02630185535737957im; … ; -0.0012815695393514097 + 0.04205710064673984im -0.012031126028777987 + 0.03532699969968919im … 0.0012993240469349999 - 0.017958810774148515im 0.009214148160376277 - 0.012559285426301721im; -0.015169232023233187 + 0.05337889560099482im -0.01368816927448221 + 0.028005884235388835im … -0.027180501255821575 - 0.009322995529805582im -0.015270134081197895 + 0.0028602952421732542im;;; -0.03897296292202883 + 0.008696081988269228im 0.02608453595781127 - 0.05356216343851606im … -0.014410981573996793 + 0.00359542947852955im -0.05043713050686398 + 0.04102666356797423im; 0.013797489461218258 - 0.012341002878855997im 0.00021066551374901356 - 0.05839219683158518im … -0.022814471035031928 + 0.00836886979021065im -0.029603109650688922 + 0.02892480442394118im; … ; -0.02957875025332396 + 0.03456081895393982im 0.03048508791882391 - 0.00023653581725009113im … 0.004001041553231531 - 0.017830438665968753im -0.017601771807386025 - 0.006047914874717073im; 0.0034203237734187317 + 0.03008173927729577im 0.02229713737933442 - 0.02738059991571375im … 0.002104355819270086 - 0.014085963899084782im -0.03239134506213395 + 0.02335507115846802im;;; 0.017521481987772557 - 0.023870847098226643im -0.01027984311463135 - 0.040059456409205496im … -0.03161756080887094 + 0.011426530400628193im -0.06675757470331085 + 0.027081073777622918im; 0.05070321413373625 - 0.04845841248571848im 0.0067792862144336495 - 0.032847340804717615im … -0.02931757676418428 + 0.012505811821245388im 0.0041764775780487795 - 0.00215884002730149im; … ; 0.01958236832840774 + 0.006749368827428721im 0.03539855087580504 - 0.018763728283728864im … -0.003490571497635802 - 0.00650599885757934im -0.02696281622326151 + 0.010734567666315704im; 0.013977042747135088 - 0.003075819234021053im 0.04012505538443358 - 0.04042008956791194im … -0.005683226709127333 + 0.0013803830102002471im -0.02568832332191773 + 0.015507342067638437im;;; … ;;; 0.014182837233275116 - 0.0165963796642436im 0.011281225684345222 + 0.009065416229529829im … 0.004219336917247644 - 0.013604597587977944im -0.017846943473068207 - 0.021829566513157667im; -0.011706173514027658 + 0.0027844219759808365im -0.0031825796644000953 + 0.015647818329931368im … -0.024871985488539305 - 0.003797300811320425im -0.03659123073218691 - 0.009375394849214675im; … ; 0.04021966234797299 - 0.03554691417553667im 0.03264973749580411 - 0.0190770379875628im … 0.058855956370649595 - 0.026673162082823058im 0.011919640755589461 - 0.030282612964851234im; 0.044494300497395244 - 0.0421867248723547im 0.027137480791043354 - 0.011882843163460364im … 0.0484589787872345 - 0.034289003784015296im 0.009776230856065615 - 0.041313094745458884im;;; 0.014151998090014477 + 0.022717947555835047im -0.017686639052840875 + 0.051196533150389675im … -0.0869531202128889 + 0.00046034545065203834im -0.059043060336977676 - 0.01009806660183192im; -0.011784033721975219 + 0.025351388235289946im -0.008790418462397103 + 0.04065707372421255im … -0.07697859476750146 - 0.010737349151339334im -0.054346344035069494 - 0.007438155822176363im; … ; 0.10086651547416195 - 0.04669622144458964im 0.03809954994525876 - 0.004767686984926571im … 0.04345920247975989 - 0.0384165486757773im 0.057876643035754016 - 0.060295450788371965im; 0.046159745938849465 - 0.02142713580428947im 0.012266242438721875 + 0.022726402816692914im … -0.02430853424791259 - 0.0287037036555199im -0.008540335445993018 - 0.044854814845617125im;;; -0.00040476664148777564 + 0.06761343373696235im -0.049993762113496126 + 0.08470308782317763im … -0.09533705186527774 - 0.007548187458084847im -0.021074726962642894 + 0.005820453411175578im; 0.011185129402748042 + 0.06014470372245152im -0.02995354000430037 + 0.042315741505845654im … -0.04618562659169546 - 0.025594235392459325im 0.001847088163604633 - 0.0012572346669677444im; … ; 0.029489954421291042 + 0.0155884759991767im -0.001924978196426125 + 0.03992464304377352im … 0.0020503333650018158 - 0.01784122699423943im 0.04298680069050772 - 0.03793218023427662im; 0.00854764678812157 + 0.045610996973845505im -0.0645874858001032 + 0.06396731867805im … -0.07646679916099783 - 0.005827118709967497im -0.06095863961771997 + 0.012264615683953895im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392126602683 -0.48683674427690926 … -0.7027113226188287 -0.4868367442769094; -0.48683674427690904 -0.7744303950401494 … -0.4136373284390824 -0.38233074979423365; … ; -0.702711322618829 -0.41363732843908263 … -2.3967616825877496 -1.2958067581746637; -0.4868367442769088 -0.38233074979423354 … -1.2958067581746642 -0.7744303950401493;;; -0.486836744276909 -0.7744303950401494 … -0.4136373284390824 -0.382330749794234; -0.7744303950401493 -1.4814477483915465 … -0.32458456943307135 -0.4499193965704385; … ; -0.4136373284390825 -0.3245845694330717 … -1.0113572986114496 -0.637327779192939; -0.3823307497942335 -0.4499193965704385 … -0.6373277791929388 -0.4499193965704387;;; -0.7027113226188287 -1.2958067581746644 … -0.2982034893753869 -0.41363732843908263; -1.2958067581746642 -2.9196723936535585 … -0.353729584661268 -0.6373277791929388; … ; -0.2982034893753869 -0.3537295846612686 … -0.4903726081069969 -0.35372958466126847; -0.41363732843908235 -0.6373277791929388 … -0.3537295846612678 -0.32458456943307123;;; … ;;; -1.016674421255516 -0.53328781430639 … -3.636138257122572 -1.9987602620503342; -0.5332878143063898 -0.32174124747372107 … -1.4667339407500135 -0.9061938941466477; … ; -3.636138257122572 -1.4667339407500135 … -10.988177824465513 -8.087376168207834; -1.998760262050334 -0.9061938941466479 … -8.087376168207834 -4.647878371142912;;; -0.7027113226188286 -0.4136373284390824 … -2.39676168258775 -1.2958067581746642; -0.4136373284390823 -0.32458456943307135 … -1.0113572986114496 -0.6373277791929387; … ; -2.39676168258775 -1.0113572986114499 … -11.002806190874619 -6.077304186393729; -1.2958067581746637 -0.6373277791929386 … -6.077304186393729 -2.9196723936535585;;; -0.48683674427690904 -0.3823307497942339 … -1.2958067581746642 -0.7744303950401494; -0.3823307497942337 -0.44991939657043867 … -0.6373277791929388 -0.4499193965704386; … ; -1.2958067581746642 -0.6373277791929388 … -6.077304186393728 -2.919672393653558; -0.7744303950401492 -0.44991939657043845 … -2.919672393653558 -1.4814477483915465])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392126602683 -0.48683674427690926 … -0.7027113226188287 -0.4868367442769094; -0.48683674427690904 -0.7744303950401494 … -0.4136373284390824 -0.38233074979423365; … ; -0.702711322618829 -0.41363732843908263 … -2.3967616825877496 -1.2958067581746637; -0.4868367442769088 -0.38233074979423354 … -1.2958067581746642 -0.7744303950401493;;; -0.486836744276909 -0.7744303950401494 … -0.4136373284390824 -0.382330749794234; -0.7744303950401493 -1.4814477483915465 … -0.32458456943307135 -0.4499193965704385; … ; -0.4136373284390825 -0.3245845694330717 … -1.0113572986114496 -0.637327779192939; -0.3823307497942335 -0.4499193965704385 … -0.6373277791929388 -0.4499193965704387;;; -0.7027113226188287 -1.2958067581746644 … -0.2982034893753869 -0.41363732843908263; -1.2958067581746642 -2.9196723936535585 … -0.353729584661268 -0.6373277791929388; … ; -0.2982034893753869 -0.3537295846612686 … -0.4903726081069969 -0.35372958466126847; -0.41363732843908235 -0.6373277791929388 … -0.3537295846612678 -0.32458456943307123;;; … ;;; -1.016674421255516 -0.53328781430639 … -3.636138257122572 -1.9987602620503342; -0.5332878143063898 -0.32174124747372107 … -1.4667339407500135 -0.9061938941466477; … ; -3.636138257122572 -1.4667339407500135 … -10.988177824465513 -8.087376168207834; -1.998760262050334 -0.9061938941466479 … -8.087376168207834 -4.647878371142912;;; -0.7027113226188286 -0.4136373284390824 … -2.39676168258775 -1.2958067581746642; -0.4136373284390823 -0.32458456943307135 … -1.0113572986114496 -0.6373277791929387; … ; -2.39676168258775 -1.0113572986114499 … -11.002806190874619 -6.077304186393729; -1.2958067581746637 -0.6373277791929386 … -6.077304186393729 -2.9196723936535585;;; -0.48683674427690904 -0.3823307497942339 … -1.2958067581746642 -0.7744303950401494; -0.3823307497942337 -0.44991939657043867 … -0.6373277791929388 -0.4499193965704386; … ; -1.2958067581746642 -0.6373277791929388 … -6.077304186393728 -2.919672393653558; -0.7744303950401492 -0.44991939657043845 … -2.919672393653558 -1.4814477483915465]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0023504725315560723 + 0.002454935077356879im 0.07918440721632161 + 0.08271919637131925im … 0.018593708385316907 + 0.01942243931544378im -0.02574643496512337 - 0.02689650377724933im; 0.0803607460622037 + 0.0839484697088694im 0.08145835258060706 + 0.08509598536132697im … 0.0034608157362162866 + 0.0036148768680093635im -0.013830573948666665 - 0.014448118571614436im; … ; -0.04597973175579996 - 0.048032844132282496im -0.0187550913019426 - 0.019592644392616813im … 0.0341917882124477 + 0.03571747633291936im 0.013006700463876239 + 0.013586220050229851im; -0.05019451945202587 - 0.05243574724606219im 0.007845123866938992 + 0.008194929487246707im … 0.045076054167262194 + 0.0470865064877965im -0.03027187250567623 - 0.03162447991202935im;;; 0.04636864243052616 - 0.02450699983157452im 0.07089534860507976 + 0.10084301074553184im … -0.006757103621532545 + 0.04776271160695031im -0.024617951276080928 - 0.03535146262172402im; 0.04781505948990097 + 0.016410470116448382im 0.014520834354326637 + 0.09342938433507098im … -0.004956358736585625 - 0.0011997210936640049im 0.013640645131300528 - 0.050346108676939165im; … ; -0.013982446083583695 - 0.05374475705627117im 0.009373874457479295 - 0.02294352989913999im … 0.013904665625390548 + 0.0678402836146367im -0.014326621559800853 + 0.017550828969690006im; -0.00950254241272935 - 0.07050432747050166im 0.04912113427119759 + 0.006323795573856381im … 0.003629147104166836 + 0.07717717130591135im -0.03230657884261472 - 0.02040460012854474im;;; 0.04079301582739301 - 0.013237638164486334im 0.02526071950870625 + 0.09448021768525071im … -0.01228593028175471 - 0.022667391499474464im 0.011458114512182064 - 0.10000632549425365im; 0.024250953059868394 + 0.0075921182730306225im -0.04855357281822363 + 0.07885216348355648im … 0.004106971305316533 - 0.05891971316004622im 0.011865841609850526 - 0.09497656771329879im; … ; 0.008407835206843533 - 0.05866514313807084im 0.022300122137428102 - 0.007434655021747174im … -0.002555741743695976 + 0.027970453517555647im -0.007872526731707975 - 0.020932220044788792im; 0.04161850566847125 - 0.07261722035401934im 0.038432968074292743 + 0.05953167842669141im … -0.007483101010346017 + 0.005287094570957565im -0.009684142448159018 - 0.0685953817631088im;;; … ;;; -0.023557031894991955 - 0.0704850158770288im -0.016893249860441634 + 0.00043516040085440574im … 0.003965862241512411 + 0.009474230100998769im 0.0013781480791762455 - 0.0803472815561472im; -0.012384009179870481 - 0.016943286988949507im -0.004050290747443477 + 0.027610363381806446im … 0.0063163652586584965 - 0.025829331853893682im -0.006369448594335084 - 0.05696512817123728im; … ; 0.023547489080535944 - 0.03247284789088607im 0.0011332243288010636 - 0.038677221230664444im … -0.00268593051780821 + 0.1053653019683348im 0.0401661943776387 + 0.029701654192069337im; -0.0020875289753085457 - 0.10503844429814879im -0.010857122672006222 - 0.05464348905353157im … -0.004621674151649456 + 0.04858360304058566im 0.018444435281163914 - 0.056771904197241596im;;; -0.04462992305282977 - 0.025014811774387996im -0.02221233797673384 + 0.0663501760536851im … 0.02202579979669477 - 0.030126196797943615im -0.008741282197450607 - 0.12467489516087832im; -0.019211433724669005 + 0.03499825332316598im 0.01225613926486183 + 0.10344913936559191im … 0.007490264762184477 - 0.06521675983210068im -0.02287083998335847 - 0.075177814364846im; … ; 0.0065437062136951135 - 0.0754778482604927im -0.01532781193300503 - 0.05317123998917743im … 0.013445740310655516 + 0.06989913303121523im 0.05859837354426535 - 0.006876856376758124im; -0.038166344277857964 - 0.12345971887481205im -0.030011540818394494 - 0.02348177856089513im … 0.015563303973291752 + 0.03400036605075554im 0.01488639790046509 - 0.11402145339166124im;;; -0.05283740800810953 + 0.023061509249958142im 0.018688067893365475 + 0.12251138655129297im … 0.01798677461197127 - 0.04580707511655981im -0.03139368193308777 - 0.06633604318109221im; 0.009485279590708212 + 0.07554554563381523im 0.05850768539859191 + 0.14249169708642834im … -0.010374335832940205 - 0.06692285058739528im -0.0517048509299025 - 0.04101752321921222im; … ; -0.027093246763764137 - 0.07329359697677737im -0.03599627524196131 - 0.02814399721207008im … 0.02577181777874759 + 0.04026725250697327im 0.03916191472284971 - 0.019667980664672055im; -0.08400853434181424 - 0.06097723443276571im -0.03349671981663834 + 0.006680476334393986im … 0.02933504885048705 + 0.021008738716223316im -0.01065290287368141 - 0.08407577358316808im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729848), converged = true, ρ = [0.09132316917750835 0.08747419134084428 … 0.07684754935968537 0.08747419134084428; 0.08747419134084428 0.08089966872169993 … 0.07642471016974528 0.08486944834429615; … ; 0.07684754935968537 0.07642471016974528 … 0.047784666671096473 0.06587895342310741; 0.08747419134084426 0.08486944834429616 … 0.06587895342310743 0.08089966872169994;;; 0.08747419134084426 0.08089966872169994 … 0.07642471016974528 0.08486944834429615; 0.08089966872169993 0.06744471469782538 … 0.07348669934706288 0.08163768629018228; … ; 0.07642471016974528 0.07348669934706288 … 0.06188804120002602 0.07259829028451617; 0.08486944834429613 0.08163768629018228 … 0.07259829028451617 0.0816376862901823;;; 0.07684754935968537 0.06587895342310741 … 0.0684720369897521 0.07642471016974528; 0.06587895342310741 0.04657864264988616 … 0.06665759371633796 0.07259829028451617; … ; 0.0684720369897521 0.06665759371633796 … 0.06132515314383624 0.06665759371633798; 0.07642471016974527 0.07259829028451617 … 0.06665759371633798 0.07348669934706287;;; … ;;; 0.06328495229892232 0.06591651445956188 … 0.03394064888058946 0.04987593486006612; 0.06591651445956188 0.06297790960107062 … 0.04975639788534251 0.06087020457151833; … ; 0.03394064888058946 0.04975639788534251 … 0.009696353214100091 0.01683133879263597; 0.049875934860066105 0.06087020457151833 … 0.01683133879263597 0.030985721885117015;;; 0.07684754935968537 0.07642471016974528 … 0.047784666671096473 0.06587895342310741; 0.07642471016974528 0.07348669934706287 … 0.06188804120002602 0.07259829028451617; … ; 0.04778466667109648 0.06188804120002602 … 0.009696353214100084 0.02571001067536279; 0.0658789534231074 0.07259829028451617 … 0.025710010675362792 0.04657864264988616;;; 0.08747419134084426 0.08486944834429615 … 0.06587895342310741 0.08089966872169994; 0.08486944834429615 0.08163768629018228 … 0.07259829028451617 0.0816376862901823; … ; 0.06587895342310741 0.07259829028451617 … 0.025710010675362775 0.04657864264988616; 0.08089966872169993 0.0816376862901823 … 0.04657864264988616 0.0674447146978254;;;;], eigenvalues = [[-0.1667770759636101, 0.2642777178291922, 0.26427771782919757, 0.2642777178292026, 0.3573203719041459, 0.3573203719041541, 0.3573203719041604], [-0.11613218761139597, 0.07040532319947558, 0.22624813602958152, 0.22624813602958235, 0.3361178489454459, 0.39343797761762855, 0.3934379776176291], [-0.0958893814369681, 0.08764319967892165, 0.17312704142685953, 0.17312704142686205, 0.29197248922089797, 0.3377321250725206, 0.5327646516179338], [-0.045051463486549134, 0.022269526239200317, 0.09831189251487413, 0.184464093220591, 0.3229270151620701, 0.48024696182838267, 0.5024422339965587]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.28971208183817665, n_iter = 13, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.9299068664734869 + 0.21968132664277568im 1.8204351423453293e-13 + 4.658718475363954e-13im … -6.432026588893941e-11 - 1.0358530942935213e-10im 3.882870348026184e-11 + 6.630832444474249e-11im; -0.09371062026121924 + 0.022138209880458736im -0.197570142956895 + 0.3230838843868209im … -0.15215329565734456 + 0.03848630783109052im -0.5271931036579569 + 0.10180908082580903im; … ; -0.01147831029456368 + 0.0027116376100798987im 0.016381990398256396 - 0.04637279065651755im … -0.042126542786149204 - 0.04649097615625382im -0.09073547576001224 + 0.03804025382571412im; 0.09371062026124329 - 0.022138209880424652im -0.037186825264152096 - 0.130916016447643im … -0.19494027508030287 - 0.4215397920800021im -0.22040445267916514 + 0.21161629698696569im], [-0.8015023521250835 + 0.4692007334226998im -0.1969659004785435 + 0.007912240170864148im … 2.218802901809677e-11 + 2.330720122061892e-10im -3.4072953143595876e-10 - 9.14024870639449e-11im; -0.05463996006270695 + 0.0319863182779633im 0.00876639699408694 - 0.0003521515058707151im … -6.633751292804457e-10 + 4.0974457913099797e-10im 3.6054607327762235e-10 - 1.071528252665456e-9im; … ; -0.0066889191103769435 + 0.003915703733207741im -0.0861891194311211 + 0.003462269415207198im … -0.050814568726897255 + 0.0573270270009188im -0.06785959970820844 + 0.04003473004385552im; 0.097460496737585 - 0.057053527575772395im 0.09063445943761002 - 0.0036408414303836767im … -0.2156854352203218 + 0.24332794752458936im -0.28803407296145694 + 0.1699297731058333im], [0.30029357046373456 + 0.8841462123084074im 2.037121149012421e-15 - 6.487795787988594e-15im … -7.061104416842006e-11 + 8.097004116163251e-11im -3.2247264892089636e-9 - 2.860471299574951e-8im; 0.022109491274031338 + 0.06509637530971554im 0.019469982300565562 - 0.05377407218653312im … 0.024367575974723006 - 0.006351843752214437im 0.007644963319873622 + 0.007985978505006411im; … ; 0.00446067232093142 + 0.013133436492832136im 5.297455613953888e-14 - 1.7977743039552263e-13im … -5.686863285485292e-10 + 3.583349220073481e-10im -0.019283062914434042 + 0.0630933443150163im; -0.04927182092673542 - 0.145069685570155im 0.09775016683646127 - 0.26997582465995046im … -0.3694980916201495 + 0.09631626187831349im -0.047820177584284314 + 0.14539334809168325im], [-0.5594238062360904 - 0.5844197834431606im 4.448375121603822e-15 + 4.642962831392407e-15im … -0.12961182171795624 - 0.13539860897377162im -6.6584990936517206e-6 - 6.955238936429525e-6im; -0.2679340764267876 - 0.27990581233202566im -0.43408975113363735 - 0.45185941901954313im … 0.12324661623879633 + 0.12874921573650394im 3.924013476320461e-6 + 4.098866713528091e-6im; … ; -0.00787861518588384 - 0.008230644690905715im -0.0011386897786866675 - 0.0011853025796631537im … -0.011184480180299074 - 0.01168516860548828im -0.013835999226755847 + 0.04207330264989321im; 0.04507111067149104 + 0.04708496214235927im -0.008649504311617562 - 0.009003575833986182im … -0.09362351745025571 - 0.09779972049751826im -0.14706630461369008 + 0.44709369882927696im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.1667770759636101, 0.2642777178291922, 0.26427771782919757, 0.2642777178292026, 0.3573203719041459, 0.3573203719041541, 0.3573203719041604], [-0.11613218761139597, 0.07040532319947558, 0.22624813602958152, 0.22624813602958235, 0.3361178489454459, 0.39343797761762855, 0.3934379776176291], [-0.0958893814369681, 0.08764319967892165, 0.17312704142685953, 0.17312704142686205, 0.29197248922089797, 0.3377321250725206, 0.5327646516179338], [-0.045051463486549134, 0.022269526239200317, 0.09831189251487413, 0.184464093220591, 0.3229270151620701, 0.48024696182838267, 0.5024422339965587]], X = [[-0.9299068664734869 + 0.21968132664277568im 1.8204351423453293e-13 + 4.658718475363954e-13im … -6.432026588893941e-11 - 1.0358530942935213e-10im 3.882870348026184e-11 + 6.630832444474249e-11im; -0.09371062026121924 + 0.022138209880458736im -0.197570142956895 + 0.3230838843868209im … -0.15215329565734456 + 0.03848630783109052im -0.5271931036579569 + 0.10180908082580903im; … ; -0.01147831029456368 + 0.0027116376100798987im 0.016381990398256396 - 0.04637279065651755im … -0.042126542786149204 - 0.04649097615625382im -0.09073547576001224 + 0.03804025382571412im; 0.09371062026124329 - 0.022138209880424652im -0.037186825264152096 - 0.130916016447643im … -0.19494027508030287 - 0.4215397920800021im -0.22040445267916514 + 0.21161629698696569im], [-0.8015023521250835 + 0.4692007334226998im -0.1969659004785435 + 0.007912240170864148im … 2.218802901809677e-11 + 2.330720122061892e-10im -3.4072953143595876e-10 - 9.14024870639449e-11im; -0.05463996006270695 + 0.0319863182779633im 0.00876639699408694 - 0.0003521515058707151im … -6.633751292804457e-10 + 4.0974457913099797e-10im 3.6054607327762235e-10 - 1.071528252665456e-9im; … ; -0.0066889191103769435 + 0.003915703733207741im -0.0861891194311211 + 0.003462269415207198im … -0.050814568726897255 + 0.0573270270009188im -0.06785959970820844 + 0.04003473004385552im; 0.097460496737585 - 0.057053527575772395im 0.09063445943761002 - 0.0036408414303836767im … -0.2156854352203218 + 0.24332794752458936im -0.28803407296145694 + 0.1699297731058333im], [0.30029357046373456 + 0.8841462123084074im 2.037121149012421e-15 - 6.487795787988594e-15im … -7.061104416842006e-11 + 8.097004116163251e-11im -3.2247264892089636e-9 - 2.860471299574951e-8im; 0.022109491274031338 + 0.06509637530971554im 0.019469982300565562 - 0.05377407218653312im … 0.024367575974723006 - 0.006351843752214437im 0.007644963319873622 + 0.007985978505006411im; … ; 0.00446067232093142 + 0.013133436492832136im 5.297455613953888e-14 - 1.7977743039552263e-13im … -5.686863285485292e-10 + 3.583349220073481e-10im -0.019283062914434042 + 0.0630933443150163im; -0.04927182092673542 - 0.145069685570155im 0.09775016683646127 - 0.26997582465995046im … -0.3694980916201495 + 0.09631626187831349im -0.047820177584284314 + 0.14539334809168325im], [-0.5594238062360904 - 0.5844197834431606im 4.448375121603822e-15 + 4.642962831392407e-15im … -0.12961182171795624 - 0.13539860897377162im -6.6584990936517206e-6 - 6.955238936429525e-6im; -0.2679340764267876 - 0.27990581233202566im -0.43408975113363735 - 0.45185941901954313im … 0.12324661623879633 + 0.12874921573650394im 3.924013476320461e-6 + 4.098866713528091e-6im; … ; -0.00787861518588384 - 0.008230644690905715im -0.0011386897786866675 - 0.0011853025796631537im … -0.011184480180299074 - 0.01168516860548828im -0.013835999226755847 + 0.04207330264989321im; 0.04507111067149104 + 0.04708496214235927im -0.008649504311617562 - 0.009003575833986182im … -0.09362351745025571 - 0.09779972049751826im -0.14706630461369008 + 0.44709369882927696im]], residual_norms = [[2.8617633282450643e-12, 3.0993123489960525e-12, 9.367884977569572e-13, 1.3373539842290238e-12, 3.6556302727162364e-9, 2.8769012801036062e-9, 1.746538251541135e-9], [4.154154454596599e-12, 3.3343996784982403e-12, 6.589191549409602e-12, 3.363432414357858e-12, 1.9378784208641286e-9, 4.892267893233055e-9, 6.137778405629875e-9], [4.731053714746265e-12, 1.5251419096605642e-12, 3.6039312339621133e-12, 3.341986138211609e-12, 4.1564724348490346e-10, 8.744840851848816e-9, 5.854364661293309e-7], [5.909315621650455e-12, 2.608241764653737e-12, 4.357529322926502e-12, 5.9340862276870825e-12, 9.163413830749561e-9, 3.406926616022615e-5, 1.921380772463446e-5]], iterations = [28, 19, 19, 18], converged = 1, n_matvec = 581)], stage = :finalize, algorithm = &quot;SCF&quot;, occupation_threshold = 1.0e-6)</code></pre><h2 id="Direct-minimization"><a class="docs-heading-anchor" href="#Direct-minimization">Direct minimization</a><a id="Direct-minimization-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-minimization" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_dm = direct_minimization(basis; tol)

# Newton algorithm</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3915556369663311 0.3785174208383219 … 0.34469960022371 0.37851742083832196; 0.3785174208383219 0.36645844059431626 … 0.32735728167513234 0.36364954256135795; … ; 0.34469960022370993 0.3273572816751323 … 0.3075192693901794 0.3343805319474643; 0.37851742083832185 0.36364954256135784 … 0.3343805319474643 0.36645844059431615;;; 0.3785174208383219 0.3664584405943162 … 0.3273572816751324 0.36364954256135795; 0.36645844059431615 0.35102886337130873 … 0.3111940134149062 0.35191706629557284; … ; 0.32735728167513234 0.3111940134149062 … 0.29824122838699274 0.3214260027759877; 0.36364954256135795 0.3519170662955727 … 0.3214260027759877 0.35191706629557273;;; 0.34469960022370993 0.3343805319474644 … 0.28653515372400445 0.3273572816751324; 0.3343805319474644 0.3186160477277185 … 0.27805891878865097 0.3214260027759878; … ; 0.2865351537240044 0.27805891878865097 … 0.255901857701422 0.27805891878865097; 0.3273572816751323 0.32142600277598765 … 0.2780589187886509 0.3111940134149062;;; … ;;; 0.3048747492605077 0.2830366689329269 … 0.2855643322973116 0.3009573704936208; 0.28303666893292684 0.25898431619134943 … 0.27263300127450435 0.28541419660482964; … ; 0.2855643322973115 0.2726330012745043 … 0.27716038910846924 0.2812108737569504; 0.30095737049362076 0.28541419660482953 … 0.2812108737569504 0.293082726245133;;; 0.34469960022371 0.3273572816751324 … 0.3075192693901794 0.3343805319474645; 0.3273572816751324 0.3111940134149062 … 0.29824122838699285 0.32142600277598776; … ; 0.3075192693901794 0.2982412283869928 … 0.2771603891084693 0.29313119144060074; 0.3343805319474643 0.32142600277598765 … 0.2931311914406008 0.3186160477277184;;; 0.3785174208383219 0.36364954256135795 … 0.3343805319474644 0.3664584405943162; 0.36364954256135795 0.35191706629557284 … 0.32142600277598776 0.3519170662955728; … ; 0.3343805319474644 0.3214260027759877 … 0.29313119144060074 0.3186160477277184; 0.3664584405943161 0.3519170662955726 … 0.31861604772771834 0.3510288633713086]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081922765161 -0.4966565571926346 … -0.4771919009397553 -0.4966565571926345; -0.4966565571926345 -0.4848182086803746 … -0.4763804457419404 -0.4920413111378461; … ; -0.4771919009397553 -0.4763804457419404 … -0.41228807085827096 -0.45507008153320083; -0.4966565571926345 -0.4920413111378461 … -0.45507008153320083 -0.4848182086803747;;; -0.4966565571926345 -0.48481820868037473 … -0.4763804457419404 -0.4920413111378461; -0.48481820868037473 -0.45837440788443623 … -0.47065601568120063 -0.4861790251471163; … ; -0.4763804457419404 -0.47065601568120063 … -0.4463984364271961 -0.4688943963720205; -0.4920413111378461 -0.48617902514711625 … -0.4688943963720205 -0.4861790251471162;;; -0.4771919009397553 -0.45507008153320094 … -0.46051412340119346 -0.4763804457419404; -0.45507008153320094 -0.4090661824137952 … -0.45671990830367803 -0.4688943963720205; … ; -0.46051412340119346 -0.45671990830367803 … -0.44514495659714887 -0.45671990830367803; -0.4763804457419404 -0.4688943963720205 … -0.45671990830367803 -0.4706560156812005;;; … ;;; -0.44947595082847885 -0.45514997218876363 … -0.37125986261330746 -0.41774571519210646; -0.45514997218876363 -0.44880351098175447 … -0.41743801071834635 -0.4441260992929654; … ; -0.37125986261330746 -0.41743801071834635 … -0.253656983259762 -0.2997980910435204; -0.4177457151921064 -0.44412609929296537 … -0.2997980910435204 -0.361063432632848;;; -0.4771919009397553 -0.4763804457419404 … -0.41228807085827096 -0.45507008153320094; -0.4763804457419404 -0.4706560156812005 … -0.4463984364271962 -0.46889439637202057; … ; -0.41228807085827096 -0.4463984364271962 … -0.2536569832597621 -0.3410633022791024; -0.45507008153320094 -0.46889439637202057 … -0.3410633022791024 -0.4090661824137953;;; -0.4966565571926345 -0.4920413111378462 … -0.45507008153320094 -0.48481820868037473; -0.4920413111378462 -0.48617902514711625 … -0.4688943963720205 -0.48617902514711625; … ; -0.45507008153320094 -0.4688943963720205 … -0.3410633022791024 -0.4090661824137953; -0.48481820868037473 -0.48617902514711625 … -0.4090661824137953 -0.45837440788443623])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392129775306 -0.4868367443055645 … -0.7027113226404706 -0.4868367443055645; -0.48683674430556423 -0.774430395063701 … -0.41363732846160284 -0.38233074982210447; … ; -0.702711322640471 -0.4136373284616031 … -2.3967616826007765 -1.2958067581911619; -0.4868367443055642 -0.38233074982210447 … -1.295806758191162 -0.774430395063701;;; -0.48683674430556434 -0.7744303950637013 … -0.4136373284616028 -0.38233074982210474; -0.774430395063701 -1.4814477484078723 … -0.3245845694544447 -0.4499193965958148; … ; -0.41363732846160295 -0.3245845694544451 … -1.0113572986279329 -0.6373277792127935; -0.3823307498221043 -0.4499193965958149 … -0.6373277792127933 -0.4499193965958147;;; -0.7027113226404708 -1.2958067581911623 … -0.2982034893940342 -0.413637328461603; -1.295806758191162 -2.9196723936638183 … -0.3537295846788302 -0.6373277792127932; … ; -0.2982034893940343 -0.35372958467883076 … -0.4903726081225384 -0.35372958467883064; -0.4136373284616029 -0.6373277792127934 … -0.3537295846788301 -0.3245845694544446;;; … ;;; -1.0166744212718803 -0.5332878143233252 … -3.636138257138498 -1.9987602620647595; -0.5332878143233251 -0.32174124748931726 … -1.4667339407672535 -0.9061938941628669; … ; -3.636138257138499 -1.4667339407672535 … -10.98817782447082 -8.087376168218942; -1.9987602620647593 -0.9061938941628669 … -8.087376168218942 -4.64787837115462;;; -0.7027113226404706 -0.4136373284616028 … -2.396761682600777 -1.295806758191162; -0.41363732846160267 -0.32458456945444486 … -1.0113572986279329 -0.6373277792127933; … ; -2.396761682600777 -1.011357298627933 … -11.002806190879927 -6.077304186401963; -1.295806758191162 -0.6373277792127932 … -6.077304186401963 -2.9196723936638187;;; -0.4868367443055644 -0.38233074982210474 … -1.295806758191162 -0.7744303950637013; -0.3823307498221045 -0.4499193965958148 … -0.6373277792127932 -0.4499193965958148; … ; -1.295806758191162 -0.6373277792127934 … -6.077304186401962 -2.9196723936638183; -0.774430395063701 -0.4499193965958148 … -2.9196723936638183 -1.4814477484078725]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.1270504662175337 + 0.07625636295999885im -0.0025531487196218316 + 0.12200562166335356im … 0.06488914105876561 + 0.08205795313376038im -0.0025531460263493403 + 0.12200561611628992im; -0.04666704971938465 - 0.07058142894805258im 0.10387189728576239 - 0.03682979050608241im … 0.021667066256415294 + 0.059234746754272066im -0.01994502740618071 + 0.018350632860570378im; … ; 0.020580598407799123 - 0.11137882847481131im -0.005644339267723922 - 0.05999802265776992im … 0.017660465063301427 - 0.010599904141808556im 0.06839425376588527 - 0.047932573849198294im; -0.046667049046924786 - 0.07058142803153054im -0.01994502908712585 + 0.018350638182149263im … 0.07621825344785266 - 0.013775516878837595im 0.10387189815101812 - 0.036829791170214066im;;; -0.005821580715877567 + 0.0954574009118099im 0.15149827025613488 + 0.15677374878187916im … 0.01728635645275116 + 0.04142694656361502im -0.008036836347457232 + 0.06675801100923318im; 0.10006085941332588 - 0.06778537263527559im 0.22156445524963903 - 0.019138932356706495im … 0.005621299941710624 + 0.015942428137965845im 0.008537560140634896 - 0.029703243184093637im; … ; -0.0052937969025608185 - 0.0571507051006977im 0.0003806252637395234 - 0.006936660157675293im … 0.013080164260409487 - 0.017374063425087148im 0.0145669350741514 - 0.04599311425589248im; -0.0208979152167839 + 0.010610700992464831im 0.0377392903190098 + 0.09778208351409551im … 0.024544079975959764 - 0.0024361234333167177im 0.010701139659497708 - 0.012129329631600282im;;; 0.06160628592450458 + 0.05539260077777115im 0.09543240596746577 + 0.06197883756843105im … 0.005649389371087998 + 0.014422704394404729im 0.015262832650287415 + 0.02499065228544746im; 0.07405467457067386 - 0.03134942946086383im 0.07188794583697815 - 0.03676800008755546im … 0.00477879836626769 - 0.0031635423637952605im 0.022192255200122538 - 0.021539079968925866im; … ; 0.0019502928808104673 - 0.001726354229852643im 0.011141462569763338 + 0.024613795415328696im … 0.003672150528519438 - 0.01007273731875424im 0.0015258970369798827 - 0.014473950294648742im; 0.01999408460895642 + 0.04564577099060575im 0.043957580232212294 + 0.0734812976709576im … 0.0055482311590827026 + 0.0030862604839047127im 0.0052330141848042685 + 0.01278853516843757im;;; … ;;; 0.01816230397780383 + 0.008673931958782527im 0.010972113106452155 + 0.007327924474600421im … -0.029951991392195735 - 0.03758569292155241im 0.004394083150896734 - 0.00826681798827844im; 0.014748800616464308 + 0.023815722495056698im 0.00683257965122055 + 0.012117206018444165im … 0.0004921078980561132 - 6.703268865438523e-5im 0.015202414901777168 + 0.02233101468203592im; … ; -0.021284327792138593 + 0.00025452525085829824im -0.0010276106559927046 - 0.006701634777217441im … -0.09481682576129216 - 0.01122641835915263im -0.0717255636408145 - 0.0017260532942504122im; 0.0024549651473071915 - 0.01673238230444585im 0.007810615299601234 - 0.009939196214391263im … -0.08351374371052364 - 0.05318943973158331im -0.03875197404383009 - 0.03602319076004801im;;; 0.061606285935838244 + 0.055392601990722753im 0.0152628321641503 + 0.02499065504866369im … 0.01766046532325192 - 0.010599904755371743im 0.09543240571422301 + 0.061978836428510035im; 0.019994084330722188 + 0.04564577277196512im 0.005233013486921579 + 0.012788537226504793im … 0.02724499764675673 + 0.040206677245332306im 0.04395758022916994 + 0.07348129784646898im; … ; 0.01766046597069559 - 0.010599906890446407im 0.011946702066420872 - 0.02658074270971396im … -0.15508849220891469 - 0.021262601032546923im -0.04738119804835904 + 0.011458902686496441im; 0.07405467526818488 - 0.031349432807974933im 0.022192255603141982 - 0.021539080233917207im … -0.06875892935617521 - 0.08186936376507017im 0.07188794510452201 - 0.03676800362318791im;;; -0.005821580771174413 + 0.09545740373583098im -0.008036838616713364 + 0.06675801791170669im … 0.0960120917317982 + 0.06668740402009418im 0.1514982709858934 + 0.1567737471605915im; -0.02089791578922804 + 0.010610702569584594im 0.010701138227577019 - 0.012129327556311758im … 0.044696794907927884 + 0.07948564931204935im 0.03773929112561289 + 0.0977820818596719im; … ; 0.06681036157425632 - 0.06079792217214958im 0.012954325344302629 - 0.05909171959409813im … -0.048965091444353716 - 0.001406442072222127im 0.08379613556712534 + 0.011639376104599315im; 0.10006086025363256 - 0.06778537360473308im 0.008537559718914975 - 0.029703240170643012im … 0.07093505669306617 - 0.04450793390727931im 0.2215644543595917 - 0.01913893378546627im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3915556369663311 0.3785174208383219 … 0.34469960022371 0.37851742083832196; 0.3785174208383219 0.36645844059431626 … 0.32735728167513234 0.36364954256135795; … ; 0.34469960022370993 0.3273572816751323 … 0.3075192693901794 0.3343805319474643; 0.37851742083832185 0.36364954256135784 … 0.3343805319474643 0.36645844059431615;;; 0.3785174208383219 0.3664584405943162 … 0.3273572816751324 0.36364954256135795; 0.36645844059431615 0.35102886337130873 … 0.3111940134149062 0.35191706629557284; … ; 0.32735728167513234 0.3111940134149062 … 0.29824122838699274 0.3214260027759877; 0.36364954256135795 0.3519170662955727 … 0.3214260027759877 0.35191706629557273;;; 0.34469960022370993 0.3343805319474644 … 0.28653515372400445 0.3273572816751324; 0.3343805319474644 0.3186160477277185 … 0.27805891878865097 0.3214260027759878; … ; 0.2865351537240044 0.27805891878865097 … 0.255901857701422 0.27805891878865097; 0.3273572816751323 0.32142600277598765 … 0.2780589187886509 0.3111940134149062;;; … ;;; 0.3048747492605077 0.2830366689329269 … 0.2855643322973116 0.3009573704936208; 0.28303666893292684 0.25898431619134943 … 0.27263300127450435 0.28541419660482964; … ; 0.2855643322973115 0.2726330012745043 … 0.27716038910846924 0.2812108737569504; 0.30095737049362076 0.28541419660482953 … 0.2812108737569504 0.293082726245133;;; 0.34469960022371 0.3273572816751324 … 0.3075192693901794 0.3343805319474645; 0.3273572816751324 0.3111940134149062 … 0.29824122838699285 0.32142600277598776; … ; 0.3075192693901794 0.2982412283869928 … 0.2771603891084693 0.29313119144060074; 0.3343805319474643 0.32142600277598765 … 0.2931311914406008 0.3186160477277184;;; 0.3785174208383219 0.36364954256135795 … 0.3343805319474644 0.3664584405943162; 0.36364954256135795 0.35191706629557284 … 0.32142600277598776 0.3519170662955728; … ; 0.3343805319474644 0.3214260027759877 … 0.29313119144060074 0.3186160477277184; 0.3664584405943161 0.3519170662955726 … 0.31861604772771834 0.3510288633713086]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081922765161 -0.4966565571926346 … -0.4771919009397553 -0.4966565571926345; -0.4966565571926345 -0.4848182086803746 … -0.4763804457419404 -0.4920413111378461; … ; -0.4771919009397553 -0.4763804457419404 … -0.41228807085827096 -0.45507008153320083; -0.4966565571926345 -0.4920413111378461 … -0.45507008153320083 -0.4848182086803747;;; -0.4966565571926345 -0.48481820868037473 … -0.4763804457419404 -0.4920413111378461; -0.48481820868037473 -0.45837440788443623 … -0.47065601568120063 -0.4861790251471163; … ; -0.4763804457419404 -0.47065601568120063 … -0.4463984364271961 -0.4688943963720205; -0.4920413111378461 -0.48617902514711625 … -0.4688943963720205 -0.4861790251471162;;; -0.4771919009397553 -0.45507008153320094 … -0.46051412340119346 -0.4763804457419404; -0.45507008153320094 -0.4090661824137952 … -0.45671990830367803 -0.4688943963720205; … ; -0.46051412340119346 -0.45671990830367803 … -0.44514495659714887 -0.45671990830367803; -0.4763804457419404 -0.4688943963720205 … -0.45671990830367803 -0.4706560156812005;;; … ;;; -0.44947595082847885 -0.45514997218876363 … -0.37125986261330746 -0.41774571519210646; -0.45514997218876363 -0.44880351098175447 … -0.41743801071834635 -0.4441260992929654; … ; -0.37125986261330746 -0.41743801071834635 … -0.253656983259762 -0.2997980910435204; -0.4177457151921064 -0.44412609929296537 … -0.2997980910435204 -0.361063432632848;;; -0.4771919009397553 -0.4763804457419404 … -0.41228807085827096 -0.45507008153320094; -0.4763804457419404 -0.4706560156812005 … -0.4463984364271962 -0.46889439637202057; … ; -0.41228807085827096 -0.4463984364271962 … -0.2536569832597621 -0.3410633022791024; -0.45507008153320094 -0.46889439637202057 … -0.3410633022791024 -0.4090661824137953;;; -0.4966565571926345 -0.4920413111378462 … -0.45507008153320094 -0.48481820868037473; -0.4920413111378462 -0.48617902514711625 … -0.4688943963720205 -0.48617902514711625; … ; -0.45507008153320094 -0.4688943963720205 … -0.3410633022791024 -0.4090661824137953; -0.48481820868037473 -0.48617902514711625 … -0.4090661824137953 -0.45837440788443623])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392129775306 -0.4868367443055645 … -0.7027113226404706 -0.4868367443055645; -0.48683674430556423 -0.774430395063701 … -0.41363732846160284 -0.38233074982210447; … ; -0.702711322640471 -0.4136373284616031 … -2.3967616826007765 -1.2958067581911619; -0.4868367443055642 -0.38233074982210447 … -1.295806758191162 -0.774430395063701;;; -0.48683674430556434 -0.7744303950637013 … -0.4136373284616028 -0.38233074982210474; -0.774430395063701 -1.4814477484078723 … -0.3245845694544447 -0.4499193965958148; … ; -0.41363732846160295 -0.3245845694544451 … -1.0113572986279329 -0.6373277792127935; -0.3823307498221043 -0.4499193965958149 … -0.6373277792127933 -0.4499193965958147;;; -0.7027113226404708 -1.2958067581911623 … -0.2982034893940342 -0.413637328461603; -1.295806758191162 -2.9196723936638183 … -0.3537295846788302 -0.6373277792127932; … ; -0.2982034893940343 -0.35372958467883076 … -0.4903726081225384 -0.35372958467883064; -0.4136373284616029 -0.6373277792127934 … -0.3537295846788301 -0.3245845694544446;;; … ;;; -1.0166744212718803 -0.5332878143233252 … -3.636138257138498 -1.9987602620647595; -0.5332878143233251 -0.32174124748931726 … -1.4667339407672535 -0.9061938941628669; … ; -3.636138257138499 -1.4667339407672535 … -10.98817782447082 -8.087376168218942; -1.9987602620647593 -0.9061938941628669 … -8.087376168218942 -4.64787837115462;;; -0.7027113226404706 -0.4136373284616028 … -2.396761682600777 -1.295806758191162; -0.41363732846160267 -0.32458456945444486 … -1.0113572986279329 -0.6373277792127933; … ; -2.396761682600777 -1.011357298627933 … -11.002806190879927 -6.077304186401963; -1.295806758191162 -0.6373277792127932 … -6.077304186401963 -2.9196723936638187;;; -0.4868367443055644 -0.38233074982210474 … -1.295806758191162 -0.7744303950637013; -0.3823307498221045 -0.4499193965958148 … -0.6373277792127932 -0.4499193965958148; … ; -1.295806758191162 -0.6373277792127934 … -6.077304186401962 -2.9196723936638183; -0.774430395063701 -0.4499193965958148 … -2.9196723936638183 -1.4814477484078725]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.2287897298021706 + 0.15214501248276835im -0.11850357197467085 + 0.005143268354753949im … -0.0142185057462699 + 0.0009147709440779292im -0.13451361214590724 + 0.08859280470852182im; -0.11080621184656117 + 0.045093074707163054im -0.007073873482216866 - 0.0295872409484359im … -0.019693049979715167 - 0.0011740437408634071im -0.07465740758427959 + 0.02953596316673287im; … ; -0.0545854626894401 + 0.12413543770636583im -0.0437910947429894 + 0.0881321811055585im … 0.030226241777114086 - 0.04004321768664218im 0.011789642946185447 - 0.001980869631703207im; -0.18283566902087034 + 0.2389840730562147im -0.11446580561323579 + 0.11587611109183932im … 0.014019984743840475 - 0.005468104741725846im -0.0619307183583106 + 0.10910808743007062im;;; -0.21711230825262248 + 0.07559533037707925im -0.08356199207328863 - 0.07748910594879492im … -0.01888737867241964 + 0.006966099709439755im -0.12658802685419437 + 0.06800507928517491im; -0.07724225111482187 + 0.020545304209017602im 0.06801379840436253 - 0.07414083483132988im … -0.0248976661538439 + 0.008187666077085863im -0.07515033451896176 + 0.036241019507453336im; … ; -0.03788384275019177 + 0.08391168194549829im -0.035982150498314144 + 0.047012257930303225im … 0.01686492478365942 - 0.008469689702316041im 0.0015999950883965903 + 0.030597179132037154im; -0.15865852695206242 + 0.14745007148299977im -0.1027353260092173 + 0.021745501926422682im … 0.007301108489623391 + 0.004309584525394473im -0.05751744431669706 + 0.07797025507925999im;;; -0.08832734913434973 + 0.009409158309805092im 0.005409788138387805 - 0.06664603847497994im … -0.02206942662561783 + 0.010401038033766345im -0.06832775666203947 + 0.029528813333858824im; 0.012786372480688304 - 0.013120727855218409im 0.132916894482342 - 0.06938049140105851im … -0.02120028918716957 + 0.011009979636330644im -0.034088479328407494 + 0.01806669092446178im; … ; -0.028019514295297785 + 0.030445843951525595im -0.025495717006645637 + 0.008216717636415495im … 0.006074131547027917 + 0.0021380012919270143im -0.008327369397868666 + 0.020437483500393067im; -0.07705113858145879 + 0.03149083044899903im -0.044036427180901526 - 0.021374746233507054im … -0.0058095174830040544 + 0.007578802018789748im -0.042670879566560585 + 0.031432519003820936im;;; … ;;; -0.01683115440104834 + 0.010694481676985234im -0.018828501213362044 + 0.011053070739337678im … 0.02134727159414972 - 0.004116884951807843im 0.004880885924522228 + 0.000640159739834525im; -0.01530752068645859 + 0.004666375465222654im -0.010939093622882576 + 0.0026417348644093026im … 0.0020582457850963467 + 0.0012452102606896173im -0.00827444075232631 + 0.0027158714061407685im; … ; 0.034587231303361415 - 0.028933746032379165im 0.0009780038939572453 - 0.0022758073641307676im … 0.06909318929091304 - 0.03151330299969914im 0.07838739471185316 - 0.05191271784018637im; 0.0039618110144670265 - 0.0007854927281998737im -0.01518211022696089 + 0.01240410362356357im … 0.057370939079106134 - 0.023892757184521843im 0.04590177907434739 - 0.024635065697160202im;;; -0.07163199661354064 + 0.041934451311020554im -0.04261946522142246 + 0.023921741975100864im … 0.0072425338362213845 - 0.000902244298299142im -0.03573221687116699 + 0.01555777325222661im; -0.03504882103402095 + 0.00979705063956762im -0.015890676255845157 + 0.0017525263171749039im … -0.007993847132586305 + 0.0002699422969969674im -0.02749207542029878 + 0.004698478553274694im; … ; 0.011865001172694694 - 0.02692483376018391im -0.022982631047520047 + 0.019999821034844295im … 0.12298493085270089 - 0.077716232312467im 0.10621498541351498 - 0.10820865891017067im; -0.06162640260717066 + 0.04857826247554595im -0.05099469224806045 + 0.04595964043764977im … 0.0661953913572583 - 0.03514160421348522im 0.017089498158450307 - 0.021624122218361345im;;; -0.17742652908311496 + 0.11925239563950654im -0.081159205691262 + 0.03554797440775992im … -0.015606028308414104 + 0.0011784034263526216im -0.1016622464434731 + 0.053218152395251225im; -0.06990187132681608 + 0.026138319812378144im -0.01942846889221033 - 0.0035700610053817925im … -0.016492297632530573 - 0.0031604299227854485im -0.0523907335525381 + 0.012089249822210772im; … ; -0.04689840866765095 + 0.03994943398011841im -0.04688271483396107 + 0.06523616773333456im … 0.07258945483709159 - 0.0841845404193243im 0.04598274731342775 - 0.1009931341407456im; -0.15581844833063632 + 0.17618717634283962im -0.0970543889043123 + 0.10621784648269764im … 0.021173572056988353 - 0.02454203220830877im -0.034305025957472486 + 0.02806562800855677im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3915556369663311 0.3785174208383219 … 0.34469960022371 0.37851742083832196; 0.3785174208383219 0.36645844059431626 … 0.32735728167513234 0.36364954256135795; … ; 0.34469960022370993 0.3273572816751323 … 0.3075192693901794 0.3343805319474643; 0.37851742083832185 0.36364954256135784 … 0.3343805319474643 0.36645844059431615;;; 0.3785174208383219 0.3664584405943162 … 0.3273572816751324 0.36364954256135795; 0.36645844059431615 0.35102886337130873 … 0.3111940134149062 0.35191706629557284; … ; 0.32735728167513234 0.3111940134149062 … 0.29824122838699274 0.3214260027759877; 0.36364954256135795 0.3519170662955727 … 0.3214260027759877 0.35191706629557273;;; 0.34469960022370993 0.3343805319474644 … 0.28653515372400445 0.3273572816751324; 0.3343805319474644 0.3186160477277185 … 0.27805891878865097 0.3214260027759878; … ; 0.2865351537240044 0.27805891878865097 … 0.255901857701422 0.27805891878865097; 0.3273572816751323 0.32142600277598765 … 0.2780589187886509 0.3111940134149062;;; … ;;; 0.3048747492605077 0.2830366689329269 … 0.2855643322973116 0.3009573704936208; 0.28303666893292684 0.25898431619134943 … 0.27263300127450435 0.28541419660482964; … ; 0.2855643322973115 0.2726330012745043 … 0.27716038910846924 0.2812108737569504; 0.30095737049362076 0.28541419660482953 … 0.2812108737569504 0.293082726245133;;; 0.34469960022371 0.3273572816751324 … 0.3075192693901794 0.3343805319474645; 0.3273572816751324 0.3111940134149062 … 0.29824122838699285 0.32142600277598776; … ; 0.3075192693901794 0.2982412283869928 … 0.2771603891084693 0.29313119144060074; 0.3343805319474643 0.32142600277598765 … 0.2931311914406008 0.3186160477277184;;; 0.3785174208383219 0.36364954256135795 … 0.3343805319474644 0.3664584405943162; 0.36364954256135795 0.35191706629557284 … 0.32142600277598776 0.3519170662955728; … ; 0.3343805319474644 0.3214260027759877 … 0.29313119144060074 0.3186160477277184; 0.3664584405943161 0.3519170662955726 … 0.31861604772771834 0.3510288633713086]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081922765161 -0.4966565571926346 … -0.4771919009397553 -0.4966565571926345; -0.4966565571926345 -0.4848182086803746 … -0.4763804457419404 -0.4920413111378461; … ; -0.4771919009397553 -0.4763804457419404 … -0.41228807085827096 -0.45507008153320083; -0.4966565571926345 -0.4920413111378461 … -0.45507008153320083 -0.4848182086803747;;; -0.4966565571926345 -0.48481820868037473 … -0.4763804457419404 -0.4920413111378461; -0.48481820868037473 -0.45837440788443623 … -0.47065601568120063 -0.4861790251471163; … ; -0.4763804457419404 -0.47065601568120063 … -0.4463984364271961 -0.4688943963720205; -0.4920413111378461 -0.48617902514711625 … -0.4688943963720205 -0.4861790251471162;;; -0.4771919009397553 -0.45507008153320094 … -0.46051412340119346 -0.4763804457419404; -0.45507008153320094 -0.4090661824137952 … -0.45671990830367803 -0.4688943963720205; … ; -0.46051412340119346 -0.45671990830367803 … -0.44514495659714887 -0.45671990830367803; -0.4763804457419404 -0.4688943963720205 … -0.45671990830367803 -0.4706560156812005;;; … ;;; -0.44947595082847885 -0.45514997218876363 … -0.37125986261330746 -0.41774571519210646; -0.45514997218876363 -0.44880351098175447 … -0.41743801071834635 -0.4441260992929654; … ; -0.37125986261330746 -0.41743801071834635 … -0.253656983259762 -0.2997980910435204; -0.4177457151921064 -0.44412609929296537 … -0.2997980910435204 -0.361063432632848;;; -0.4771919009397553 -0.4763804457419404 … -0.41228807085827096 -0.45507008153320094; -0.4763804457419404 -0.4706560156812005 … -0.4463984364271962 -0.46889439637202057; … ; -0.41228807085827096 -0.4463984364271962 … -0.2536569832597621 -0.3410633022791024; -0.45507008153320094 -0.46889439637202057 … -0.3410633022791024 -0.4090661824137953;;; -0.4966565571926345 -0.4920413111378462 … -0.45507008153320094 -0.48481820868037473; -0.4920413111378462 -0.48617902514711625 … -0.4688943963720205 -0.48617902514711625; … ; -0.45507008153320094 -0.4688943963720205 … -0.3410633022791024 -0.4090661824137953; -0.48481820868037473 -0.48617902514711625 … -0.4090661824137953 -0.45837440788443623])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392129775306 -0.4868367443055645 … -0.7027113226404706 -0.4868367443055645; -0.48683674430556423 -0.774430395063701 … -0.41363732846160284 -0.38233074982210447; … ; -0.702711322640471 -0.4136373284616031 … -2.3967616826007765 -1.2958067581911619; -0.4868367443055642 -0.38233074982210447 … -1.295806758191162 -0.774430395063701;;; -0.48683674430556434 -0.7744303950637013 … -0.4136373284616028 -0.38233074982210474; -0.774430395063701 -1.4814477484078723 … -0.3245845694544447 -0.4499193965958148; … ; -0.41363732846160295 -0.3245845694544451 … -1.0113572986279329 -0.6373277792127935; -0.3823307498221043 -0.4499193965958149 … -0.6373277792127933 -0.4499193965958147;;; -0.7027113226404708 -1.2958067581911623 … -0.2982034893940342 -0.413637328461603; -1.295806758191162 -2.9196723936638183 … -0.3537295846788302 -0.6373277792127932; … ; -0.2982034893940343 -0.35372958467883076 … -0.4903726081225384 -0.35372958467883064; -0.4136373284616029 -0.6373277792127934 … -0.3537295846788301 -0.3245845694544446;;; … ;;; -1.0166744212718803 -0.5332878143233252 … -3.636138257138498 -1.9987602620647595; -0.5332878143233251 -0.32174124748931726 … -1.4667339407672535 -0.9061938941628669; … ; -3.636138257138499 -1.4667339407672535 … -10.98817782447082 -8.087376168218942; -1.9987602620647593 -0.9061938941628669 … -8.087376168218942 -4.64787837115462;;; -0.7027113226404706 -0.4136373284616028 … -2.396761682600777 -1.295806758191162; -0.41363732846160267 -0.32458456945444486 … -1.0113572986279329 -0.6373277792127933; … ; -2.396761682600777 -1.011357298627933 … -11.002806190879927 -6.077304186401963; -1.295806758191162 -0.6373277792127932 … -6.077304186401963 -2.9196723936638187;;; -0.4868367443055644 -0.38233074982210474 … -1.295806758191162 -0.7744303950637013; -0.3823307498221045 -0.4499193965958148 … -0.6373277792127932 -0.4499193965958148; … ; -1.295806758191162 -0.6373277792127934 … -6.077304186401962 -2.9196723936638183; -0.774430395063701 -0.4499193965958148 … -2.9196723936638183 -1.4814477484078725]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.010085908826709138 + 0.1315083239427463im -0.00856787671395294 + 0.0700940540151302im … 0.04822277572962 + 0.0011507876963171692im 0.05983306257970719 + 0.06652294286454659im; -0.017752584869373436 + 0.07093342886410947im -0.0018765083661431278 + 0.00012932402255338721im … 0.02672610522915521 + 0.009337929734202333im 0.02291660617233182 + 0.046350146927473815im; … ; 0.00041276616406282383 + 0.0055200630407494225im -0.013621942653384407 + 0.013025268969280038im … 0.0009957363886731298 - 0.012983209404527097im 0.03337877077859612 - 0.02174854751573299im; -0.0019190639891497603 + 0.07216636430263754im -0.0198657568943408 + 0.050259953967241075im … 0.031159049095152498 - 0.02154569113062031im 0.06325397490001419 - 0.004359337953588225im;;; 0.091618029592923 - 0.08271110760685259im 0.08380582902628608 - 0.10453359458676154im … 0.032294300211860826 + 0.003883636422873143im 0.0896383137936056 - 0.04396425889569437im; 0.042719366414717394 - 0.10077877279435457im 0.01714331167435201 - 0.09276196758658511im … 0.025907470289402896 - 0.010358171422081891im 0.045128267207119516 - 0.048275662394690826im; … ; -0.0031639320689261837 + 0.007124103753101962im 0.005176798788957958 - 0.008463630850262404im … -0.01084546514271769 + 0.024264387762753692im -0.006906300023400208 + 0.027540250091962995im; 0.05417358736844802 - 0.04072319822158669im 0.04933745789909279 - 0.04866033337563223im … 0.004353316260801032 + 0.026511252878709167im 0.034003373218947634 + 0.011769246935972139im;;; 0.07677877297301555 - 0.11466190944854207im 0.014396443906632625 - 0.03220498547790539im … 0.027296111651847397 - 0.023799546807291766im 0.06267871529038707 - 0.07980466717278488im; -0.013209565560999602 - 0.02968211938591379im -0.08216642216744052 + 0.05960613179140261im … 0.019047490306265055 - 0.02466211135904605im 0.022185493715308167 - 0.04865615426149561im; … ; 0.01682488861075203 - 0.022842599684044104im 0.01927929759467903 - 0.024683295937184876im … -0.004831277608630513 + 0.013578563911086208im 0.004735545763599738 - 0.0009539065661870391im; 0.061486669418363095 - 0.07969572826258575im 0.04197693902733129 - 0.05046486079413812im … 0.01103270277895663 - 0.0015293930018479476im 0.03928893003509651 - 0.04224810215823556im;;; … ;;; 0.02789240401569585 - 0.04073351973637447im 0.011277998440182799 - 0.016378696193062238im … -0.01078439436268469 + 0.0009847342702946843im 0.022212623101402665 - 0.037847428816170425im; 0.0134245905735032 - 0.01657486957684604im 0.0011066528898484198 + 0.0006079074601961156im … 0.00748872611312915 - 0.015755398095162045im 0.018969929630523318 - 0.026877672490242394im; … ; 0.0001590460828784815 - 1.5368055964147846e-5im 0.011851711496108502 - 0.016154123876504438im … -0.09431598026422437 + 0.11466287360458594im -0.05166964898145618 + 0.06291725123372129im; 0.025165696091251254 - 0.03811730511913167im 0.017620923177864737 - 0.026754389102447373im … -0.060133798295000415 + 0.06369077537560582im -0.0069802126340769806 - 0.0013985277420234762im;;; 0.050677984583142724 - 0.05982013918354903im 0.0016557852421918136 + 0.0040900730016571645im … 0.02891790594593515 - 0.06091593726928883im 0.08896573952884969 - 0.12008273458990346im; 0.008244628247459949 + 0.0034879298967006906im -0.010732352000529882 + 0.024255935979346714im … 0.025334214417211808 - 0.03405226843482717im 0.03442749218564098 - 0.033920692008748435im; … ; 0.0457616316333402 - 0.0624552565784236im 0.022736726105589092 - 0.03381488840495822im … -0.12695985042735083 + 0.1281430039991433im -0.003540691898247289 - 0.010828455811148406im; 0.0838389399105948 - 0.11961420513911691im 0.02130249687939681 - 0.03272122111778137im … -0.031146701354810753 - 0.008305589756131933im 0.10014728078899898 - 0.15766569474135694im;;; 0.021996603958460356 + 0.04611708632331127im -0.027797285192307834 + 0.07237722607989948im … 0.0725125878919758 - 0.0919224853971903im 0.1323673866855179 - 0.10788035748969999im; -0.018651652893290988 + 0.07154142235833814im -0.024071935767905433 + 0.053044637112742286im … 0.03403980082073027 - 0.021681830090624722im 0.032416248886175045 + 0.00920015979421792im; … ; 0.06830339708642963 - 0.09153781451533198im 0.009686343106975647 - 0.019456209130092363im … -0.024544200856383695 - 0.02304218828929213im 0.09695657789742103 - 0.13938573796650733im; 0.09128092401539922 - 0.10412553578024322im -0.0051074082344991535 + 0.01262938273616375im … 0.06149185153277331 - 0.13614467725726126im 0.17153383883291395 - 0.23089936837957753im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3915556369663311 0.3785174208383219 … 0.34469960022371 0.37851742083832196; 0.3785174208383219 0.36645844059431626 … 0.32735728167513234 0.36364954256135795; … ; 0.34469960022370993 0.3273572816751323 … 0.3075192693901794 0.3343805319474643; 0.37851742083832185 0.36364954256135784 … 0.3343805319474643 0.36645844059431615;;; 0.3785174208383219 0.3664584405943162 … 0.3273572816751324 0.36364954256135795; 0.36645844059431615 0.35102886337130873 … 0.3111940134149062 0.35191706629557284; … ; 0.32735728167513234 0.3111940134149062 … 0.29824122838699274 0.3214260027759877; 0.36364954256135795 0.3519170662955727 … 0.3214260027759877 0.35191706629557273;;; 0.34469960022370993 0.3343805319474644 … 0.28653515372400445 0.3273572816751324; 0.3343805319474644 0.3186160477277185 … 0.27805891878865097 0.3214260027759878; … ; 0.2865351537240044 0.27805891878865097 … 0.255901857701422 0.27805891878865097; 0.3273572816751323 0.32142600277598765 … 0.2780589187886509 0.3111940134149062;;; … ;;; 0.3048747492605077 0.2830366689329269 … 0.2855643322973116 0.3009573704936208; 0.28303666893292684 0.25898431619134943 … 0.27263300127450435 0.28541419660482964; … ; 0.2855643322973115 0.2726330012745043 … 0.27716038910846924 0.2812108737569504; 0.30095737049362076 0.28541419660482953 … 0.2812108737569504 0.293082726245133;;; 0.34469960022371 0.3273572816751324 … 0.3075192693901794 0.3343805319474645; 0.3273572816751324 0.3111940134149062 … 0.29824122838699285 0.32142600277598776; … ; 0.3075192693901794 0.2982412283869928 … 0.2771603891084693 0.29313119144060074; 0.3343805319474643 0.32142600277598765 … 0.2931311914406008 0.3186160477277184;;; 0.3785174208383219 0.36364954256135795 … 0.3343805319474644 0.3664584405943162; 0.36364954256135795 0.35191706629557284 … 0.32142600277598776 0.3519170662955728; … ; 0.3343805319474644 0.3214260027759877 … 0.29313119144060074 0.3186160477277184; 0.3664584405943161 0.3519170662955726 … 0.31861604772771834 0.3510288633713086]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081922765161 -0.4966565571926346 … -0.4771919009397553 -0.4966565571926345; -0.4966565571926345 -0.4848182086803746 … -0.4763804457419404 -0.4920413111378461; … ; -0.4771919009397553 -0.4763804457419404 … -0.41228807085827096 -0.45507008153320083; -0.4966565571926345 -0.4920413111378461 … -0.45507008153320083 -0.4848182086803747;;; -0.4966565571926345 -0.48481820868037473 … -0.4763804457419404 -0.4920413111378461; -0.48481820868037473 -0.45837440788443623 … -0.47065601568120063 -0.4861790251471163; … ; -0.4763804457419404 -0.47065601568120063 … -0.4463984364271961 -0.4688943963720205; -0.4920413111378461 -0.48617902514711625 … -0.4688943963720205 -0.4861790251471162;;; -0.4771919009397553 -0.45507008153320094 … -0.46051412340119346 -0.4763804457419404; -0.45507008153320094 -0.4090661824137952 … -0.45671990830367803 -0.4688943963720205; … ; -0.46051412340119346 -0.45671990830367803 … -0.44514495659714887 -0.45671990830367803; -0.4763804457419404 -0.4688943963720205 … -0.45671990830367803 -0.4706560156812005;;; … ;;; -0.44947595082847885 -0.45514997218876363 … -0.37125986261330746 -0.41774571519210646; -0.45514997218876363 -0.44880351098175447 … -0.41743801071834635 -0.4441260992929654; … ; -0.37125986261330746 -0.41743801071834635 … -0.253656983259762 -0.2997980910435204; -0.4177457151921064 -0.44412609929296537 … -0.2997980910435204 -0.361063432632848;;; -0.4771919009397553 -0.4763804457419404 … -0.41228807085827096 -0.45507008153320094; -0.4763804457419404 -0.4706560156812005 … -0.4463984364271962 -0.46889439637202057; … ; -0.41228807085827096 -0.4463984364271962 … -0.2536569832597621 -0.3410633022791024; -0.45507008153320094 -0.46889439637202057 … -0.3410633022791024 -0.4090661824137953;;; -0.4966565571926345 -0.4920413111378462 … -0.45507008153320094 -0.48481820868037473; -0.4920413111378462 -0.48617902514711625 … -0.4688943963720205 -0.48617902514711625; … ; -0.45507008153320094 -0.4688943963720205 … -0.3410633022791024 -0.4090661824137953; -0.48481820868037473 -0.48617902514711625 … -0.4090661824137953 -0.45837440788443623])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392129775306 -0.4868367443055645 … -0.7027113226404706 -0.4868367443055645; -0.48683674430556423 -0.774430395063701 … -0.41363732846160284 -0.38233074982210447; … ; -0.702711322640471 -0.4136373284616031 … -2.3967616826007765 -1.2958067581911619; -0.4868367443055642 -0.38233074982210447 … -1.295806758191162 -0.774430395063701;;; -0.48683674430556434 -0.7744303950637013 … -0.4136373284616028 -0.38233074982210474; -0.774430395063701 -1.4814477484078723 … -0.3245845694544447 -0.4499193965958148; … ; -0.41363732846160295 -0.3245845694544451 … -1.0113572986279329 -0.6373277792127935; -0.3823307498221043 -0.4499193965958149 … -0.6373277792127933 -0.4499193965958147;;; -0.7027113226404708 -1.2958067581911623 … -0.2982034893940342 -0.413637328461603; -1.295806758191162 -2.9196723936638183 … -0.3537295846788302 -0.6373277792127932; … ; -0.2982034893940343 -0.35372958467883076 … -0.4903726081225384 -0.35372958467883064; -0.4136373284616029 -0.6373277792127934 … -0.3537295846788301 -0.3245845694544446;;; … ;;; -1.0166744212718803 -0.5332878143233252 … -3.636138257138498 -1.9987602620647595; -0.5332878143233251 -0.32174124748931726 … -1.4667339407672535 -0.9061938941628669; … ; -3.636138257138499 -1.4667339407672535 … -10.98817782447082 -8.087376168218942; -1.9987602620647593 -0.9061938941628669 … -8.087376168218942 -4.64787837115462;;; -0.7027113226404706 -0.4136373284616028 … -2.396761682600777 -1.295806758191162; -0.41363732846160267 -0.32458456945444486 … -1.0113572986279329 -0.6373277792127933; … ; -2.396761682600777 -1.011357298627933 … -11.002806190879927 -6.077304186401963; -1.295806758191162 -0.6373277792127932 … -6.077304186401963 -2.9196723936638187;;; -0.4868367443055644 -0.38233074982210474 … -1.295806758191162 -0.7744303950637013; -0.3823307498221045 -0.4499193965958148 … -0.6373277792127932 -0.4499193965958148; … ; -1.295806758191162 -0.6373277792127934 … -6.077304186401962 -2.9196723936638183; -0.774430395063701 -0.4499193965958148 … -2.9196723936638183 -1.4814477484078725]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.1772259705852472 + 0.21173006617433127im -0.08136701896731334 + 0.10874920157626101im … -0.05529864527783271 + 0.0344283733583987im -0.1643332315107552 + 0.14960072292859106im; 0.0542267502067799 - 0.005281559483225054im 0.10318969526809267 - 0.08464438817970438im … -0.012018411287394542 + 0.00046614619556323636im 0.010574465060244675 - 0.001987881646314176im; … ; 0.005913303340223985 - 0.00679136215321442im -0.026549534189322245 + 0.030823371236697622im … 0.04354279568576943 - 0.04278151808542198im 0.05577952320489065 - 0.06293978179185904im; -0.13755746636292518 + 0.14856849793798538im -0.09404533721493429 + 0.10849242007374002im … 0.026024081147979418 - 0.03357917898334036im -0.029820652665854642 + 0.009613243281304962im;;; -0.03851174643164131 + 0.1356241195111517im 0.05758093395669868 + 0.002898556803961147im … -0.036245674522106495 + 0.009126621688668362im -0.07114266883557692 + 0.08104250132260772im; 0.1809732340781722 - 0.04380726926566888im 0.19410302929679624 - 0.13529290175314843im … 0.010391036265780296 - 0.01111379497125729im 0.07985704750469934 - 0.004381694816299913im; … ; -0.02708042131240751 + 0.02377544585666518im -0.030710237433825557 + 0.035242547266518535im … 0.01245324559040868 - 0.021387199152290478im -0.0002656147357459164 - 0.013702442641103036im; -0.09204390682986056 + 0.11065995073455381im -0.04340898208774107 + 0.06614033806712247im … -0.015589268266779206 - 0.009068099455072627im -0.06052518053065431 + 0.038206509580768364im;;; 0.04734164288225742 + 0.025594620559012998im 0.07070679625051988 - 0.04102133307508324im … -0.005638342956852499 + 0.006182059496484093im 0.009236605259467946 + 0.030098699956193575im; 0.10563775006012482 - 0.02278157701419291im 0.07460371506223717 - 0.08756738181013203im … 0.018225044120595967 + 0.00029065185327016053im 0.05805098006606191 + 0.007928646379298084im; … ; -0.018541839378421965 + 0.02187295163302181im -0.012344281225171946 + 0.019453335133962163im … -0.002280353346260971 - 0.0064807415594219904im -0.01152612354025894 + 0.005390093466449185im; -0.016673015100891163 + 0.04259423833407966im 0.007187793511388672 + 0.013189358825832992im … -0.012756479889330551 + 0.0017801134396626152im -0.021769215472697324 + 0.026016423032920746im;;; … ;;; 0.004745835110839392 + 0.009236281599669261im 0.0019540350713976662 + 0.012511340502528275im … -0.012187403865726344 - 0.02093466917776248im -0.002376923018225357 - 0.005147777400560688im; 0.0002624080755793834 + 0.018948765764972376im 0.001186455523937499 + 0.010254141994581533im … -0.012405756793324264 + 0.009947786381816131im -0.006686637632928337 + 0.02052669139361684im; … ; 0.00737526364763913 - 0.024684650608650594im 0.011393929572184101 - 0.014362617536089764im … -0.037607617407793635 + 0.0032194460564312676im -0.017306681940723823 - 0.01881020148434237im; 0.016353772490345402 - 0.02398783617863029im 0.010486653236516492 - 0.004331100124402342im … -0.01803590891263688 - 0.04203770006417033im 0.003604095482671767 - 0.044165003805560585im;;; -0.0034993448710093156 + 0.06162302827890178im -0.013958948021776718 + 0.040670917430037576im … -0.006271945128309966 + 0.004148592220951406im 0.010451945368116531 + 0.04467173526399561im; 0.0019489636796410567 + 0.03526307822118763im 0.0003248606672149755 + 0.010359480620814052im … -0.016240880566424983 + 0.038632730941422756im -0.005340574590292311 + 0.05285099926692108im; … ; 0.045050498097563424 - 0.05174036929627099im 0.021270909343999157 - 0.016187344610871554im … -0.03067038524235533 - 0.025613473503640738im 0.030873520477022586 - 0.06716840548225386im; 0.04768953296026868 - 0.024710175779239327im 0.0058815525122111875 + 0.01411502478477282im … 0.016370414033535473 - 0.08137779895702993im 0.07460371544628266 - 0.0875673817392282im;;; -0.11308778664441674 + 0.18847234450170702im -0.06777372896285258 + 0.09346091634555523im … -0.007919324867228503 + 0.051602537192333375im -0.05725837343926604 + 0.1250152876722647im; 0.010366210371805245 + 0.023281325577798523im 0.013916287775867854 - 0.014546352829603156im … -0.01672858643053425 + 0.04489473049415296im -0.007442306135028194 + 0.05748289196366761im; … ; 0.061971397097106064 - 0.05395573120245983im 0.007065598712607329 + 0.0018522356268969279im … 0.04001972892629869 - 0.051666550380989544im 0.1021121477425957 - 0.10405102850245507im; 0.0064501948831934865 + 0.039132296111073675im -0.042090319418444225 + 0.0652058688876961im … 0.0839053075446374 - 0.07266494150892117im 0.11952698949576043 - 0.08244467668969727im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729849), converged = true, ρ = [0.09132316915651359 0.08747419132194752 … 0.07684754934650921 0.0874741913219475; 0.0874741913219475 0.08089966870522308 … 0.07642471015679575 0.08486944832662559; … ; 0.07684754934650923 0.07642471015679575 … 0.047784666665112115 0.06587895341225955; 0.0874741913219475 0.08486944832662559 … 0.06587895341225955 0.08089966870522307;;; 0.08747419132194749 0.08089966870522311 … 0.07642471015679575 0.08486944832662559; 0.08089966870522311 0.06744471468321499 … 0.07348669933462672 0.08163768627463892; … ; 0.07642471015679575 0.07348669933462672 … 0.061888041195902875 0.07259829027467442; 0.08486944832662559 0.08163768627463891 … 0.07259829027467442 0.0816376862746389;;; 0.07684754934650923 0.06587895341225956 … 0.06847203697937325 0.07642471015679576; 0.06587895341225956 0.046578642640408646 … 0.06665759370804535 0.07259829027467442; … ; 0.06847203697937326 0.06665759370804535 … 0.06132515314097081 0.06665759370804535; 0.07642471015679575 0.07259829027467442 … 0.06665759370804535 0.0734866993346267;;; … ;;; 0.06328495229317273 0.06591651445354198 … 0.03394064887914308 0.049875934855846266; 0.06591651445354198 0.0629779095937801 … 0.04975639788718888 0.06087020456887385; … ; 0.03394064887914308 0.04975639788718888 … 0.009696353210998569 0.016831338789618375; 0.04987593485584626 0.060870204568873834 … 0.016831338789618375 0.030985721880787187;;; 0.07684754934650923 0.07642471015679576 … 0.047784666665112115 0.06587895341225956; 0.07642471015679576 0.0734866993346267 … 0.06188804119590289 0.07259829027467443; … ; 0.047784666665112115 0.06188804119590289 … 0.00969635321099858 0.025710010669932035; 0.06587895341225956 0.07259829027467443 … 0.025710010669932035 0.04657864264040866;;; 0.0874741913219475 0.0848694483266256 … 0.06587895341225956 0.08089966870522311; 0.0848694483266256 0.08163768627463891 … 0.07259829027467442 0.08163768627463891; … ; 0.06587895341225956 0.07259829027467442 … 0.025710010669932035 0.04657864264040866; 0.08089966870522311 0.08163768627463891 … 0.04657864264040866 0.067444714683215;;;;], ψ = Matrix{ComplexF64}[[0.8192631584612392 - 0.49172608506321386im -3.1615292328535105e-10 + 2.2496315921216592e-10im 3.385135574629494e-11 + 5.484881646089512e-10im -6.576970218441502e-10 - 4.3918368941575636e-11im; 0.0825605890513895 - 0.04955330260325003im -0.20694428959883554 + 0.10047302409611329im -0.11604253356092739 + 0.3741111255232062im 0.019402380993050097 - 0.21328585927313684im; … ; 0.010112579063325779 - 0.006069623478956214im 0.030428791891379297 + 0.016342964545449763im -0.02084775364106464 - 0.03406516535475473im -0.025634224705801824 + 0.0079571833850045im; -0.08256058921029695 + 0.049553302669927im 0.09096033435790471 + 0.2604742580913648im -0.3201466667501142 + 0.04060559882274272im -0.2315623542864582 - 0.1353832786050454im], [0.7878970901013782 - 0.4917047122492212im -0.054308792568424885 + 0.18949597532917914im -1.1973547153765196e-11 - 2.880843619212925e-10im -1.5695413302374561e-9 - 1.6309497363753422e-9im; 0.053712463456576834 - 0.03352045738422429im 0.002417129924352915 - 0.008433931239398753im 5.017074897889495e-10 + 8.473862670582699e-10im -2.014392114918495e-9 - 2.4699438883057923e-9im; … ; 0.006575376850830816 - 0.004103510179430434im -0.02376465653992376 + 0.08292040021182306im -0.043099881596116746 - 0.004663602284327483im 0.08348301303764022 - 0.02826713359323202im; -0.09580613429272619 + 0.05978994995306971im 0.024990356277748753 - 0.08719715048543433im -0.2699123754367814 - 0.029205742388716094im 0.5228111389428538 - 0.17702250408997422im], [-0.07140346384269676 + 0.931016808743042im 6.882083236625647e-10 + 5.177083510152225e-10im -6.19312823246787e-10 - 6.342028846528791e-10im -1.835616020295916e-9 - 9.88096493514945e-10im; -0.0052571696362952985 + 0.06854728180304424im 0.05705496990957146 - 0.003932115270942973im 0.02332203330937607 + 0.01368987500280621im 0.02383182110505986 + 0.009330851143959137im; … ; -0.0010606534689469715 + 0.013829669631807567im 1.958629196330275e-10 + 4.231552540551013e-10im -0.01294609869183428 - 0.08018142621373224im -0.10086991206756676 + 0.03153603298306338im; 0.011715797354560473 - 0.15276015930619943im 0.2864477596866762 - 0.01974141114868124im 0.32069106042946915 - 0.3167913704599377im -0.28211389264390696 + 0.3837758084160969im], [0.5174156421701186 - 0.621918428516674im -1.0972824038280038e-10 - 1.056177367786404e-11im 0.3349715727539475 - 0.3647798046921684im -2.2837629010119542e-10 + 4.263661368408833e-10im; 0.24781441307031743 - 0.29786565692903766im 0.5112339595158714 - 0.3622853643520444im -0.36439856716064056 + 0.39682543030481954im 4.6079098869888924e-10 - 4.396135677708912e-10im; … ; 0.007286995380041899 - 0.008758754848570756im 0.0013410519012253064 - 0.0009503349087100303im -0.014119173021722916 + 0.015375600576716308im 0.007690836486120741 + 0.005048363608724647im; -0.04168663834523008 + 0.05010611608781261im 0.010186649826498634 - 0.0072187579047691495im -0.08533840923425802 + 0.0929324478655847im 0.14938527530866733 + 0.09805840670685709im]], eigenvalues = Any[[-0.16677707597110655, 0.2642777178177651, 0.26427771781776543, 0.2642777178177655], [-0.11613218761963598, 0.07040532319173329, 0.226248136019352, 0.22624813601935206], [-0.09588938144522799, 0.0876431996683683, 0.1731270414184931, 0.17312704141849328], [-0.0450514634961153, 0.022269526229782177, 0.09831189250998482, 0.18446409321176183]], occupation = [[2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0]], εF = nothing, optim_res =  * Status: failure (line search failed)

 * Candidate solution
    Final objective value:     -7.852647e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 5.55e-16 ≤ 1.0e-12
    |x - x&#39;|/|x&#39;|          = 8.02e-16 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 8.88e-16 ≰ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 1.13e-16 ≰ -1.0e+00
    |g(x)|                 = 5.04e-09 ≰ -1.0e+00

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    45
    f(x) calls:    65
    ∇f(x) calls:   46
)</code></pre><p>Start not too far from the solution to ensure convergence: We run first a very crude SCF to get close and then switch to Newton.</p><pre><code class="language-julia hljs">scfres_start = self_consistent_field(basis; tol=1e-1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39298724567482274 0.37969056550666797 … 0.3451848414377043 0.37969056550666797; 0.37969056550666785 0.36712117149945417 … 0.32816669909275775 0.3648714074546493; … ; 0.34518484143770445 0.32816669909275786 … 0.30666689322668467 0.3342398701327985; 0.37969056550666785 0.3648714074546493 … 0.3342398701327984 0.36712117149945417;;; 0.3796905655066679 0.3671211714994542 … 0.32816669909275775 0.3648714074546493; 0.3671211714994541 0.3510609265928547 … 0.31207721732336224 0.35289021738004217; … ; 0.32816669909275786 0.31207721732336235 … 0.297794031852141 0.3217377459084694; 0.36487140745464924 0.35289021738004217 … 0.32173774590846926 0.3528902173800421;;; 0.34518484143770434 0.33423987013279843 … 0.28728330833940385 0.3281666990927578; 0.3342398701327984 0.3179174732682778 … 0.27858652846712884 0.3217377459084694; … ; 0.2872833083394039 0.2785865284671289 … 0.2558442558156437 0.2785865284671289; 0.32816669909275775 0.3217377459084694 … 0.27858652846712884 0.31207721732336224;;; … ;;; 0.3045175328514078 0.2831388940343613 … 0.28422918185417434 0.30006303914796884; 0.2831388940343613 0.25943267022184296 … 0.2714834938860886 0.2849168959592438; … ; 0.28422918185417445 0.27148349388608867 … 0.2758090759113075 0.2798482804086055; 0.30006303914796884 0.2849168959592438 … 0.2798482804086054 0.29188385170028036;;; 0.34518484143770434 0.3281666990927578 … 0.3066668932266846 0.33423987013279843; 0.3281666990927577 0.3120772173233623 … 0.297794031852141 0.3217377459084693; … ; 0.3066668932266847 0.29779403185214104 … 0.2758090759113075 0.29195794332001734; 0.3342398701327984 0.3217377459084693 … 0.29195794332001723 0.3179174732682778;;; 0.3796905655066679 0.3648714074546493 … 0.3342398701327984 0.3671211714994542; 0.3648714074546492 0.3528902173800421 … 0.3217377459084694 0.35289021738004217; … ; 0.33423987013279854 0.32173774590846943 … 0.29195794332001734 0.31791747326827796; 0.36712117149945417 0.35289021738004217 … 0.3179174732682778 0.3510609265928547]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5045319850765922 -0.4977731487349752 … -0.47794575811563167 -0.4977731487349752; -0.4977731487349752 -0.485763645597073 … -0.4772033658747815 -0.49311909643734586; … ; -0.47794575811563167 -0.4772033658747816 … -0.4121985033634613 -0.45555640389791935; -0.4977731487349752 -0.49311909643734586 … -0.45555640389791946 -0.4857636455970731;;; -0.4977731487349752 -0.485763645597073 … -0.4772033658747816 -0.49311909643734586; -0.4857636455970731 -0.4591239465415499 … -0.47148609690409926 -0.4871407647417751; … ; -0.4772033658747816 -0.47148609690409926 … -0.4464296780499333 -0.46947081269565233; -0.49311909643734586 -0.4871407647417751 … -0.46947081269565233 -0.4871407647417751;;; -0.4779457581156317 -0.45555640389791946 … -0.46124008197701316 -0.4772033658747815; -0.45555640389791935 -0.4093162935148763 … -0.4573123347508885 -0.4694708126956524; … ; -0.46124008197701316 -0.4573123347508885 … -0.4453125668102239 -0.4573123347508885; -0.4772033658747815 -0.46947081269565233 … -0.4573123347508885 -0.47148609690409926;;; … ;;; -0.44958557970026125 -0.4554593683082766 … -0.3704280706854528 -0.4175002403630478; -0.4554593683082765 -0.44929891051588455 … -0.4166912649069091 -0.4440363021726864; … ; -0.3704280706854528 -0.4166912649069091 … -0.25279957090390087 -0.29896381474968176; -0.4175002403630478 -0.44403630217268636 … -0.2989638147496818 -0.3605993901093801;;; -0.4779457581156317 -0.4772033658747815 … -0.41219850336346137 -0.45555640389791946; -0.4772033658747815 -0.47148609690409926 … -0.4464296780499333 -0.4694708126956524; … ; -0.41219850336346137 -0.4464296780499334 … -0.25279957090390087 -0.340763500552861; -0.45555640389791946 -0.46947081269565233 … -0.340763500552861 -0.4093162935148763;;; -0.4977731487349752 -0.49311909643734586 … -0.45555640389791935 -0.4857636455970731; -0.49311909643734586 -0.4871407647417751 … -0.46947081269565233 -0.4871407647417751; … ; -0.45555640389791946 -0.46947081269565233 … -0.340763500552861 -0.4093162935148763; -0.4857636455970731 -0.4871407647417751 … -0.4093162935148763 -0.4591239465415499])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41270610538933755 -0.48678019117955906 … -0.7029799386023527 -0.4867801911795592; -0.48678019117955895 -0.7747131010752616 … -0.41365083117681856 -0.3821866702283129; … ; -0.7029799386023529 -0.4136508311768188 … -2.3975244912694618 -1.2964337423705463; -0.48678019117955884 -0.38218667022831276 … -1.2964337423705465 -0.7747131010752615;;; -0.486780191179559 -0.7747131010752615 … -0.41365083117681867 -0.38218667022831315; -0.7747131010752615 -1.48216522384344 … -0.32453144676888734 -0.44990798510600427; … ; -0.41365083117681867 -0.32453144676888757 … -1.0118357367855217 -0.6375924524039436; -0.38218667022831276 -0.44990798510600427 … -0.6375924524039436 -0.4499079851060042;;; -0.7029799386023527 -1.2964337423705468 … -0.29818129335445454 -0.4136508311768187; -1.2964337423705465 -2.92062107922434 … -0.3537944014475628 -0.6375924524039435; … ; -0.2981812933544544 -0.3537944014475633 … -0.49059782022139176 -0.3537944014475632; -0.41365083117681856 -0.6375924524039434 … -0.3537944014475626 -0.32453144676888734;;; … ;;; -1.0171412665527626 -0.5334949853414037 … -3.6366416156537813 -1.9994091185813527; -0.5334949853414034 -0.3217882929929538 … -1.467136702344232 -0.9066013976881737; … ; -3.6366416156537804 -1.467136702344232 … -10.98867172531212 -8.087904485273448; -1.9994091185813527 -0.9066013976881736 … -8.087904485273448 -4.648613203176004;;; -0.7029799386023527 -0.4136508311768185 … -2.397524491269462 -1.2964337423705465; -0.4136508311768185 -0.3245314467688875 … -1.0118357367855217 -0.6375924524039436; … ; -2.397524491269462 -1.011835736785522 … -11.003300091721226 -6.078177632796305; -1.2964337423705463 -0.6375924524039434 … -6.078177632796305 -2.92062107922434;;; -0.48678019117955906 -0.38218667022831304 … -1.2964337423705465 -0.7747131010752616; -0.38218667022831293 -0.4499079851060044 … -0.6375924524039434 -0.44990798510600427; … ; -1.2964337423705465 -0.6375924524039435 … -6.078177632796304 -2.9206210792243397; -0.7747131010752613 -0.4499079851060041 … -2.9206210792243397 -1.48216522384344]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39298724567482274 0.37969056550666797 … 0.3451848414377043 0.37969056550666797; 0.37969056550666785 0.36712117149945417 … 0.32816669909275775 0.3648714074546493; … ; 0.34518484143770445 0.32816669909275786 … 0.30666689322668467 0.3342398701327985; 0.37969056550666785 0.3648714074546493 … 0.3342398701327984 0.36712117149945417;;; 0.3796905655066679 0.3671211714994542 … 0.32816669909275775 0.3648714074546493; 0.3671211714994541 0.3510609265928547 … 0.31207721732336224 0.35289021738004217; … ; 0.32816669909275786 0.31207721732336235 … 0.297794031852141 0.3217377459084694; 0.36487140745464924 0.35289021738004217 … 0.32173774590846926 0.3528902173800421;;; 0.34518484143770434 0.33423987013279843 … 0.28728330833940385 0.3281666990927578; 0.3342398701327984 0.3179174732682778 … 0.27858652846712884 0.3217377459084694; … ; 0.2872833083394039 0.2785865284671289 … 0.2558442558156437 0.2785865284671289; 0.32816669909275775 0.3217377459084694 … 0.27858652846712884 0.31207721732336224;;; … ;;; 0.3045175328514078 0.2831388940343613 … 0.28422918185417434 0.30006303914796884; 0.2831388940343613 0.25943267022184296 … 0.2714834938860886 0.2849168959592438; … ; 0.28422918185417445 0.27148349388608867 … 0.2758090759113075 0.2798482804086055; 0.30006303914796884 0.2849168959592438 … 0.2798482804086054 0.29188385170028036;;; 0.34518484143770434 0.3281666990927578 … 0.3066668932266846 0.33423987013279843; 0.3281666990927577 0.3120772173233623 … 0.297794031852141 0.3217377459084693; … ; 0.3066668932266847 0.29779403185214104 … 0.2758090759113075 0.29195794332001734; 0.3342398701327984 0.3217377459084693 … 0.29195794332001723 0.3179174732682778;;; 0.3796905655066679 0.3648714074546493 … 0.3342398701327984 0.3671211714994542; 0.3648714074546492 0.3528902173800421 … 0.3217377459084694 0.35289021738004217; … ; 0.33423987013279854 0.32173774590846943 … 0.29195794332001734 0.31791747326827796; 0.36712117149945417 0.35289021738004217 … 0.3179174732682778 0.3510609265928547]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5045319850765922 -0.4977731487349752 … -0.47794575811563167 -0.4977731487349752; -0.4977731487349752 -0.485763645597073 … -0.4772033658747815 -0.49311909643734586; … ; -0.47794575811563167 -0.4772033658747816 … -0.4121985033634613 -0.45555640389791935; -0.4977731487349752 -0.49311909643734586 … -0.45555640389791946 -0.4857636455970731;;; -0.4977731487349752 -0.485763645597073 … -0.4772033658747816 -0.49311909643734586; -0.4857636455970731 -0.4591239465415499 … -0.47148609690409926 -0.4871407647417751; … ; -0.4772033658747816 -0.47148609690409926 … -0.4464296780499333 -0.46947081269565233; -0.49311909643734586 -0.4871407647417751 … -0.46947081269565233 -0.4871407647417751;;; -0.4779457581156317 -0.45555640389791946 … -0.46124008197701316 -0.4772033658747815; -0.45555640389791935 -0.4093162935148763 … -0.4573123347508885 -0.4694708126956524; … ; -0.46124008197701316 -0.4573123347508885 … -0.4453125668102239 -0.4573123347508885; -0.4772033658747815 -0.46947081269565233 … -0.4573123347508885 -0.47148609690409926;;; … ;;; -0.44958557970026125 -0.4554593683082766 … -0.3704280706854528 -0.4175002403630478; -0.4554593683082765 -0.44929891051588455 … -0.4166912649069091 -0.4440363021726864; … ; -0.3704280706854528 -0.4166912649069091 … -0.25279957090390087 -0.29896381474968176; -0.4175002403630478 -0.44403630217268636 … -0.2989638147496818 -0.3605993901093801;;; -0.4779457581156317 -0.4772033658747815 … -0.41219850336346137 -0.45555640389791946; -0.4772033658747815 -0.47148609690409926 … -0.4464296780499333 -0.4694708126956524; … ; -0.41219850336346137 -0.4464296780499334 … -0.25279957090390087 -0.340763500552861; -0.45555640389791946 -0.46947081269565233 … -0.340763500552861 -0.4093162935148763;;; -0.4977731487349752 -0.49311909643734586 … -0.45555640389791935 -0.4857636455970731; -0.49311909643734586 -0.4871407647417751 … -0.46947081269565233 -0.4871407647417751; … ; -0.45555640389791946 -0.46947081269565233 … -0.340763500552861 -0.4093162935148763; -0.4857636455970731 -0.4871407647417751 … -0.4093162935148763 -0.4591239465415499])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41270610538933755 -0.48678019117955906 … -0.7029799386023527 -0.4867801911795592; -0.48678019117955895 -0.7747131010752616 … -0.41365083117681856 -0.3821866702283129; … ; -0.7029799386023529 -0.4136508311768188 … -2.3975244912694618 -1.2964337423705463; -0.48678019117955884 -0.38218667022831276 … -1.2964337423705465 -0.7747131010752615;;; -0.486780191179559 -0.7747131010752615 … -0.41365083117681867 -0.38218667022831315; -0.7747131010752615 -1.48216522384344 … -0.32453144676888734 -0.44990798510600427; … ; -0.41365083117681867 -0.32453144676888757 … -1.0118357367855217 -0.6375924524039436; -0.38218667022831276 -0.44990798510600427 … -0.6375924524039436 -0.4499079851060042;;; -0.7029799386023527 -1.2964337423705468 … -0.29818129335445454 -0.4136508311768187; -1.2964337423705465 -2.92062107922434 … -0.3537944014475628 -0.6375924524039435; … ; -0.2981812933544544 -0.3537944014475633 … -0.49059782022139176 -0.3537944014475632; -0.41365083117681856 -0.6375924524039434 … -0.3537944014475626 -0.32453144676888734;;; … ;;; -1.0171412665527626 -0.5334949853414037 … -3.6366416156537813 -1.9994091185813527; -0.5334949853414034 -0.3217882929929538 … -1.467136702344232 -0.9066013976881737; … ; -3.6366416156537804 -1.467136702344232 … -10.98867172531212 -8.087904485273448; -1.9994091185813527 -0.9066013976881736 … -8.087904485273448 -4.648613203176004;;; -0.7029799386023527 -0.4136508311768185 … -2.397524491269462 -1.2964337423705465; -0.4136508311768185 -0.3245314467688875 … -1.0118357367855217 -0.6375924524039436; … ; -2.397524491269462 -1.011835736785522 … -11.003300091721226 -6.078177632796305; -1.2964337423705463 -0.6375924524039434 … -6.078177632796305 -2.92062107922434;;; -0.48678019117955906 -0.38218667022831304 … -1.2964337423705465 -0.7747131010752616; -0.38218667022831293 -0.4499079851060044 … -0.6375924524039434 -0.44990798510600427; … ; -1.2964337423705465 -0.6375924524039435 … -6.078177632796304 -2.9206210792243397; -0.7747131010752613 -0.4499079851060041 … -2.9206210792243397 -1.48216522384344]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39298724567482274 0.37969056550666797 … 0.3451848414377043 0.37969056550666797; 0.37969056550666785 0.36712117149945417 … 0.32816669909275775 0.3648714074546493; … ; 0.34518484143770445 0.32816669909275786 … 0.30666689322668467 0.3342398701327985; 0.37969056550666785 0.3648714074546493 … 0.3342398701327984 0.36712117149945417;;; 0.3796905655066679 0.3671211714994542 … 0.32816669909275775 0.3648714074546493; 0.3671211714994541 0.3510609265928547 … 0.31207721732336224 0.35289021738004217; … ; 0.32816669909275786 0.31207721732336235 … 0.297794031852141 0.3217377459084694; 0.36487140745464924 0.35289021738004217 … 0.32173774590846926 0.3528902173800421;;; 0.34518484143770434 0.33423987013279843 … 0.28728330833940385 0.3281666990927578; 0.3342398701327984 0.3179174732682778 … 0.27858652846712884 0.3217377459084694; … ; 0.2872833083394039 0.2785865284671289 … 0.2558442558156437 0.2785865284671289; 0.32816669909275775 0.3217377459084694 … 0.27858652846712884 0.31207721732336224;;; … ;;; 0.3045175328514078 0.2831388940343613 … 0.28422918185417434 0.30006303914796884; 0.2831388940343613 0.25943267022184296 … 0.2714834938860886 0.2849168959592438; … ; 0.28422918185417445 0.27148349388608867 … 0.2758090759113075 0.2798482804086055; 0.30006303914796884 0.2849168959592438 … 0.2798482804086054 0.29188385170028036;;; 0.34518484143770434 0.3281666990927578 … 0.3066668932266846 0.33423987013279843; 0.3281666990927577 0.3120772173233623 … 0.297794031852141 0.3217377459084693; … ; 0.3066668932266847 0.29779403185214104 … 0.2758090759113075 0.29195794332001734; 0.3342398701327984 0.3217377459084693 … 0.29195794332001723 0.3179174732682778;;; 0.3796905655066679 0.3648714074546493 … 0.3342398701327984 0.3671211714994542; 0.3648714074546492 0.3528902173800421 … 0.3217377459084694 0.35289021738004217; … ; 0.33423987013279854 0.32173774590846943 … 0.29195794332001734 0.31791747326827796; 0.36712117149945417 0.35289021738004217 … 0.3179174732682778 0.3510609265928547]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5045319850765922 -0.4977731487349752 … -0.47794575811563167 -0.4977731487349752; -0.4977731487349752 -0.485763645597073 … -0.4772033658747815 -0.49311909643734586; … ; -0.47794575811563167 -0.4772033658747816 … -0.4121985033634613 -0.45555640389791935; -0.4977731487349752 -0.49311909643734586 … -0.45555640389791946 -0.4857636455970731;;; -0.4977731487349752 -0.485763645597073 … -0.4772033658747816 -0.49311909643734586; -0.4857636455970731 -0.4591239465415499 … -0.47148609690409926 -0.4871407647417751; … ; -0.4772033658747816 -0.47148609690409926 … -0.4464296780499333 -0.46947081269565233; -0.49311909643734586 -0.4871407647417751 … -0.46947081269565233 -0.4871407647417751;;; -0.4779457581156317 -0.45555640389791946 … -0.46124008197701316 -0.4772033658747815; -0.45555640389791935 -0.4093162935148763 … -0.4573123347508885 -0.4694708126956524; … ; -0.46124008197701316 -0.4573123347508885 … -0.4453125668102239 -0.4573123347508885; -0.4772033658747815 -0.46947081269565233 … -0.4573123347508885 -0.47148609690409926;;; … ;;; -0.44958557970026125 -0.4554593683082766 … -0.3704280706854528 -0.4175002403630478; -0.4554593683082765 -0.44929891051588455 … -0.4166912649069091 -0.4440363021726864; … ; -0.3704280706854528 -0.4166912649069091 … -0.25279957090390087 -0.29896381474968176; -0.4175002403630478 -0.44403630217268636 … -0.2989638147496818 -0.3605993901093801;;; -0.4779457581156317 -0.4772033658747815 … -0.41219850336346137 -0.45555640389791946; -0.4772033658747815 -0.47148609690409926 … -0.4464296780499333 -0.4694708126956524; … ; -0.41219850336346137 -0.4464296780499334 … -0.25279957090390087 -0.340763500552861; -0.45555640389791946 -0.46947081269565233 … -0.340763500552861 -0.4093162935148763;;; -0.4977731487349752 -0.49311909643734586 … -0.45555640389791935 -0.4857636455970731; -0.49311909643734586 -0.4871407647417751 … -0.46947081269565233 -0.4871407647417751; … ; -0.45555640389791946 -0.46947081269565233 … -0.340763500552861 -0.4093162935148763; -0.4857636455970731 -0.4871407647417751 … -0.4093162935148763 -0.4591239465415499])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41270610538933755 -0.48678019117955906 … -0.7029799386023527 -0.4867801911795592; -0.48678019117955895 -0.7747131010752616 … -0.41365083117681856 -0.3821866702283129; … ; -0.7029799386023529 -0.4136508311768188 … -2.3975244912694618 -1.2964337423705463; -0.48678019117955884 -0.38218667022831276 … -1.2964337423705465 -0.7747131010752615;;; -0.486780191179559 -0.7747131010752615 … -0.41365083117681867 -0.38218667022831315; -0.7747131010752615 -1.48216522384344 … -0.32453144676888734 -0.44990798510600427; … ; -0.41365083117681867 -0.32453144676888757 … -1.0118357367855217 -0.6375924524039436; -0.38218667022831276 -0.44990798510600427 … -0.6375924524039436 -0.4499079851060042;;; -0.7029799386023527 -1.2964337423705468 … -0.29818129335445454 -0.4136508311768187; -1.2964337423705465 -2.92062107922434 … -0.3537944014475628 -0.6375924524039435; … ; -0.2981812933544544 -0.3537944014475633 … -0.49059782022139176 -0.3537944014475632; -0.41365083117681856 -0.6375924524039434 … -0.3537944014475626 -0.32453144676888734;;; … ;;; -1.0171412665527626 -0.5334949853414037 … -3.6366416156537813 -1.9994091185813527; -0.5334949853414034 -0.3217882929929538 … -1.467136702344232 -0.9066013976881737; … ; -3.6366416156537804 -1.467136702344232 … -10.98867172531212 -8.087904485273448; -1.9994091185813527 -0.9066013976881736 … -8.087904485273448 -4.648613203176004;;; -0.7029799386023527 -0.4136508311768185 … -2.397524491269462 -1.2964337423705465; -0.4136508311768185 -0.3245314467688875 … -1.0118357367855217 -0.6375924524039436; … ; -2.397524491269462 -1.011835736785522 … -11.003300091721226 -6.078177632796305; -1.2964337423705463 -0.6375924524039434 … -6.078177632796305 -2.92062107922434;;; -0.48678019117955906 -0.38218667022831304 … -1.2964337423705465 -0.7747131010752616; -0.38218667022831293 -0.4499079851060044 … -0.6375924524039434 -0.44990798510600427; … ; -1.2964337423705465 -0.6375924524039435 … -6.078177632796304 -2.9206210792243397; -0.7747131010752613 -0.4499079851060041 … -2.9206210792243397 -1.48216522384344]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39298724567482274 0.37969056550666797 … 0.3451848414377043 0.37969056550666797; 0.37969056550666785 0.36712117149945417 … 0.32816669909275775 0.3648714074546493; … ; 0.34518484143770445 0.32816669909275786 … 0.30666689322668467 0.3342398701327985; 0.37969056550666785 0.3648714074546493 … 0.3342398701327984 0.36712117149945417;;; 0.3796905655066679 0.3671211714994542 … 0.32816669909275775 0.3648714074546493; 0.3671211714994541 0.3510609265928547 … 0.31207721732336224 0.35289021738004217; … ; 0.32816669909275786 0.31207721732336235 … 0.297794031852141 0.3217377459084694; 0.36487140745464924 0.35289021738004217 … 0.32173774590846926 0.3528902173800421;;; 0.34518484143770434 0.33423987013279843 … 0.28728330833940385 0.3281666990927578; 0.3342398701327984 0.3179174732682778 … 0.27858652846712884 0.3217377459084694; … ; 0.2872833083394039 0.2785865284671289 … 0.2558442558156437 0.2785865284671289; 0.32816669909275775 0.3217377459084694 … 0.27858652846712884 0.31207721732336224;;; … ;;; 0.3045175328514078 0.2831388940343613 … 0.28422918185417434 0.30006303914796884; 0.2831388940343613 0.25943267022184296 … 0.2714834938860886 0.2849168959592438; … ; 0.28422918185417445 0.27148349388608867 … 0.2758090759113075 0.2798482804086055; 0.30006303914796884 0.2849168959592438 … 0.2798482804086054 0.29188385170028036;;; 0.34518484143770434 0.3281666990927578 … 0.3066668932266846 0.33423987013279843; 0.3281666990927577 0.3120772173233623 … 0.297794031852141 0.3217377459084693; … ; 0.3066668932266847 0.29779403185214104 … 0.2758090759113075 0.29195794332001734; 0.3342398701327984 0.3217377459084693 … 0.29195794332001723 0.3179174732682778;;; 0.3796905655066679 0.3648714074546493 … 0.3342398701327984 0.3671211714994542; 0.3648714074546492 0.3528902173800421 … 0.3217377459084694 0.35289021738004217; … ; 0.33423987013279854 0.32173774590846943 … 0.29195794332001734 0.31791747326827796; 0.36712117149945417 0.35289021738004217 … 0.3179174732682778 0.3510609265928547]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5045319850765922 -0.4977731487349752 … -0.47794575811563167 -0.4977731487349752; -0.4977731487349752 -0.485763645597073 … -0.4772033658747815 -0.49311909643734586; … ; -0.47794575811563167 -0.4772033658747816 … -0.4121985033634613 -0.45555640389791935; -0.4977731487349752 -0.49311909643734586 … -0.45555640389791946 -0.4857636455970731;;; -0.4977731487349752 -0.485763645597073 … -0.4772033658747816 -0.49311909643734586; -0.4857636455970731 -0.4591239465415499 … -0.47148609690409926 -0.4871407647417751; … ; -0.4772033658747816 -0.47148609690409926 … -0.4464296780499333 -0.46947081269565233; -0.49311909643734586 -0.4871407647417751 … -0.46947081269565233 -0.4871407647417751;;; -0.4779457581156317 -0.45555640389791946 … -0.46124008197701316 -0.4772033658747815; -0.45555640389791935 -0.4093162935148763 … -0.4573123347508885 -0.4694708126956524; … ; -0.46124008197701316 -0.4573123347508885 … -0.4453125668102239 -0.4573123347508885; -0.4772033658747815 -0.46947081269565233 … -0.4573123347508885 -0.47148609690409926;;; … ;;; -0.44958557970026125 -0.4554593683082766 … -0.3704280706854528 -0.4175002403630478; -0.4554593683082765 -0.44929891051588455 … -0.4166912649069091 -0.4440363021726864; … ; -0.3704280706854528 -0.4166912649069091 … -0.25279957090390087 -0.29896381474968176; -0.4175002403630478 -0.44403630217268636 … -0.2989638147496818 -0.3605993901093801;;; -0.4779457581156317 -0.4772033658747815 … -0.41219850336346137 -0.45555640389791946; -0.4772033658747815 -0.47148609690409926 … -0.4464296780499333 -0.4694708126956524; … ; -0.41219850336346137 -0.4464296780499334 … -0.25279957090390087 -0.340763500552861; -0.45555640389791946 -0.46947081269565233 … -0.340763500552861 -0.4093162935148763;;; -0.4977731487349752 -0.49311909643734586 … -0.45555640389791935 -0.4857636455970731; -0.49311909643734586 -0.4871407647417751 … -0.46947081269565233 -0.4871407647417751; … ; -0.45555640389791946 -0.46947081269565233 … -0.340763500552861 -0.4093162935148763; -0.4857636455970731 -0.4871407647417751 … -0.4093162935148763 -0.4591239465415499])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41270610538933755 -0.48678019117955906 … -0.7029799386023527 -0.4867801911795592; -0.48678019117955895 -0.7747131010752616 … -0.41365083117681856 -0.3821866702283129; … ; -0.7029799386023529 -0.4136508311768188 … -2.3975244912694618 -1.2964337423705463; -0.48678019117955884 -0.38218667022831276 … -1.2964337423705465 -0.7747131010752615;;; -0.486780191179559 -0.7747131010752615 … -0.41365083117681867 -0.38218667022831315; -0.7747131010752615 -1.48216522384344 … -0.32453144676888734 -0.44990798510600427; … ; -0.41365083117681867 -0.32453144676888757 … -1.0118357367855217 -0.6375924524039436; -0.38218667022831276 -0.44990798510600427 … -0.6375924524039436 -0.4499079851060042;;; -0.7029799386023527 -1.2964337423705468 … -0.29818129335445454 -0.4136508311768187; -1.2964337423705465 -2.92062107922434 … -0.3537944014475628 -0.6375924524039435; … ; -0.2981812933544544 -0.3537944014475633 … -0.49059782022139176 -0.3537944014475632; -0.41365083117681856 -0.6375924524039434 … -0.3537944014475626 -0.32453144676888734;;; … ;;; -1.0171412665527626 -0.5334949853414037 … -3.6366416156537813 -1.9994091185813527; -0.5334949853414034 -0.3217882929929538 … -1.467136702344232 -0.9066013976881737; … ; -3.6366416156537804 -1.467136702344232 … -10.98867172531212 -8.087904485273448; -1.9994091185813527 -0.9066013976881736 … -8.087904485273448 -4.648613203176004;;; -0.7029799386023527 -0.4136508311768185 … -2.397524491269462 -1.2964337423705465; -0.4136508311768185 -0.3245314467688875 … -1.0118357367855217 -0.6375924524039436; … ; -2.397524491269462 -1.011835736785522 … -11.003300091721226 -6.078177632796305; -1.2964337423705463 -0.6375924524039434 … -6.078177632796305 -2.92062107922434;;; -0.48678019117955906 -0.38218667022831304 … -1.2964337423705465 -0.7747131010752616; -0.38218667022831293 -0.4499079851060044 … -0.6375924524039434 -0.44990798510600427; … ; -1.2964337423705465 -0.6375924524039435 … -6.078177632796304 -2.9206210792243397; -0.7747131010752613 -0.4499079851060041 … -2.9206210792243397 -1.48216522384344]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.85230879797291), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09204364626200691 0.08811244424086374 … 0.0772418000216824 0.08811244424086374; 0.08811244424086374 0.08141192769452682 … 0.07685353496860567 0.0854729345779737; … ; 0.0772418000216824 0.07685353496860568 … 0.047750854709164584 0.06610782664583861; 0.08811244424086374 0.08547293457797368 … 0.06610782664583863 0.08141192769452683;;; 0.08811244424086376 0.08141192769452682 … 0.07685353496860568 0.08547293457797368; 0.0814119276945268 0.06780337989356099 … 0.07390787592190427 0.08216202644642963; … ; 0.07685353496860568 0.07390787592190427 … 0.061902115383362655 0.072888174971297; 0.08547293457797368 0.08216202644642963 … 0.07288817497129702 0.08216202644642963;;; 0.07724180002168243 0.06610782664583863 … 0.06882299305875815 0.07685353496860567; 0.06610782664583861 0.046671512127737964 … 0.06693871440746063 0.07288817497129703; … ; 0.06882299305875815 0.06693871440746064 … 0.061400217221229035 0.06693871440746063; 0.07685353496860566 0.07288817497129702 … 0.06693871440746063 0.07390787592190427;;; … ;;; 0.0633351064763623 0.0660621165064033 … 0.03369266588780428 0.049780557053455105; 0.06606211650640328 0.06320401518565942 … 0.04946711567703098 0.06083021832222872; … ; 0.03369266588780428 0.04946711567703098 … 0.009588355745493196 0.016677647472146596; 0.0497805570534551 0.06083021832222871 … 0.016677647472146603 0.03085559661754854;;; 0.07724180002168243 0.07685353496860567 … 0.04775085470916459 0.06610782664583863; 0.07685353496860566 0.07390787592190427 … 0.061902115383362655 0.07288817497129703; … ; 0.04775085470916459 0.06190211538336267 … 0.009588355745493196 0.02563599434760138; 0.06610782664583863 0.07288817497129702 … 0.025635994347601384 0.04667151212773798;;; 0.08811244424086376 0.08547293457797368 … 0.06610782664583861 0.08141192769452683; 0.08547293457797368 0.08216202644642963 … 0.07288817497129702 0.08216202644642963; … ; 0.06610782664583863 0.07288817497129702 … 0.02563599434760138 0.046671512127737964; 0.0814119276945268 0.08216202644642963 … 0.046671512127737964 0.06780337989356099;;;;], α = 0.8, eigenvalues = [[-0.16685550944360106, 0.2643756341975132, 0.2644198587726557, 0.26451400015680243, 0.3573579747889874, 0.3573645075436276, 0.3589990481012447], [-0.11617991127910272, 0.07032534562141028, 0.2263016345798703, 0.22630329265612714, 0.336402030978888, 0.3933593044720052, 0.3933898188892565], [-0.09593661027111805, 0.08791935874833764, 0.17299622675208787, 0.17302327815485144, 0.29148067762277485, 0.3372652955750799, 0.534040451007862], [-0.044926350243179466, 0.022390456413045687, 0.09785620423649488, 0.1844828569897518, 0.3248345247332321, 0.5030909346498043, 0.5048763951311901]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.29003029193381513, n_iter = 2, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.5138851064042992 - 0.8067347059613991im 5.355956070051543e-5 + 0.00024579037851799783im … 0.0001601517758790885 + 1.304626704865463e-5im -0.002018303771212475 - 0.0004769677321248868im; 0.05246214052140068 - 0.0808430260093584im 0.190340853523424 - 0.014254428060864237im … -0.34294402412176633 - 0.2120668238872912im 0.036013692686697435 + 0.17033542191816714im; … ; 0.005773883276991899 - 0.00963796910955921im -0.05130205462110319 + 0.002745791215996899im … -0.044928336554739906 - 0.05272352647172694im -0.03257272489727775 + 0.04892661265049002im; -0.05207496942815378 + 0.08097064328620428im -0.3096797827297767 + 0.004515852105034855im … -0.027397990626738738 - 0.22178870344926926im -0.2857178127336523 + 0.2402781474425414im], [-0.9055781925578656 + 0.20919046480250622im 0.18667076675062802 - 0.06152760890971974im … -4.7350709397945266e-5 + 0.00016522375446518123im -0.00017147456018591135 + 6.918453436749109e-5im; -0.0609435118377276 + 0.014082792942854756im -0.01082865316111607 + 0.0035462191174525865im … 0.0004119736163875915 + 0.0001394941753921376im -0.0007328739454395394 - 0.0002796645894398152im; … ; -0.007810965062078977 + 0.0018387248283357985im 0.08129264617872385 - 0.026777193415229026im … -0.005379242841938687 - 0.009248430537239723im 0.10007399128766843 - 0.025105935280704563im; 0.10943972112535798 - 0.025275839470251606im -0.08425280591847467 + 0.027745254418338066im … -0.02279231020544433 - 0.039919626939101886im 0.44830738516803753 - 0.10985088005699331im], [0.8097771386365411 + 0.46643550329557953im -1.2267718669727783e-5 - 9.011356933880479e-5im … 0.0001347527502366209 - 0.0007674390359252059im 4.138416171510811e-5 + 7.430435202317008e-5im; 0.058330744138135555 + 0.03358607226683511im -0.011059376262041436 - 0.058519558441072525im … 0.0023954402835733497 - 0.009845893511616747im -0.006400726037899045 + 0.002360283793570184im; … ; 0.012577477637188045 + 0.007247392929534377im -4.459764514959266e-6 + 4.52734385274255e-6im … -0.0007641354755918231 + 0.006036819032365955im -0.004331575353986205 - 0.06442417534315205im; -0.1318806247964994 - 0.07596341665182306im -0.05323209725862398 - 0.2816163555495411im … -0.06987810479185888 + 0.37483646277229304im -0.007844362089895827 - 0.14854847705157176im], [-0.1189750451545593 + 0.8007867842843965im -0.00016645989841718552 + 5.640789191365802e-5im … -0.018460921317527267 + 0.007567194494145026im 0.2068850177112936 - 0.08582220913565189im; -0.05691127019149685 + 0.3830726525345838im -0.5883149400680047 + 0.21765379397246498im … 0.01837737337020955 - 0.007588841266031298im -0.19996408709219435 + 0.08280997075445473im; … ; -0.0016769077769304844 + 0.01118481023972509im -0.001292267893430744 + 0.00045175403798418227im … -0.006027502984862089 - 0.04434800972675251im 0.010403901306005506 - 0.00938787639372417im; 0.00939771950229495 - 0.06325136806010632im -0.01273392495520778 + 0.004699505716507864im … -0.08706278820512232 - 0.47162715942242595im 0.39094662107504063 - 0.2114413573527281im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16685550944360106, 0.2643756341975132, 0.2644198587726557, 0.26451400015680243, 0.3573579747889874, 0.3573645075436276, 0.3589990481012447], [-0.11617991127910272, 0.07032534562141028, 0.2263016345798703, 0.22630329265612714, 0.336402030978888, 0.3933593044720052, 0.3933898188892565], [-0.09593661027111805, 0.08791935874833764, 0.17299622675208787, 0.17302327815485144, 0.29148067762277485, 0.3372652955750799, 0.534040451007862], [-0.044926350243179466, 0.022390456413045687, 0.09785620423649488, 0.1844828569897518, 0.3248345247332321, 0.5030909346498043, 0.5048763951311901]], X = [[0.5138851064042992 - 0.8067347059613991im 5.355956070051543e-5 + 0.00024579037851799783im … 0.0001601517758790885 + 1.304626704865463e-5im -0.002018303771212475 - 0.0004769677321248868im; 0.05246214052140068 - 0.0808430260093584im 0.190340853523424 - 0.014254428060864237im … -0.34294402412176633 - 0.2120668238872912im 0.036013692686697435 + 0.17033542191816714im; … ; 0.005773883276991899 - 0.00963796910955921im -0.05130205462110319 + 0.002745791215996899im … -0.044928336554739906 - 0.05272352647172694im -0.03257272489727775 + 0.04892661265049002im; -0.05207496942815378 + 0.08097064328620428im -0.3096797827297767 + 0.004515852105034855im … -0.027397990626738738 - 0.22178870344926926im -0.2857178127336523 + 0.2402781474425414im], [-0.9055781925578656 + 0.20919046480250622im 0.18667076675062802 - 0.06152760890971974im … -4.7350709397945266e-5 + 0.00016522375446518123im -0.00017147456018591135 + 6.918453436749109e-5im; -0.0609435118377276 + 0.014082792942854756im -0.01082865316111607 + 0.0035462191174525865im … 0.0004119736163875915 + 0.0001394941753921376im -0.0007328739454395394 - 0.0002796645894398152im; … ; -0.007810965062078977 + 0.0018387248283357985im 0.08129264617872385 - 0.026777193415229026im … -0.005379242841938687 - 0.009248430537239723im 0.10007399128766843 - 0.025105935280704563im; 0.10943972112535798 - 0.025275839470251606im -0.08425280591847467 + 0.027745254418338066im … -0.02279231020544433 - 0.039919626939101886im 0.44830738516803753 - 0.10985088005699331im], [0.8097771386365411 + 0.46643550329557953im -1.2267718669727783e-5 - 9.011356933880479e-5im … 0.0001347527502366209 - 0.0007674390359252059im 4.138416171510811e-5 + 7.430435202317008e-5im; 0.058330744138135555 + 0.03358607226683511im -0.011059376262041436 - 0.058519558441072525im … 0.0023954402835733497 - 0.009845893511616747im -0.006400726037899045 + 0.002360283793570184im; … ; 0.012577477637188045 + 0.007247392929534377im -4.459764514959266e-6 + 4.52734385274255e-6im … -0.0007641354755918231 + 0.006036819032365955im -0.004331575353986205 - 0.06442417534315205im; -0.1318806247964994 - 0.07596341665182306im -0.05323209725862398 - 0.2816163555495411im … -0.06987810479185888 + 0.37483646277229304im -0.007844362089895827 - 0.14854847705157176im], [-0.1189750451545593 + 0.8007867842843965im -0.00016645989841718552 + 5.640789191365802e-5im … -0.018460921317527267 + 0.007567194494145026im 0.2068850177112936 - 0.08582220913565189im; -0.05691127019149685 + 0.3830726525345838im -0.5883149400680047 + 0.21765379397246498im … 0.01837737337020955 - 0.007588841266031298im -0.19996408709219435 + 0.08280997075445473im; … ; -0.0016769077769304844 + 0.01118481023972509im -0.001292267893430744 + 0.00045175403798418227im … -0.006027502984862089 - 0.04434800972675251im 0.010403901306005506 - 0.00938787639372417im; 0.00939771950229495 - 0.06325136806010632im -0.01273392495520778 + 0.004699505716507864im … -0.08706278820512232 - 0.47162715942242595im 0.39094662107504063 - 0.2114413573527281im]], residual_norms = [[0.012389813422161977, 0.008762663719680392, 0.01073006303531753, 0.013247518955217114, 0.0037731096704534187, 0.004682054877433457, 0.028409425798182297], [0.00402595971087985, 0.006479796874961176, 0.006104221594695288, 0.006191421124142111, 0.007432108339388484, 0.010589595464503663, 0.011834734917202659], [0.005876416976951518, 0.005692256181809381, 0.004628353716991574, 0.007319094821723258, 0.00751418486695034, 0.01670065111764248, 0.03146269359916226], [0.0049428214201124206, 0.004845717768407996, 0.008105300334181118, 0.012515413537685371, 0.040786745844471554, 0.01881436199709964, 0.050893824502703355]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 0.002749485308744353)</code></pre><p>Remove the virtual orbitals (which Newton cannot treat yet)</p><pre><code class="language-julia hljs">ψ, _ = DFTK.select_occupied_orbitals(basis, scfres_start.ψ, scfres_start.occupation)
scfres_newton = newton(basis, ψ; tol)

# Comparison of results

println(&quot;|ρ_newton - ρ_scf|  = &quot;, norm(scfres_newton.ρ - scfres_scf.ρ))
println(&quot;|ρ_newton - ρ_scfv| = &quot;, norm(scfres_newton.ρ - scfres_scfv.ρ))
println(&quot;|ρ_newton - ρ_dm|   = &quot;, norm(scfres_newton.ρ - scfres_dm.ρ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)
---   ---------------   ---------   ---------
  1   -7.852646686688                   -2.54
  2   -7.852646686730      -10.38       -5.80
  3   -7.852646686730   +  -14.75      -12.46
|ρ_newton - ρ_scf|  = 1.3240403863828133e-13
|ρ_newton - ρ_scfv| = 2.2390488850073437e-12
|ρ_newton - ρ_dm|   = 3.4128119010308714e-10</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scf_callbacks/">« Monitoring self-consistent field calculations</a><a class="docs-footer-nextpage" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 17 September 2022 13:58">Saturday 17 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
