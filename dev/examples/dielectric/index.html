<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Eigenvalues of the dielectric matrix · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/dielectric/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li class="is-active"><a class="tocitem" href>Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../compare_solvers/">Comparison of DFT solvers</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Response and properties</a></li><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/dielectric.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Eigenvalues-of-the-dielectric-matrix"><a class="docs-heading-anchor" href="#Eigenvalues-of-the-dielectric-matrix">Eigenvalues of the dielectric matrix</a><a id="Eigenvalues-of-the-dielectric-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalues-of-the-dielectric-matrix" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/dielectric.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/dielectric.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compute a few eigenvalues of the dielectric matrix (q=0,ω=0) iteratively.</p><pre><code class="language-julia hljs">using DFTK
using Plots
using KrylovKit
using Printf

# Calculation parameters
kgrid = [1, 1, 1]
Ecut = 5

# Silicon lattice
a = 10.26
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

# Compute the dielectric operator without symmetries
model = model_LDA(lattice, atoms, positions, symmetries=false)
basis = PlaneWaveBasis(model; Ecut, kgrid)
scfres = self_consistent_field(basis, tol=1e-14)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.5274666744689548 0.5044274658699962 … 0.4441271664936309 0.504427478502088; 0.5044274686977281 0.47725916445875305 … 0.4288920116969746 0.486075147209411; … ; 0.444127161012168 0.42889200429550023 … 0.36709511118798666 0.41730358542160934; 0.5044274758006027 0.4860751420060915 … 0.4173035884410338 0.4772591819059474;;; 0.5044274709202728 0.47725916661872675 … 0.42889201376188996 0.4860751494001064; 0.4772591695977044 0.44452968054376796 … 0.4098211963583682 0.4647445370568542; … ; 0.42889200867177096 0.4098211891922889 … 0.3603062815564723 0.408901997969588; 0.4860751467786085 0.4647445317545573 … 0.40890200072770777 0.46474454373352125;;; 0.4441271539085711 0.41730357175952293 … 0.37467443553269236 0.42889200676379613; 0.41730357473551144 0.38733678514371744 … 0.3577719596568285 0.4089019894067655; … ; 0.37467443094210245 0.35777195284141583 … 0.3134919689490639 0.3577719631030625; 0.4288920042770589 0.40890198417144896 … 0.3577719654893405 0.409821195865353;;; … ;;; 0.3720716534233013 0.35385338522832877 … 0.3279354992611307 0.3563741638163379; 0.3538533872598707 0.33178203437557524 … 0.3099360220659916 0.3421493121956579; … ; 0.32793549409006123 0.3099360152142307 … 0.3241773227211713 0.32702014607478525; 0.3563741613901982 0.342149307886648 … 0.32702014887163616 0.34341104120209026;;; 0.44412715724033597 0.4288920005441669 … 0.3670951077410094 0.4173035817746079; 0.4288920028415719 0.4098211834300131 … 0.3603062762204897 0.4089019923080386; … ; 0.3670951022752266 0.3603062689828534 … 0.3241773286031964 0.34595875362170286; 0.4173035791813364 0.4089019876354802 … 0.3459587565815542 0.38733679243548613;;; 0.5044274736219335 0.4860751398567541 … 0.41730358645802557 0.4772591797927153; 0.48607514243449024 0.46474452749336204 … 0.4089019967454786 0.46474453949333755; … ; 0.41730358083764524 0.4089019892977626 … 0.34595875810753096 0.38733679403629584; 0.47725917709409205 0.46474453450873277 … 0.38733679711469216 0.4445296949122144]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5575517636733178 -0.5479471274492559 … -0.5185332279633479 -0.5479471320415416; -0.5479471281023176 -0.5318143632479466 … -0.518437725594091 -0.5418065877811188; … ; -0.5185332265690551 -0.5184377239694419 … -0.4296212318120341 -0.4895688452608669; -0.5479471314560509 -0.5418065866756181 … -0.4895688462453177 -0.5318143704535112;;; -0.547947128872234 -0.5318143640127829 … -0.5184377263372093 -0.5418065885499148; -0.5318143647628951 -0.5005477155262569 … -0.5121183322935949 -0.5325945667833931; … ; -0.5184377251501437 -0.5121183307552585 … -0.46613440901020087 -0.5043253433080069; -0.5418065879857396 -0.5325945655895552 … -0.5043253441004452 -0.5325945700819387;;; -0.5185332223636495 -0.48956883842022475 … -0.498132777768199 -0.518437723255094; -0.48956883922049893 -0.43645079067572756 … -0.4900722209255985 -0.5043253384575727; … ; -0.4981327767612919 -0.4900722194333216 … -0.4651952848275145 -0.49007222355914365; -0.5184377227079592 -0.5043253372027893 … -0.4900722241638334 -0.5121183325594584;;; … ;;; -0.47260172438807746 -0.4820441561914165 … -0.3634524773588852 -0.4305619814512486; -0.4820441565492981 -0.479220528863064 … -0.4126646395952022 -0.46009328839407465; … ; -0.36345247580083767 -0.4126646379411798 … -0.22859973235970166 -0.2848129662971616; -0.43056198095704323 -0.46009328758480844 … -0.2848129676914352 -0.3648044502069665;;; -0.5185332251653678 -0.5184377226092692 … -0.4296212301389882 -0.4895688437992337; -0.5184377230598183 -0.5121183287114919 … -0.4661344068549138 -0.5043253412157139; … ; -0.42962122851598133 -0.4661344050968914 … -0.22859973920788573 -0.34831028650213847; -0.48956884322084887 -0.504325340269137 … -0.3483102878215038 -0.4364507961521405;;; -0.5479471306841084 -0.5418065859273251 … -0.48956884543493095 -0.5318143696730773; -0.5418065864736273 -0.532594564107901 … -0.504325342621921 -0.5325945685765994; … ; -0.48956884387354943 -0.5043253408937123 … -0.3483102888576268 -0.43645079689113353; -0.5318143690716801 -0.5325945675468995 … -0.4364507980396366 -0.5005477225284004])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.33107431007540206 -0.4128072016633583 … -0.6446111563147616 -0.41280719362355206; -0.4128071994886877 -0.7100657338429106 … -0.35446156819197466 -0.3091330632435711; … ; -0.644611160401932 -0.3544615739688002 … -2.3546475372252775 -1.2457143194725313; -0.4128071957395468 -0.30913306734139034 … -1.245714317437558 -0.7100657236012807;;; -0.41280719803605975 -0.710065732447773 … -0.3544615668701777 -0.3091330618216716; -0.7100657302189073 -1.4302028633669996 … -0.2672778776278695 -0.3835446252602306; … ; -0.35446157077323137 -0.26727788325561264 … -0.9690574211979619 -0.5871334776820591; -0.3091330638789944 -0.3835446293686899 … -0.5871334757163781 -0.38354462188210925;;; -0.644611163300123 -1.245714326293976 … -0.247800707523383 -0.3544615707861562; -1.2457143241182613 -2.8821341167586736 … -0.30543891061437506 -0.5871334813944477; … ; -0.24780071110706609 -0.30543891593751116 … -0.45306668783748294 -0.3054389098016863; -0.35446157272575884 -0.5871334853749811 … -0.3054389080200978 -0.2672778783867482;;; … ;;; -0.9709769962867055 -0.4899758258417381 … -3.58786038929012 -1.9567619749298975; -0.4899758241680774 -0.27931812672081824 … -1.4218711381075757 -0.8653691177398413; … ; -3.587860392903142 -1.4218711433053142 … -10.921547058568986 -8.025756895399466; -1.9567619768618316 -0.8653691212395851 … -8.025756893996888 -4.601265261071095;;; -0.6446111627700766 -0.3544615763599608 … -2.3546475389992096 -1.2457143216579003; -0.3544615745131046 -0.2672778869741216 … -0.9690574243786566 -0.5871334812513158; … ; -2.354647542841985 -0.9690574298582706 … -10.93098724986057 -6.027813133855969; -1.2457143236727866 -0.5871334849772976 … -6.027813132215486 -2.8821341149433177;;; -0.41280719714627356 -0.30913306874243424 … -1.24571431861018 -0.7100657249340789; -0.30913306671100027 -0.38354463214823065 … -0.5871334782200828 -0.38354462461695343; … ; -1.2457143226691787 -0.5871334839395903 … -6.027813131725631 -2.8821341140815004; -0.7100657270313049 -0.3835446285718587 … -2.8821341121516078 -1.4302028560006965]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -7.25133879870454), converged = true, occupation_threshold = 1.0e-6, ρ = [0.1271082753568749 0.12017965427801115 … 0.10056375961538552 0.12017965752793243; 0.12017965474017737 0.10912704730850106 … 0.10050389711585668 0.11588721248641821; … ; 0.10056375874124228 0.10050389609770541 … 0.05464060938652987 0.08349600785133053; 0.12017965711358569 0.11588721172316697 … 0.08349600839515334 0.10912705208414089;;; 0.1201796552850405 0.10912704781541245 … 0.10050389758156156 0.11588721301720457; 0.10912704831256509 0.08971211814905537 … 0.0965964198278391 0.10964497706469031; … ; 0.10050389683763943 0.09659641888943642 … 0.07122114710220298 0.09192172071325329; 0.11588721262769097 0.1096449762708978 … 0.0919217211806075 0.10964497925792002;;; 0.10056375610468919 0.08349600407247523 … 0.08831868400662439 0.10050389565003075; 0.08349600451455652 0.0575166753383788 … 0.08377439414825408 0.0919217178526255; … ; 0.08831868342872469 0.0837743933220318 … 0.07075664425290934 0.08377439560635735; 0.10050389530714685 0.09192171711259534 … 0.08377439594115327 0.0965964199900189;;; … ;;; 0.07447652236347167 0.07940929847143768 … 0.031661598662949784 0.05503081497404691; 0.07940929866249509 0.07791160729953332 … 0.047927001155104135 0.06826914873611867; … ; 0.03166159821890895 0.047927000529286085 … 0.006870415400695813 0.014215397622794656; 0.055030814768561864 0.06826914834635878 … 0.014215397852217473 0.03204851532611605;;; 0.10056375786120918 0.10050389524529885 … 0.05464060869426504 0.08349600704390626; 0.10050389552765344 0.09659641764271551 … 0.07122114603379322 0.09192171947928719; … ; 0.05464060802270517 0.0712211451623138 … 0.006870416083376464 0.027544043391565142; 0.08349600672439932 0.09192171892102703 … 0.02754404373337632 0.05751667768508048;;; 0.1201796565672886 0.1158872112065362 … 0.08349600794748564 0.10912705156689181; 0.11588721158371007 0.10964497528573389 … 0.09192172030862215 0.10964497825700767; … ; 0.08349600708495919 0.09192171928938117 … 0.027544044001807235 0.057516678001746945; 0.10912705116830317 0.10964497757235193 … 0.05751667849389281 0.08971212221087758;;;;], α = 0.8, eigenvalues = [[-0.1443155931737168, 0.29698169024488885, 0.2969816913429474, 0.29698169198807994, 0.3757382660095806, 0.3757382665204912, 0.37573826699420887]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.3442393820478714, n_iter = 16, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.4525293629530904 + 0.8506228578370674im 1.3935256707634674e-9 - 1.3900286103899729e-9im … -1.4849696146195128e-9 + 2.7067586296082946e-9im 2.2986398171428746e-9 - 4.32666550206572e-9im; -0.040500207171082145 + 0.07612854602795892im -0.17744834799510656 + 0.1792081800185036im … -0.3776384794600432 - 0.2039746263009781im -0.3292465575426055 - 0.17384930210667726im; … ; -0.006018707695155765 + 0.011313412469782368im 0.02282720668343677 - 0.023053590596469074im … -0.05260594794654037 - 0.028414152067614228im -0.029352847342502427 - 0.015498940439592601im; 0.04050020937078023 - 0.07612854574230123im 0.07090745664312313 - 0.07161065335122944im … -0.0920341871543984 - 0.04971057511152843im 0.06718055796933824 + 0.035472778961525876im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.1443155931737168, 0.29698169024488885, 0.2969816913429474, 0.29698169198807994, 0.3757382660095806, 0.3757382665204912, 0.37573826699420887]], X = [[-0.4525293629530904 + 0.8506228578370674im 1.3935256707634674e-9 - 1.3900286103899729e-9im … -1.4849696146195128e-9 + 2.7067586296082946e-9im 2.2986398171428746e-9 - 4.32666550206572e-9im; -0.040500207171082145 + 0.07612854602795892im -0.17744834799510656 + 0.1792081800185036im … -0.3776384794600432 - 0.2039746263009781im -0.3292465575426055 - 0.17384930210667726im; … ; -0.006018707695155765 + 0.011313412469782368im 0.02282720668343677 - 0.023053590596469074im … -0.05260594794654037 - 0.028414152067614228im -0.029352847342502427 - 0.015498940439592601im; 0.04050020937078023 - 0.07612854574230123im 0.07090745664312313 - 0.07161065335122944im … -0.0920341871543984 - 0.04971057511152843im 0.06718055796933824 + 0.035472778961525876im]], residual_norms = [[3.4182245115381306e-9, 4.769682618631236e-9, 3.637781934753812e-9, 5.186523466288439e-9, 4.431399174111583e-9, 3.2096830307386434e-9, 4.001402405026947e-9]], iterations = [1], converged = 1, n_matvec = 14)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 1.6593470009919172e-8)</code></pre><p>Apply ε† = 1 - χ0 (vc + fxc)</p><pre><code class="language-julia hljs">function eps_fun(δρ)
    δV = apply_kernel(basis, δρ; ρ=scfres.ρ)
    χ0δV = apply_χ0(scfres, δV)
    δρ - χ0δV
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">eps_fun (generic function with 1 method)</code></pre><p>eager diagonalizes the subspace matrix at each iteration</p><pre><code class="language-julia hljs">eigsolve(eps_fun, randn(size(scfres.ρ)), 5, :LM; eager=true, verbosity=3);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Arnoldi iteration step 1: normres = 0.0636859320136737
[ Info: Arnoldi iteration step 2: normres = 0.37291826427649566
[ Info: Arnoldi iteration step 3: normres = 1.050225152169492
[ Info: Arnoldi iteration step 4: normres = 0.28331224975076813
[ Info: Arnoldi iteration step 5: normres = 0.6743086235075589
[ Info: Arnoldi schursolve in iter 1, krylovdim = 5: 0 values converged, normres = (8.16e-02, 9.72e-02, 6.24e-01, 2.21e-01, 1.88e-02)
[ Info: Arnoldi iteration step 6: normres = 0.20370769963863988
[ Info: Arnoldi schursolve in iter 1, krylovdim = 6: 0 values converged, normres = (1.24e-02, 1.10e-01, 9.93e-02, 1.03e-01, 6.51e-02)
[ Info: Arnoldi iteration step 7: normres = 0.08497049516557163
[ Info: Arnoldi schursolve in iter 1, krylovdim = 7: 0 values converged, normres = (5.11e-04, 8.41e-03, 7.43e-03, 6.29e-02, 4.83e-02)
[ Info: Arnoldi iteration step 8: normres = 0.10520552964687213
[ Info: Arnoldi schursolve in iter 1, krylovdim = 8: 0 values converged, normres = (2.30e-05, 6.18e-04, 6.03e-04, 1.92e-02, 3.12e-02)
[ Info: Arnoldi iteration step 9: normres = 0.06742997367852646
[ Info: Arnoldi schursolve in iter 1, krylovdim = 9: 0 values converged, normres = (6.69e-07, 2.96e-05, 3.21e-05, 4.36e-03, 2.37e-02)
[ Info: Arnoldi iteration step 10: normres = 0.11519448533222616
[ Info: Arnoldi schursolve in iter 1, krylovdim = 10: 0 values converged, normres = (3.36e-08, 2.46e-06, 2.97e-06, 1.79e-03, 3.56e-02)
[ Info: Arnoldi iteration step 11: normres = 0.0846277007100041
[ Info: Arnoldi schursolve in iter 1, krylovdim = 11: 0 values converged, normres = (1.25e-09, 1.53e-07, 2.06e-07, 6.17e-04, 4.78e-02)
[ Info: Arnoldi iteration step 12: normres = 0.07679838903773933
[ Info: Arnoldi schursolve in iter 1, krylovdim = 12: 0 values converged, normres = (4.10e-11, 8.16e-09, 1.22e-08, 1.44e-04, 1.96e-02)
[ Info: Arnoldi iteration step 13: normres = 0.2844611302219234
[ Info: Arnoldi schursolve in iter 1, krylovdim = 13: 0 values converged, normres = (5.16e-12, 1.72e-09, 2.86e-09, 1.66e-04, 5.99e-02)
[ Info: Arnoldi iteration step 14: normres = 0.15552554406551658
[ Info: Arnoldi schursolve in iter 1, krylovdim = 14: 1 values converged, normres = (7.50e-13, 2.00e-09, 1.48e-01, 4.01e-03, 1.67e-05)
[ Info: Arnoldi iteration step 15: normres = 0.4921186158275097
[ Info: Arnoldi schursolve in iter 1, krylovdim = 15: 1 values converged, normres = (1.66e-13, 8.17e-10, 5.93e-02, 4.48e-04, 4.37e-05)
[ Info: Arnoldi iteration step 16: normres = 0.0814317220382233
[ Info: Arnoldi schursolve in iter 1, krylovdim = 16: 1 values converged, normres = (1.34e-14, 1.55e-08, 6.81e-02, 7.42e-04, 3.56e-02)
[ Info: Arnoldi iteration step 17: normres = 0.031483447555057914
[ Info: Arnoldi schursolve in iter 1, krylovdim = 17: 1 values converged, normres = (1.76e-16, 5.22e-08, 1.45e-03, 2.09e-04, 7.56e-04)
[ Info: Arnoldi iteration step 18: normres = 0.017781197237263464
[ Info: Arnoldi schursolve in iter 1, krylovdim = 18: 1 values converged, normres = (1.29e-18, 1.64e-05, 4.09e-06, 3.70e-07, 1.01e-05)
[ Info: Arnoldi iteration step 19: normres = 0.09159814499588645
[ Info: Arnoldi schursolve in iter 1, krylovdim = 19: 1 values converged, normres = (4.92e-20, 1.16e-07, 1.03e-06, 6.57e-07, 1.78e-07)
[ Info: Arnoldi iteration step 20: normres = 0.1501826579243869
[ Info: Arnoldi schursolve in iter 1, krylovdim = 20: 1 values converged, normres = (3.57e-21, 9.73e-08, 9.18e-08, 6.82e-08, 7.33e-08)
[ Info: Arnoldi iteration step 21: normres = 0.026366793154752165
[ Info: Arnoldi schursolve in iter 1, krylovdim = 21: 1 values converged, normres = (4.02e-23, 1.85e-09, 1.64e-09, 1.61e-09, 1.28e-09)
[ Info: Arnoldi iteration step 22: normres = 0.3280402359776638
[ Info: Arnoldi schursolve in iter 1, krylovdim = 22: 1 values converged, normres = (5.58e-24, 4.08e-10, 3.79e-10, 3.99e-10, 3.20e-10)
[ Info: Arnoldi iteration step 23: normres = 0.059847141108010475
[ Info: Arnoldi schursolve in iter 1, krylovdim = 23: 1 values converged, normres = (3.09e-25, 1.63e-10, 1.52e-10, 7.82e-09, 6.66e-09)
[ Info: Arnoldi iteration step 24: normres = 0.013945182212543211
[ Info: Arnoldi schursolve in iter 1, krylovdim = 24: 1 values converged, normres = (1.77e-27, 1.52e-12, 1.41e-12, 4.91e-09, 4.32e-09)
[ Info: Arnoldi iteration step 25: normres = 0.093932436477255
[ Info: Arnoldi schursolve in iter 1, krylovdim = 25: 3 values converged, normres = (6.95e-29, 9.58e-14, 8.89e-14, 2.85e-05, 1.26e-05)
[ Info: Arnoldi iteration step 26: normres = 0.03136256490394622
[ Info: Arnoldi schursolve in iter 1, krylovdim = 26: 3 values converged, normres = (9.75e-31, 2.27e-15, 2.10e-15, 7.68e-08, 1.07e-08)
[ Info: Arnoldi iteration step 27: normres = 0.02966559338099292
[ Info: Arnoldi schursolve in iter 1, krylovdim = 27: 3 values converged, normres = (1.19e-32, 4.40e-17, 4.08e-17, 6.33e-09, 2.19e-08)
[ Info: Arnoldi iteration step 28: normres = 0.09503831420008363
[ Info: Arnoldi schursolve in iter 1, krylovdim = 28: 3 values converged, normres = (4.93e-34, 3.02e-18, 2.80e-18, 3.32e-10, 1.73e-09)
[ Info: Arnoldi iteration step 29: normres = 0.024084227568406603
[ Info: Arnoldi schursolve in iter 1, krylovdim = 29: 3 values converged, normres = (4.97e-36, 4.91e-20, 4.56e-20, 6.00e-12, 3.10e-11)
[ Info: Arnoldi iteration step 30: normres = 0.22739609161451801
[ Info: Arnoldi schursolve in iter 1, krylovdim = 30: 3 values converged, normres = (5.20e-37, 8.82e-21, 8.18e-21, 1.21e-12, 6.25e-12)
[ Info: Arnoldi schursolve in iter 2, krylovdim = 19: 3 values converged, normres = (5.20e-37, 8.82e-21, 8.18e-21, 1.21e-12, 6.25e-12)
[ Info: Arnoldi iteration step 20: normres = 0.03849401177801852
┌ Info: Arnoldi eigsolve finished after 2 iterations:
│ *  6 eigenvalues converged
│ *  norm of residuals = (8.93311387168403e-39, 2.5763617427932235e-22, 2.650275638221875e-22, 3.964460606423837e-14, 2.0805420268572586e-13, 2.0820109727149098e-14)
└ *  number of operations = 31</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../forwarddiff/">« Polarizability using automatic differentiation</a><a class="docs-footer-nextpage" href="../atomsbase/">AtomsBase integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Sunday 11 September 2022 12:35">Sunday 11 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
