<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Eigenvalues of the dielectric matrix · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/dielectric/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li class="is-active"><a class="tocitem" href>Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../compare_solvers/">Comparison of DFT solvers</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Response and properties</a></li><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/dielectric.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Eigenvalues-of-the-dielectric-matrix"><a class="docs-heading-anchor" href="#Eigenvalues-of-the-dielectric-matrix">Eigenvalues of the dielectric matrix</a><a id="Eigenvalues-of-the-dielectric-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalues-of-the-dielectric-matrix" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/dielectric.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/dielectric.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compute a few eigenvalues of the dielectric matrix (q=0,ω=0) iteratively.</p><pre><code class="language-julia hljs">using DFTK
using Plots
using KrylovKit
using Printf

# Calculation parameters
kgrid = [1, 1, 1]
Ecut = 5

# Silicon lattice
a = 10.26
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

# Compute the dielectric operator without symmetries
model = model_LDA(lattice, atoms, positions, symmetries=false)
basis = PlaneWaveBasis(model; Ecut, kgrid)
scfres = self_consistent_field(basis, tol=1e-14)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.5274666732468158 0.5044274774693577 … 0.44412714405353576 0.5044274647791018; 0.5044274796156613 0.4772591850461737 … 0.42889199830737046 0.48607514556956677; … ; 0.4441271399746526 0.42889199247050536 … 0.3670950884700243 0.41730356063387086; 0.5044274626106363 0.4860751413940993 … 0.41730356266980234 0.4772591596110816;;; 0.5044274838766113 0.47725918952502844 … 0.42889200258647364 0.4860751497647934; 0.47725919146153106 0.4445297073195789 … 0.4098211961264608 0.4647445489184935; … ; 0.4288919984224661 0.4098211903973359 … 0.36030626033904467 0.40890197960067115; 0.48607514763480913 0.4647445449754932 … 0.40890198177314674 0.46474453278528377;;; 0.44412717748758707 0.4173036006486063 … 0.3746744373288723 0.42889202030968326; 0.4173036020925876 0.3873368122026038 … 0.35777197148870893 0.4089020111642642; … ; 0.3746744336145289 0.3577719665903378 … 0.31349195437988325 0.35777195540467926; 0.428892018488078 0.40890200797623855 … 0.35777195741442186 0.40982119831577607;;; … ;;; 0.37207162279180905 0.35385336067783696 … 0.3279354732828601 0.35637413295563586; 0.35385336181928434 0.3317820187087561 … 0.30993599142271455 0.3421492814288922; … ; 0.3279354726105937 0.30993598967236397 … 0.3241773197123768 0.32702013289148074; 0.35637413231386633 0.3421492796739376 … 0.3270201329312422 0.343411016894644;;; 0.44412713148334254 0.42889198498373354 … 0.3670950779828832 0.41730355106412576; 0.4288919866845473 0.4098211794723462 … 0.36030624620228424 0.4089019666764045; … ; 0.36709507580590695 0.36030624250663723 … 0.324177316762042 0.3459587327809007; 0.4173035496979647 0.4089019636836846 … 0.34595873363663454 0.3873367636946321;;; 0.504427458277998 0.4860751373651649 … 0.41730355749049614 0.4772591548527849; 0.4860751394228444 0.4647445368198964 … 0.4089019725943718 0.4647445241818022; … ; 0.4173035541002922 0.40890196745572854 … 0.3459587390671689 0.3873367686691798; 0.477259152946925 0.4647445203368094 … 0.3873367702415265 0.44452966639486086]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5575517632093184 -0.5479471313484933 … -0.5185332200054054 -0.5479471273181973; -0.5479471320959125 -0.5318143705287984 … -0.518437721015113 -0.5418065874880464; … ; -0.5185332184841069 -0.5184377189424567 … -0.4296212226784701 -0.48956883591248396; -0.5479471265799806 -0.5418065860677035 … -0.4895688367937171 -0.5318143625207703;;; -0.5479471330990833 -0.531814371673106 … -0.5184377221472001 -0.541806588491368; -0.5318143724144915 -0.5005477249291899 … -0.5121183324333742 -0.5325945711470201; … ; -0.5184377206598171 -0.5121183303988056 … -0.46613440046318555 -0.5043253359810237; -0.5418065877653763 -0.5325945697516631 … -0.5043253368206431 -0.5325945657534704;;; -0.5185332305235785 -0.4895688487462042 … -0.4981327781538414 -0.5184377278845979; -0.489568849418286 -0.43645080135521747 … -0.49007222568306774 -0.5043253466693859; … ; -0.49813277679408424 -0.4900722238343142 … -0.4651952783081246 -0.4900722196723412; -0.5184377272231531 -0.5043253454086175 … -0.4900722204298126 -0.5121183327598832;;; … ;;; -0.47260171246477434 -0.4820441467668382 … -0.3634524648523803 -0.43056196862219204; -0.48204414718048616 -0.47922052347313043 … -0.41266462638853885 -0.4600932763936195; … ; -0.3634524645921107 -0.4126646256558756 … -0.22859973269725611 -0.28481295820488295; -0.43056196836805083 -0.4600932757308706 … -0.2848129580238197 -0.3648044383256902;;; -0.5185332160480686 -0.5184377171086207 … -0.4296212181993432 -0.48956883263338064; -0.5184377177077392 -0.5121183279180656 … -0.4661343954354394 -0.5043253321562781; … ; -0.42962121709550555 -0.46613439388347744 … -0.22859972962036643 -0.3483102760811569; -0.48956883208237273 -0.5043253310514253 … -0.34831027672915743 -0.43645078475422294;;; -0.5479471254967372 -0.5418065851504987 … -0.48956883499625586 -0.5318143611378656; -0.5418065858538743 -0.532594567852734 … -0.5043253340622723 -0.5325945635344891; … ; -0.4895688335686861 -0.5043253321239398 … -0.34831027989227054 -0.4364507868151349; -0.531814360448436 -0.5325945621997213 … -0.4364507876701888 -0.5005477123673989])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.3310743108335416 -0.41280719396323423 … -0.6446111707969142 -0.412807202623194; -0.4128071925643495 -0.7100657205363418 … -0.35446157700260084 -0.30913306459034295; … ; -0.6446111733544992 -0.3544615807668099 … -2.354647550809676 -1.2457143349118869; -0.4128072040534428 -0.3091330673454679 … -1.245714333757189 -0.7100657379634057;;; -0.4128071893065706 -0.7100657172017945 … -0.3544615738555848 -0.30913306139843777; -0.710065716006677 -1.4302028459941218 … -0.26727787799955627 -0.3835446177622183; … ; -0.35446157653220955 -0.2672778816941127 … -0.9690574338683742 -0.5871334887239927; -0.3091330628024305 -0.38354462030986186 … -0.587133487391137 -0.3835446285018785;;; -0.6446111478810361 -1.2457143077308723 … -0.2478007061128455 -0.35446156186977296; -1.2457143069589722 -2.882134100379277 … -0.3054389035399639 -0.5871334678487621; … ; -0.2478007084674319 -0.30543890658958184 … -0.4530666958872737 -0.3054389136132671; -0.35446156302993365 -0.5871334697760198 … -0.30543891236099563 -0.2672778761367499;;; … ;;; -0.9709770149948946 -0.4899758409676516 … -3.587860402761886 -1.956761992961543; -0.4899758402398518 -0.2793181369977038 … -1.4218711555441894 -0.8653691365061519; … ; -3.5878604031738828 -1.4218711565618767 … -10.921547061915337 -8.02575690049049; -1.9567619933491713 -0.8653691375983577 … -8.025756900269666 -4.601265273497265;;; -0.6446111794097706 -0.3544615864197456 … -2.3546475568176906 -1.2457143412025293; -0.3544615853180501 -0.2672778901383621 … -0.9690574429773877 -0.5871334978235141; … ; -2.354647557890829 -0.9690574451210728 … -10.930987252114207 -6.0278131442757905; -1.2457143420176822 -0.5871334997113814 … -6.027813144068059 -2.8821341322862546;;; -0.41280720730283793 -0.30913307045719707 … -1.2457143371390342 -0.7100657413387976; -0.30913306910289307 -0.38354462656652927 … -0.587133493811541 -0.3835446348863785; … ; -1.2457143391016685 -0.5871334970118518 … -6.027813141800638 -2.882134129372618; -0.7100657425552278 -0.38354463739660394 … -2.8821341286553257 -1.4302028743570487]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -7.25133879870454), converged = true, occupation_threshold = 1.0e-6, ρ = [0.1271082750157586 0.120179657037468 … 0.10056375462620257 0.1201796541852621; 0.12017965756641028 0.10912705213403907 … 0.10050389424625708 0.11588721228407745; … ; 0.10056375367243395 0.10050389294734423 … 0.054640605607288215 0.0834960026871682; 0.12017965366283241 0.11588721130345515 … 0.08349600317397225 0.10912704682654963;;; 0.12017965827634568 0.10912705289245303 … 0.10050389495572479 0.11588721297678305; 0.10912705338382185 0.08971212360353407 … 0.09659641991310608 0.10964497996610127; … ; 0.1005038940235968 0.09659641867199611 … 0.07122114286531284 0.0919217163920379; 0.11588721247554946 0.10964497903831714 … 0.09192171688721794 0.10964497637988638;;; 0.1005637612205064 0.08349600977667405 … 0.08831868422795826 0.10050389855129445; 0.08349601014794032 0.05751667991465479 … 0.08377439678230097 0.0919217226956848; … ; 0.08831868344754537 0.08377439575870985 … 0.07075664103552066 0.08377439345436868; 0.10050389813677366 0.09192172195212481 … 0.08377439387375452 0.09659642011228026;;; … ;;; 0.07447651627017349 0.07940929344006563 … 0.0316615950986178 0.05503080963986903; 0.07940929366089426 0.07791160445915103 … 0.04792699615821426 0.06826914295644305; … ; 0.03166159502444142 0.04792699588100287 … 0.006870415434345883 0.01421539629123883; 0.05503080953419996 0.06826914263724902 … 0.014215396261445513 0.0320485119117117;;; 0.10056375214517477 0.1005038917980977 … 0.05464060375393696 0.08349600087575099; 0.1005038921735592 0.09659641715871645 … 0.07122114037297989 0.09192171413632792; … ; 0.05464060329719642 0.07122113960364793 … 0.0068704151276174205 0.02754404069177624; 0.08349600057136744 0.09192171348472188 … 0.027544040859655308 0.057516672800950665;;; 0.12017965289623034 0.11588721067020566 … 0.08349600218103248 0.10912704591000043; 0.1158872111558249 0.10964497777570373 … 0.09192171526042103 0.10964497490446777; … ; 0.08349600139242529 0.09192171411725585 … 0.027544041679130653 0.05751667368407353; 0.10912704545306648 0.10964497401696983 … 0.05751667405047325 0.08971211631665656;;;;], α = 0.8, eigenvalues = [[-0.14431559109266398, 0.2969816933853997, 0.2969816936586286, 0.2969816948972336, 0.375738267813543, 0.37573826801574406, 0.37573826823281603]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.3442393823569184, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.02995869229501422 + 0.9630392239604406im -2.688532969235216e-10 - 7.300309571879143e-10im … -2.248111896241648e-9 - 6.92062860484989e-9im 4.2169012803122814e-11 + 1.0887024280062185e-9im; -0.002681227401065111 + 0.08618951994059097im 0.10150378456953071 + 0.2880807314913306im … -0.24700590048147214 + 0.07838830810637526im 0.5211654425573474 - 0.013109443498343979im; … ; -0.0003984560572048809 + 0.012808566933746508im -0.0101660377680481 - 0.028852514965423494im … -0.03965239599806509 + 0.012583831351651366im 0.06245483837030417 - 0.00157099960547413im; 0.00268122262522261 - 0.08618952111938584im -0.009100815812866868 - 0.025829335651534367im … -0.10701579064495033 + 0.03396174977586113im 0.036439385910605034 - 0.0009166084051578233im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.14431559109266398, 0.2969816933853997, 0.2969816936586286, 0.2969816948972336, 0.375738267813543, 0.37573826801574406, 0.37573826823281603]], X = [[-0.02995869229501422 + 0.9630392239604406im -2.688532969235216e-10 - 7.300309571879143e-10im … -2.248111896241648e-9 - 6.92062860484989e-9im 4.2169012803122814e-11 + 1.0887024280062185e-9im; -0.002681227401065111 + 0.08618951994059097im 0.10150378456953071 + 0.2880807314913306im … -0.24700590048147214 + 0.07838830810637526im 0.5211654425573474 - 0.013109443498343979im; … ; -0.0003984560572048809 + 0.012808566933746508im -0.0101660377680481 - 0.028852514965423494im … -0.03965239599806509 + 0.012583831351651366im 0.06245483837030417 - 0.00157099960547413im; 0.00268122262522261 - 0.08618952111938584im -0.009100815812866868 - 0.025829335651534367im … -0.10701579064495033 + 0.03396174977586113im 0.036439385910605034 - 0.0009166084051578233im]], residual_norms = [[2.3953745992120617e-9, 4.981004084502647e-9, 5.8446646580612525e-9, 6.000662191803646e-9, 2.5558760360266816e-9, 6.2041434504544546e-9, 2.9597146831308555e-9]], iterations = [1], converged = 1, n_matvec = 14)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 2.5918922488798713e-8)</code></pre><p>Apply ε† = 1 - χ0 (vc + fxc)</p><pre><code class="language-julia hljs">function eps_fun(δρ)
    δV = apply_kernel(basis, δρ; ρ=scfres.ρ)
    χ0δV = apply_χ0(scfres, δV)
    δρ - χ0δV
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">eps_fun (generic function with 1 method)</code></pre><p>eager diagonalizes the subspace matrix at each iteration</p><pre><code class="language-julia hljs">eigsolve(eps_fun, randn(size(scfres.ρ)), 5, :LM; eager=true, verbosity=3);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Arnoldi iteration step 1: normres = 0.056406538373478095
[ Info: Arnoldi iteration step 2: normres = 0.2761203488122839
[ Info: Arnoldi iteration step 3: normres = 0.8298360244069252
[ Info: Arnoldi iteration step 4: normres = 0.5801099502293943
[ Info: Arnoldi iteration step 5: normres = 0.5852538333660797
[ Info: Arnoldi schursolve in iter 1, krylovdim = 5: 0 values converged, normres = (1.80e-01, 8.84e-02, 5.15e-01, 1.94e-01, 8.26e-03)
[ Info: Arnoldi iteration step 6: normres = 0.20447289373695796
[ Info: Arnoldi schursolve in iter 1, krylovdim = 6: 0 values converged, normres = (3.04e-02, 1.10e-01, 1.13e-01, 1.05e-01, 1.66e-02)
[ Info: Arnoldi iteration step 7: normres = 0.07365157242771485
[ Info: Arnoldi schursolve in iter 1, krylovdim = 7: 0 values converged, normres = (1.02e-03, 6.55e-03, 6.65e-03, 2.97e-02, 6.38e-02)
[ Info: Arnoldi iteration step 8: normres = 0.10014723120426165
[ Info: Arnoldi schursolve in iter 1, krylovdim = 8: 0 values converged, normres = (4.38e-05, 4.60e-04, 5.18e-04, 9.09e-03, 4.80e-02)
[ Info: Arnoldi iteration step 9: normres = 0.053490413341957296
[ Info: Arnoldi schursolve in iter 1, krylovdim = 9: 0 values converged, normres = (1.01e-06, 1.75e-05, 2.18e-05, 1.63e-03, 2.60e-02)
[ Info: Arnoldi iteration step 10: normres = 0.09720802200350818
[ Info: Arnoldi schursolve in iter 1, krylovdim = 10: 0 values converged, normres = (4.23e-08, 1.20e-06, 1.66e-06, 4.92e-04, 2.01e-02)
[ Info: Arnoldi iteration step 11: normres = 0.08603644259317086
[ Info: Arnoldi schursolve in iter 1, krylovdim = 11: 0 values converged, normres = (1.59e-09, 7.49e-08, 1.16e-07, 1.60e-04, 3.62e-02)
[ Info: Arnoldi iteration step 12: normres = 0.11020316357370961
[ Info: Arnoldi schursolve in iter 1, krylovdim = 12: 0 values converged, normres = (7.68e-11, 6.01e-09, 1.03e-08, 6.59e-05, 4.91e-02)
[ Info: Arnoldi iteration step 13: normres = 0.11034856256198483
[ Info: Arnoldi schursolve in iter 1, krylovdim = 13: 0 values converged, normres = (3.66e-12, 4.73e-10, 9.03e-10, 2.62e-05, 4.19e-02)
[ Info: Arnoldi iteration step 14: normres = 0.47307369381197156
[ Info: Arnoldi schursolve in iter 1, krylovdim = 14: 0 values converged, normres = (1.60e-12, 1.28e-09, 1.25e-08, 4.71e-01, 6.22e-04)
[ Info: Arnoldi iteration step 15: normres = 0.12879763897876892
[ Info: Arnoldi schursolve in iter 1, krylovdim = 15: 1 values converged, normres = (1.00e-13, 1.34e-09, 4.29e-02, 1.41e-05, 3.13e-06)
[ Info: Arnoldi iteration step 16: normres = 0.28837499538204076
[ Info: Arnoldi schursolve in iter 1, krylovdim = 16: 1 values converged, normres = (2.63e-14, 9.39e-09, 6.46e-02, 3.14e-04, 2.77e-01)
[ Info: Arnoldi iteration step 17: normres = 0.030030047091600134
[ Info: Arnoldi schursolve in iter 1, krylovdim = 17: 1 values converged, normres = (3.48e-16, 3.85e-08, 1.86e-03, 3.45e-07, 6.09e-03)
[ Info: Arnoldi iteration step 18: normres = 0.0188397125238678
[ Info: Arnoldi schursolve in iter 1, krylovdim = 18: 1 values converged, normres = (2.71e-18, 1.82e-08, 2.32e-05, 7.26e-05, 4.15e-05)
[ Info: Arnoldi iteration step 19: normres = 0.15117826348682253
[ Info: Arnoldi schursolve in iter 1, krylovdim = 19: 1 values converged, normres = (1.73e-19, 1.45e-06, 1.90e-06, 9.07e-09, 9.53e-06)
[ Info: Arnoldi iteration step 20: normres = 0.07627496775514181
[ Info: Arnoldi schursolve in iter 1, krylovdim = 20: 1 values converged, normres = (6.38e-21, 1.89e-08, 1.57e-07, 4.78e-07, 5.37e-07)
[ Info: Arnoldi iteration step 21: normres = 0.027445240346605216
[ Info: Arnoldi schursolve in iter 1, krylovdim = 21: 1 values converged, normres = (7.36e-23, 1.38e-09, 2.61e-09, 1.45e-08, 3.30e-09)
[ Info: Arnoldi iteration step 22: normres = 0.0505946493122954
[ Info: Arnoldi schursolve in iter 1, krylovdim = 22: 1 values converged, normres = (1.53e-24, 4.64e-11, 8.62e-11, 5.18e-10, 1.56e-10)
[ Info: Arnoldi iteration step 23: normres = 0.426120572822563
[ Info: Arnoldi schursolve in iter 1, krylovdim = 23: 1 values converged, normres = (5.41e-25, 6.56e-11, 1.23e-10, 1.39e-09, 3.87e-10)
[ Info: Arnoldi iteration step 24: normres = 0.016342726870050825
[ Info: Arnoldi schursolve in iter 1, krylovdim = 24: 1 values converged, normres = (4.17e-27, 1.50e-12, 2.80e-12, 1.16e-03, 1.17e-03)
[ Info: Arnoldi iteration step 25: normres = 0.03052867233059192
[ Info: Arnoldi schursolve in iter 1, krylovdim = 25: 3 values converged, normres = (5.21e-29, 2.98e-14, 5.55e-14, 2.52e-08, 3.32e-09)
[ Info: Arnoldi iteration step 26: normres = 0.10711113890301369
[ Info: Arnoldi schursolve in iter 1, krylovdim = 26: 3 values converged, normres = (2.46e-30, 2.35e-15, 4.37e-15, 3.55e-06, 3.85e-06)
[ Info: Arnoldi iteration step 27: normres = 0.018727407042015167
[ Info: Arnoldi schursolve in iter 1, krylovdim = 27: 3 values converged, normres = (1.95e-32, 3.03e-17, 5.64e-17, 3.64e-08, 3.30e-08)
[ Info: Arnoldi iteration step 28: normres = 0.08433295791750862
[ Info: Arnoldi schursolve in iter 1, krylovdim = 28: 3 values converged, normres = (6.89e-34, 1.73e-18, 3.21e-18, 5.65e-09, 7.06e-09)
[ Info: Arnoldi iteration step 29: normres = 0.04922464299334077
[ Info: Arnoldi schursolve in iter 1, krylovdim = 29: 3 values converged, normres = (1.48e-35, 6.16e-20, 1.15e-19, 1.66e-10, 3.23e-10)
[ Info: Arnoldi iteration step 30: normres = 0.18018150558508286
[ Info: Arnoldi schursolve in iter 1, krylovdim = 30: 3 values converged, normres = (1.26e-36, 9.14e-21, 1.70e-20, 2.79e-11, 5.41e-11)
[ Info: Arnoldi schursolve in iter 2, krylovdim = 19: 3 values converged, normres = (1.26e-36, 9.14e-21, 1.70e-20, 2.79e-11, 5.41e-11)
[ Info: Arnoldi iteration step 20: normres = 0.077762922452344
[ Info: Arnoldi schursolve in iter 2, krylovdim = 20: 3 values converged, normres = (4.30e-38, 5.23e-22, 9.73e-22, 1.78e-12, 3.46e-12)
[ Info: Arnoldi iteration step 21: normres = 0.03599908478933959
┌ Info: Arnoldi eigsolve finished after 2 iterations:
│ *  6 eigenvalues converged
│ *  norm of residuals = (6.696067130746412e-40, 1.3414892197901112e-23, 2.4868261940041042e-23, 5.0798717496590804e-14, 1.0083410116147622e-13, 2.6830815838100025e-15)
└ *  number of operations = 32</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../forwarddiff/">« Polarizability using automatic differentiation</a><a class="docs-footer-nextpage" href="../atomsbase/">AtomsBase integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Monday 12 September 2022 14:02">Monday 12 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
