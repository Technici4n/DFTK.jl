<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison of DFT solvers · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/compare_solvers/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../energy_cutoff_smearing/">Energy cutoff smearing</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li class="is-active"><a class="tocitem" href>Comparison of DFT solvers</a><ul class="internal"><li><a class="tocitem" href="#Density-based-self-consistent-field"><span>Density-based self-consistent field</span></a></li><li><a class="tocitem" href="#Potential-based-SCF"><span>Potential-based SCF</span></a></li><li><a class="tocitem" href="#Direct-minimization"><span>Direct minimization</span></a></li></ul></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/compare_solvers.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-of-DFT-solvers"><a class="docs-heading-anchor" href="#Comparison-of-DFT-solvers">Comparison of DFT solvers</a><a id="Comparison-of-DFT-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-DFT-solvers" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/compare_solvers.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/compare_solvers.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compare four different approaches for solving the DFT minimisation problem, namely a density-based SCF, a potential-based SCF, direct minimisation and Newton.</p><p>First we setup our problem</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra

a = 10.26  # Silicon lattice constant in Bohr
lattice = a / 2 * [[0 1 1.];
                   [1 0 1.];
                   [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=[3, 3, 3])

# Convergence we desire
tol = 1e-12
is_converged = DFTK.ScfConvergenceDensity(tol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">#512 (generic function with 1 method)</code></pre><h2 id="Density-based-self-consistent-field"><a class="docs-heading-anchor" href="#Density-based-self-consistent-field">Density-based self-consistent field</a><a id="Density-based-self-consistent-field-1"></a><a class="docs-heading-anchor-permalink" href="#Density-based-self-consistent-field" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scf = self_consistent_field(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39155563703345003 0.3785174208997436 … 0.34469960027019386 0.3785174208997436; 0.37851742089974366 0.3664584406479101 … 0.32735728172224776 0.3636495426205361; … ; 0.34469960027019386 0.3273572817222477 … 0.30751926941851926 0.3343805319865576; 0.37851742089974366 0.3636495426205361 … 0.3343805319865577 0.36645844064791017;;; 0.37851742089974366 0.36645844064791017 … 0.32735728172224776 0.36364954262053606; 0.36645844064791017 0.3510288634177039 … 0.3111940134605783 0.3519170663491838; … ; 0.32735728172224776 0.3111940134605783 … 0.2982412284122229 0.32142600281508027; 0.3636495426205361 0.3519170663491838 … 0.3214260028150804 0.3519170663491838;;; 0.3446996002701939 0.3343805319865577 … 0.2865351537639304 0.32735728172224776; 0.3343805319865577 0.31861604776295127 … 0.27805891882347816 0.3214260028150804; … ; 0.2865351537639304 0.27805891882347816 … 0.2559018577231108 0.27805891882347816; 0.3273572817222478 0.3214260028150804 … 0.2780589188234783 0.31119401346057834;;; … ;;; 0.30487474928902786 0.2830366689623692 … 0.2855643323175207 0.3009573705183916; 0.2830366689623692 0.2589843162227283 … 0.27263300128655327 0.28541419662660966; … ; 0.2855643323175207 0.2726330012865532 … 0.27716038913767876 0.2812108737837726; 0.3009573705183916 0.2854141966266096 … 0.28121087378377263 0.29308272627167264;;; 0.3446996002701939 0.32735728172224776 … 0.30751926941851926 0.33438053198655765; 0.3273572817222478 0.31119401346057823 … 0.298241228412223 0.3214260028150804; … ; 0.30751926941851926 0.29824122841222295 … 0.2771603891376788 0.2931311914702048; 0.3343805319865577 0.3214260028150804 … 0.29313119147020483 0.31861604776295127;;; 0.37851742089974366 0.36364954262053606 … 0.3343805319865577 0.36645844064791017; 0.36364954262053606 0.35191706634918374 … 0.3214260028150804 0.3519170663491838; … ; 0.33438053198655765 0.3214260028150803 … 0.2931311914702048 0.3186160477629512; 0.3664584406479102 0.3519170663491838 … 0.31861604776295127 0.35102886341770395]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923122056 -0.4966565572256956 … -0.4771919009648843 -0.4966565572256956; -0.4966565572256956 -0.48481820871073145 … -0.4763804457667763 -0.4920413111694215; … ; -0.4771919009648843 -0.4763804457667763 … -0.41228807087390884 -0.455070081556115; -0.4966565572256956 -0.4920413111694215 … -0.455070081556115 -0.48481820871073145;;; -0.4966565572256956 -0.48481820871073145 … -0.4763804457667762 -0.4920413111694215; -0.48481820871073145 -0.4583744079148522 … -0.47065601570571586 -0.4861790251756173; … ; -0.4763804457667762 -0.47065601570571586 … -0.44639843643621074 -0.46889439639151903; -0.4920413111694215 -0.4861790251756173 … -0.46889439639151903 -0.4861790251756173;;; -0.4771919009648843 -0.455070081556115 … -0.4605141234226662 -0.4763804457667763; -0.455070081556115 -0.4090661824391208 … -0.4567199083211368 -0.46889439639151903; … ; -0.4605141234226661 -0.4567199083211368 … -0.44514495660348863 -0.4567199083211368; -0.4763804457667763 -0.46889439639151903 … -0.4567199083211368 -0.4706560157057159;;; … ;;; -0.4494759508409079 -0.4551499722014883 … -0.371259862617903 -0.417745715202758; -0.4551499722014883 -0.4488035109977127 … -0.41743801071341696 -0.4441260992987761; … ; -0.371259862617903 -0.4174380107134169 … -0.25365698328407355 -0.29979809105960026; -0.417745715202758 -0.4441260992987761 … -0.29979809105960026 -0.3610634326480208;;; -0.4771919009648843 -0.4763804457667763 … -0.41228807087390884 -0.455070081556115; -0.4763804457667763 -0.4706560157057159 … -0.44639843643621085 -0.46889439639151903; … ; -0.41228807087390884 -0.44639843643621085 … -0.2536569832840736 -0.3410633023008365; -0.455070081556115 -0.46889439639151903 … -0.3410633023008365 -0.4090661824391208;;; -0.4966565572256956 -0.4920413111694215 … -0.45507008155611495 -0.48481820871073145; -0.4920413111694215 -0.4861790251756173 … -0.46889439639151903 -0.4861790251756173; … ; -0.45507008155611495 -0.46889439639151903 … -0.3410633023008365 -0.4090661824391208; -0.48481820871073145 -0.4861790251756173 … -0.4090661824391208 -0.4583744079148522])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4129139212663236 -0.48683674427720386 … -0.7027113226191158 -0.48683674427720397; -0.4868367442772036 -0.7744303950404641 … -0.4136373284393233 -0.3823307497945017; … ; -0.7027113226191161 -0.4136373284393236 … -2.3967616825880746 -1.2958067581749828; -0.48683674427720347 -0.3823307497945016 … -1.2958067581749828 -0.7744303950404638;;; -0.4868367442772037 -0.7744303950404641 … -0.4136373284393232 -0.38233074979450205; -0.7744303950404638 -1.481447748391893 … -0.32458456943328784 -0.44991939657070484; … ; -0.4136373284393233 -0.32458456943328823 … -1.0113572986117174 -0.6373277791931995; -0.38233074979450155 -0.44991939657070484 … -0.637327779193199 -0.44991939657070473;;; -0.7027113226191157 -1.295806758174983 … -0.29820348937558094 -0.41363732843932355; -1.2958067581749828 -2.919672393653911 … -0.35372958466146176 -0.637327779193199; … ; -0.29820348937558094 -0.3537295846614623 … -0.49037260810718936 -0.3537295846614622; -0.41363732843932327 -0.637327779193199 … -0.3537295846614614 -0.32458456943328784;;; … ;;; -1.0166744212557892 -0.5332878143066075 … -3.636138257122885 -1.9987602620506402; -0.5332878143066073 -0.32174124747389665 … -1.4667339407502753 -0.9061938941468974; … ; -3.636138257122885 -1.466733940750275 … -10.988177824465922 -8.087376168208198; -1.99876026205064 -0.9061938941468975 … -8.087376168208198 -4.6478783711432525;;; -0.7027113226191157 -0.4136373284393233 … -2.396761682588075 -1.295806758174983; -0.41363732843932316 -0.32458456943328823 … -1.0113572986117174 -0.637327779193199; … ; -2.396761682588075 -1.0113572986117176 … -11.002806190875027 -6.077304186394093; -1.2958067581749826 -0.6373277791931989 … -6.077304186394093 -2.919672393653911;;; -0.48683674427720375 -0.38233074979450193 … -1.2958067581749828 -0.7744303950404641; -0.3823307497945017 -0.44991939657070495 … -0.637327779193199 -0.44991939657070484; … ; -1.295806758174983 -0.6373277791931993 … -6.077304186394093 -2.9196723936539106; -0.7744303950404636 -0.4499193965707047 … -2.9196723936539106 -1.481447748391893]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39155563703345003 0.3785174208997436 … 0.34469960027019386 0.3785174208997436; 0.37851742089974366 0.3664584406479101 … 0.32735728172224776 0.3636495426205361; … ; 0.34469960027019386 0.3273572817222477 … 0.30751926941851926 0.3343805319865576; 0.37851742089974366 0.3636495426205361 … 0.3343805319865577 0.36645844064791017;;; 0.37851742089974366 0.36645844064791017 … 0.32735728172224776 0.36364954262053606; 0.36645844064791017 0.3510288634177039 … 0.3111940134605783 0.3519170663491838; … ; 0.32735728172224776 0.3111940134605783 … 0.2982412284122229 0.32142600281508027; 0.3636495426205361 0.3519170663491838 … 0.3214260028150804 0.3519170663491838;;; 0.3446996002701939 0.3343805319865577 … 0.2865351537639304 0.32735728172224776; 0.3343805319865577 0.31861604776295127 … 0.27805891882347816 0.3214260028150804; … ; 0.2865351537639304 0.27805891882347816 … 0.2559018577231108 0.27805891882347816; 0.3273572817222478 0.3214260028150804 … 0.2780589188234783 0.31119401346057834;;; … ;;; 0.30487474928902786 0.2830366689623692 … 0.2855643323175207 0.3009573705183916; 0.2830366689623692 0.2589843162227283 … 0.27263300128655327 0.28541419662660966; … ; 0.2855643323175207 0.2726330012865532 … 0.27716038913767876 0.2812108737837726; 0.3009573705183916 0.2854141966266096 … 0.28121087378377263 0.29308272627167264;;; 0.3446996002701939 0.32735728172224776 … 0.30751926941851926 0.33438053198655765; 0.3273572817222478 0.31119401346057823 … 0.298241228412223 0.3214260028150804; … ; 0.30751926941851926 0.29824122841222295 … 0.2771603891376788 0.2931311914702048; 0.3343805319865577 0.3214260028150804 … 0.29313119147020483 0.31861604776295127;;; 0.37851742089974366 0.36364954262053606 … 0.3343805319865577 0.36645844064791017; 0.36364954262053606 0.35191706634918374 … 0.3214260028150804 0.3519170663491838; … ; 0.33438053198655765 0.3214260028150803 … 0.2931311914702048 0.3186160477629512; 0.3664584406479102 0.3519170663491838 … 0.31861604776295127 0.35102886341770395]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923122056 -0.4966565572256956 … -0.4771919009648843 -0.4966565572256956; -0.4966565572256956 -0.48481820871073145 … -0.4763804457667763 -0.4920413111694215; … ; -0.4771919009648843 -0.4763804457667763 … -0.41228807087390884 -0.455070081556115; -0.4966565572256956 -0.4920413111694215 … -0.455070081556115 -0.48481820871073145;;; -0.4966565572256956 -0.48481820871073145 … -0.4763804457667762 -0.4920413111694215; -0.48481820871073145 -0.4583744079148522 … -0.47065601570571586 -0.4861790251756173; … ; -0.4763804457667762 -0.47065601570571586 … -0.44639843643621074 -0.46889439639151903; -0.4920413111694215 -0.4861790251756173 … -0.46889439639151903 -0.4861790251756173;;; -0.4771919009648843 -0.455070081556115 … -0.4605141234226662 -0.4763804457667763; -0.455070081556115 -0.4090661824391208 … -0.4567199083211368 -0.46889439639151903; … ; -0.4605141234226661 -0.4567199083211368 … -0.44514495660348863 -0.4567199083211368; -0.4763804457667763 -0.46889439639151903 … -0.4567199083211368 -0.4706560157057159;;; … ;;; -0.4494759508409079 -0.4551499722014883 … -0.371259862617903 -0.417745715202758; -0.4551499722014883 -0.4488035109977127 … -0.41743801071341696 -0.4441260992987761; … ; -0.371259862617903 -0.4174380107134169 … -0.25365698328407355 -0.29979809105960026; -0.417745715202758 -0.4441260992987761 … -0.29979809105960026 -0.3610634326480208;;; -0.4771919009648843 -0.4763804457667763 … -0.41228807087390884 -0.455070081556115; -0.4763804457667763 -0.4706560157057159 … -0.44639843643621085 -0.46889439639151903; … ; -0.41228807087390884 -0.44639843643621085 … -0.2536569832840736 -0.3410633023008365; -0.455070081556115 -0.46889439639151903 … -0.3410633023008365 -0.4090661824391208;;; -0.4966565572256956 -0.4920413111694215 … -0.45507008155611495 -0.48481820871073145; -0.4920413111694215 -0.4861790251756173 … -0.46889439639151903 -0.4861790251756173; … ; -0.45507008155611495 -0.46889439639151903 … -0.3410633023008365 -0.4090661824391208; -0.48481820871073145 -0.4861790251756173 … -0.4090661824391208 -0.4583744079148522])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4129139212663236 -0.48683674427720386 … -0.7027113226191158 -0.48683674427720397; -0.4868367442772036 -0.7744303950404641 … -0.4136373284393233 -0.3823307497945017; … ; -0.7027113226191161 -0.4136373284393236 … -2.3967616825880746 -1.2958067581749828; -0.48683674427720347 -0.3823307497945016 … -1.2958067581749828 -0.7744303950404638;;; -0.4868367442772037 -0.7744303950404641 … -0.4136373284393232 -0.38233074979450205; -0.7744303950404638 -1.481447748391893 … -0.32458456943328784 -0.44991939657070484; … ; -0.4136373284393233 -0.32458456943328823 … -1.0113572986117174 -0.6373277791931995; -0.38233074979450155 -0.44991939657070484 … -0.637327779193199 -0.44991939657070473;;; -0.7027113226191157 -1.295806758174983 … -0.29820348937558094 -0.41363732843932355; -1.2958067581749828 -2.919672393653911 … -0.35372958466146176 -0.637327779193199; … ; -0.29820348937558094 -0.3537295846614623 … -0.49037260810718936 -0.3537295846614622; -0.41363732843932327 -0.637327779193199 … -0.3537295846614614 -0.32458456943328784;;; … ;;; -1.0166744212557892 -0.5332878143066075 … -3.636138257122885 -1.9987602620506402; -0.5332878143066073 -0.32174124747389665 … -1.4667339407502753 -0.9061938941468974; … ; -3.636138257122885 -1.466733940750275 … -10.988177824465922 -8.087376168208198; -1.99876026205064 -0.9061938941468975 … -8.087376168208198 -4.6478783711432525;;; -0.7027113226191157 -0.4136373284393233 … -2.396761682588075 -1.295806758174983; -0.41363732843932316 -0.32458456943328823 … -1.0113572986117174 -0.637327779193199; … ; -2.396761682588075 -1.0113572986117176 … -11.002806190875027 -6.077304186394093; -1.2958067581749826 -0.6373277791931989 … -6.077304186394093 -2.919672393653911;;; -0.48683674427720375 -0.38233074979450193 … -1.2958067581749828 -0.7744303950404641; -0.3823307497945017 -0.44991939657070495 … -0.637327779193199 -0.44991939657070484; … ; -1.295806758174983 -0.6373277791931993 … -6.077304186394093 -2.9196723936539106; -0.7744303950404636 -0.4499193965707047 … -2.9196723936539106 -1.481447748391893]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39155563703345003 0.3785174208997436 … 0.34469960027019386 0.3785174208997436; 0.37851742089974366 0.3664584406479101 … 0.32735728172224776 0.3636495426205361; … ; 0.34469960027019386 0.3273572817222477 … 0.30751926941851926 0.3343805319865576; 0.37851742089974366 0.3636495426205361 … 0.3343805319865577 0.36645844064791017;;; 0.37851742089974366 0.36645844064791017 … 0.32735728172224776 0.36364954262053606; 0.36645844064791017 0.3510288634177039 … 0.3111940134605783 0.3519170663491838; … ; 0.32735728172224776 0.3111940134605783 … 0.2982412284122229 0.32142600281508027; 0.3636495426205361 0.3519170663491838 … 0.3214260028150804 0.3519170663491838;;; 0.3446996002701939 0.3343805319865577 … 0.2865351537639304 0.32735728172224776; 0.3343805319865577 0.31861604776295127 … 0.27805891882347816 0.3214260028150804; … ; 0.2865351537639304 0.27805891882347816 … 0.2559018577231108 0.27805891882347816; 0.3273572817222478 0.3214260028150804 … 0.2780589188234783 0.31119401346057834;;; … ;;; 0.30487474928902786 0.2830366689623692 … 0.2855643323175207 0.3009573705183916; 0.2830366689623692 0.2589843162227283 … 0.27263300128655327 0.28541419662660966; … ; 0.2855643323175207 0.2726330012865532 … 0.27716038913767876 0.2812108737837726; 0.3009573705183916 0.2854141966266096 … 0.28121087378377263 0.29308272627167264;;; 0.3446996002701939 0.32735728172224776 … 0.30751926941851926 0.33438053198655765; 0.3273572817222478 0.31119401346057823 … 0.298241228412223 0.3214260028150804; … ; 0.30751926941851926 0.29824122841222295 … 0.2771603891376788 0.2931311914702048; 0.3343805319865577 0.3214260028150804 … 0.29313119147020483 0.31861604776295127;;; 0.37851742089974366 0.36364954262053606 … 0.3343805319865577 0.36645844064791017; 0.36364954262053606 0.35191706634918374 … 0.3214260028150804 0.3519170663491838; … ; 0.33438053198655765 0.3214260028150803 … 0.2931311914702048 0.3186160477629512; 0.3664584406479102 0.3519170663491838 … 0.31861604776295127 0.35102886341770395]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923122056 -0.4966565572256956 … -0.4771919009648843 -0.4966565572256956; -0.4966565572256956 -0.48481820871073145 … -0.4763804457667763 -0.4920413111694215; … ; -0.4771919009648843 -0.4763804457667763 … -0.41228807087390884 -0.455070081556115; -0.4966565572256956 -0.4920413111694215 … -0.455070081556115 -0.48481820871073145;;; -0.4966565572256956 -0.48481820871073145 … -0.4763804457667762 -0.4920413111694215; -0.48481820871073145 -0.4583744079148522 … -0.47065601570571586 -0.4861790251756173; … ; -0.4763804457667762 -0.47065601570571586 … -0.44639843643621074 -0.46889439639151903; -0.4920413111694215 -0.4861790251756173 … -0.46889439639151903 -0.4861790251756173;;; -0.4771919009648843 -0.455070081556115 … -0.4605141234226662 -0.4763804457667763; -0.455070081556115 -0.4090661824391208 … -0.4567199083211368 -0.46889439639151903; … ; -0.4605141234226661 -0.4567199083211368 … -0.44514495660348863 -0.4567199083211368; -0.4763804457667763 -0.46889439639151903 … -0.4567199083211368 -0.4706560157057159;;; … ;;; -0.4494759508409079 -0.4551499722014883 … -0.371259862617903 -0.417745715202758; -0.4551499722014883 -0.4488035109977127 … -0.41743801071341696 -0.4441260992987761; … ; -0.371259862617903 -0.4174380107134169 … -0.25365698328407355 -0.29979809105960026; -0.417745715202758 -0.4441260992987761 … -0.29979809105960026 -0.3610634326480208;;; -0.4771919009648843 -0.4763804457667763 … -0.41228807087390884 -0.455070081556115; -0.4763804457667763 -0.4706560157057159 … -0.44639843643621085 -0.46889439639151903; … ; -0.41228807087390884 -0.44639843643621085 … -0.2536569832840736 -0.3410633023008365; -0.455070081556115 -0.46889439639151903 … -0.3410633023008365 -0.4090661824391208;;; -0.4966565572256956 -0.4920413111694215 … -0.45507008155611495 -0.48481820871073145; -0.4920413111694215 -0.4861790251756173 … -0.46889439639151903 -0.4861790251756173; … ; -0.45507008155611495 -0.46889439639151903 … -0.3410633023008365 -0.4090661824391208; -0.48481820871073145 -0.4861790251756173 … -0.4090661824391208 -0.4583744079148522])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4129139212663236 -0.48683674427720386 … -0.7027113226191158 -0.48683674427720397; -0.4868367442772036 -0.7744303950404641 … -0.4136373284393233 -0.3823307497945017; … ; -0.7027113226191161 -0.4136373284393236 … -2.3967616825880746 -1.2958067581749828; -0.48683674427720347 -0.3823307497945016 … -1.2958067581749828 -0.7744303950404638;;; -0.4868367442772037 -0.7744303950404641 … -0.4136373284393232 -0.38233074979450205; -0.7744303950404638 -1.481447748391893 … -0.32458456943328784 -0.44991939657070484; … ; -0.4136373284393233 -0.32458456943328823 … -1.0113572986117174 -0.6373277791931995; -0.38233074979450155 -0.44991939657070484 … -0.637327779193199 -0.44991939657070473;;; -0.7027113226191157 -1.295806758174983 … -0.29820348937558094 -0.41363732843932355; -1.2958067581749828 -2.919672393653911 … -0.35372958466146176 -0.637327779193199; … ; -0.29820348937558094 -0.3537295846614623 … -0.49037260810718936 -0.3537295846614622; -0.41363732843932327 -0.637327779193199 … -0.3537295846614614 -0.32458456943328784;;; … ;;; -1.0166744212557892 -0.5332878143066075 … -3.636138257122885 -1.9987602620506402; -0.5332878143066073 -0.32174124747389665 … -1.4667339407502753 -0.9061938941468974; … ; -3.636138257122885 -1.466733940750275 … -10.988177824465922 -8.087376168208198; -1.99876026205064 -0.9061938941468975 … -8.087376168208198 -4.6478783711432525;;; -0.7027113226191157 -0.4136373284393233 … -2.396761682588075 -1.295806758174983; -0.41363732843932316 -0.32458456943328823 … -1.0113572986117174 -0.637327779193199; … ; -2.396761682588075 -1.0113572986117176 … -11.002806190875027 -6.077304186394093; -1.2958067581749826 -0.6373277791931989 … -6.077304186394093 -2.919672393653911;;; -0.48683674427720375 -0.38233074979450193 … -1.2958067581749828 -0.7744303950404641; -0.3823307497945017 -0.44991939657070495 … -0.637327779193199 -0.44991939657070484; … ; -1.295806758174983 -0.6373277791931993 … -6.077304186394093 -2.9196723936539106; -0.7744303950404636 -0.4499193965707047 … -2.9196723936539106 -1.481447748391893]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39155563703345003 0.3785174208997436 … 0.34469960027019386 0.3785174208997436; 0.37851742089974366 0.3664584406479101 … 0.32735728172224776 0.3636495426205361; … ; 0.34469960027019386 0.3273572817222477 … 0.30751926941851926 0.3343805319865576; 0.37851742089974366 0.3636495426205361 … 0.3343805319865577 0.36645844064791017;;; 0.37851742089974366 0.36645844064791017 … 0.32735728172224776 0.36364954262053606; 0.36645844064791017 0.3510288634177039 … 0.3111940134605783 0.3519170663491838; … ; 0.32735728172224776 0.3111940134605783 … 0.2982412284122229 0.32142600281508027; 0.3636495426205361 0.3519170663491838 … 0.3214260028150804 0.3519170663491838;;; 0.3446996002701939 0.3343805319865577 … 0.2865351537639304 0.32735728172224776; 0.3343805319865577 0.31861604776295127 … 0.27805891882347816 0.3214260028150804; … ; 0.2865351537639304 0.27805891882347816 … 0.2559018577231108 0.27805891882347816; 0.3273572817222478 0.3214260028150804 … 0.2780589188234783 0.31119401346057834;;; … ;;; 0.30487474928902786 0.2830366689623692 … 0.2855643323175207 0.3009573705183916; 0.2830366689623692 0.2589843162227283 … 0.27263300128655327 0.28541419662660966; … ; 0.2855643323175207 0.2726330012865532 … 0.27716038913767876 0.2812108737837726; 0.3009573705183916 0.2854141966266096 … 0.28121087378377263 0.29308272627167264;;; 0.3446996002701939 0.32735728172224776 … 0.30751926941851926 0.33438053198655765; 0.3273572817222478 0.31119401346057823 … 0.298241228412223 0.3214260028150804; … ; 0.30751926941851926 0.29824122841222295 … 0.2771603891376788 0.2931311914702048; 0.3343805319865577 0.3214260028150804 … 0.29313119147020483 0.31861604776295127;;; 0.37851742089974366 0.36364954262053606 … 0.3343805319865577 0.36645844064791017; 0.36364954262053606 0.35191706634918374 … 0.3214260028150804 0.3519170663491838; … ; 0.33438053198655765 0.3214260028150803 … 0.2931311914702048 0.3186160477629512; 0.3664584406479102 0.3519170663491838 … 0.31861604776295127 0.35102886341770395]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923122056 -0.4966565572256956 … -0.4771919009648843 -0.4966565572256956; -0.4966565572256956 -0.48481820871073145 … -0.4763804457667763 -0.4920413111694215; … ; -0.4771919009648843 -0.4763804457667763 … -0.41228807087390884 -0.455070081556115; -0.4966565572256956 -0.4920413111694215 … -0.455070081556115 -0.48481820871073145;;; -0.4966565572256956 -0.48481820871073145 … -0.4763804457667762 -0.4920413111694215; -0.48481820871073145 -0.4583744079148522 … -0.47065601570571586 -0.4861790251756173; … ; -0.4763804457667762 -0.47065601570571586 … -0.44639843643621074 -0.46889439639151903; -0.4920413111694215 -0.4861790251756173 … -0.46889439639151903 -0.4861790251756173;;; -0.4771919009648843 -0.455070081556115 … -0.4605141234226662 -0.4763804457667763; -0.455070081556115 -0.4090661824391208 … -0.4567199083211368 -0.46889439639151903; … ; -0.4605141234226661 -0.4567199083211368 … -0.44514495660348863 -0.4567199083211368; -0.4763804457667763 -0.46889439639151903 … -0.4567199083211368 -0.4706560157057159;;; … ;;; -0.4494759508409079 -0.4551499722014883 … -0.371259862617903 -0.417745715202758; -0.4551499722014883 -0.4488035109977127 … -0.41743801071341696 -0.4441260992987761; … ; -0.371259862617903 -0.4174380107134169 … -0.25365698328407355 -0.29979809105960026; -0.417745715202758 -0.4441260992987761 … -0.29979809105960026 -0.3610634326480208;;; -0.4771919009648843 -0.4763804457667763 … -0.41228807087390884 -0.455070081556115; -0.4763804457667763 -0.4706560157057159 … -0.44639843643621085 -0.46889439639151903; … ; -0.41228807087390884 -0.44639843643621085 … -0.2536569832840736 -0.3410633023008365; -0.455070081556115 -0.46889439639151903 … -0.3410633023008365 -0.4090661824391208;;; -0.4966565572256956 -0.4920413111694215 … -0.45507008155611495 -0.48481820871073145; -0.4920413111694215 -0.4861790251756173 … -0.46889439639151903 -0.4861790251756173; … ; -0.45507008155611495 -0.46889439639151903 … -0.3410633023008365 -0.4090661824391208; -0.48481820871073145 -0.4861790251756173 … -0.4090661824391208 -0.4583744079148522])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4129139212663236 -0.48683674427720386 … -0.7027113226191158 -0.48683674427720397; -0.4868367442772036 -0.7744303950404641 … -0.4136373284393233 -0.3823307497945017; … ; -0.7027113226191161 -0.4136373284393236 … -2.3967616825880746 -1.2958067581749828; -0.48683674427720347 -0.3823307497945016 … -1.2958067581749828 -0.7744303950404638;;; -0.4868367442772037 -0.7744303950404641 … -0.4136373284393232 -0.38233074979450205; -0.7744303950404638 -1.481447748391893 … -0.32458456943328784 -0.44991939657070484; … ; -0.4136373284393233 -0.32458456943328823 … -1.0113572986117174 -0.6373277791931995; -0.38233074979450155 -0.44991939657070484 … -0.637327779193199 -0.44991939657070473;;; -0.7027113226191157 -1.295806758174983 … -0.29820348937558094 -0.41363732843932355; -1.2958067581749828 -2.919672393653911 … -0.35372958466146176 -0.637327779193199; … ; -0.29820348937558094 -0.3537295846614623 … -0.49037260810718936 -0.3537295846614622; -0.41363732843932327 -0.637327779193199 … -0.3537295846614614 -0.32458456943328784;;; … ;;; -1.0166744212557892 -0.5332878143066075 … -3.636138257122885 -1.9987602620506402; -0.5332878143066073 -0.32174124747389665 … -1.4667339407502753 -0.9061938941468974; … ; -3.636138257122885 -1.466733940750275 … -10.988177824465922 -8.087376168208198; -1.99876026205064 -0.9061938941468975 … -8.087376168208198 -4.6478783711432525;;; -0.7027113226191157 -0.4136373284393233 … -2.396761682588075 -1.295806758174983; -0.41363732843932316 -0.32458456943328823 … -1.0113572986117174 -0.637327779193199; … ; -2.396761682588075 -1.0113572986117176 … -11.002806190875027 -6.077304186394093; -1.2958067581749826 -0.6373277791931989 … -6.077304186394093 -2.919672393653911;;; -0.48683674427720375 -0.38233074979450193 … -1.2958067581749828 -0.7744303950404641; -0.3823307497945017 -0.44991939657070495 … -0.637327779193199 -0.44991939657070484; … ; -1.295806758174983 -0.6373277791931993 … -6.077304186394093 -2.9196723936539106; -0.7744303950404636 -0.4499193965707047 … -2.9196723936539106 -1.481447748391893]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729846), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09132316917746867 0.0874741913407988 … 0.07684754935962829 0.0874741913407988; 0.08747419134079881 0.08089966872163573 … 0.0764247101697131 0.08486944834426301; … ; 0.07684754935962829 0.07642471016971311 … 0.0477846666710169 0.06587895342303066; 0.08747419134079881 0.08486944834426301 … 0.06587895342303066 0.08089966872163573;;; 0.08747419134079878 0.08089966872163573 … 0.07642471016971308 0.08486944834426301; 0.08089966872163573 0.0674447146977432 … 0.0734866993470414 0.08163768629014383; … ; 0.07642471016971308 0.0734866993470414 … 0.061888041199963634 0.07259829028446704; 0.08486944834426301 0.08163768629014383 … 0.07259829028446704 0.08163768629014381;;; 0.07684754935962829 0.06587895342303066 … 0.0684720369897359 0.0764247101697131; 0.06587895342303066 0.046578642649805956 … 0.06665759371631805 0.07259829028446704; … ; 0.06847203698973592 0.06665759371631805 … 0.06132515314380889 0.06665759371631803; 0.07642471016971311 0.07259829028446704 … 0.06665759371631803 0.07348669934704138;;; … ;;; 0.06328495229885733 0.06591651445952568 … 0.0339406488805166 0.04987593485998757; 0.06591651445952568 0.06297790960105472 … 0.049756397885275444 0.060870204571461896; … ; 0.0339406488805166 0.04975639788527545 … 0.00969635321407262 0.016831338792589957; 0.04987593485998757 0.060870204571461896 … 0.016831338792589964 0.03098572188504802;;; 0.07684754935962829 0.0764247101697131 … 0.047784666671016905 0.06587895342303066; 0.0764247101697131 0.07348669934704138 … 0.06188804119996365 0.07259829028446704; … ; 0.047784666671016905 0.06188804119996365 … 0.009696353214072624 0.025710010675303128; 0.06587895342303066 0.07259829028446704 … 0.025710010675303128 0.04657864264980595;;; 0.08747419134079878 0.08486944834426301 … 0.06587895342303063 0.08089966872163573; 0.08486944834426301 0.08163768629014381 … 0.07259829028446706 0.08163768629014381; … ; 0.06587895342303064 0.07259829028446706 … 0.025710010675303124 0.046578642649805956; 0.08089966872163573 0.08163768629014383 … 0.046578642649805956 0.0674447146977432;;;;], α = 0.8, eigenvalues = [[-0.16677707596307978, 0.26427771782991566, 0.2642777178299157, 0.26427771782991594, 0.3573203719045071, 0.35732037190450716, 0.35732037190450705], [-0.11613218761083899, 0.0704053232000352, 0.22624813603022234, 0.22624813603022262, 0.33611784894602126, 0.39343797761799143, 0.3934379776179914], [-0.09588938143640767, 0.08764319967958158, 0.17312704142741575, 0.173127041427416, 0.29197248922129776, 0.33773212507288847, 0.5327646516179534], [-0.045051463485947775, 0.022269526239809222, 0.09831189251533239, 0.18446409322116536, 0.32292701516246536, 0.4802469613605814, 0.5024422336212916]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.28971208183818153, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.41005085678231723 - 0.8630440084043585im 6.877473062526759e-16 + 1.2601397571076025e-15im … -6.408476326176397e-12 - 5.6782593049283494e-12im 1.687986994747137e-11 + 1.480801252284303e-11im; 0.04132254692693813 - 0.08697256924946284im 0.166013137643792 + 0.16656844352607375im … 0.0327089052752543 + 0.026649978855916395im 0.3389770974233269 + 0.4170691201198138im; … ; 0.005061464906238691 - 0.010652988254569777im -0.041732918337800476 - 0.012654447620606472im … 0.06069950448492621 + 0.04177732264286125im 0.048605109070982866 + 0.06634902421619024im; -0.041322546926938215 + 0.08697256924946309im -0.24256138458610593 + 0.04267859597641336im … 0.4674130237492873 + 0.3175662608770325im 0.06149537957252775 + 0.12960094367900973im], [0.7859816459768102 + 0.4947607511653087im 0.1214642984706154 - 0.15525654154612828im … -1.7530292072917624e-13 - 2.4521392971524394e-13im 2.1447522147560033e-13 - 1.5244029608875256e-13im; 0.05358188361170298 + 0.033728793948656494im -0.00540603352322227 + 0.006910031003894314im … 1.6647166112939588e-13 + 4.315388318387001e-13im -2.07841957328732e-13 - 6.293725732688346e-13im; … ; 0.006559391421205763 + 0.004129014263060477im 0.053150829164144216 - 0.06793777282902681im … 0.010636784546992477 - 0.04455483722951228im 0.08138123728565662 + 0.057922644476308335im; -0.09557322126439757 - 0.06016155591686246im -0.05589216715215355 + 0.07144177079868878im … 0.04514845953492981 - 0.1891156351727425im 0.3454274628152092 + 0.24585608167474365im], [-0.589435388134699 - 0.7241938113629007im -2.3768986498360007e-16 + 2.9984550168040015e-16im … 2.2940734298294095e-13 + 7.046999408798557e-14im -2.0683547069862857e-10 + 1.6021086801252983e-9im; -0.04339792074239957 - 0.05331967890004159im 0.01861236942566458 - 0.05407689668095144im … -0.006293075239768323 - 0.02438282258942643im -0.004126881937077872 + 0.0063507493407070695im; … ; -0.008755692360514142 - 0.010757444071601948im 9.483270997562715e-16 + 2.7213497324508873e-16im … -5.509273171625615e-13 - 4.566696298356624e-15im 0.018230455984973495 - 0.061544522071588476im; 0.09671387518265408 + 0.1188248810473464im 0.09344447203397835 - 0.27149617246579777im … 0.09542512517196444 + 0.36972923550478515im 0.044169436800218086 - 0.14656862981111157im], [-0.7936662926153005 + 0.15682886924887407im -1.7835386701623812e-16 + 4.748530232067724e-16im … -0.08082596622270238 - 0.16912349877710872im 9.133064334150023e-6 + 5.499288738905554e-6im; -0.3801236964396122 + 0.0751126387021989im 0.6265518572363908 + 0.006604300856861821im … 0.07685108270588599 + 0.16081016835977308im -5.0787465982116244e-6 - 3.4836342240100852e-6im; … ; -0.011177556685739755 + 0.0022086909728941517im 0.0016435499655848887 + 1.732418206202828e-5im … -0.006973378545577441 - 0.014594357603056041im -0.04189353956778808 - 0.014370205784828399im; 0.06394333046242956 - 0.01263523511800558im 0.012484429721238713 + 0.00013159474184964816im … -0.05838232023992658 - 0.12216964257112585im -0.44516900154293576 - 0.152692968604399im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596307978, 0.26427771782991566, 0.2642777178299157, 0.26427771782991594, 0.3573203719045071, 0.35732037190450716, 0.35732037190450705], [-0.11613218761083899, 0.0704053232000352, 0.22624813603022234, 0.22624813603022262, 0.33611784894602126, 0.39343797761799143, 0.3934379776179914], [-0.09588938143640767, 0.08764319967958158, 0.17312704142741575, 0.173127041427416, 0.29197248922129776, 0.33773212507288847, 0.5327646516179534], [-0.045051463485947775, 0.022269526239809222, 0.09831189251533239, 0.18446409322116536, 0.32292701516246536, 0.4802469613605814, 0.5024422336212916]], X = [[0.41005085678231723 - 0.8630440084043585im 6.877473062526759e-16 + 1.2601397571076025e-15im … -6.408476326176397e-12 - 5.6782593049283494e-12im 1.687986994747137e-11 + 1.480801252284303e-11im; 0.04132254692693813 - 0.08697256924946284im 0.166013137643792 + 0.16656844352607375im … 0.0327089052752543 + 0.026649978855916395im 0.3389770974233269 + 0.4170691201198138im; … ; 0.005061464906238691 - 0.010652988254569777im -0.041732918337800476 - 0.012654447620606472im … 0.06069950448492621 + 0.04177732264286125im 0.048605109070982866 + 0.06634902421619024im; -0.041322546926938215 + 0.08697256924946309im -0.24256138458610593 + 0.04267859597641336im … 0.4674130237492873 + 0.3175662608770325im 0.06149537957252775 + 0.12960094367900973im], [0.7859816459768102 + 0.4947607511653087im 0.1214642984706154 - 0.15525654154612828im … -1.7530292072917624e-13 - 2.4521392971524394e-13im 2.1447522147560033e-13 - 1.5244029608875256e-13im; 0.05358188361170298 + 0.033728793948656494im -0.00540603352322227 + 0.006910031003894314im … 1.6647166112939588e-13 + 4.315388318387001e-13im -2.07841957328732e-13 - 6.293725732688346e-13im; … ; 0.006559391421205763 + 0.004129014263060477im 0.053150829164144216 - 0.06793777282902681im … 0.010636784546992477 - 0.04455483722951228im 0.08138123728565662 + 0.057922644476308335im; -0.09557322126439757 - 0.06016155591686246im -0.05589216715215355 + 0.07144177079868878im … 0.04514845953492981 - 0.1891156351727425im 0.3454274628152092 + 0.24585608167474365im], [-0.589435388134699 - 0.7241938113629007im -2.3768986498360007e-16 + 2.9984550168040015e-16im … 2.2940734298294095e-13 + 7.046999408798557e-14im -2.0683547069862857e-10 + 1.6021086801252983e-9im; -0.04339792074239957 - 0.05331967890004159im 0.01861236942566458 - 0.05407689668095144im … -0.006293075239768323 - 0.02438282258942643im -0.004126881937077872 + 0.0063507493407070695im; … ; -0.008755692360514142 - 0.010757444071601948im 9.483270997562715e-16 + 2.7213497324508873e-16im … -5.509273171625615e-13 - 4.566696298356624e-15im 0.018230455984973495 - 0.061544522071588476im; 0.09671387518265408 + 0.1188248810473464im 0.09344447203397835 - 0.27149617246579777im … 0.09542512517196444 + 0.36972923550478515im 0.044169436800218086 - 0.14656862981111157im], [-0.7936662926153005 + 0.15682886924887407im -1.7835386701623812e-16 + 4.748530232067724e-16im … -0.08082596622270238 - 0.16912349877710872im 9.133064334150023e-6 + 5.499288738905554e-6im; -0.3801236964396122 + 0.0751126387021989im 0.6265518572363908 + 0.006604300856861821im … 0.07685108270588599 + 0.16081016835977308im -5.0787465982116244e-6 - 3.4836342240100852e-6im; … ; -0.011177556685739755 + 0.0022086909728941517im 0.0016435499655848887 + 1.732418206202828e-5im … -0.006973378545577441 - 0.014594357603056041im -0.04189353956778808 - 0.014370205784828399im; 0.06394333046242956 - 0.01263523511800558im 0.012484429721238713 + 0.00013159474184964816im … -0.05838232023992658 - 0.12216964257112585im -0.44516900154293576 - 0.152692968604399im]], residual_norms = [[2.2912566619051892e-14, 1.61954585711779e-14, 2.4071650384488115e-14, 1.5327141937382966e-14, 3.761209482857036e-12, 6.867776923711029e-11, 1.8017312029012246e-10], [1.803647969733719e-14, 1.8994963157352945e-14, 1.0075793038659403e-14, 1.1274154596121148e-14, 2.4859915676899206e-14, 2.460890539343563e-12, 3.928964703991238e-12], [9.844612248282577e-15, 1.4158716510338198e-14, 1.5805649791715526e-14, 1.1483082621223906e-14, 3.237518367091129e-14, 4.11923736601337e-12, 8.503567708293994e-9], [1.1655626970568552e-14, 1.8521847363602158e-14, 1.242070785351221e-14, 1.8105639299053686e-14, 4.025903140040513e-12, 1.7913879160617122e-5, 4.113969037046178e-6]], iterations = [1, 2, 1, 2], converged = 1, n_matvec = 65)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 7.736094427308565e-14)</code></pre><h2 id="Potential-based-SCF"><a class="docs-heading-anchor" href="#Potential-based-SCF">Potential-based SCF</a><a id="Potential-based-SCF-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-based-SCF" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scfv = DFTK.scf_potential_mixing(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4129139212662915 -0.48683674427717216 … -0.7027113226190851 -0.4868367442771723; -0.48683674427717194 -0.7744303950404308 … -0.41363732843929685 -0.3823307497944724; … ; -0.7027113226190853 -0.4136373284392971 … -2.39676168258804 -1.295806758174949; -0.4868367442771719 -0.38233074979447235 … -1.2958067581749493 -0.7744303950404305;;; -0.486836744277172 -0.7744303950404308 … -0.41363732843929674 -0.38233074979447274; -0.7744303950404305 -1.4814477483918573 … -0.32458456943326375 -0.44991939657067587; … ; -0.41363732843929685 -0.32458456943326414 … -1.0113572986116883 -0.6373277791931711; -0.38233074979447224 -0.4499193965706759 … -0.6373277791931709 -0.4499193965706758;;; -0.7027113226190851 -1.2958067581749495 … -0.29820348937555907 -0.4136373284392971; -1.2958067581749493 -2.9196723936538747 … -0.3537295846614399 -0.6373277791931709; … ; -0.29820348937555907 -0.3537295846614405 … -0.49037260810716776 -0.3537295846614402; -0.4136373284392968 -0.6373277791931709 … -0.35372958466143967 -0.32458456943326375;;; … ;;; -1.0166744212557597 -0.5332878143065835 … -3.63613825712285 -1.998760262050607; -0.5332878143065832 -0.3217412474738766 … -1.466733940750246 -0.9061938941468701; … ; -3.6361382571228504 -1.466733940750246 … -10.988177824465886 -8.087376168208161; -1.9987602620506069 -0.9061938941468703 … -8.087376168208161 -4.647878371143216;;; -0.7027113226190851 -0.4136373284392968 … -2.3967616825880405 -1.2958067581749493; -0.41363732843929674 -0.32458456943326397 … -1.0113572986116885 -0.6373277791931709; … ; -2.3967616825880405 -1.0113572986116885 … -11.002806190874992 -6.0773041863940565; -1.295806758174949 -0.6373277791931709 … -6.0773041863940565 -2.9196723936538747;;; -0.48683674427717205 -0.38233074979447257 … -1.2958067581749493 -0.7744303950404308; -0.38233074979447235 -0.449919396570676 … -0.637327779193171 -0.44991939657067587; … ; -1.2958067581749493 -0.6373277791931711 … -6.077304186394056 -2.919672393653874; -0.7744303950404303 -0.44991939657067576 … -2.919672393653874 -1.4814477483918573])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4129139212662915 -0.48683674427717216 … -0.7027113226190851 -0.4868367442771723; -0.48683674427717194 -0.7744303950404308 … -0.41363732843929685 -0.3823307497944724; … ; -0.7027113226190853 -0.4136373284392971 … -2.39676168258804 -1.295806758174949; -0.4868367442771719 -0.38233074979447235 … -1.2958067581749493 -0.7744303950404305;;; -0.486836744277172 -0.7744303950404308 … -0.41363732843929674 -0.38233074979447274; -0.7744303950404305 -1.4814477483918573 … -0.32458456943326375 -0.44991939657067587; … ; -0.41363732843929685 -0.32458456943326414 … -1.0113572986116883 -0.6373277791931711; -0.38233074979447224 -0.4499193965706759 … -0.6373277791931709 -0.4499193965706758;;; -0.7027113226190851 -1.2958067581749495 … -0.29820348937555907 -0.4136373284392971; -1.2958067581749493 -2.9196723936538747 … -0.3537295846614399 -0.6373277791931709; … ; -0.29820348937555907 -0.3537295846614405 … -0.49037260810716776 -0.3537295846614402; -0.4136373284392968 -0.6373277791931709 … -0.35372958466143967 -0.32458456943326375;;; … ;;; -1.0166744212557597 -0.5332878143065835 … -3.63613825712285 -1.998760262050607; -0.5332878143065832 -0.3217412474738766 … -1.466733940750246 -0.9061938941468701; … ; -3.6361382571228504 -1.466733940750246 … -10.988177824465886 -8.087376168208161; -1.9987602620506069 -0.9061938941468703 … -8.087376168208161 -4.647878371143216;;; -0.7027113226190851 -0.4136373284392968 … -2.3967616825880405 -1.2958067581749493; -0.41363732843929674 -0.32458456943326397 … -1.0113572986116885 -0.6373277791931709; … ; -2.3967616825880405 -1.0113572986116885 … -11.002806190874992 -6.0773041863940565; -1.295806758174949 -0.6373277791931709 … -6.0773041863940565 -2.9196723936538747;;; -0.48683674427717205 -0.38233074979447257 … -1.2958067581749493 -0.7744303950404308; -0.38233074979447235 -0.449919396570676 … -0.637327779193171 -0.44991939657067587; … ; -1.2958067581749493 -0.6373277791931711 … -6.077304186394056 -2.919672393653874; -0.7744303950404303 -0.44991939657067576 … -2.919672393653874 -1.4814477483918573]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.006992427506529243 - 0.03395378193918719im 0.023831395174028918 - 0.005154038904794303im … 0.04800232097488967 + 0.005092684760583099im -0.0017968443213397713 - 0.033602689466682656im; -0.025467707734938543 - 0.02780785168864232im 0.0051653063995919105 + 0.014281409529400015im … -0.035057383829605264 - 0.015700534391282512im -0.0630756248138869 - 0.03835503245780906im; … ; 0.031521761200376336 - 0.01634756953204154im -0.008405096175266545 - 0.020170583262247424im … 0.035876408569805826 + 0.005200881991622693im 0.0875194649448845 + 0.006369123885051798im; 0.03180927512836122 - 0.04403783947338168im 0.014953060482419674 - 0.024265632938090753im … 0.11666339098723802 + 0.02000706421429142im 0.091751935244527 + 0.005905629828830896im;;; -0.1302407593464757 + 0.004910508594490708im -0.01640450050228845 + 0.048456978024889547im … -0.0044623099110455595 - 0.0013253420151703495im -0.05827055197333316 - 0.021173053518075597im; -0.06835419398505063 + 0.027340388521920556im 0.017272709915434045 + 0.04220836652858599im … -0.04533102294045304 - 0.008676677136104071im -0.0901022101413314 - 0.015802063611717113im; … ; -0.014667409301638065 - 0.0225435767639158im -0.06374301214840024 + 0.012089958857559167im … 0.06629783830649286 + 0.0074625953632561646im 0.08594779121906042 - 0.01562487228315167im; -0.09082775810866664 - 0.01917509327874401im -0.08098275322143375 + 0.03996883122267464im … 0.07084224231357718 + 0.006562651089068812im 0.02209464055239061 - 0.024218999258952996im;;; -0.07068887740502589 + 0.0005637692169865385im 0.08207315658374831 + 0.019842972666544056im … -0.035372330667650054 - 0.01400744973269162im -0.07266285150522019 - 0.029069368748460462im; -0.005055609584614176 + 0.04189209960484129im 0.11974976790504621 - 0.01692119064067007im … -0.036210021194796806 - 0.009393992743977606im -0.05493887607783618 + 0.004307675743106159im; … ; -0.06370075497211186 - 0.008340921310461113im -0.06336707457944327 + 0.03509585833722689im … 0.0349429016826007 - 0.0027108461629111267im 0.018020328043235105 - 0.020486677567105836im; -0.11678428501860619 + 0.0047302944428946276im -0.03679858555017742 + 0.040093507750114755im … 0.012093553722013569 - 0.009290499963687405im -0.05021369874308466 - 0.024435939821931325im;;; … ;;; -0.096709464786468 + 0.03460779964420212im -0.033347974513768 + 0.006580502395763551im … 0.09216201265849136 + 0.029423641734798556im -0.024623673153881687 + 0.036537790676885146im; -0.0495041632944585 + 0.008444686653459108im 0.0034865961012540657 - 0.018614583861176495im … 0.021098317105123304 + 0.016745405461594233im -0.04462513090776135 + 0.01922149611004896im; … ; -0.043872234010106335 - 0.0056887147146726155im -0.058433889271117784 - 0.0017688181791110948im … 0.05142465152650907 - 0.014527397325819334im 0.03946564093105738 + 0.004341729870870953im; -0.10775003183621851 + 0.01553337540727534im -0.08154753537705095 + 0.009527587962846067im … 0.09476003533335871 - 0.008171628618538745im 0.01386001772780836 + 0.016742242965202665im;;; -0.10739387678636671 + 0.020083479252091266im 0.05897358914132259 - 0.025643344404995744im … 0.06958812444745073 + 0.024917375692300122im -0.11095842273726651 + 0.031079676631724527im; -0.027979008208832812 - 0.03255820315220314im 0.0854855611690633 - 0.03789490399477231im … -0.010988194892873806 + 0.01015595721513362im -0.09332270862889162 + 0.008971023371566588im; … ; -0.12240923134467149 + 0.02077481566280516im -0.06702609330229309 - 0.005436378450845167im … -0.03158880616400666 - 0.005607658981967906im -0.07772257256453885 + 0.028683494558234195im; -0.1596564264660002 + 0.026993495497312912im -0.03376991526214869 + 0.008432242999671456im … 0.06978987787603151 + 0.018353034198475962im -0.07620231294399343 + 0.036170352562070726im;;; 0.05156826163759998 - 0.039795182046302266im 0.16319611784359672 - 0.050728463934381934im … 0.05978442396884853 + 0.016731546590501217im -0.04756766513147952 + 0.0006422812673743668im; 0.04382369919335265 - 0.048886295721863406im 0.12320746259593596 - 0.040420576264236695im … -0.03929842161008817 + 0.0033970759158021713im -0.08988500535990186 - 0.03144716549382578im; … ; -0.02699696687886294 + 0.0036744548820816037im -0.0023758397382815035 - 0.011392304768072478im … -0.04767418817702415 + 0.0034941113386941377im -0.04033240435782728 + 0.020005210230605756im; -0.00399976903569025 - 0.013565451978160507im 0.09441018994629345 - 0.03646341370856773im … 0.08080402421316352 - 0.006044494737728548im 0.009265640729362808 + 0.016519604329723877im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4129139212662915 -0.48683674427717216 … -0.7027113226190851 -0.4868367442771723; -0.48683674427717194 -0.7744303950404308 … -0.41363732843929685 -0.3823307497944724; … ; -0.7027113226190853 -0.4136373284392971 … -2.39676168258804 -1.295806758174949; -0.4868367442771719 -0.38233074979447235 … -1.2958067581749493 -0.7744303950404305;;; -0.486836744277172 -0.7744303950404308 … -0.41363732843929674 -0.38233074979447274; -0.7744303950404305 -1.4814477483918573 … -0.32458456943326375 -0.44991939657067587; … ; -0.41363732843929685 -0.32458456943326414 … -1.0113572986116883 -0.6373277791931711; -0.38233074979447224 -0.4499193965706759 … -0.6373277791931709 -0.4499193965706758;;; -0.7027113226190851 -1.2958067581749495 … -0.29820348937555907 -0.4136373284392971; -1.2958067581749493 -2.9196723936538747 … -0.3537295846614399 -0.6373277791931709; … ; -0.29820348937555907 -0.3537295846614405 … -0.49037260810716776 -0.3537295846614402; -0.4136373284392968 -0.6373277791931709 … -0.35372958466143967 -0.32458456943326375;;; … ;;; -1.0166744212557597 -0.5332878143065835 … -3.63613825712285 -1.998760262050607; -0.5332878143065832 -0.3217412474738766 … -1.466733940750246 -0.9061938941468701; … ; -3.6361382571228504 -1.466733940750246 … -10.988177824465886 -8.087376168208161; -1.9987602620506069 -0.9061938941468703 … -8.087376168208161 -4.647878371143216;;; -0.7027113226190851 -0.4136373284392968 … -2.3967616825880405 -1.2958067581749493; -0.41363732843929674 -0.32458456943326397 … -1.0113572986116885 -0.6373277791931709; … ; -2.3967616825880405 -1.0113572986116885 … -11.002806190874992 -6.0773041863940565; -1.295806758174949 -0.6373277791931709 … -6.0773041863940565 -2.9196723936538747;;; -0.48683674427717205 -0.38233074979447257 … -1.2958067581749493 -0.7744303950404308; -0.38233074979447235 -0.449919396570676 … -0.637327779193171 -0.44991939657067587; … ; -1.2958067581749493 -0.6373277791931711 … -6.077304186394056 -2.919672393653874; -0.7744303950404303 -0.44991939657067576 … -2.919672393653874 -1.4814477483918573])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4129139212662915 -0.48683674427717216 … -0.7027113226190851 -0.4868367442771723; -0.48683674427717194 -0.7744303950404308 … -0.41363732843929685 -0.3823307497944724; … ; -0.7027113226190853 -0.4136373284392971 … -2.39676168258804 -1.295806758174949; -0.4868367442771719 -0.38233074979447235 … -1.2958067581749493 -0.7744303950404305;;; -0.486836744277172 -0.7744303950404308 … -0.41363732843929674 -0.38233074979447274; -0.7744303950404305 -1.4814477483918573 … -0.32458456943326375 -0.44991939657067587; … ; -0.41363732843929685 -0.32458456943326414 … -1.0113572986116883 -0.6373277791931711; -0.38233074979447224 -0.4499193965706759 … -0.6373277791931709 -0.4499193965706758;;; -0.7027113226190851 -1.2958067581749495 … -0.29820348937555907 -0.4136373284392971; -1.2958067581749493 -2.9196723936538747 … -0.3537295846614399 -0.6373277791931709; … ; -0.29820348937555907 -0.3537295846614405 … -0.49037260810716776 -0.3537295846614402; -0.4136373284392968 -0.6373277791931709 … -0.35372958466143967 -0.32458456943326375;;; … ;;; -1.0166744212557597 -0.5332878143065835 … -3.63613825712285 -1.998760262050607; -0.5332878143065832 -0.3217412474738766 … -1.466733940750246 -0.9061938941468701; … ; -3.6361382571228504 -1.466733940750246 … -10.988177824465886 -8.087376168208161; -1.9987602620506069 -0.9061938941468703 … -8.087376168208161 -4.647878371143216;;; -0.7027113226190851 -0.4136373284392968 … -2.3967616825880405 -1.2958067581749493; -0.41363732843929674 -0.32458456943326397 … -1.0113572986116885 -0.6373277791931709; … ; -2.3967616825880405 -1.0113572986116885 … -11.002806190874992 -6.0773041863940565; -1.295806758174949 -0.6373277791931709 … -6.0773041863940565 -2.9196723936538747;;; -0.48683674427717205 -0.38233074979447257 … -1.2958067581749493 -0.7744303950404308; -0.38233074979447235 -0.449919396570676 … -0.637327779193171 -0.44991939657067587; … ; -1.2958067581749493 -0.6373277791931711 … -6.077304186394056 -2.919672393653874; -0.7744303950404303 -0.44991939657067576 … -2.919672393653874 -1.4814477483918573]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.020969995271457466 - 0.128439083509765im 0.04364291289294267 - 0.021435785601789797im … -0.010407216699653405 - 0.05227572421497055im -0.015059881529625787 - 0.10507917990840467im; 0.05062075866583085 - 0.034557938585725895im 0.04336458142172041 + 0.015852055030317183im … 0.005149105720936282 - 0.03159865311429144im 0.027143572602215043 - 0.06583439546235016im; … ; -0.034448006000243434 - 0.011190364535342254im 0.02049083578985484 + 0.025584175056250533im … -0.0044589409309937125 - 0.0099148323470515im -0.03070604478244672 - 0.03998965646076238im; -0.02066116831718341 - 0.06530852548191178im 0.044948034370785095 - 0.01875021221944961im … -0.025906444661207992 - 0.044597738930686026im -0.044948809612080844 - 0.07455684512063682im;;; -0.012563188080245376 + 0.004229112970749309im 0.12581870707968246 - 0.02787418250875651im … -0.030189160205652342 - 0.013010045083977195im -0.07388253753162988 - 0.022432602951029834im; 0.0758440100590872 + 0.03596799480078614im 0.12234948567108272 + 0.047217592066320674im … -0.03236245743786627 + 0.00484810035552268im -0.027305496792643134 + 0.021188712958531773im; … ; -0.06548055703547351 + 0.010430596159218914im -0.020908990920442086 + 0.01887218348798335im … 0.011117747981957452 - 0.04200863861717284im -0.028064564400907037 - 0.04346025400179687im; -0.0896310729602425 - 0.002170314957944905im 0.0059605473511202605 + 0.014402709056962903im … -0.020359420670571324 - 0.041252496436106775im -0.10146566569885403 - 0.023444115622598443im;;; 0.0998203400908134 - 0.017659719262466823im 0.18623100431884962 - 0.012297545510821727im … -0.04464123192794338 + 0.016147417750121257im -0.04303221364666615 + 0.016000136310686804im; 0.153830128800823 + 0.007920227339989861im 0.12620525136742916 + 0.06782982399064627im … -0.02775221816902517 + 0.01293554338665654im 0.014855390954229854 + 0.014345249470906905im; … ; -0.055615575987684296 + 0.021865192609770375im -0.01264899514526585 + 0.006085006069082442im … -0.009486557602574483 - 0.01541072797148004im -0.04553143143791984 + 0.0009840530924615336im; -0.04314087351237413 + 0.010090748597121902im 0.0760904184970152 - 0.029447881511454173im … -0.039893260216854506 + 0.001090978042674478im -0.08190938640518067 + 0.02206647375430909im;;; … ;;; -0.008535231525663805 + 0.019844594305990497im 0.010751729758509142 - 0.009995209191959042im … -0.031086098007693203 + 0.05264712310291129im -0.057032123869634806 + 0.0803016454263696im; 0.004032424375061844 - 0.012031811849502607im 0.011979264536152457 - 0.019942995760805896im … -0.035191911270516234 + 0.03969773805591091im -0.033349252371864854 + 0.027909488448877265im; … ; -0.04700590816303551 + 0.028287344201634097im -0.021183878517111468 + 0.010117102729198383im … 0.06930497091756709 - 0.08332391232076837im -0.02807712533564747 + 0.013138943379634838im; -0.0205564594851958 + 0.047345442678570576im 0.0010425168430314696 + 0.01239455785733491im … 0.013804015478278564 - 0.0018910694553781742im -0.04913560143300243 + 0.08156622970015917im;;; 0.029960081958165706 - 0.05268921690528467im 0.03617860593515482 - 0.05059186636413668im … -0.10662968701239589 + 0.11613102961155289im -0.0912879165436929 + 0.08613334029136058im; 0.0384822292201798 - 0.07474826859080061im 0.019443833715575308 - 0.03271872003377219im … -0.05854071527347737 + 0.042702602551913896im -0.004345699940665213 - 0.018743984077138523im; … ; -0.09829729423893165 + 0.05649960691784915im -0.02035929888170386 + 0.014105202771831086im … -0.00498097763183954 + 0.02791988637400205im -0.10522783098714072 + 0.100214247696159im; -0.03674009628690644 + 0.04477038030798018im 0.04340005848149993 - 0.01803523967250992im … -0.0866183548050981 + 0.11918070464016378im -0.10175217989393184 + 0.15819103300601206im;;; 0.06080131383210839 - 0.14595858309417067im 0.04223552722519697 - 0.07464316396402387im … -0.08621358727318615 + 0.0360093291842328im -0.0259102383056243 - 0.05965809414856863im; 0.0666636116552268 - 0.1066335131337901im 0.027124190088068288 - 0.03962869113856761im … -0.020505881015907723 - 0.012827405224457076im 0.043440623201552064 - 0.09775102972467165im; … ; -0.08252305282191699 + 0.011652848018041258im 0.02976137620036312 + 0.0019524073536257606im … -0.04861028348090031 + 0.07476081800908646im -0.09817708199207119 + 0.06407629246860691im; 0.026654338176688108 - 0.04599390126766309im 0.0770393011227055 - 0.03516109891163337im … -0.08881200985788335 + 0.08761259626209059im -0.08513560672533695 + 0.02555978488713178im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4129139212662915 -0.48683674427717216 … -0.7027113226190851 -0.4868367442771723; -0.48683674427717194 -0.7744303950404308 … -0.41363732843929685 -0.3823307497944724; … ; -0.7027113226190853 -0.4136373284392971 … -2.39676168258804 -1.295806758174949; -0.4868367442771719 -0.38233074979447235 … -1.2958067581749493 -0.7744303950404305;;; -0.486836744277172 -0.7744303950404308 … -0.41363732843929674 -0.38233074979447274; -0.7744303950404305 -1.4814477483918573 … -0.32458456943326375 -0.44991939657067587; … ; -0.41363732843929685 -0.32458456943326414 … -1.0113572986116883 -0.6373277791931711; -0.38233074979447224 -0.4499193965706759 … -0.6373277791931709 -0.4499193965706758;;; -0.7027113226190851 -1.2958067581749495 … -0.29820348937555907 -0.4136373284392971; -1.2958067581749493 -2.9196723936538747 … -0.3537295846614399 -0.6373277791931709; … ; -0.29820348937555907 -0.3537295846614405 … -0.49037260810716776 -0.3537295846614402; -0.4136373284392968 -0.6373277791931709 … -0.35372958466143967 -0.32458456943326375;;; … ;;; -1.0166744212557597 -0.5332878143065835 … -3.63613825712285 -1.998760262050607; -0.5332878143065832 -0.3217412474738766 … -1.466733940750246 -0.9061938941468701; … ; -3.6361382571228504 -1.466733940750246 … -10.988177824465886 -8.087376168208161; -1.9987602620506069 -0.9061938941468703 … -8.087376168208161 -4.647878371143216;;; -0.7027113226190851 -0.4136373284392968 … -2.3967616825880405 -1.2958067581749493; -0.41363732843929674 -0.32458456943326397 … -1.0113572986116885 -0.6373277791931709; … ; -2.3967616825880405 -1.0113572986116885 … -11.002806190874992 -6.0773041863940565; -1.295806758174949 -0.6373277791931709 … -6.0773041863940565 -2.9196723936538747;;; -0.48683674427717205 -0.38233074979447257 … -1.2958067581749493 -0.7744303950404308; -0.38233074979447235 -0.449919396570676 … -0.637327779193171 -0.44991939657067587; … ; -1.2958067581749493 -0.6373277791931711 … -6.077304186394056 -2.919672393653874; -0.7744303950404303 -0.44991939657067576 … -2.919672393653874 -1.4814477483918573])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4129139212662915 -0.48683674427717216 … -0.7027113226190851 -0.4868367442771723; -0.48683674427717194 -0.7744303950404308 … -0.41363732843929685 -0.3823307497944724; … ; -0.7027113226190853 -0.4136373284392971 … -2.39676168258804 -1.295806758174949; -0.4868367442771719 -0.38233074979447235 … -1.2958067581749493 -0.7744303950404305;;; -0.486836744277172 -0.7744303950404308 … -0.41363732843929674 -0.38233074979447274; -0.7744303950404305 -1.4814477483918573 … -0.32458456943326375 -0.44991939657067587; … ; -0.41363732843929685 -0.32458456943326414 … -1.0113572986116883 -0.6373277791931711; -0.38233074979447224 -0.4499193965706759 … -0.6373277791931709 -0.4499193965706758;;; -0.7027113226190851 -1.2958067581749495 … -0.29820348937555907 -0.4136373284392971; -1.2958067581749493 -2.9196723936538747 … -0.3537295846614399 -0.6373277791931709; … ; -0.29820348937555907 -0.3537295846614405 … -0.49037260810716776 -0.3537295846614402; -0.4136373284392968 -0.6373277791931709 … -0.35372958466143967 -0.32458456943326375;;; … ;;; -1.0166744212557597 -0.5332878143065835 … -3.63613825712285 -1.998760262050607; -0.5332878143065832 -0.3217412474738766 … -1.466733940750246 -0.9061938941468701; … ; -3.6361382571228504 -1.466733940750246 … -10.988177824465886 -8.087376168208161; -1.9987602620506069 -0.9061938941468703 … -8.087376168208161 -4.647878371143216;;; -0.7027113226190851 -0.4136373284392968 … -2.3967616825880405 -1.2958067581749493; -0.41363732843929674 -0.32458456943326397 … -1.0113572986116885 -0.6373277791931709; … ; -2.3967616825880405 -1.0113572986116885 … -11.002806190874992 -6.0773041863940565; -1.295806758174949 -0.6373277791931709 … -6.0773041863940565 -2.9196723936538747;;; -0.48683674427717205 -0.38233074979447257 … -1.2958067581749493 -0.7744303950404308; -0.38233074979447235 -0.449919396570676 … -0.637327779193171 -0.44991939657067587; … ; -1.2958067581749493 -0.6373277791931711 … -6.077304186394056 -2.919672393653874; -0.7744303950404303 -0.44991939657067576 … -2.919672393653874 -1.4814477483918573]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.013131574525844365 - 0.011224023805368615im 0.033697214953422074 - 0.021808928784528538im … 0.0003878323842926379 - 0.014895356660230176im -0.0035965919029504845 - 0.010197667514637042im; 0.057877975132808915 - 0.041156386331035494im 0.061764885486327234 - 0.05116836609622505im … -0.012348804907377579 + 0.014512053518340447im 0.019930253915252612 - 0.009419928765232014im; … ; -0.036301609866923046 + 0.029870005141375694im -0.05724357822993002 + 0.05646407163157563im … 0.025124508369852014 - 0.011432699168795237im -0.00028133031058877843 + 0.006220122060985463im; -0.04606427585017725 + 0.028543994416387254im -0.03033088967508263 + 0.03161420578573358im … 0.006204575626867639 - 0.017043496637951485im -0.02216623141300887 + 0.00822022765836856im;;; 0.013894553446426046 + 0.020362916286589462im 0.0011582756705086203 - 0.10060917379233456im … -0.04001594679267406 - 0.003920239341523564im -0.02873742509088924 + 0.033879263657601695im; 0.033935856560533946 - 0.017222218604782836im -0.029011886172329325 - 0.07678570567704435im … -0.021645453443198133 + 0.01572349985035474im 0.03056262978425448 + 0.06112110593459358im; … ; -0.03854735984902755 + 0.08012438615835259im -0.03712012594010646 + 0.0531133745617826im … 0.0030666313315050753 - 0.004493669139120998im -0.028490970194034303 + 0.029773010390386444im; -0.04249040031189541 + 0.030591518699817542im -0.030363918875675293 - 0.024862103435048386im … -0.02968253716458543 - 0.03886981798943273im -0.043467458239943677 + 0.01733178221218131im;;; 0.011696988456987198 - 0.03455087370645769im -0.0005729840275541867 - 0.10981986382228537im … -0.021594212419099687 + 0.013781579577923034im -0.0004625691995951125 + 0.03439936159414546im; 0.027706179096127083 - 0.024617835676678503im -0.012788133968439839 - 0.03015870577546703im … -0.0002567770795873759 + 0.03534317219362297im 0.03705075164043334 + 0.04658101058284815im; … ; -0.03281134214168663 + 0.029202490175569716im -0.027844428894345963 - 0.02527432983302781im … -0.010382448431908465 - 0.003937363498250652im -0.03366885180002143 + 0.014932922808548446im; -0.033510522520465325 - 0.019195745145060568im -0.015253797733664221 - 0.11750318650833451im … -0.025065176709520305 - 0.0007366977397892131im -0.03688470890968519 + 0.008120463664842162im;;; … ;;; -0.050863055110926134 - 0.013588103773146433im -0.05813070985271207 - 0.034094517016728686im … 0.015058947475115103 + 0.011586489329671974im -0.010528179399377752 + 0.052701050105687944im; -0.05565099754981026 - 0.01718010624934846im -0.03587506991023835 - 0.023424821272995194im … -0.011128529668749661 + 0.010095437539615977im -0.039724279566620405 + 0.01650399036827732im; … ; 0.05289756190178315 + 0.03184035611450663im 0.007653702112631443 - 0.012784413067964864im … 0.050297163477272616 + 0.009194360825003828im 0.09058494387467848 + 0.08028561533393272im; 0.01331384912514979 + 0.018555971878330267im -0.027445824185702503 - 0.025257779148235182im … 0.05222691824833531 + 0.02191026767903308im 0.05750815765236264 + 0.09100861257079948im;;; -0.12373659472092423 - 0.06385741152022609im -0.09386855247622061 - 0.060032693460751865im … -0.027102854751002728 + 0.03384499092739253im -0.05685063951707471 + 0.059362052275466676im; -0.0645028749812177 - 0.05520374809821031im -0.010992188304529305 - 0.021864873364550674im … -0.0260757356813804 + 0.03498724349696994im -0.05590760563630637 + 0.021820081606756622im; … ; 0.006667665327701533 - 0.03656264021801918im -0.031471946355052974 - 0.03318636311399152im … 0.022289340499320215 - 0.0019881960121141172im 0.05657777036164509 + 0.05495430065405432im; -0.06156848081669306 - 0.031004859658810533im -0.07729858852881165 - 0.04474794473601134im … -0.0202674165073126 + 0.01310224723026427im -0.015124398048602567 + 0.07077472969118487im;;; -0.05562502909210183 - 0.060092920586478554im -0.030108560790565186 - 0.01597799570057111im … 0.018787395458991496 + 0.05106068277399885im -0.024874493269710894 + 0.01907680564840469im; 0.024308297016926765 - 0.06431817869481149im 0.06827472849907944 - 0.02338581779761461im … 0.003793536445317044 + 0.04752665819088103im 0.007659875794133648 + 0.0023550711734574223im; … ; -0.02505292822723494 - 0.030798819185744807im -0.05145256639365374 + 0.0036131268704344033im … 0.006472260989228566 - 0.0010818865147091536im 0.00877865221700958 - 0.004190624164977674im; -0.08110889702368532 - 0.029559038634900864im -0.08801995061893467 + 0.006318442198701239im … -0.0023098211161880315 + 0.004990814202559442im -0.01796215006568598 + 0.03863330819671874im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4129139212662915 -0.48683674427717216 … -0.7027113226190851 -0.4868367442771723; -0.48683674427717194 -0.7744303950404308 … -0.41363732843929685 -0.3823307497944724; … ; -0.7027113226190853 -0.4136373284392971 … -2.39676168258804 -1.295806758174949; -0.4868367442771719 -0.38233074979447235 … -1.2958067581749493 -0.7744303950404305;;; -0.486836744277172 -0.7744303950404308 … -0.41363732843929674 -0.38233074979447274; -0.7744303950404305 -1.4814477483918573 … -0.32458456943326375 -0.44991939657067587; … ; -0.41363732843929685 -0.32458456943326414 … -1.0113572986116883 -0.6373277791931711; -0.38233074979447224 -0.4499193965706759 … -0.6373277791931709 -0.4499193965706758;;; -0.7027113226190851 -1.2958067581749495 … -0.29820348937555907 -0.4136373284392971; -1.2958067581749493 -2.9196723936538747 … -0.3537295846614399 -0.6373277791931709; … ; -0.29820348937555907 -0.3537295846614405 … -0.49037260810716776 -0.3537295846614402; -0.4136373284392968 -0.6373277791931709 … -0.35372958466143967 -0.32458456943326375;;; … ;;; -1.0166744212557597 -0.5332878143065835 … -3.63613825712285 -1.998760262050607; -0.5332878143065832 -0.3217412474738766 … -1.466733940750246 -0.9061938941468701; … ; -3.6361382571228504 -1.466733940750246 … -10.988177824465886 -8.087376168208161; -1.9987602620506069 -0.9061938941468703 … -8.087376168208161 -4.647878371143216;;; -0.7027113226190851 -0.4136373284392968 … -2.3967616825880405 -1.2958067581749493; -0.41363732843929674 -0.32458456943326397 … -1.0113572986116885 -0.6373277791931709; … ; -2.3967616825880405 -1.0113572986116885 … -11.002806190874992 -6.0773041863940565; -1.295806758174949 -0.6373277791931709 … -6.0773041863940565 -2.9196723936538747;;; -0.48683674427717205 -0.38233074979447257 … -1.2958067581749493 -0.7744303950404308; -0.38233074979447235 -0.449919396570676 … -0.637327779193171 -0.44991939657067587; … ; -1.2958067581749493 -0.6373277791931711 … -6.077304186394056 -2.919672393653874; -0.7744303950404303 -0.44991939657067576 … -2.919672393653874 -1.4814477483918573])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4129139212662915 -0.48683674427717216 … -0.7027113226190851 -0.4868367442771723; -0.48683674427717194 -0.7744303950404308 … -0.41363732843929685 -0.3823307497944724; … ; -0.7027113226190853 -0.4136373284392971 … -2.39676168258804 -1.295806758174949; -0.4868367442771719 -0.38233074979447235 … -1.2958067581749493 -0.7744303950404305;;; -0.486836744277172 -0.7744303950404308 … -0.41363732843929674 -0.38233074979447274; -0.7744303950404305 -1.4814477483918573 … -0.32458456943326375 -0.44991939657067587; … ; -0.41363732843929685 -0.32458456943326414 … -1.0113572986116883 -0.6373277791931711; -0.38233074979447224 -0.4499193965706759 … -0.6373277791931709 -0.4499193965706758;;; -0.7027113226190851 -1.2958067581749495 … -0.29820348937555907 -0.4136373284392971; -1.2958067581749493 -2.9196723936538747 … -0.3537295846614399 -0.6373277791931709; … ; -0.29820348937555907 -0.3537295846614405 … -0.49037260810716776 -0.3537295846614402; -0.4136373284392968 -0.6373277791931709 … -0.35372958466143967 -0.32458456943326375;;; … ;;; -1.0166744212557597 -0.5332878143065835 … -3.63613825712285 -1.998760262050607; -0.5332878143065832 -0.3217412474738766 … -1.466733940750246 -0.9061938941468701; … ; -3.6361382571228504 -1.466733940750246 … -10.988177824465886 -8.087376168208161; -1.9987602620506069 -0.9061938941468703 … -8.087376168208161 -4.647878371143216;;; -0.7027113226190851 -0.4136373284392968 … -2.3967616825880405 -1.2958067581749493; -0.41363732843929674 -0.32458456943326397 … -1.0113572986116885 -0.6373277791931709; … ; -2.3967616825880405 -1.0113572986116885 … -11.002806190874992 -6.0773041863940565; -1.295806758174949 -0.6373277791931709 … -6.0773041863940565 -2.9196723936538747;;; -0.48683674427717205 -0.38233074979447257 … -1.2958067581749493 -0.7744303950404308; -0.38233074979447235 -0.449919396570676 … -0.637327779193171 -0.44991939657067587; … ; -1.2958067581749493 -0.6373277791931711 … -6.077304186394056 -2.919672393653874; -0.7744303950404303 -0.44991939657067576 … -2.919672393653874 -1.4814477483918573]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.02360491501688983 + 0.03239913718039716im -0.07477358695894391 - 0.06046961940021787im … -0.012713393341890348 - 0.030874917502785433im 0.0416341186502934 + 0.02404230707089891im; -0.07020880488739636 - 0.05114683774124064im -0.09142319265815707 - 0.09282310820936995im … -0.0036561230457428685 - 0.002393612805984802im 0.02669027460543629 + 0.034416814765632395im; … ; 0.045610434915227524 + 0.0501905198383193im 0.02209616469571604 + 0.029082968368914563im … -0.06347531220254779 - 0.030370332296647137im -0.02548760136153767 + 0.0017668050315856132im; 0.06540510906757516 + 0.06023062165127526im 0.00556158596455382 + 0.019195345759370486im … -0.06717302601137684 - 0.03904558043372221im 0.02538643078180395 + 0.03229294769484085im;;; -0.04867742377213387 + 0.04179561761124277im -0.11500537407011154 - 0.03207782651797437im … 0.044505281585628956 + 0.0042422064794698676im 0.0342978763635641 + 0.06546600143217413im; -0.07933336484915901 + 0.022136147877654923im -0.021925987363437573 - 0.06602955054269163im … 0.031159423008472402 + 0.03525432010760538im 0.024139651852972475 + 0.04382047474600827im; … ; 0.027163376616092076 + 0.03884062367469798im -0.02096242663221766 + 0.01852393054528445im … -0.001760273770732095 - 0.007755835566677487im 0.03142083157684424 + 0.019944963434818365im; -0.004449331081675809 + 0.06541474921852151im -0.0734394725154123 + 0.014047836091344346im … 0.02071945722226904 - 0.0036944543177579656im 0.05366163768524289 + 0.04322518228517368im;;; -0.06311939145240603 + 0.002640369431363164im -0.01485044830511288 - 0.05149247015508335im … 0.0136304270660138 + 0.02467155231675453im -0.02050166017405635 + 0.03900263269698713im; -0.014190374255386912 - 0.027226843106456865im 0.08032570447101389 - 0.05850314113674556im … 0.005806442336375288 + 0.027123590168093598im -0.018025762161439716 + 0.024997853499596188im; … ; -0.01142177795251469 + 0.013169714905051014im -0.024790409492717307 + 0.00277583653991072im … 0.017384400413440956 + 0.0040332859112613174im 0.021327608105023904 + 0.018406476856548327im; -0.03753382319056176 + 0.019135019627847798im -0.05574384350196211 - 0.006211910231723185im … 0.03369884096344482 + 0.010462062104379607im 0.005867478334105527 + 0.033134180217185144im;;; … ;;; 0.005558843559882573 + 0.054587241761791305im 0.0056753480111478155 + 0.006911732096896385im … 0.010575367059628454 + 0.020883427520455446im -0.02666496016763327 + 0.06491667825666456im; 0.015459766685877029 + 0.004581430756249139im -0.0002552519328741028 - 0.01825552650182937im … 0.011761054320738042 + 0.010374921627170179im 0.0062627594285527 + 0.02877177933472006im; … ; -0.009363509710507834 + 0.013918385617698266im -0.008415677836495963 + 0.027856963936582275im … 0.0798984968337518 - 0.06935612935902519im 0.04069755925737217 - 0.05249724297811685im; -0.010244340548603018 + 0.0630369283194081im 0.0048357245752335895 + 0.03368542763677193im … 0.04465055421584209 - 0.027427227240110222im -0.003052655742133803 + 0.030280247886737686im;;; -0.0009821066626288831 + 0.0628196153607104im 0.00982551109757095 - 0.03260522663268375im … -0.01103009271744855 + 0.006829950868734749im -0.034534849672205936 + 0.0772253528299331im; 0.00597032927588207 - 0.024941353162289952im -0.03592869229384146 - 0.059880242255247365im … 0.007754632773714389 - 0.005100275161933249im -0.007441663662860681 + 0.04189543746351182im; … ; -0.03825390577281351 + 0.06086872024425606im -0.01117772964944122 + 0.04222996526510599im … 0.04154856404230478 - 0.05836318358129882im -0.024206986877057614 - 0.004180349985692928im; -0.038473039138203914 + 0.1078105609308101im 0.009385281360804425 + 0.025094762756372305im … -0.021495089552142695 + 0.008529325774745654im -0.05243154064695937 + 0.06901501627518997im;;; 0.04770593827962233 + 0.02140759907197505im -0.021732986346621557 - 0.056430871824550075im … -0.045744109367222716 - 0.02959097274762018im -0.040683279947470646 + 0.05965087731615562im; -0.03488884803023015 - 0.03289577594246958im -0.08049637808042452 - 0.09113915897302557im … -0.02645309659996866 + 0.00897128253287428im -0.017153357558007447 + 0.0382316647290499im; … ; -0.024373524689944092 + 0.06506979559494326im 0.008689285380704582 + 0.0360965150981424im … -0.05339084543928495 - 0.03291778091688031im -0.07784932818387269 + 0.014022116661666518im; 0.0034938078662125546 + 0.09217044243127953im 0.037158823098494456 + 0.0015782856573442192im … -0.0903355050973583 - 0.007395684173039206im -0.06735202892211203 + 0.05138541927584034im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729845), converged = true, ρ = [0.09132316917747478 0.08747419134080511 … 0.07684754935963482 0.08747419134080511; 0.08747419134080511 0.08089966872164338 … 0.07642471016971729 0.08486944834426795; … ; 0.07684754935963482 0.0764247101697173 … 0.047784666671024253 0.06587895342303854; 0.08747419134080511 0.08486944834426796 … 0.06587895342303852 0.08089966872164338;;; 0.08747419134080511 0.08089966872164338 … 0.07642471016971729 0.08486944834426798; 0.08089966872164338 0.06744471469775204 … 0.07348669934704445 0.081637686290149; … ; 0.07642471016971729 0.07348669934704445 … 0.061888041199969726 0.07259829028447255; 0.08486944834426795 0.081637686290149 … 0.07259829028447255 0.081637686290149;;; 0.07684754935963481 0.06587895342303852 … 0.06847203698973821 0.0764247101697173; 0.06587895342303852 0.04657864264981378 … 0.06665759371632056 0.07259829028447254; … ; 0.06847203698973821 0.06665759371632056 … 0.0613251531438119 0.06665759371632057; 0.07642471016971729 0.07259829028447254 … 0.06665759371632056 0.07348669934704444;;; … ;;; 0.06328495229886355 0.06591651445952947 … 0.033940648880522686 0.04987593485999455; 0.06591651445952947 0.0629779096010566 … 0.049756397885281196 0.06087020457146726; … ; 0.0339406488805227 0.049756397885281196 … 0.009696353214075977 0.016831338792594394; 0.04987593485999454 0.06087020457146726 … 0.01683133879259439 0.03098572188505414;;; 0.07684754935963481 0.07642471016971729 … 0.04778466667102425 0.06587895342303854; 0.07642471016971729 0.07348669934704445 … 0.06188804119996971 0.07259829028447252; … ; 0.047784666671024253 0.06188804119996971 … 0.009696353214075977 0.02571001067530885; 0.06587895342303852 0.07259829028447254 … 0.025710010675308842 0.04657864264981378;;; 0.0874741913408051 0.08486944834426795 … 0.06587895342303852 0.08089966872164339; 0.08486944834426795 0.081637686290149 … 0.07259829028447255 0.081637686290149; … ; 0.06587895342303852 0.07259829028447255 … 0.02571001067530886 0.046578642649813796; 0.08089966872164338 0.081637686290149 … 0.046578642649813796 0.06744471469775204;;;;], eigenvalues = [[-0.16677707596311472, 0.2642777178298631, 0.26427771782986714, 0.26427771782986986, 0.3573203719044713, 0.3573203719044826, 0.35732037190449095], [-0.1161321876108762, 0.07040532319999943, 0.2262481360301788, 0.22624813603017946, 0.3361178489459821, 0.39343797761796667, 0.3934379776179685], [-0.09588938143644504, 0.08764319967953446, 0.17312704142737873, 0.17312704142737972, 0.2919724892212784, 0.3377321250728743, 0.532764651617933], [-0.045051463485989894, 0.022269526239767114, 0.09831189251530764, 0.18446409322112733, 0.32292701516244865, 0.480246960281565, 0.5024422335105533]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2897120818381764, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.5024209244618154 + 0.8127483498928051im 1.6474781097166108e-14 - 1.8659479339347197e-14im … 2.0577499337967644e-11 - 2.491531484862247e-11im 1.9164766572158697e-10 - 2.3256232244364613e-10im; -0.05063106657321811 + 0.08190406451480305im -0.1713471667578441 + 0.38192020476221383im … 0.2751437368404439 - 0.24949158155283865im -0.13443156405170587 - 0.3451528118208576im; … ; -0.006201635322205511 + 0.010032163529325679im -0.007192906707493829 - 0.025339294240403994im … 0.011141309089672913 - 0.0521070150484329im -0.02151831386250307 - 0.047473570105994685im; 0.05063106657321886 - 0.08190406451479855im -0.24176731800768814 + 0.1338428967217056im … -0.18334705660700845 - 0.17983417841468455im -0.04286445576412795 - 0.045996568269264126im], [0.5250086815158322 - 0.7661078468721401im 0.19574233402935357 + 0.02330468117282971im … 7.083411525261338e-12 + 1.7762401958247318e-13im -8.263396557743083e-12 + 7.634728517261479e-12im; 0.03579085365684184 - 0.052227048424402144im -0.008711939499971623 - 0.0010372256642898587im … 2.6231179004032724e-11 + 5.559033772144909e-12im -4.6648706650029484e-12 + 2.009581229072939e-11im; … ; 0.004381447657474976 - 0.006393535096142618im 0.08565370637450027 + 0.010197754758714763im … 0.0005132815319010793 - 0.04939199063695812im -0.09760791097411113 + 0.010443981197371928im; -0.06383962162613294 + 0.09315662157798775im -0.09007143160646562 - 0.010723720071993645im … 0.002178653634175101 - 0.20964721819939472im -0.4143025366821445 + 0.044330094423790926im], [-0.6139342474133012 - 0.703544947430415im 2.417436015000001e-15 + 2.486106820503381e-15im … 1.3192301971753727e-11 - 2.306159108138644e-11im 2.128278619145712e-9 + 4.566812091230215e-9im; -0.04520168002570683 - 0.05179938035944678im -0.0409684680242493 - 0.03990383036786447im … -0.011130785987633673 + 0.022588280628150863im 0.005055363584394454 + 0.006803046825647925im; … ; -0.009119607522958739 - 0.010450718171139331im -1.1575380274092938e-15 - 1.6595334274532191e-15im … 1.1200036327850812e-12 - 2.4373268078516063e-11im -0.06094482061703806 + 0.022217312083091786im; 0.10073361961281949 + 0.11543683939049972im -0.20568455187050116 - 0.20033947723582463im … 0.16878181465758885 - 0.3425176800946148im -0.14472655246585933 + 0.049858808005249645im], [-0.4816930881515812 - 0.6499794205131092im -8.581964079920638e-16 - 8.098995319637928e-16im … 0.18022797388060532 - 0.05145766813649776im -3.529151171523181e-6 + 4.9137700256116396e-8im; -0.23070522072222552 - 0.311305371330537im -0.2999441034949523 - 0.5501312401370844im … -0.171370057583154 + 0.04892786869058111im 2.0623757046037103e-6 + 1.800159140517027e-7im; … ; -0.006783898784723595 - 0.009153950325160571im -0.0007868033831247043 - 0.0014430859478762551im … 0.015553700763670094 - 0.00444098256693118im -0.02242848242341246 + 0.038188392865001385im; 0.038808578118720106 + 0.05236690693100181im -0.005976570074979015 - 0.010961702093163096im … 0.13014488042135672 - 0.03715853640840677im -0.23835998347723658 + 0.40583229939464077im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596311472, 0.2642777178298631, 0.26427771782986714, 0.26427771782986986, 0.3573203719044713, 0.3573203719044826, 0.35732037190449095], [-0.1161321876108762, 0.07040532319999943, 0.2262481360301788, 0.22624813603017946, 0.3361178489459821, 0.39343797761796667, 0.3934379776179685], [-0.09588938143644504, 0.08764319967953446, 0.17312704142737873, 0.17312704142737972, 0.2919724892212784, 0.3377321250728743, 0.532764651617933], [-0.045051463485989894, 0.022269526239767114, 0.09831189251530764, 0.18446409322112733, 0.32292701516244865, 0.480246960281565, 0.5024422335105533]], X = [[-0.5024209244618154 + 0.8127483498928051im 1.6474781097166108e-14 - 1.8659479339347197e-14im … 2.0577499337967644e-11 - 2.491531484862247e-11im 1.9164766572158697e-10 - 2.3256232244364613e-10im; -0.05063106657321811 + 0.08190406451480305im -0.1713471667578441 + 0.38192020476221383im … 0.2751437368404439 - 0.24949158155283865im -0.13443156405170587 - 0.3451528118208576im; … ; -0.006201635322205511 + 0.010032163529325679im -0.007192906707493829 - 0.025339294240403994im … 0.011141309089672913 - 0.0521070150484329im -0.02151831386250307 - 0.047473570105994685im; 0.05063106657321886 - 0.08190406451479855im -0.24176731800768814 + 0.1338428967217056im … -0.18334705660700845 - 0.17983417841468455im -0.04286445576412795 - 0.045996568269264126im], [0.5250086815158322 - 0.7661078468721401im 0.19574233402935357 + 0.02330468117282971im … 7.083411525261338e-12 + 1.7762401958247318e-13im -8.263396557743083e-12 + 7.634728517261479e-12im; 0.03579085365684184 - 0.052227048424402144im -0.008711939499971623 - 0.0010372256642898587im … 2.6231179004032724e-11 + 5.559033772144909e-12im -4.6648706650029484e-12 + 2.009581229072939e-11im; … ; 0.004381447657474976 - 0.006393535096142618im 0.08565370637450027 + 0.010197754758714763im … 0.0005132815319010793 - 0.04939199063695812im -0.09760791097411113 + 0.010443981197371928im; -0.06383962162613294 + 0.09315662157798775im -0.09007143160646562 - 0.010723720071993645im … 0.002178653634175101 - 0.20964721819939472im -0.4143025366821445 + 0.044330094423790926im], [-0.6139342474133012 - 0.703544947430415im 2.417436015000001e-15 + 2.486106820503381e-15im … 1.3192301971753727e-11 - 2.306159108138644e-11im 2.128278619145712e-9 + 4.566812091230215e-9im; -0.04520168002570683 - 0.05179938035944678im -0.0409684680242493 - 0.03990383036786447im … -0.011130785987633673 + 0.022588280628150863im 0.005055363584394454 + 0.006803046825647925im; … ; -0.009119607522958739 - 0.010450718171139331im -1.1575380274092938e-15 - 1.6595334274532191e-15im … 1.1200036327850812e-12 - 2.4373268078516063e-11im -0.06094482061703806 + 0.022217312083091786im; 0.10073361961281949 + 0.11543683939049972im -0.20568455187050116 - 0.20033947723582463im … 0.16878181465758885 - 0.3425176800946148im -0.14472655246585933 + 0.049858808005249645im], [-0.4816930881515812 - 0.6499794205131092im -8.581964079920638e-16 - 8.098995319637928e-16im … 0.18022797388060532 - 0.05145766813649776im -3.529151171523181e-6 + 4.9137700256116396e-8im; -0.23070522072222552 - 0.311305371330537im -0.2999441034949523 - 0.5501312401370844im … -0.171370057583154 + 0.04892786869058111im 2.0623757046037103e-6 + 1.800159140517027e-7im; … ; -0.006783898784723595 - 0.009153950325160571im -0.0007868033831247043 - 0.0014430859478762551im … 0.015553700763670094 - 0.00444098256693118im -0.02242848242341246 + 0.038188392865001385im; 0.038808578118720106 + 0.05236690693100181im -0.005976570074979015 - 0.010961702093163096im … 0.13014488042135672 - 0.03715853640840677im -0.23835998347723658 + 0.40583229939464077im]], residual_norms = [[1.236024425598318e-13, 1.3662208300186162e-13, 8.070987427113882e-14, 1.3521327766621497e-13, 1.5314013819851378e-9, 1.4052228297177456e-10, 1.3080636337111888e-9], [1.181859473928693e-13, 1.2031082860745778e-13, 1.217312324257361e-13, 5.09621388149834e-14, 1.001177289244759e-10, 2.662076610153711e-10, 1.9547977907391998e-10], [9.737413073320352e-14, 1.0086392747498587e-13, 1.3044147155638818e-13, 4.8605323231668616e-14, 2.0816521720708015e-11, 6.053246123087991e-10, 1.2614854739961693e-7], [1.47936767787169e-13, 7.595132276056435e-14, 1.2681951828017707e-13, 6.636263990523839e-14, 4.781641897958515e-10, 5.749108094709023e-6, 3.6809055322590154e-6]], iterations = [31, 22, 22, 21], converged = 1, n_matvec = 659)], stage = :finalize, algorithm = &quot;SCF&quot;, occupation_threshold = 1.0e-6)</code></pre><h2 id="Direct-minimization"><a class="docs-heading-anchor" href="#Direct-minimization">Direct minimization</a><a id="Direct-minimization-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-minimization" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_dm = direct_minimization(basis; tol)

# Newton algorithm</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.391555636997019 0.3785174208573158 … 0.3446996002165795 0.3785174208573158; 0.3785174208573159 0.3664584405851327 … 0.3273572816980893 0.36364954259401666; … ; 0.3446996002165795 0.3273572816980893 … 0.3075192693424968 0.33438053191322625; 0.3785174208573159 0.36364954259401666 … 0.33438053191322625 0.36645844058513266;;; 0.37851742085731593 0.36645844058513266 … 0.3273572816980893 0.3636495425940165; 0.3664584405851327 0.35102886333576444 … 0.3111940134508919 0.3519170663165556; … ; 0.32735728169808925 0.3111940134508919 … 0.29824122835575706 0.32142600277078137; 0.36364954259401666 0.35191706631655556 … 0.32142600277078137 0.3519170663165556;;; 0.3446996002165796 0.3343805319132262 … 0.2865351537613934 0.32735728169808925; 0.33438053191322625 0.3186160476795281 … 0.2780589188146396 0.32142600277078137; … ; 0.2865351537613933 0.2780589188146396 … 0.25590185770148366 0.2780589188146397; 0.32735728169808936 0.32142600277078137 … 0.2780589188146397 0.31119401345089187;;; … ;;; 0.30487474922948105 0.2830366689321476 … 0.2855643322463041 0.3009573704462925; 0.2830366689321477 0.25898431621942497 … 0.2726330012290846 0.28541419657551376; … ; 0.2855643322463041 0.27263300122908457 … 0.27716038905803564 0.28121087370634845; 0.30095737044629256 0.28541419657551376 … 0.2812108737063484 0.29308272619387865;;; 0.3446996002165796 0.32735728169808925 … 0.30751926934249685 0.3343805319132262; 0.3273572816980893 0.31119401345089187 … 0.29824122835575706 0.3214260027707814; … ; 0.3075192693424968 0.2982412283557571 … 0.2771603890580357 0.2931311913898121; 0.33438053191322625 0.3214260027707814 … 0.2931311913898121 0.31861604767952806;;; 0.37851742085731593 0.3636495425940166 … 0.3343805319132262 0.36645844058513266; 0.3636495425940167 0.3519170663165556 … 0.32142600277078137 0.3519170663165556; … ; 0.3343805319132262 0.32142600277078137 … 0.29313119138981203 0.31861604767952817; 0.3664584405851327 0.3519170663165556 … 0.31861604767952817 0.35102886333576444]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923028566 -0.4966565572070334 … -0.4771919009287844 -0.4966565572070334; -0.4966565572070334 -0.48481820866903186 … -0.4763804457601093 -0.4920413111665687; … ; -0.4771919009287844 -0.4763804457601093 … -0.4122880708337544 -0.4550700815049018; -0.4966565572070334 -0.4920413111665687 … -0.4550700815049019 -0.4848182086690318;;; -0.4966565572070334 -0.48481820866903186 … -0.4763804457601093 -0.4920413111665688; -0.48481820866903186 -0.45837440785740263 … -0.47065601571454363 -0.4861790251634745; … ; -0.4763804457601093 -0.47065601571454363 … -0.4463984363979398 -0.4688943963621215; -0.4920413111665688 -0.4861790251634745 … -0.4688943963621215 -0.4861790251634745;;; -0.4771919009287844 -0.4550700815049019 … -0.46051412343680515 -0.4763804457601093; -0.4550700815049019 -0.4090661823905755 … -0.4567199083259325 -0.4688943963621215; … ; -0.46051412343680515 -0.45671990832593246 … -0.4451449565908624 -0.4567199083259325; -0.4763804457601093 -0.4688943963621215 … -0.4567199083259325 -0.4706560157145437;;; … ;;; -0.4494759507970175 -0.4551499721802225 … -0.37125986260333826 -0.417745715162433; -0.4551499721802225 -0.44880351100545696 … -0.4174380106866974 -0.4441260992619815; … ; -0.3712598626033382 -0.41743801068669734 … -0.25365698326354325 -0.2997980910500038; -0.417745715162433 -0.4441260992619815 … -0.2997980910500038 -0.3610634326225414;;; -0.4771919009287844 -0.4763804457601093 … -0.4122880708337544 -0.4550700815049019; -0.4763804457601093 -0.4706560157145437 … -0.4463984363979398 -0.4688943963621215; … ; -0.4122880708337544 -0.44639843639793975 … -0.25365698326354325 -0.34106330227385045; -0.4550700815049019 -0.4688943963621215 … -0.34106330227385045 -0.4090661823905755;;; -0.4966565572070334 -0.49204131116656874 … -0.4550700815049018 -0.48481820866903186; -0.4920413111665688 -0.4861790251634745 … -0.4688943963621215 -0.4861790251634745; … ; -0.4550700815049018 -0.4688943963621214 … -0.3410633022738505 -0.4090661823905755; -0.48481820866903186 -0.4861790251634745 … -0.4090661823905755 -0.45837440785740263])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392129340565 -0.4868367443009694 … -0.7027113226366303 -0.4868367443009695; -0.4868367443009691 -0.7744303950615419 … -0.4136373284568148 -0.38233074981816834; … ; -0.7027113226366305 -0.413637328456815 … -2.396761682623943 -1.295806758197101; -0.486836744300969 -0.3823307498181682 … -1.2958067581971013 -0.7744303950615417;;; -0.4868367443009692 -0.7744303950615419 … -0.4136373284568148 -0.3823307498181689; -0.7744303950615417 -1.4814477484163828 … -0.32458456945180203 -0.44991939659119023; … ; -0.41363732845681495 -0.32458456945180236 … -1.0113572986299122 -0.6373277792081008; -0.3823307498181683 -0.4499193965911903 … -0.6373277792081006 -0.4499193965911901;;; -0.7027113226366302 -1.2958067581971013 … -0.29820348939225694 -0.41363732845681506; -1.2958067581971013 -2.9196723936887894 … -0.35372958467509596 -0.6373277792081006; … ; -0.29820348939225705 -0.3537295846750965 … -0.49037260811619027 -0.3537295846750964; -0.4136373284568147 -0.6373277792081006 … -0.35372958467509574 -0.32458456945180214;;; … ;;; -1.0166744212714458 -0.5332878143155634 … -3.6361382571795366 -1.9987602620824143; -0.533287814315563 -0.3217412474849442 … -1.4667339407810243 -0.9061938941611988; … ; -3.6361382571795366 -1.4667339407810243 … -10.988177824525033 -8.087376168276025; -1.9987602620824139 -0.9061938941611988 … -8.087376168276025 -4.647878371195567;;; -0.7027113226366302 -0.41363732845681483 … -2.396761682623943 -1.2958067581971013; -0.41363732845681467 -0.32458456945180236 … -1.0113572986299122 -0.6373277792081005; … ; -2.396761682623943 -1.0113572986299122 … -11.00280619093414 -6.0773041864475; -1.295806758197101 -0.6373277792081004 … -6.0773041864475 -2.9196723936887894;;; -0.48683674430096924 -0.3823307498181686 … -1.2958067581971011 -0.7744303950615419; -0.38233074981816834 -0.4499193965911903 … -0.6373277792081005 -0.44991939659119023; … ; -1.2958067581971011 -0.6373277792081006 … -6.077304186447499 -2.9196723936887885; -0.7744303950615415 -0.44991939659119007 … -2.9196723936887885 -1.4814477484163828]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.01089995947295886 - 0.23461566076600718im 0.02813287678172566 - 0.059581905249627816im … 0.022470008261454184 + 0.06471720622664884im 0.028132880165955297 - 0.059581902254532665im; -0.011159834158388462 - 0.11684544907648008im 0.005955633347387591 + 0.0920775640174118im … 0.014055416870339059 + 0.01521602863987142im 0.0054283985957190185 - 0.06176844652632167im; … ; -0.01699608286531152 + 0.007200999758689483im -0.010271146286931467 - 0.020236467929544984im … -0.0015151304195980177 + 0.032612409582879434im -0.002378244313979384 + 0.0794089384046285im; -0.011159847279711147 - 0.1168454505748783im 0.005428385068329688 - 0.06176845012539281im … 0.004590673348980766 + 0.08956514627514692im 0.005955632229204104 + 0.09207756423712966im;;; 0.015339409784045759 - 0.2955585596082387im 0.036854124105906994 - 0.11630435900041752im … 0.011213349188797846 + 0.03438315589868978im 0.013154049854630683 - 0.11387091626806908im; -0.008961721754192072 - 0.18307443370930043im 0.008581749488057377 + 0.03880444811101512im … 0.004046652807127943 - 0.012416903938944034im -0.005840021337690665 - 0.12738405097936856im; … ; -0.00889903688660603 + 0.005072221734492518im -0.0006212760330798013 - 0.019219739906705467im … -0.0008474984903701353 + 0.05015660060856292im -0.004628395176468832 + 0.06152104934648797im; 0.001698544658433592 - 0.13056567655041215im 0.020170263791066963 - 0.08947775593882423im … 0.004258354374102448 + 0.0744722206176606im 0.002628763495082021 + 0.02882354947773693im;;; 0.009620092899308418 - 0.17230063148664992im 0.015163257471621028 - 0.03889236704778193im … 0.0031003728045038642 - 0.018050551821528295im 0.0032927704305406604 - 0.11171260336722914im; -0.0038781171706211916 - 0.06664245615833311im -0.0024501733576668483 + 0.10781340497160888im … -0.0009755783081411436 - 0.03751792540112283im -0.0049472755828631676 - 0.09532644844852228im; … ; -0.00019445344957452347 - 0.022852289649039136im 0.004691712856735456 - 0.029258653634600507im … -0.0004623304536561573 + 0.028987024007676825im -0.0015465632859811668 + 0.01281278584775822im; 0.007506945591346719 - 0.10557104156322031im 0.014439330643818221 - 0.06707323051535738im … 0.0020361731065897575 + 0.018034113103912574im 0.0025268021752268962 - 0.04045062360622154im;;; … ;;; 0.0016006061211789407 - 0.027084367432144332im 0.0005784527438778724 - 0.0500730248753406im … -0.008061328025495546 + 0.05423903286239848im -0.0009129391396565527 + 0.039537309222794026im; 0.0039423879562046306 - 0.045170567648718754im 0.0017269161342984697 - 0.03702413012536781im … -3.1074370737662006e-5 + 0.011776880443882573im 0.004350862221084753 - 0.014399789249852484im; … ; -0.00034094713588947163 + 0.06549038769788226im -0.0013847022006735848 + 0.009804158414805333im … -0.0075794098665878575 + 0.04501830653154632im -0.003356392659929296 + 0.10002563998881236im; -0.0026401308354663984 + 0.03702017147919613im -0.0022330905978333454 - 0.023994965223710196im … -0.01385624934105165 + 0.08472359308561125im -0.00723044813279632 + 0.11394100487895498im;;; 0.009620095835580728 - 0.17230063316758037im 0.0032927741775331523 - 0.11171260598771653im … -0.0015151366886513263 + 0.032612410235126885im 0.015163250745155975 - 0.038892365490234546im; 0.0075069513297489655 - 0.10557104363012906im 0.0025268066371798483 - 0.04045062539429031im … 0.008342195637229884 - 0.011819464280822846im 0.014439329683243622 - 0.06707323112320847im; … ; -0.001515131471187907 + 0.03261241161058242im -0.005284155433474929 - 0.03167793532386794im … -0.01440661316010907 + 0.08558633352530004im -0.0006716470790848539 + 0.13106912351398128im; -0.003878116896724387 - 0.06664245305178265im -0.004947274100594026 - 0.09532644863082354im … -0.0197130215659721 + 0.10331903405955051im -0.002450178512004641 + 0.1078134103749114im;;; 0.015339416031696201 - 0.2955585631419009im 0.013154052244875626 - 0.11387092159121309im … 0.01743228800623361 + 0.002960230169010593im 0.036854122963349466 - 0.11630435845635617im; 0.0016985606195939913 - 0.13056567831297738im 0.0026287687488661888 + 0.02882354822129955im … 0.01733279958999181 - 0.013702906191554648im 0.0201702708594291 - 0.0894777557638545im; … ; -0.008577997326523196 - 0.03494606528155275im -0.010940553719661513 - 0.05490729498980347im … -0.006871398715900286 + 0.016714117129967006im 0.005275488638082755 + 0.05571093895451421im; -0.00896172294109985 - 0.18307443358478692im -0.005840024740007331 - 0.12738405382226792im … -0.006180016399724331 + 0.03901617867121688im 0.008581749368049653 + 0.03880445108305865im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.391555636997019 0.3785174208573158 … 0.3446996002165795 0.3785174208573158; 0.3785174208573159 0.3664584405851327 … 0.3273572816980893 0.36364954259401666; … ; 0.3446996002165795 0.3273572816980893 … 0.3075192693424968 0.33438053191322625; 0.3785174208573159 0.36364954259401666 … 0.33438053191322625 0.36645844058513266;;; 0.37851742085731593 0.36645844058513266 … 0.3273572816980893 0.3636495425940165; 0.3664584405851327 0.35102886333576444 … 0.3111940134508919 0.3519170663165556; … ; 0.32735728169808925 0.3111940134508919 … 0.29824122835575706 0.32142600277078137; 0.36364954259401666 0.35191706631655556 … 0.32142600277078137 0.3519170663165556;;; 0.3446996002165796 0.3343805319132262 … 0.2865351537613934 0.32735728169808925; 0.33438053191322625 0.3186160476795281 … 0.2780589188146396 0.32142600277078137; … ; 0.2865351537613933 0.2780589188146396 … 0.25590185770148366 0.2780589188146397; 0.32735728169808936 0.32142600277078137 … 0.2780589188146397 0.31119401345089187;;; … ;;; 0.30487474922948105 0.2830366689321476 … 0.2855643322463041 0.3009573704462925; 0.2830366689321477 0.25898431621942497 … 0.2726330012290846 0.28541419657551376; … ; 0.2855643322463041 0.27263300122908457 … 0.27716038905803564 0.28121087370634845; 0.30095737044629256 0.28541419657551376 … 0.2812108737063484 0.29308272619387865;;; 0.3446996002165796 0.32735728169808925 … 0.30751926934249685 0.3343805319132262; 0.3273572816980893 0.31119401345089187 … 0.29824122835575706 0.3214260027707814; … ; 0.3075192693424968 0.2982412283557571 … 0.2771603890580357 0.2931311913898121; 0.33438053191322625 0.3214260027707814 … 0.2931311913898121 0.31861604767952806;;; 0.37851742085731593 0.3636495425940166 … 0.3343805319132262 0.36645844058513266; 0.3636495425940167 0.3519170663165556 … 0.32142600277078137 0.3519170663165556; … ; 0.3343805319132262 0.32142600277078137 … 0.29313119138981203 0.31861604767952817; 0.3664584405851327 0.3519170663165556 … 0.31861604767952817 0.35102886333576444]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923028566 -0.4966565572070334 … -0.4771919009287844 -0.4966565572070334; -0.4966565572070334 -0.48481820866903186 … -0.4763804457601093 -0.4920413111665687; … ; -0.4771919009287844 -0.4763804457601093 … -0.4122880708337544 -0.4550700815049018; -0.4966565572070334 -0.4920413111665687 … -0.4550700815049019 -0.4848182086690318;;; -0.4966565572070334 -0.48481820866903186 … -0.4763804457601093 -0.4920413111665688; -0.48481820866903186 -0.45837440785740263 … -0.47065601571454363 -0.4861790251634745; … ; -0.4763804457601093 -0.47065601571454363 … -0.4463984363979398 -0.4688943963621215; -0.4920413111665688 -0.4861790251634745 … -0.4688943963621215 -0.4861790251634745;;; -0.4771919009287844 -0.4550700815049019 … -0.46051412343680515 -0.4763804457601093; -0.4550700815049019 -0.4090661823905755 … -0.4567199083259325 -0.4688943963621215; … ; -0.46051412343680515 -0.45671990832593246 … -0.4451449565908624 -0.4567199083259325; -0.4763804457601093 -0.4688943963621215 … -0.4567199083259325 -0.4706560157145437;;; … ;;; -0.4494759507970175 -0.4551499721802225 … -0.37125986260333826 -0.417745715162433; -0.4551499721802225 -0.44880351100545696 … -0.4174380106866974 -0.4441260992619815; … ; -0.3712598626033382 -0.41743801068669734 … -0.25365698326354325 -0.2997980910500038; -0.417745715162433 -0.4441260992619815 … -0.2997980910500038 -0.3610634326225414;;; -0.4771919009287844 -0.4763804457601093 … -0.4122880708337544 -0.4550700815049019; -0.4763804457601093 -0.4706560157145437 … -0.4463984363979398 -0.4688943963621215; … ; -0.4122880708337544 -0.44639843639793975 … -0.25365698326354325 -0.34106330227385045; -0.4550700815049019 -0.4688943963621215 … -0.34106330227385045 -0.4090661823905755;;; -0.4966565572070334 -0.49204131116656874 … -0.4550700815049018 -0.48481820866903186; -0.4920413111665688 -0.4861790251634745 … -0.4688943963621215 -0.4861790251634745; … ; -0.4550700815049018 -0.4688943963621214 … -0.3410633022738505 -0.4090661823905755; -0.48481820866903186 -0.4861790251634745 … -0.4090661823905755 -0.45837440785740263])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392129340565 -0.4868367443009694 … -0.7027113226366303 -0.4868367443009695; -0.4868367443009691 -0.7744303950615419 … -0.4136373284568148 -0.38233074981816834; … ; -0.7027113226366305 -0.413637328456815 … -2.396761682623943 -1.295806758197101; -0.486836744300969 -0.3823307498181682 … -1.2958067581971013 -0.7744303950615417;;; -0.4868367443009692 -0.7744303950615419 … -0.4136373284568148 -0.3823307498181689; -0.7744303950615417 -1.4814477484163828 … -0.32458456945180203 -0.44991939659119023; … ; -0.41363732845681495 -0.32458456945180236 … -1.0113572986299122 -0.6373277792081008; -0.3823307498181683 -0.4499193965911903 … -0.6373277792081006 -0.4499193965911901;;; -0.7027113226366302 -1.2958067581971013 … -0.29820348939225694 -0.41363732845681506; -1.2958067581971013 -2.9196723936887894 … -0.35372958467509596 -0.6373277792081006; … ; -0.29820348939225705 -0.3537295846750965 … -0.49037260811619027 -0.3537295846750964; -0.4136373284568147 -0.6373277792081006 … -0.35372958467509574 -0.32458456945180214;;; … ;;; -1.0166744212714458 -0.5332878143155634 … -3.6361382571795366 -1.9987602620824143; -0.533287814315563 -0.3217412474849442 … -1.4667339407810243 -0.9061938941611988; … ; -3.6361382571795366 -1.4667339407810243 … -10.988177824525033 -8.087376168276025; -1.9987602620824139 -0.9061938941611988 … -8.087376168276025 -4.647878371195567;;; -0.7027113226366302 -0.41363732845681483 … -2.396761682623943 -1.2958067581971013; -0.41363732845681467 -0.32458456945180236 … -1.0113572986299122 -0.6373277792081005; … ; -2.396761682623943 -1.0113572986299122 … -11.00280619093414 -6.0773041864475; -1.295806758197101 -0.6373277792081004 … -6.0773041864475 -2.9196723936887894;;; -0.48683674430096924 -0.3823307498181686 … -1.2958067581971011 -0.7744303950615419; -0.38233074981816834 -0.4499193965911903 … -0.6373277792081005 -0.44991939659119023; … ; -1.2958067581971011 -0.6373277792081006 … -6.077304186447499 -2.9196723936887885; -0.7744303950615415 -0.44991939659119007 … -2.9196723936887885 -1.4814477484163828]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0076448339169726265 - 0.2995502477185455im -0.10396423344169056 - 0.07693383627119746im … -0.03926078586526032 + 0.02903162348541575im -0.02148953430750369 - 0.1401641057678997im; -0.015528219728954558 - 0.1468286974417851im -0.0643702712504577 + 0.04750958807867646im … -0.01803087899698374 - 0.013774408450308522im -0.008215976895936514 - 0.10296995768811193im; … ; 0.06089971460549095 - 0.06608530243468083im 0.044649651794992834 - 0.058675076819597285im … -0.025293687933557293 + 0.05375803696261667im -0.03119961661163648 + 0.0650353945221175im; 0.08506777990963618 - 0.23218944368413044im 0.004399278589805283 - 0.1103532636959472im … -0.04266223377054618 + 0.08206110076673052im -0.007833451308295644 + 0.0018510963988119748im;;; -0.0487501992226065 - 0.06112339391067472im -0.15156104939671686 + 0.1776818443978831im … -0.01571857147049704 - 0.011820671488816367im -0.008316506736612885 - 0.07483259872671663im; -0.025080859549208526 + 0.05876004202940321im -0.05136431880757561 + 0.2222225617588674im … -0.004372679622189607 - 0.01832629736599062im 0.0016729295632104003 - 0.03405124392376157im; … ; 0.041342001603755826 - 0.05962221628692797im 0.010284000251002194 - 0.01636460487338602im … -0.011614488383373249 + 0.007003556201054922im 0.007112252551924836 - 0.021632708261373854im; 0.029144129000733217 - 0.10326761818976946im -0.06843590274660889 + 0.04718841202591284im … -0.01638210141463038 + 0.0034453540349292933im 0.00931308987557003 - 0.058289427022054016im;;; -0.03841401447489518 + 0.07241825558453793im -0.06639961818931736 + 0.12258846151451927im … -0.0025462937333759175 - 0.003050933496269584im -0.00459260860045151 + 0.008546750919105162im; -0.005602706719758169 + 0.06475494342824156im 0.015250096267733493 + 0.06702299649784939im … 0.002378806062102324 - 0.00343486144834635im 0.003372604135451331 + 0.013270311722332315im; … ; 0.007550248751274299 - 0.004902671323716962im -0.012702558352615807 + 0.020280575055487728im … -0.0016172650721939068 - 0.004782493346498794im 0.007271533691101606 - 0.01181254033177192im; -0.01627867276616594 + 0.027917809086429157im -0.05360347410613962 + 0.07399778834141799im … -0.0029071594542008222 - 0.0034820409311227332im 0.002127130995656733 - 0.003915635285985021im;;; … ;;; -0.001997702741366998 + 0.029854550116291956im 0.0011785554393116257 + 0.01032592190293059im … 0.010057252548757853 + 0.0010972815502786073im -0.0026458052249730066 + 0.03335613170185135im; -0.004609022192228617 + 0.012583251941462394im -0.0029449384942667562 - 0.0002478714101581866im … -0.0009589089306042528 + 0.0155076741853198im -0.006179891581429635 + 0.023770571369973924im; … ; -0.0031673596177150586 - 0.0012570382134307286im 0.0012545989742942048 + 0.0054779401203865034im … 0.04213756417035357 - 0.09369458377006537im 0.013750576973633626 - 0.046593858997307086im; 0.0002589009446574349 + 0.025190911557370042im 0.005288151361040079 + 0.013049810160819571im … 0.030033398459383187 - 0.05189605357820813im 0.006026192411460766 + 0.003965323392826347im;;; -0.007113225222328361 + 0.03823702162892284im -0.002430254212263162 - 0.00801558475931866im … -0.009592353860855444 + 0.06426553058649835im -0.030903835419224746 + 0.11105178099069746im; -0.009432715687940706 - 0.011312339007341864im -0.00941596782906362 - 0.01977043372777053im … -0.013441189324126763 + 0.0361741984989566im -0.01806253246815402 + 0.028400102303407525im; … ; -0.01501267044129799 + 0.05670198847323875im 0.010697370670798793 + 0.013392518595997594im … 0.05588442685889426 - 0.09935227083237905im -0.021415139199060268 + 0.04064640909175195im; -0.0003055194176213083 + 0.09418987198976059im 0.016259491445814116 + 0.012792217446502878im … 0.01823115237049594 + 0.021340072982814633im -0.03643806460454746 + 0.1611762219291027im;;; 0.002538713452031393 - 0.13328365845786638im -0.03375348769924082 - 0.08211643355992942im … -0.04217310098171808 + 0.10782484684660318im -0.05475555743625577 + 0.08666699955870578im; -0.010878746965894998 - 0.1037324365779009im -0.02952744023698256 - 0.042985414618012224im … -0.024221642789149372 + 0.02663645181833359im -0.022563221941768664 - 0.02896527600445962im; … ; 0.001661609344174116 + 0.07444514990826662im 0.034259197233362224 - 0.013859227671619685im … -0.002587182022324547 + 0.04603776244629406im -0.07942587641169929 + 0.19485897246727535im; 0.04473714611883784 + 0.016904595660868292im 0.03145102808623397 - 0.05195026731988661im … -0.038724862270367255 + 0.16052140219753425im -0.06344518735353519 + 0.26549432688934327im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.391555636997019 0.3785174208573158 … 0.3446996002165795 0.3785174208573158; 0.3785174208573159 0.3664584405851327 … 0.3273572816980893 0.36364954259401666; … ; 0.3446996002165795 0.3273572816980893 … 0.3075192693424968 0.33438053191322625; 0.3785174208573159 0.36364954259401666 … 0.33438053191322625 0.36645844058513266;;; 0.37851742085731593 0.36645844058513266 … 0.3273572816980893 0.3636495425940165; 0.3664584405851327 0.35102886333576444 … 0.3111940134508919 0.3519170663165556; … ; 0.32735728169808925 0.3111940134508919 … 0.29824122835575706 0.32142600277078137; 0.36364954259401666 0.35191706631655556 … 0.32142600277078137 0.3519170663165556;;; 0.3446996002165796 0.3343805319132262 … 0.2865351537613934 0.32735728169808925; 0.33438053191322625 0.3186160476795281 … 0.2780589188146396 0.32142600277078137; … ; 0.2865351537613933 0.2780589188146396 … 0.25590185770148366 0.2780589188146397; 0.32735728169808936 0.32142600277078137 … 0.2780589188146397 0.31119401345089187;;; … ;;; 0.30487474922948105 0.2830366689321476 … 0.2855643322463041 0.3009573704462925; 0.2830366689321477 0.25898431621942497 … 0.2726330012290846 0.28541419657551376; … ; 0.2855643322463041 0.27263300122908457 … 0.27716038905803564 0.28121087370634845; 0.30095737044629256 0.28541419657551376 … 0.2812108737063484 0.29308272619387865;;; 0.3446996002165796 0.32735728169808925 … 0.30751926934249685 0.3343805319132262; 0.3273572816980893 0.31119401345089187 … 0.29824122835575706 0.3214260027707814; … ; 0.3075192693424968 0.2982412283557571 … 0.2771603890580357 0.2931311913898121; 0.33438053191322625 0.3214260027707814 … 0.2931311913898121 0.31861604767952806;;; 0.37851742085731593 0.3636495425940166 … 0.3343805319132262 0.36645844058513266; 0.3636495425940167 0.3519170663165556 … 0.32142600277078137 0.3519170663165556; … ; 0.3343805319132262 0.32142600277078137 … 0.29313119138981203 0.31861604767952817; 0.3664584405851327 0.3519170663165556 … 0.31861604767952817 0.35102886333576444]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923028566 -0.4966565572070334 … -0.4771919009287844 -0.4966565572070334; -0.4966565572070334 -0.48481820866903186 … -0.4763804457601093 -0.4920413111665687; … ; -0.4771919009287844 -0.4763804457601093 … -0.4122880708337544 -0.4550700815049018; -0.4966565572070334 -0.4920413111665687 … -0.4550700815049019 -0.4848182086690318;;; -0.4966565572070334 -0.48481820866903186 … -0.4763804457601093 -0.4920413111665688; -0.48481820866903186 -0.45837440785740263 … -0.47065601571454363 -0.4861790251634745; … ; -0.4763804457601093 -0.47065601571454363 … -0.4463984363979398 -0.4688943963621215; -0.4920413111665688 -0.4861790251634745 … -0.4688943963621215 -0.4861790251634745;;; -0.4771919009287844 -0.4550700815049019 … -0.46051412343680515 -0.4763804457601093; -0.4550700815049019 -0.4090661823905755 … -0.4567199083259325 -0.4688943963621215; … ; -0.46051412343680515 -0.45671990832593246 … -0.4451449565908624 -0.4567199083259325; -0.4763804457601093 -0.4688943963621215 … -0.4567199083259325 -0.4706560157145437;;; … ;;; -0.4494759507970175 -0.4551499721802225 … -0.37125986260333826 -0.417745715162433; -0.4551499721802225 -0.44880351100545696 … -0.4174380106866974 -0.4441260992619815; … ; -0.3712598626033382 -0.41743801068669734 … -0.25365698326354325 -0.2997980910500038; -0.417745715162433 -0.4441260992619815 … -0.2997980910500038 -0.3610634326225414;;; -0.4771919009287844 -0.4763804457601093 … -0.4122880708337544 -0.4550700815049019; -0.4763804457601093 -0.4706560157145437 … -0.4463984363979398 -0.4688943963621215; … ; -0.4122880708337544 -0.44639843639793975 … -0.25365698326354325 -0.34106330227385045; -0.4550700815049019 -0.4688943963621215 … -0.34106330227385045 -0.4090661823905755;;; -0.4966565572070334 -0.49204131116656874 … -0.4550700815049018 -0.48481820866903186; -0.4920413111665688 -0.4861790251634745 … -0.4688943963621215 -0.4861790251634745; … ; -0.4550700815049018 -0.4688943963621214 … -0.3410633022738505 -0.4090661823905755; -0.48481820866903186 -0.4861790251634745 … -0.4090661823905755 -0.45837440785740263])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392129340565 -0.4868367443009694 … -0.7027113226366303 -0.4868367443009695; -0.4868367443009691 -0.7744303950615419 … -0.4136373284568148 -0.38233074981816834; … ; -0.7027113226366305 -0.413637328456815 … -2.396761682623943 -1.295806758197101; -0.486836744300969 -0.3823307498181682 … -1.2958067581971013 -0.7744303950615417;;; -0.4868367443009692 -0.7744303950615419 … -0.4136373284568148 -0.3823307498181689; -0.7744303950615417 -1.4814477484163828 … -0.32458456945180203 -0.44991939659119023; … ; -0.41363732845681495 -0.32458456945180236 … -1.0113572986299122 -0.6373277792081008; -0.3823307498181683 -0.4499193965911903 … -0.6373277792081006 -0.4499193965911901;;; -0.7027113226366302 -1.2958067581971013 … -0.29820348939225694 -0.41363732845681506; -1.2958067581971013 -2.9196723936887894 … -0.35372958467509596 -0.6373277792081006; … ; -0.29820348939225705 -0.3537295846750965 … -0.49037260811619027 -0.3537295846750964; -0.4136373284568147 -0.6373277792081006 … -0.35372958467509574 -0.32458456945180214;;; … ;;; -1.0166744212714458 -0.5332878143155634 … -3.6361382571795366 -1.9987602620824143; -0.533287814315563 -0.3217412474849442 … -1.4667339407810243 -0.9061938941611988; … ; -3.6361382571795366 -1.4667339407810243 … -10.988177824525033 -8.087376168276025; -1.9987602620824139 -0.9061938941611988 … -8.087376168276025 -4.647878371195567;;; -0.7027113226366302 -0.41363732845681483 … -2.396761682623943 -1.2958067581971013; -0.41363732845681467 -0.32458456945180236 … -1.0113572986299122 -0.6373277792081005; … ; -2.396761682623943 -1.0113572986299122 … -11.00280619093414 -6.0773041864475; -1.295806758197101 -0.6373277792081004 … -6.0773041864475 -2.9196723936887894;;; -0.48683674430096924 -0.3823307498181686 … -1.2958067581971011 -0.7744303950615419; -0.38233074981816834 -0.4499193965911903 … -0.6373277792081005 -0.44991939659119023; … ; -1.2958067581971011 -0.6373277792081006 … -6.077304186447499 -2.9196723936887885; -0.7744303950615415 -0.44991939659119007 … -2.9196723936887885 -1.4814477484163828]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.010876446652294581 + 0.24361615641525022im -0.011977728522511773 + 0.15749195817142553im … 0.10975125478641473 - 0.06336151039312973im 0.15503141764623785 + 0.030462252213210906im; -0.024639158796443836 + 0.15376095690056188im -0.0058018223484410415 + 0.0062594152171562695im … 0.05180880916555076 + 0.00501226759088573im 0.04977007484337655 + 0.08130606172972428im; … ; 0.04384353736115189 - 0.08278284081319076im -0.003812341917074231 - 0.01137787282434727im … -0.001073782837983383 - 0.02405109787474468im 0.09505441875314706 - 0.13836448688017536im; 0.06990401894234721 + 0.005377370233952623im -0.00920686319902044 + 0.06392705596463688im … 0.09199445665982722 - 0.13926617978940586im 0.1955697175138595 - 0.2109944418990265im;;; -0.186719073339176 + 0.3172636501326522im -0.10404804139000996 + 0.1355568518672753im … 0.06296718654539205 - 0.01654616289534411im -0.021065636298141316 + 0.1354813674663034im; -0.16068712134201346 + 0.11886675404870556im -0.042691580691521756 - 0.09330167346452475im … 0.010539051552806263 + 0.021195633849181918im -0.07052674575377796 + 0.1022909672614308im; … ; 0.014086812091857203 - 0.03094996800892893im -0.01803888183663616 + 0.012774442647787515im … 0.05153072863632725 - 0.05578902878474926im 0.07816993287934848 - 0.09072122028207527im; -0.06995496366042525 + 0.12107492438314045im -0.0647242348395869 + 0.10400081961126238im … 0.09369169519339596 - 0.08614735089818501im 0.09365887531878561 - 0.06397383080198721im;;; -0.1426360264147042 + 0.14552027316677119im -0.01943449932909687 + 0.004839781310270529im … -0.007114556000789035 + 0.019960346468563966im -0.08725847356181729 + 0.10007990857714637im; -0.05749031839024557 - 0.0063743019695477465im 0.07189231112048966 - 0.15582086037186632im … -0.024671838311706596 + 0.026171852171698033im -0.07243334387106139 + 0.051896386125456564im; … ; -0.021549491830689084 + 0.015706737450538258im -0.02435228442521715 + 0.026266016640246737im … 0.029519081171328405 - 0.02990201515191749im 0.014609551163198101 - 0.01999253145131576im; -0.08890174944294013 + 0.09959567697731489im -0.04515016652079537 + 0.05993604564752375im … 0.023290395420564568 - 0.017434507030409684im -0.027981676833265676 + 0.034342334576686034im;;; … ;;; -0.019791437963910558 + 0.001238030285023597im -0.014922318948303474 + 0.011288196324335718im … -0.005194830419113463 - 0.015669118029527317im -0.014148355118661589 - 0.014667775493027363im; -0.011963169023124824 + 0.01216018252297447im -0.005131077076749918 + 0.01208944928363956im … -0.009494796659864451 - 0.005010760772939185im -0.013026420226730314 + 0.002507524231590963im; … ; 0.009891073114699937 - 0.01122368571204764im -0.0034802732594928954 - 0.003238433525391761im … 0.03420236215850559 + 0.0011236764723447095im 0.027774296884474393 - 0.010389210382302429im; -0.010077443751954141 - 0.013468181340045023im -0.014886071102825074 + 0.001959532506397392im … 0.01610618043463865 - 0.013827507682134347im 0.005055944875449245 - 0.02532775843714174im;;; -0.03213476087721709 + 0.02625928026274858im -0.01352932523779132 + 0.03166055456294069im … -0.03666308010773403 - 0.019512552088245618im -0.03660634985321337 - 0.016981369527935095im; -0.004446381872482303 + 0.03433706703021992im 0.005943921050981932 + 0.020715907178610896im … -0.013210008185013623 + 0.0006580529069226907im -0.009567394766572701 + 0.017765913110623525im; … ; -0.013443432857258726 - 0.012670311929850681im -0.016790733290607613 - 0.00039709557771823337im … -0.009292089727065626 + 0.0379550954108613im -0.007694907002445644 - 0.004630250649080817im; -0.04367381622139589 - 0.01906397200630567im -0.027660645147445522 + 0.012434292326659614im … -0.045750726535871394 - 0.015844333721699553im -0.04742932915893776 - 0.05956711338817011im;;; 0.017075080669640412 + 0.1139658563064023im 0.010480713382797338 + 0.0781368220934168im … -0.006467465834131526 - 0.04018168552237646im 0.046095413391447355 - 0.026428523215725322im; 0.02308827793242909 + 0.08185195117244996im 0.02329627075090151 + 0.026872546928360157im … 0.017201219192325264 + 0.0036038172497045973im 0.034912889044241474 + 0.042997893632650955im; … ; -0.012269976777502089 - 0.04189153787183605im -0.016370846873180175 - 0.006289017461267497im … -0.09984976458129405 + 0.06896786484100575im -0.028957509554478046 - 0.041284736115920116im; -0.010543666834631996 - 0.04311862093027208im -0.01681474371702114 + 0.027755074733882945im … -0.07784683713849819 - 0.05569117908008947im 0.014490040812395844 - 0.1783308490591788im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.391555636997019 0.3785174208573158 … 0.3446996002165795 0.3785174208573158; 0.3785174208573159 0.3664584405851327 … 0.3273572816980893 0.36364954259401666; … ; 0.3446996002165795 0.3273572816980893 … 0.3075192693424968 0.33438053191322625; 0.3785174208573159 0.36364954259401666 … 0.33438053191322625 0.36645844058513266;;; 0.37851742085731593 0.36645844058513266 … 0.3273572816980893 0.3636495425940165; 0.3664584405851327 0.35102886333576444 … 0.3111940134508919 0.3519170663165556; … ; 0.32735728169808925 0.3111940134508919 … 0.29824122835575706 0.32142600277078137; 0.36364954259401666 0.35191706631655556 … 0.32142600277078137 0.3519170663165556;;; 0.3446996002165796 0.3343805319132262 … 0.2865351537613934 0.32735728169808925; 0.33438053191322625 0.3186160476795281 … 0.2780589188146396 0.32142600277078137; … ; 0.2865351537613933 0.2780589188146396 … 0.25590185770148366 0.2780589188146397; 0.32735728169808936 0.32142600277078137 … 0.2780589188146397 0.31119401345089187;;; … ;;; 0.30487474922948105 0.2830366689321476 … 0.2855643322463041 0.3009573704462925; 0.2830366689321477 0.25898431621942497 … 0.2726330012290846 0.28541419657551376; … ; 0.2855643322463041 0.27263300122908457 … 0.27716038905803564 0.28121087370634845; 0.30095737044629256 0.28541419657551376 … 0.2812108737063484 0.29308272619387865;;; 0.3446996002165796 0.32735728169808925 … 0.30751926934249685 0.3343805319132262; 0.3273572816980893 0.31119401345089187 … 0.29824122835575706 0.3214260027707814; … ; 0.3075192693424968 0.2982412283557571 … 0.2771603890580357 0.2931311913898121; 0.33438053191322625 0.3214260027707814 … 0.2931311913898121 0.31861604767952806;;; 0.37851742085731593 0.3636495425940166 … 0.3343805319132262 0.36645844058513266; 0.3636495425940167 0.3519170663165556 … 0.32142600277078137 0.3519170663165556; … ; 0.3343805319132262 0.32142600277078137 … 0.29313119138981203 0.31861604767952817; 0.3664584405851327 0.3519170663165556 … 0.31861604767952817 0.35102886333576444]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923028566 -0.4966565572070334 … -0.4771919009287844 -0.4966565572070334; -0.4966565572070334 -0.48481820866903186 … -0.4763804457601093 -0.4920413111665687; … ; -0.4771919009287844 -0.4763804457601093 … -0.4122880708337544 -0.4550700815049018; -0.4966565572070334 -0.4920413111665687 … -0.4550700815049019 -0.4848182086690318;;; -0.4966565572070334 -0.48481820866903186 … -0.4763804457601093 -0.4920413111665688; -0.48481820866903186 -0.45837440785740263 … -0.47065601571454363 -0.4861790251634745; … ; -0.4763804457601093 -0.47065601571454363 … -0.4463984363979398 -0.4688943963621215; -0.4920413111665688 -0.4861790251634745 … -0.4688943963621215 -0.4861790251634745;;; -0.4771919009287844 -0.4550700815049019 … -0.46051412343680515 -0.4763804457601093; -0.4550700815049019 -0.4090661823905755 … -0.4567199083259325 -0.4688943963621215; … ; -0.46051412343680515 -0.45671990832593246 … -0.4451449565908624 -0.4567199083259325; -0.4763804457601093 -0.4688943963621215 … -0.4567199083259325 -0.4706560157145437;;; … ;;; -0.4494759507970175 -0.4551499721802225 … -0.37125986260333826 -0.417745715162433; -0.4551499721802225 -0.44880351100545696 … -0.4174380106866974 -0.4441260992619815; … ; -0.3712598626033382 -0.41743801068669734 … -0.25365698326354325 -0.2997980910500038; -0.417745715162433 -0.4441260992619815 … -0.2997980910500038 -0.3610634326225414;;; -0.4771919009287844 -0.4763804457601093 … -0.4122880708337544 -0.4550700815049019; -0.4763804457601093 -0.4706560157145437 … -0.4463984363979398 -0.4688943963621215; … ; -0.4122880708337544 -0.44639843639793975 … -0.25365698326354325 -0.34106330227385045; -0.4550700815049019 -0.4688943963621215 … -0.34106330227385045 -0.4090661823905755;;; -0.4966565572070334 -0.49204131116656874 … -0.4550700815049018 -0.48481820866903186; -0.4920413111665688 -0.4861790251634745 … -0.4688943963621215 -0.4861790251634745; … ; -0.4550700815049018 -0.4688943963621214 … -0.3410633022738505 -0.4090661823905755; -0.48481820866903186 -0.4861790251634745 … -0.4090661823905755 -0.45837440785740263])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392129340565 -0.4868367443009694 … -0.7027113226366303 -0.4868367443009695; -0.4868367443009691 -0.7744303950615419 … -0.4136373284568148 -0.38233074981816834; … ; -0.7027113226366305 -0.413637328456815 … -2.396761682623943 -1.295806758197101; -0.486836744300969 -0.3823307498181682 … -1.2958067581971013 -0.7744303950615417;;; -0.4868367443009692 -0.7744303950615419 … -0.4136373284568148 -0.3823307498181689; -0.7744303950615417 -1.4814477484163828 … -0.32458456945180203 -0.44991939659119023; … ; -0.41363732845681495 -0.32458456945180236 … -1.0113572986299122 -0.6373277792081008; -0.3823307498181683 -0.4499193965911903 … -0.6373277792081006 -0.4499193965911901;;; -0.7027113226366302 -1.2958067581971013 … -0.29820348939225694 -0.41363732845681506; -1.2958067581971013 -2.9196723936887894 … -0.35372958467509596 -0.6373277792081006; … ; -0.29820348939225705 -0.3537295846750965 … -0.49037260811619027 -0.3537295846750964; -0.4136373284568147 -0.6373277792081006 … -0.35372958467509574 -0.32458456945180214;;; … ;;; -1.0166744212714458 -0.5332878143155634 … -3.6361382571795366 -1.9987602620824143; -0.533287814315563 -0.3217412474849442 … -1.4667339407810243 -0.9061938941611988; … ; -3.6361382571795366 -1.4667339407810243 … -10.988177824525033 -8.087376168276025; -1.9987602620824139 -0.9061938941611988 … -8.087376168276025 -4.647878371195567;;; -0.7027113226366302 -0.41363732845681483 … -2.396761682623943 -1.2958067581971013; -0.41363732845681467 -0.32458456945180236 … -1.0113572986299122 -0.6373277792081005; … ; -2.396761682623943 -1.0113572986299122 … -11.00280619093414 -6.0773041864475; -1.295806758197101 -0.6373277792081004 … -6.0773041864475 -2.9196723936887894;;; -0.48683674430096924 -0.3823307498181686 … -1.2958067581971011 -0.7744303950615419; -0.38233074981816834 -0.4499193965911903 … -0.6373277792081005 -0.44991939659119023; … ; -1.2958067581971011 -0.6373277792081006 … -6.077304186447499 -2.9196723936887885; -0.7744303950615415 -0.44991939659119007 … -2.9196723936887885 -1.4814477484163828]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.22541671754248652 - 0.22543231219281124im 0.09693915186778457 - 0.12266194287105919im … 0.07883091763829311 - 0.01423435438085759im 0.21079278389843242 - 0.12209581309357348im; 0.0941900522942982 - 0.10421310302376807im -0.0006660301089161822 + 0.009497639222466854im … 0.05655517874021157 - 0.004829120692643603im 0.12397919570090424 - 0.05841721426529008im; … ; 0.007757909318493365 + 0.0012383509596760696im 0.019492687468228354 - 0.026700628819195105im … -0.04523282975116322 + 0.03423143164431919im -0.027263523833114024 + 0.04751584397832404im; 0.12691700852464816 - 0.12725947971746032im 0.06975259919224419 - 0.09354928910902327im … -0.01888941285811706 + 0.03240063210451968im 0.0702955884357388 - 0.0013853484546344184im;;; 0.033467046326693166 - 0.19900990499870524im -0.05274804669471038 - 0.05931693675933955im … 0.07351945752665942 + 0.004656024466433778im 0.11293456997114949 - 0.08965338119605468im; -0.13911113487910587 - 0.10890194734717859im -0.17221835947475314 + 0.049717292412608596im … 0.0256142852978199 - 0.0032420039773164615im -0.02589295235093324 - 0.0868898837293852im; … ; 0.02832169332418124 - 0.017051065030335755im 0.019146069852237782 - 0.028661662753728705im … 0.0008009116260780627 + 0.02032314599822301im 0.020667856145134368 + 0.016160623410118476im; 0.07319236269360763 - 0.1003032211073708im 0.021886685663511395 - 0.06662214205435371im … 0.04226038098601154 + 0.02028426465942659im 0.08729020050879918 - 0.020014543136130193im;;; -0.07054479109492581 - 0.07822363001533279im -0.06765197631586763 + 0.006022766641997702im … 0.014523842611272621 - 0.008308490629972324im -0.018657177045480096 - 0.05625869581465698im; -0.1270620435047235 - 0.04892243972313124im -0.07473857810775723 + 0.0843583276386795im … -0.014574124666914065 - 0.01822992097418732im -0.07083348931364601 - 0.06189733724893989im; … ; 0.01166494526203423 - 0.018184019381816928im 0.0026654250032862453 - 0.0185071004952055im … 0.011835141559293853 + 0.009589928313722943im 0.016743911165560562 - 0.0007348267728917229im; -0.0026381228891306113 - 0.05064412732805314im -0.017796606609461738 - 0.024822266038753652im … 0.023978110916072572 + 0.004614980484786491im 0.019931341556070483 - 0.023910175409206983im;;; … ;;; -0.020995154401962597 - 0.012940464691961938im -0.013430158597786096 - 0.018515502980823502im … 0.015561066729342944 + 0.044566127667764334im -0.008433029984171489 + 0.015676040351915582im; -0.017716847820545188 - 0.025375313332129487im -0.007344911288739983 - 0.016292230138945728im … -0.0013562884697744032 - 0.0004578986564830119im -0.015788229328605644 - 0.01962716179787291im; … ; 0.0018645808144591438 + 0.03222510237560146im -0.00637754681478276 + 0.01268771712106398im … 0.03972500657368662 + 0.02629113314902646im 0.024896148811472497 + 0.04411034219366464im; -0.012092166309828806 + 0.02530282785208078im -0.013049148716566532 - 0.0006749203982058523im … 0.03725335641492544 + 0.07883766858004818im 0.011200133383529232 + 0.06621788111804752im;;; -0.04342089552832172 - 0.08238347008655142im -0.004086089560459657 - 0.05042206043177591im … -0.035198629813832635 + 0.014600789750033611im -0.07627998918357123 - 0.05671059984754777im; -0.01476918805077744 - 0.05685497441050781im 0.008144052439388738 - 0.02210242419533747im … -0.022566647290176732 - 0.03534310428445003im -0.03701381077937206 - 0.06708407217024878im; … ; -0.030435154657575833 + 0.043255331469476244im -0.016935037141794035 + 0.0072738644203134695im … 0.02475127490161623 + 0.07141040470697264im -0.01899339645159325 + 0.08242654576735353im; -0.055372162637541904 + 0.004139480001235457im -0.017099720755725488 - 0.024929143471083107im … -0.01801698750564718 + 0.12230028085114608im -0.07473857810823605 + 0.0843583269620152im;;; 0.07325369848293763 - 0.2051117608980096im 0.06024411382396719 - 0.09831741981178019im … -0.061983008422699236 - 0.051093091423303795im -0.01201350306853813 - 0.12839420104382093im; 0.06944921564375243 - 0.08298427409816969im 0.047575342116060015 - 0.01392369618704464im … -0.007728867232361214 - 0.049774685284642115im 0.020681643214716716 - 0.0940327685992246im; … ; -0.044561716275535485 + 0.03101777311899566im -0.007226901600384193 - 0.009471185533709292im … -0.06224164145930134 + 0.059345830010688286im -0.08549128315803722 + 0.08099143628437828im; -0.025469567065038175 - 0.06350048476414924im 0.021183173744241918 - 0.06651424816848647im … -0.12852484807237807 + 0.06517350067703703im -0.1324317073931774 + 0.04361543574426939im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729848), converged = true, ρ = [0.0913231691719794 0.08747419133015767 … 0.07684754934078167 0.08747419133015767; 0.08747419133015769 0.08089966869909049 … 0.07642471016624555 0.0848694483426695; … ; 0.07684754934078165 0.07642471016624554 … 0.047784666655854804 0.06587895339895719; 0.08747419133015767 0.0848694483426695 … 0.0658789533989572 0.08089966869909046;;; 0.08747419133015767 0.08089966869909049 … 0.07642471016624554 0.08486944834266953; 0.08089966869909049 0.06744471467030241 … 0.07348669935151181 0.08163768628353796; … ; 0.07642471016624554 0.0734866993515118 … 0.06188804118272408 0.07259829026970278; 0.08486944834266953 0.08163768628353796 … 0.0725982902697028 0.08163768628353796;;; 0.07684754934078165 0.0658789533989572 … 0.06847203699655935 0.07642471016624555; 0.06587895339895722 0.046578642631792726 … 0.06665759371859047 0.07259829026970278; … ; 0.06847203699655935 0.06665759371859045 … 0.06132515313815661 0.06665759371859048; 0.07642471016624555 0.07259829026970278 … 0.06665759371859048 0.07348669935151182;;; … ;;; 0.06328495227878332 0.06591651444952552 … 0.0339406488761635 0.049875934844309286; 0.06591651444952552 0.06297790960458494 … 0.04975639787490396 0.0608702045550738; … ; 0.033940648876163486 0.04975639787490395 … 0.009696353211476686 0.016831338790816518; 0.049875934844309286 0.0608702045550738 … 0.016831338790816514 0.030985721877892888;;; 0.07684754934078167 0.07642471016624555 … 0.04778466665585481 0.0658789533989572; 0.07642471016624555 0.07348669935151184 … 0.06188804118272408 0.0725982902697028; … ; 0.0477846666558548 0.06188804118272406 … 0.009696353211476686 0.025710010668634126; 0.0658789533989572 0.0725982902697028 … 0.02571001066863413 0.04657864263179272;;; 0.08747419133015767 0.08486944834266952 … 0.06587895339895718 0.08089966869909049; 0.08486944834266953 0.08163768628353797 … 0.07259829026970278 0.08163768628353796; … ; 0.06587895339895719 0.07259829026970277 … 0.025710010668634136 0.046578642631792726; 0.08089966869909049 0.08163768628353797 … 0.046578642631792726 0.06744471467030241;;;;], ψ = Matrix{ComplexF64}[[-0.044343695128044786 + 0.9544738353174633im 4.4367615137375083e-10 - 5.046785975237889e-10im 5.605773831240946e-10 - 1.1039697489501066e-9im 7.053728989792063e-10 + 2.711200873181663e-10im; -0.0044686998056936295 + 0.09618633751134245im -0.31830050593658343 + 0.31850313692045307im -0.12101125362874475 - 0.05128585814772184im 0.08622484013954958 + 0.15730520868119152im; … ; -0.0005473563992891336 + 0.011781552827080953im 0.03400955070145813 - 0.014184986513171193im 0.02299735299876305 + 0.01265346052473781im -0.02831073073325841 + 0.025693373314103787im; 0.004468700266839177 - 0.09618633721317918im 0.014660546041159565 + 0.17962898783799527im 0.10413794760167278 + 0.07259433488411146im -0.19094340822510417 + 0.40884903909097214im], [-0.004168626159142291 + 0.9287292240798303im 0.1699386951846478 - 0.09989499203560895im 6.334989650913503e-10 + 3.208484866679129e-11im 8.892096226009727e-10 - 2.819053268598992e-9im; -0.0002841834472118981 + 0.0633132615144753im -0.007563494015341217 + 0.004446042295810616im -1.9617099858600107e-9 + 4.203422124260392e-10im -2.0581260654073397e-10 - 2.453908742872102e-9im; … ; -3.478875680025528e-5 + 0.007750688743782227im 0.07436244713871104 - 0.043712447289327064im 0.014623020585283615 + 0.013413179816805796im -0.05577376472888546 + 0.07837942468159467im; 0.0005068934297940697 - 0.11293093621236869im -0.07819780982730257 + 0.0459669816737821im 0.09157644455905098 + 0.08399983486845461im -0.3492823747801295 + 0.4908499990074028im], [0.04164659812182543 + 0.9328216946772814im -2.5217979232605714e-9 + 5.421315202314148e-10im 5.088205412562274e-10 - 2.5470972553343074e-10im 6.363592318023303e-10 - 2.601830875748057e-9im; 0.0030662835883516065 + 0.0686801687952497im 0.03887743223170627 - 0.04194372629683532im -0.03548859211109397 - 0.00038237880247905245im -0.010263236829186919 + 0.004629259935408482im; … ; 0.0006186339102051135 + 0.013856480076891935im -1.6951323556640974e-9 + 4.4914512820765085e-10im 0.06284571674696415 + 0.010131592466831648im 0.09098162386714868 - 0.07372946522199465im; -0.006833326406436171 - 0.15305630257108457im 0.1951863923156289 - 0.21058088804561645im -0.18777374154780999 + 0.063761955548098im 0.45229387940534127 - 0.43148271334292154im], [0.5815051389877743 - 0.5624528884614279im -2.4521198960236745e-10 - 4.069671405426689e-10im 0.08109113847987738 + 0.4885636982979433im 3.491735789395989e-10 + 5.401754599176911e-10im; 0.27850985350116847 - 0.26938484471979274im 0.6193452955616405 - 0.09498553245774177im -0.08821493468778879 - 0.5314836439169598im 1.663539200488784e-9 - 1.144387157953064e-9im; … ; 0.008189596425101114 - 0.007921275043162581im 0.0016246456696761146 - 0.00024916306233392003im -0.0034180211110797828 - 0.020593137089583987im 0.0049418529521108095 + 0.007759705863781039im; -0.04685013848147846 + 0.04531515486667697im 0.012340833860374099 - 0.001892646119229719im -0.02065903402165938 - 0.12446802107805661im 0.09598956792415728 + 0.1507229742285127im]], eigenvalues = Any[[-0.16677707596910663, 0.2642777178175984, 0.2642777178175986, 0.2642777178175991], [-0.1161321876183514, 0.07040532319333068, 0.22624813601916635, 0.22624813601916646], [-0.09588938144402245, 0.08764319966780452, 0.1731270414188579, 0.17312704141885812], [-0.04505146349601827, 0.022269526230067727, 0.09831189251377839, 0.18446409321197693]], occupation = [[2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0]], εF = nothing, optim_res =  * Status: success

 * Candidate solution
    Final objective value:     -7.852647e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 1.21e-11 ≰ 1.0e-12
    |x - x&#39;|/|x&#39;|          = 1.49e-11 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 0.00e+00 ≰ -1.0e+00
    |g(x)|                 = 8.33e-09 ≰ -1.0e+00

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    49
    f(x) calls:    66
    ∇f(x) calls:   51
)</code></pre><p>Start not too far from the solution to ensure convergence: We run first a very crude SCF to get close and then switch to Newton.</p><pre><code class="language-julia hljs">scfres_start = self_consistent_field(basis; tol=1e-1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3929410101350789 0.37964956251034165 … 0.345159501735629 0.37964956251034165; 0.3796495625103417 0.3670898049017776 … 0.3281372753664465 0.3648317059579433; … ; 0.345159501735629 0.3281372753664464 … 0.3066775259048511 0.33422898048191385; 0.37964956251034165 0.3648317059579433 … 0.33422898048191385 0.3670898049017776;;; 0.37964956251034165 0.36708980490177756 … 0.3281372753664465 0.3648317059579433; 0.36708980490177756 0.3510425107199827 … 0.31204790084642625 0.3528561363073317; … ; 0.32813727536644643 0.3120479008464262 … 0.29779874992267963 0.3217201361297791; 0.36483170595794334 0.3528561363073317 … 0.3217201361297791 0.35285613630733176;;; 0.345159501735629 0.33422898048191385 … 0.28725804783615205 0.3281372753664465; 0.33422898048191385 0.31791965161035746 … 0.278567671977459 0.3217201361297791; … ; 0.287258047836152 0.27856767197745896 … 0.25584341864825055 0.27856767197745913; 0.3281372753664465 0.3217201361297791 … 0.2785676719774591 0.31204790084642636;;; … ;;; 0.304514309913813 0.283126507967621 … 0.28425660581065293 0.30007495935474315; 0.283126507967621 0.2594132934663595 … 0.27151178975178264 0.28492200910556964; … ; 0.2842566058106529 0.27151178975178253 … 0.27582995769757485 0.2798714756224445; 0.3000749593547431 0.2849220091055696 … 0.2798714756224445 0.2919025304680111;;; 0.34515950173562904 0.3281372753664465 … 0.30667752590485103 0.3342289804819138; 0.3281372753664465 0.31204790084642625 … 0.2977987499226796 0.3217201361297791; … ; 0.306677525904851 0.2977987499226795 … 0.27582995769757485 0.2919746308458946; 0.3342289804819138 0.3217201361297791 … 0.2919746308458946 0.31791965161035746;;; 0.37964956251034165 0.3648317059579433 … 0.33422898048191385 0.36708980490177756; 0.3648317059579433 0.3528561363073317 … 0.3217201361297791 0.3528561363073317; … ; 0.33422898048191374 0.321720136129779 … 0.2919746308458945 0.3179196516103574; 0.36708980490177756 0.3528561363073317 … 0.31791965161035746 0.35104251071998277]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5045015710337306 -0.49774209518280216 … -0.47791752696327316 -0.49774209518280216; -0.49774209518280216 -0.485729034650366 … -0.47718123953205976 -0.49309304735976; … ; -0.47791752696327316 -0.47718123953205976 … -0.41218953419176074 -0.4555292594345703; -0.49774209518280216 -0.49309304735976 … -0.4555292594345703 -0.485729034650366;;; -0.49774209518280216 -0.485729034650366 … -0.47718123953205976 -0.49309304735976; -0.48572903465036593 -0.459085720463692 … -0.4714670507953435 -0.4871150278536812; … ; -0.47718123953205976 -0.4714670507953435 … -0.44642419575132886 -0.46945043933403696; -0.49309304735976 -0.4871150278536812 … -0.46945043933403696 -0.48711502785368127;;; -0.47791752696327316 -0.4555292594345703 … -0.46122376567948264 -0.47718123953205976; -0.4555292594345703 -0.4092901770352364 … -0.4572986495793251 -0.46945043933403696; … ; -0.46122376567948264 -0.4572986495793251 … -0.4453101341174713 -0.4572986495793251; -0.47718123953205976 -0.46945043933403696 … -0.4572986495793251 -0.4714670507953435;;; … ;;; -0.44957117109439715 -0.4554452281359198 … -0.3704494020824341 -0.4174960437247207; -0.4554452281359198 -0.44928450875130077 … -0.4167150057463338 -0.4440328130072813; … ; -0.37044940208243404 -0.4167150057463338 … -0.25279526825947907 -0.29897341506963904; -0.41749604372472066 -0.4440328130072813 … -0.29897341506963904 -0.3605991330406794;;; -0.47791752696327316 -0.47718123953205976 … -0.4121895341917608 -0.4555292594345703; -0.47718123953205976 -0.47146705079534357 … -0.4464241957513288 -0.46945043933403696; … ; -0.41218953419176074 -0.4464241957513288 … -0.2527952682594791 -0.34075423980396974; -0.4555292594345703 -0.46945043933403696 … -0.34075423980396974 -0.4092901770352364;;; -0.49774209518280216 -0.49309304735976 … -0.4555292594345703 -0.485729034650366; -0.49309304735976 -0.4871150278536812 … -0.46945043933403696 -0.4871150278536812; … ; -0.4555292594345703 -0.46945043933403696 … -0.34075423980396974 -0.4092901770352364; -0.48572903465036593 -0.4871150278536812 … -0.4092901770352364 -0.459085720463692])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127219268862197 -0.48679014062371234 … -0.7029770471520695 -0.48679014062371245; -0.48679014062371206 -0.7747098567262312 … -0.41365812856040807 -0.38220032264743303; … ; -0.7029770471520698 -0.4136581285604084 … -2.3975048894195945 -1.2964174875580818; -0.486790140623712 -0.3822003226474329 … -1.296417487558082 -0.7747098567262309;;; -0.48679014062371223 -0.7747098567262312 … -0.41365812856040807 -0.3822003226474333; -0.7747098567262309 -1.482145413638454 … -0.3245417171370676 -0.44991632929062086; … ; -0.41365812856040823 -0.324541717137068 … -1.0118255364163788 -0.6375896888210185; -0.3822003226474328 -0.44991632929062086 … -0.6375896888210183 -0.44991632929062075;;; -0.7029770471520695 -1.2964174875580823 … -0.2981902375601758 -0.4136581285604083; -1.296417487558082 -2.9205927844026203 … -0.3537995727656692 -0.6375896888210183; … ; -0.2981902375601758 -0.3537995727656698 … -0.49059622469603226 -0.35379957276566953; -0.41365812856040807 -0.6375896888210183 … -0.353799572765669 -0.3245417171370675;;; … ;;; -1.0171300808844932 -0.5334932312357872 … -3.636635523094284 -1.9993930017362516; -0.533493231235787 -0.3217932679838535 … -1.4671321473179626 -0.9065927953764428; … ; -3.6366355230942835 -1.4671321473179628 … -10.988646540881431 -8.087890890379565; -1.9993930017362511 -0.9065927953764428 … -8.087890890379565 -4.648594267339573;;; -0.7029770471520695 -0.41365812856040807 … -2.3975048894195954 -1.296417487558082; -0.41365812856040796 -0.32454171713706786 … -1.0118255364163788 -0.6375896888210183; … ; -2.3975048894195954 -1.011825536416379 … -11.003274907290537 -6.078151684521537; -1.2964174875580818 -0.6375896888210182 … -6.078151684521537 -2.9205927844026203;;; -0.4867901406237123 -0.3822003226474332 … -1.296417487558082 -0.7747098567262312; -0.382200322647433 -0.4499163292906209 … -0.6375896888210182 -0.44991632929062086; … ; -1.296417487558082 -0.6375896888210185 … -6.078151684521536 -2.9205927844026203; -0.7747098567262307 -0.4499163292906207 … -2.9205927844026203 -1.482145413638454]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3929410101350789 0.37964956251034165 … 0.345159501735629 0.37964956251034165; 0.3796495625103417 0.3670898049017776 … 0.3281372753664465 0.3648317059579433; … ; 0.345159501735629 0.3281372753664464 … 0.3066775259048511 0.33422898048191385; 0.37964956251034165 0.3648317059579433 … 0.33422898048191385 0.3670898049017776;;; 0.37964956251034165 0.36708980490177756 … 0.3281372753664465 0.3648317059579433; 0.36708980490177756 0.3510425107199827 … 0.31204790084642625 0.3528561363073317; … ; 0.32813727536644643 0.3120479008464262 … 0.29779874992267963 0.3217201361297791; 0.36483170595794334 0.3528561363073317 … 0.3217201361297791 0.35285613630733176;;; 0.345159501735629 0.33422898048191385 … 0.28725804783615205 0.3281372753664465; 0.33422898048191385 0.31791965161035746 … 0.278567671977459 0.3217201361297791; … ; 0.287258047836152 0.27856767197745896 … 0.25584341864825055 0.27856767197745913; 0.3281372753664465 0.3217201361297791 … 0.2785676719774591 0.31204790084642636;;; … ;;; 0.304514309913813 0.283126507967621 … 0.28425660581065293 0.30007495935474315; 0.283126507967621 0.2594132934663595 … 0.27151178975178264 0.28492200910556964; … ; 0.2842566058106529 0.27151178975178253 … 0.27582995769757485 0.2798714756224445; 0.3000749593547431 0.2849220091055696 … 0.2798714756224445 0.2919025304680111;;; 0.34515950173562904 0.3281372753664465 … 0.30667752590485103 0.3342289804819138; 0.3281372753664465 0.31204790084642625 … 0.2977987499226796 0.3217201361297791; … ; 0.306677525904851 0.2977987499226795 … 0.27582995769757485 0.2919746308458946; 0.3342289804819138 0.3217201361297791 … 0.2919746308458946 0.31791965161035746;;; 0.37964956251034165 0.3648317059579433 … 0.33422898048191385 0.36708980490177756; 0.3648317059579433 0.3528561363073317 … 0.3217201361297791 0.3528561363073317; … ; 0.33422898048191374 0.321720136129779 … 0.2919746308458945 0.3179196516103574; 0.36708980490177756 0.3528561363073317 … 0.31791965161035746 0.35104251071998277]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5045015710337306 -0.49774209518280216 … -0.47791752696327316 -0.49774209518280216; -0.49774209518280216 -0.485729034650366 … -0.47718123953205976 -0.49309304735976; … ; -0.47791752696327316 -0.47718123953205976 … -0.41218953419176074 -0.4555292594345703; -0.49774209518280216 -0.49309304735976 … -0.4555292594345703 -0.485729034650366;;; -0.49774209518280216 -0.485729034650366 … -0.47718123953205976 -0.49309304735976; -0.48572903465036593 -0.459085720463692 … -0.4714670507953435 -0.4871150278536812; … ; -0.47718123953205976 -0.4714670507953435 … -0.44642419575132886 -0.46945043933403696; -0.49309304735976 -0.4871150278536812 … -0.46945043933403696 -0.48711502785368127;;; -0.47791752696327316 -0.4555292594345703 … -0.46122376567948264 -0.47718123953205976; -0.4555292594345703 -0.4092901770352364 … -0.4572986495793251 -0.46945043933403696; … ; -0.46122376567948264 -0.4572986495793251 … -0.4453101341174713 -0.4572986495793251; -0.47718123953205976 -0.46945043933403696 … -0.4572986495793251 -0.4714670507953435;;; … ;;; -0.44957117109439715 -0.4554452281359198 … -0.3704494020824341 -0.4174960437247207; -0.4554452281359198 -0.44928450875130077 … -0.4167150057463338 -0.4440328130072813; … ; -0.37044940208243404 -0.4167150057463338 … -0.25279526825947907 -0.29897341506963904; -0.41749604372472066 -0.4440328130072813 … -0.29897341506963904 -0.3605991330406794;;; -0.47791752696327316 -0.47718123953205976 … -0.4121895341917608 -0.4555292594345703; -0.47718123953205976 -0.47146705079534357 … -0.4464241957513288 -0.46945043933403696; … ; -0.41218953419176074 -0.4464241957513288 … -0.2527952682594791 -0.34075423980396974; -0.4555292594345703 -0.46945043933403696 … -0.34075423980396974 -0.4092901770352364;;; -0.49774209518280216 -0.49309304735976 … -0.4555292594345703 -0.485729034650366; -0.49309304735976 -0.4871150278536812 … -0.46945043933403696 -0.4871150278536812; … ; -0.4555292594345703 -0.46945043933403696 … -0.34075423980396974 -0.4092901770352364; -0.48572903465036593 -0.4871150278536812 … -0.4092901770352364 -0.459085720463692])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127219268862197 -0.48679014062371234 … -0.7029770471520695 -0.48679014062371245; -0.48679014062371206 -0.7747098567262312 … -0.41365812856040807 -0.38220032264743303; … ; -0.7029770471520698 -0.4136581285604084 … -2.3975048894195945 -1.2964174875580818; -0.486790140623712 -0.3822003226474329 … -1.296417487558082 -0.7747098567262309;;; -0.48679014062371223 -0.7747098567262312 … -0.41365812856040807 -0.3822003226474333; -0.7747098567262309 -1.482145413638454 … -0.3245417171370676 -0.44991632929062086; … ; -0.41365812856040823 -0.324541717137068 … -1.0118255364163788 -0.6375896888210185; -0.3822003226474328 -0.44991632929062086 … -0.6375896888210183 -0.44991632929062075;;; -0.7029770471520695 -1.2964174875580823 … -0.2981902375601758 -0.4136581285604083; -1.296417487558082 -2.9205927844026203 … -0.3537995727656692 -0.6375896888210183; … ; -0.2981902375601758 -0.3537995727656698 … -0.49059622469603226 -0.35379957276566953; -0.41365812856040807 -0.6375896888210183 … -0.353799572765669 -0.3245417171370675;;; … ;;; -1.0171300808844932 -0.5334932312357872 … -3.636635523094284 -1.9993930017362516; -0.533493231235787 -0.3217932679838535 … -1.4671321473179626 -0.9065927953764428; … ; -3.6366355230942835 -1.4671321473179628 … -10.988646540881431 -8.087890890379565; -1.9993930017362511 -0.9065927953764428 … -8.087890890379565 -4.648594267339573;;; -0.7029770471520695 -0.41365812856040807 … -2.3975048894195954 -1.296417487558082; -0.41365812856040796 -0.32454171713706786 … -1.0118255364163788 -0.6375896888210183; … ; -2.3975048894195954 -1.011825536416379 … -11.003274907290537 -6.078151684521537; -1.2964174875580818 -0.6375896888210182 … -6.078151684521537 -2.9205927844026203;;; -0.4867901406237123 -0.3822003226474332 … -1.296417487558082 -0.7747098567262312; -0.382200322647433 -0.4499163292906209 … -0.6375896888210182 -0.44991632929062086; … ; -1.296417487558082 -0.6375896888210185 … -6.078151684521536 -2.9205927844026203; -0.7747098567262307 -0.4499163292906207 … -2.9205927844026203 -1.482145413638454]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3929410101350789 0.37964956251034165 … 0.345159501735629 0.37964956251034165; 0.3796495625103417 0.3670898049017776 … 0.3281372753664465 0.3648317059579433; … ; 0.345159501735629 0.3281372753664464 … 0.3066775259048511 0.33422898048191385; 0.37964956251034165 0.3648317059579433 … 0.33422898048191385 0.3670898049017776;;; 0.37964956251034165 0.36708980490177756 … 0.3281372753664465 0.3648317059579433; 0.36708980490177756 0.3510425107199827 … 0.31204790084642625 0.3528561363073317; … ; 0.32813727536644643 0.3120479008464262 … 0.29779874992267963 0.3217201361297791; 0.36483170595794334 0.3528561363073317 … 0.3217201361297791 0.35285613630733176;;; 0.345159501735629 0.33422898048191385 … 0.28725804783615205 0.3281372753664465; 0.33422898048191385 0.31791965161035746 … 0.278567671977459 0.3217201361297791; … ; 0.287258047836152 0.27856767197745896 … 0.25584341864825055 0.27856767197745913; 0.3281372753664465 0.3217201361297791 … 0.2785676719774591 0.31204790084642636;;; … ;;; 0.304514309913813 0.283126507967621 … 0.28425660581065293 0.30007495935474315; 0.283126507967621 0.2594132934663595 … 0.27151178975178264 0.28492200910556964; … ; 0.2842566058106529 0.27151178975178253 … 0.27582995769757485 0.2798714756224445; 0.3000749593547431 0.2849220091055696 … 0.2798714756224445 0.2919025304680111;;; 0.34515950173562904 0.3281372753664465 … 0.30667752590485103 0.3342289804819138; 0.3281372753664465 0.31204790084642625 … 0.2977987499226796 0.3217201361297791; … ; 0.306677525904851 0.2977987499226795 … 0.27582995769757485 0.2919746308458946; 0.3342289804819138 0.3217201361297791 … 0.2919746308458946 0.31791965161035746;;; 0.37964956251034165 0.3648317059579433 … 0.33422898048191385 0.36708980490177756; 0.3648317059579433 0.3528561363073317 … 0.3217201361297791 0.3528561363073317; … ; 0.33422898048191374 0.321720136129779 … 0.2919746308458945 0.3179196516103574; 0.36708980490177756 0.3528561363073317 … 0.31791965161035746 0.35104251071998277]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5045015710337306 -0.49774209518280216 … -0.47791752696327316 -0.49774209518280216; -0.49774209518280216 -0.485729034650366 … -0.47718123953205976 -0.49309304735976; … ; -0.47791752696327316 -0.47718123953205976 … -0.41218953419176074 -0.4555292594345703; -0.49774209518280216 -0.49309304735976 … -0.4555292594345703 -0.485729034650366;;; -0.49774209518280216 -0.485729034650366 … -0.47718123953205976 -0.49309304735976; -0.48572903465036593 -0.459085720463692 … -0.4714670507953435 -0.4871150278536812; … ; -0.47718123953205976 -0.4714670507953435 … -0.44642419575132886 -0.46945043933403696; -0.49309304735976 -0.4871150278536812 … -0.46945043933403696 -0.48711502785368127;;; -0.47791752696327316 -0.4555292594345703 … -0.46122376567948264 -0.47718123953205976; -0.4555292594345703 -0.4092901770352364 … -0.4572986495793251 -0.46945043933403696; … ; -0.46122376567948264 -0.4572986495793251 … -0.4453101341174713 -0.4572986495793251; -0.47718123953205976 -0.46945043933403696 … -0.4572986495793251 -0.4714670507953435;;; … ;;; -0.44957117109439715 -0.4554452281359198 … -0.3704494020824341 -0.4174960437247207; -0.4554452281359198 -0.44928450875130077 … -0.4167150057463338 -0.4440328130072813; … ; -0.37044940208243404 -0.4167150057463338 … -0.25279526825947907 -0.29897341506963904; -0.41749604372472066 -0.4440328130072813 … -0.29897341506963904 -0.3605991330406794;;; -0.47791752696327316 -0.47718123953205976 … -0.4121895341917608 -0.4555292594345703; -0.47718123953205976 -0.47146705079534357 … -0.4464241957513288 -0.46945043933403696; … ; -0.41218953419176074 -0.4464241957513288 … -0.2527952682594791 -0.34075423980396974; -0.4555292594345703 -0.46945043933403696 … -0.34075423980396974 -0.4092901770352364;;; -0.49774209518280216 -0.49309304735976 … -0.4555292594345703 -0.485729034650366; -0.49309304735976 -0.4871150278536812 … -0.46945043933403696 -0.4871150278536812; … ; -0.4555292594345703 -0.46945043933403696 … -0.34075423980396974 -0.4092901770352364; -0.48572903465036593 -0.4871150278536812 … -0.4092901770352364 -0.459085720463692])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127219268862197 -0.48679014062371234 … -0.7029770471520695 -0.48679014062371245; -0.48679014062371206 -0.7747098567262312 … -0.41365812856040807 -0.38220032264743303; … ; -0.7029770471520698 -0.4136581285604084 … -2.3975048894195945 -1.2964174875580818; -0.486790140623712 -0.3822003226474329 … -1.296417487558082 -0.7747098567262309;;; -0.48679014062371223 -0.7747098567262312 … -0.41365812856040807 -0.3822003226474333; -0.7747098567262309 -1.482145413638454 … -0.3245417171370676 -0.44991632929062086; … ; -0.41365812856040823 -0.324541717137068 … -1.0118255364163788 -0.6375896888210185; -0.3822003226474328 -0.44991632929062086 … -0.6375896888210183 -0.44991632929062075;;; -0.7029770471520695 -1.2964174875580823 … -0.2981902375601758 -0.4136581285604083; -1.296417487558082 -2.9205927844026203 … -0.3537995727656692 -0.6375896888210183; … ; -0.2981902375601758 -0.3537995727656698 … -0.49059622469603226 -0.35379957276566953; -0.41365812856040807 -0.6375896888210183 … -0.353799572765669 -0.3245417171370675;;; … ;;; -1.0171300808844932 -0.5334932312357872 … -3.636635523094284 -1.9993930017362516; -0.533493231235787 -0.3217932679838535 … -1.4671321473179626 -0.9065927953764428; … ; -3.6366355230942835 -1.4671321473179628 … -10.988646540881431 -8.087890890379565; -1.9993930017362511 -0.9065927953764428 … -8.087890890379565 -4.648594267339573;;; -0.7029770471520695 -0.41365812856040807 … -2.3975048894195954 -1.296417487558082; -0.41365812856040796 -0.32454171713706786 … -1.0118255364163788 -0.6375896888210183; … ; -2.3975048894195954 -1.011825536416379 … -11.003274907290537 -6.078151684521537; -1.2964174875580818 -0.6375896888210182 … -6.078151684521537 -2.9205927844026203;;; -0.4867901406237123 -0.3822003226474332 … -1.296417487558082 -0.7747098567262312; -0.382200322647433 -0.4499163292906209 … -0.6375896888210182 -0.44991632929062086; … ; -1.296417487558082 -0.6375896888210185 … -6.078151684521536 -2.9205927844026203; -0.7747098567262307 -0.4499163292906207 … -2.9205927844026203 -1.482145413638454]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3929410101350789 0.37964956251034165 … 0.345159501735629 0.37964956251034165; 0.3796495625103417 0.3670898049017776 … 0.3281372753664465 0.3648317059579433; … ; 0.345159501735629 0.3281372753664464 … 0.3066775259048511 0.33422898048191385; 0.37964956251034165 0.3648317059579433 … 0.33422898048191385 0.3670898049017776;;; 0.37964956251034165 0.36708980490177756 … 0.3281372753664465 0.3648317059579433; 0.36708980490177756 0.3510425107199827 … 0.31204790084642625 0.3528561363073317; … ; 0.32813727536644643 0.3120479008464262 … 0.29779874992267963 0.3217201361297791; 0.36483170595794334 0.3528561363073317 … 0.3217201361297791 0.35285613630733176;;; 0.345159501735629 0.33422898048191385 … 0.28725804783615205 0.3281372753664465; 0.33422898048191385 0.31791965161035746 … 0.278567671977459 0.3217201361297791; … ; 0.287258047836152 0.27856767197745896 … 0.25584341864825055 0.27856767197745913; 0.3281372753664465 0.3217201361297791 … 0.2785676719774591 0.31204790084642636;;; … ;;; 0.304514309913813 0.283126507967621 … 0.28425660581065293 0.30007495935474315; 0.283126507967621 0.2594132934663595 … 0.27151178975178264 0.28492200910556964; … ; 0.2842566058106529 0.27151178975178253 … 0.27582995769757485 0.2798714756224445; 0.3000749593547431 0.2849220091055696 … 0.2798714756224445 0.2919025304680111;;; 0.34515950173562904 0.3281372753664465 … 0.30667752590485103 0.3342289804819138; 0.3281372753664465 0.31204790084642625 … 0.2977987499226796 0.3217201361297791; … ; 0.306677525904851 0.2977987499226795 … 0.27582995769757485 0.2919746308458946; 0.3342289804819138 0.3217201361297791 … 0.2919746308458946 0.31791965161035746;;; 0.37964956251034165 0.3648317059579433 … 0.33422898048191385 0.36708980490177756; 0.3648317059579433 0.3528561363073317 … 0.3217201361297791 0.3528561363073317; … ; 0.33422898048191374 0.321720136129779 … 0.2919746308458945 0.3179196516103574; 0.36708980490177756 0.3528561363073317 … 0.31791965161035746 0.35104251071998277]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5045015710337306 -0.49774209518280216 … -0.47791752696327316 -0.49774209518280216; -0.49774209518280216 -0.485729034650366 … -0.47718123953205976 -0.49309304735976; … ; -0.47791752696327316 -0.47718123953205976 … -0.41218953419176074 -0.4555292594345703; -0.49774209518280216 -0.49309304735976 … -0.4555292594345703 -0.485729034650366;;; -0.49774209518280216 -0.485729034650366 … -0.47718123953205976 -0.49309304735976; -0.48572903465036593 -0.459085720463692 … -0.4714670507953435 -0.4871150278536812; … ; -0.47718123953205976 -0.4714670507953435 … -0.44642419575132886 -0.46945043933403696; -0.49309304735976 -0.4871150278536812 … -0.46945043933403696 -0.48711502785368127;;; -0.47791752696327316 -0.4555292594345703 … -0.46122376567948264 -0.47718123953205976; -0.4555292594345703 -0.4092901770352364 … -0.4572986495793251 -0.46945043933403696; … ; -0.46122376567948264 -0.4572986495793251 … -0.4453101341174713 -0.4572986495793251; -0.47718123953205976 -0.46945043933403696 … -0.4572986495793251 -0.4714670507953435;;; … ;;; -0.44957117109439715 -0.4554452281359198 … -0.3704494020824341 -0.4174960437247207; -0.4554452281359198 -0.44928450875130077 … -0.4167150057463338 -0.4440328130072813; … ; -0.37044940208243404 -0.4167150057463338 … -0.25279526825947907 -0.29897341506963904; -0.41749604372472066 -0.4440328130072813 … -0.29897341506963904 -0.3605991330406794;;; -0.47791752696327316 -0.47718123953205976 … -0.4121895341917608 -0.4555292594345703; -0.47718123953205976 -0.47146705079534357 … -0.4464241957513288 -0.46945043933403696; … ; -0.41218953419176074 -0.4464241957513288 … -0.2527952682594791 -0.34075423980396974; -0.4555292594345703 -0.46945043933403696 … -0.34075423980396974 -0.4092901770352364;;; -0.49774209518280216 -0.49309304735976 … -0.4555292594345703 -0.485729034650366; -0.49309304735976 -0.4871150278536812 … -0.46945043933403696 -0.4871150278536812; … ; -0.4555292594345703 -0.46945043933403696 … -0.34075423980396974 -0.4092901770352364; -0.48572903465036593 -0.4871150278536812 … -0.4092901770352364 -0.459085720463692])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127219268862197 -0.48679014062371234 … -0.7029770471520695 -0.48679014062371245; -0.48679014062371206 -0.7747098567262312 … -0.41365812856040807 -0.38220032264743303; … ; -0.7029770471520698 -0.4136581285604084 … -2.3975048894195945 -1.2964174875580818; -0.486790140623712 -0.3822003226474329 … -1.296417487558082 -0.7747098567262309;;; -0.48679014062371223 -0.7747098567262312 … -0.41365812856040807 -0.3822003226474333; -0.7747098567262309 -1.482145413638454 … -0.3245417171370676 -0.44991632929062086; … ; -0.41365812856040823 -0.324541717137068 … -1.0118255364163788 -0.6375896888210185; -0.3822003226474328 -0.44991632929062086 … -0.6375896888210183 -0.44991632929062075;;; -0.7029770471520695 -1.2964174875580823 … -0.2981902375601758 -0.4136581285604083; -1.296417487558082 -2.9205927844026203 … -0.3537995727656692 -0.6375896888210183; … ; -0.2981902375601758 -0.3537995727656698 … -0.49059622469603226 -0.35379957276566953; -0.41365812856040807 -0.6375896888210183 … -0.353799572765669 -0.3245417171370675;;; … ;;; -1.0171300808844932 -0.5334932312357872 … -3.636635523094284 -1.9993930017362516; -0.533493231235787 -0.3217932679838535 … -1.4671321473179626 -0.9065927953764428; … ; -3.6366355230942835 -1.4671321473179628 … -10.988646540881431 -8.087890890379565; -1.9993930017362511 -0.9065927953764428 … -8.087890890379565 -4.648594267339573;;; -0.7029770471520695 -0.41365812856040807 … -2.3975048894195954 -1.296417487558082; -0.41365812856040796 -0.32454171713706786 … -1.0118255364163788 -0.6375896888210183; … ; -2.3975048894195954 -1.011825536416379 … -11.003274907290537 -6.078151684521537; -1.2964174875580818 -0.6375896888210182 … -6.078151684521537 -2.9205927844026203;;; -0.4867901406237123 -0.3822003226474332 … -1.296417487558082 -0.7747098567262312; -0.382200322647433 -0.4499163292906209 … -0.6375896888210182 -0.44991632929062086; … ; -1.296417487558082 -0.6375896888210185 … -6.078151684521536 -2.9205927844026203; -0.7747098567262307 -0.4499163292906207 … -2.9205927844026203 -1.482145413638454]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852334684837407), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09202569405817347 0.08809465106403169 … 0.07722701098116444 0.08809465106403168; 0.08809465106403168 0.08139313586942201 … 0.07684198351548391 0.08545831453269921; … ; 0.07722701098116443 0.07684198351548391 … 0.04774746972418529 0.06609503764882002; 0.08809465106403168 0.08545831453269921 … 0.06609503764882002 0.08139313586942201;;; 0.08809465106403168 0.08139313586942201 … 0.07684198351548392 0.08545831453269921; 0.081393135869422 0.06778505677523901 … 0.07389819369319746 0.08214796492810991; … ; 0.07684198351548391 0.07389819369319746 … 0.061899645478693345 0.07287791561444469; 0.0854583145326992 0.08214796492810991 … 0.07287791561444469 0.08214796492810993;;; 0.07722701098116444 0.06609503764882003 … 0.06881509170265772 0.07684198351548391; 0.06609503764882002 0.04666180883440105 … 0.06693221136185112 0.07287791561444468; … ; 0.06881509170265772 0.06693221136185112 … 0.0613991272942164 0.06693221136185112; 0.0768419835154839 0.07287791561444469 … 0.06693221136185112 0.07389819369319746;;; … ;;; 0.06332851312787982 0.06605545735481083 … 0.03369900990426249 0.049778927557600224; 0.06605545735481082 0.06319743426992815 … 0.04947629493671209 0.06082866497444073; … ; 0.03369900990426248 0.04947629493671209 … 0.009587815896629043 0.016679410548853853; 0.0497789275576002 0.06082866497444073 … 0.016679410548853853 0.03085552463504068;;; 0.07722701098116444 0.07684198351548392 … 0.0477474697241853 0.06609503764882003; 0.07684198351548391 0.07389819369319747 … 0.06189964547869333 0.07287791561444468; … ; 0.04774746972418529 0.06189964547869333 … 0.009587815896629047 0.02563371034204829; 0.06609503764882002 0.07287791561444469 … 0.025633710342048283 0.04666180883440105;;; 0.08809465106403168 0.08545831453269921 … 0.06609503764882003 0.08139313586942201; 0.08545831453269921 0.08214796492810991 … 0.07287791561444468 0.08214796492810991; … ; 0.06609503764882002 0.07287791561444468 … 0.025633710342048293 0.04666180883440105; 0.081393135869422 0.08214796492810991 … 0.04666180883440104 0.06778505677523901;;;;], α = 0.8, eigenvalues = [[-0.1669184058437353, 0.26430736397051646, 0.26431575315166383, 0.2643308688309486, 0.35733199558221584, 0.35735019382610944, 0.3576686766074976], [-0.11621506726319325, 0.07029289590829034, 0.22625689780607947, 0.22625777086986082, 0.33635206041783555, 0.3933541725798928, 0.3933705043123904], [-0.09597127579981818, 0.08787681047016327, 0.1729596623972985, 0.172980401156727, 0.2914994803608591, 0.33773095740608716, 0.5339050716833855], [-0.04496769302748851, 0.0223522267030832, 0.09783018228501542, 0.1844451288344008, 0.32497639243920556, 0.5005701899636907, 0.5030989088055833]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.28999652560022915, n_iter = 2, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.5034089689490973 - 0.8130097478356859im -2.6962892279143696e-5 - 0.00017586927709763362im … -9.341496329595645e-5 + 6.734571977890012e-6im 0.0002895695273184243 - 9.715939176005011e-5im; -0.05004626461434773 - 0.08114600628195494im -0.09684707708369096 - 0.1928130142119073im … 0.09187617260679547 - 0.19838994647642183im -0.4613200166377993 + 0.08291008099903263im; … ; -0.005921921582775097 - 0.00976836918146876im 0.04752082358942726 + 0.0042676373244311975im … -0.039971512709246995 - 0.01610001500147974im -0.0860918569973139 - 0.009618621491701996im; 0.050008924429616096 + 0.08122660292401229im 0.3636067037668772 - 0.15239170925452145im … -0.4225711672377601 + 0.06277902826129694im -0.24476269532125747 - 0.1602679586671922im], [-0.7211654377698146 + 0.5862722569772867im -0.18116714198574058 - 0.07634614233023226im … 2.0896167971636333e-5 - 4.267620241922015e-5im 7.986301906976584e-5 + 0.00010926843599630854im; -0.048547702860517586 + 0.03948447640598254im 0.010472399520792815 + 0.004462142784509134im … 0.0002938314067391822 - 0.001057209308226343im -0.0001754790901279095 - 0.0003740165712010179im; … ; -0.006226695377798547 + 0.005101714923222642im -0.0787296717512878 - 0.033211667354358945im … 0.04066341133176153 + 0.013117177844011745im -0.07460616541365656 + 0.06066927633149198im; 0.08712601742511708 - 0.0708258019203975im 0.08170387529444299 + 0.03443096495418416im … 0.18089645789819053 + 0.057157974214665154im -0.32640119106424653 + 0.27097719277761884im], [-0.31925135617571193 - 0.8782688032642909im 6.055233864950927e-5 + 9.191920120757001e-5im … 0.0007228018830561722 - 0.001623093307946198im 7.351509870508792e-5 + 0.00018754465425503146im; -0.023091228367707606 - 0.06340233672622826im 0.02725146762830791 + 0.0532691506345397im … -0.0011941260099022763 + 0.003053171851972635im 0.004604566592530038 - 0.0020051410232088344im; … ; -0.0049705015554228505 - 0.013667855696175606im 4.699641966983599e-5 - 3.859259275610033e-6im … -0.003326351302248984 + 0.008362332373793909im -0.062177187136210545 + 0.005918024294584793im; 0.05200604770871413 + 0.14306304562052363im 0.130815732134534 + 0.25503674574170787im … -0.13527970392637848 + 0.35545273997151455im -0.1480944096722154 + 0.014746772679055378im], [-0.3288138679639869 - 0.7398288795243805im 0.00010445660066712054 + 0.00017550113204908217im … 0.12505840058774523 + 0.19321118260888176im 0.003662211216194225 + 0.005872257199999295im; -0.15726129601504116 - 0.35384244002237675im 0.2921092865005978 + 0.555044233438927im … -0.11806688965655145 - 0.18279692162733663im -0.003305807430679498 - 0.005223976894756201im; … ; -0.004598581680076136 - 0.010353013700447167im 0.00063737995212224 + 0.0011999745757640503im … 0.003266654995463337 + 0.005981940910493021im 0.007996714844795675 + 0.04480858642746312im; 0.02589013120515574 + 0.05832735475965666im 0.006390144699040149 + 0.012067039780561992im … 0.2063677258227105 + 0.31431385844441545im 0.09240450516522729 + 0.49401481476244463im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.1669184058437353, 0.26430736397051646, 0.26431575315166383, 0.2643308688309486, 0.35733199558221584, 0.35735019382610944, 0.3576686766074976], [-0.11621506726319325, 0.07029289590829034, 0.22625689780607947, 0.22625777086986082, 0.33635206041783555, 0.3933541725798928, 0.3933705043123904], [-0.09597127579981818, 0.08787681047016327, 0.1729596623972985, 0.172980401156727, 0.2914994803608591, 0.33773095740608716, 0.5339050716833855], [-0.04496769302748851, 0.0223522267030832, 0.09783018228501542, 0.1844451288344008, 0.32497639243920556, 0.5005701899636907, 0.5030989088055833]], X = [[-0.5034089689490973 - 0.8130097478356859im -2.6962892279143696e-5 - 0.00017586927709763362im … -9.341496329595645e-5 + 6.734571977890012e-6im 0.0002895695273184243 - 9.715939176005011e-5im; -0.05004626461434773 - 0.08114600628195494im -0.09684707708369096 - 0.1928130142119073im … 0.09187617260679547 - 0.19838994647642183im -0.4613200166377993 + 0.08291008099903263im; … ; -0.005921921582775097 - 0.00976836918146876im 0.04752082358942726 + 0.0042676373244311975im … -0.039971512709246995 - 0.01610001500147974im -0.0860918569973139 - 0.009618621491701996im; 0.050008924429616096 + 0.08122660292401229im 0.3636067037668772 - 0.15239170925452145im … -0.4225711672377601 + 0.06277902826129694im -0.24476269532125747 - 0.1602679586671922im], [-0.7211654377698146 + 0.5862722569772867im -0.18116714198574058 - 0.07634614233023226im … 2.0896167971636333e-5 - 4.267620241922015e-5im 7.986301906976584e-5 + 0.00010926843599630854im; -0.048547702860517586 + 0.03948447640598254im 0.010472399520792815 + 0.004462142784509134im … 0.0002938314067391822 - 0.001057209308226343im -0.0001754790901279095 - 0.0003740165712010179im; … ; -0.006226695377798547 + 0.005101714923222642im -0.0787296717512878 - 0.033211667354358945im … 0.04066341133176153 + 0.013117177844011745im -0.07460616541365656 + 0.06066927633149198im; 0.08712601742511708 - 0.0708258019203975im 0.08170387529444299 + 0.03443096495418416im … 0.18089645789819053 + 0.057157974214665154im -0.32640119106424653 + 0.27097719277761884im], [-0.31925135617571193 - 0.8782688032642909im 6.055233864950927e-5 + 9.191920120757001e-5im … 0.0007228018830561722 - 0.001623093307946198im 7.351509870508792e-5 + 0.00018754465425503146im; -0.023091228367707606 - 0.06340233672622826im 0.02725146762830791 + 0.0532691506345397im … -0.0011941260099022763 + 0.003053171851972635im 0.004604566592530038 - 0.0020051410232088344im; … ; -0.0049705015554228505 - 0.013667855696175606im 4.699641966983599e-5 - 3.859259275610033e-6im … -0.003326351302248984 + 0.008362332373793909im -0.062177187136210545 + 0.005918024294584793im; 0.05200604770871413 + 0.14306304562052363im 0.130815732134534 + 0.25503674574170787im … -0.13527970392637848 + 0.35545273997151455im -0.1480944096722154 + 0.014746772679055378im], [-0.3288138679639869 - 0.7398288795243805im 0.00010445660066712054 + 0.00017550113204908217im … 0.12505840058774523 + 0.19321118260888176im 0.003662211216194225 + 0.005872257199999295im; -0.15726129601504116 - 0.35384244002237675im 0.2921092865005978 + 0.555044233438927im … -0.11806688965655145 - 0.18279692162733663im -0.003305807430679498 - 0.005223976894756201im; … ; -0.004598581680076136 - 0.010353013700447167im 0.00063737995212224 + 0.0011999745757640503im … 0.003266654995463337 + 0.005981940910493021im 0.007996714844795675 + 0.04480858642746312im; 0.02589013120515574 + 0.05832735475965666im 0.006390144699040149 + 0.012067039780561992im … 0.2063677258227105 + 0.31431385844441545im 0.09240450516522729 + 0.49401481476244463im]], residual_norms = [[0.00909742066273692, 0.007230149714320767, 0.007855698647915174, 0.008679505018642546, 0.0037843075580827504, 0.005440355099595422, 0.013420240733051977], [0.003952712667494099, 0.006565020069886473, 0.0059260071520989485, 0.00597536688108021, 0.006323174329952967, 0.011260768041219142, 0.011437369678027418], [0.00592967275099893, 0.005924680094747533, 0.0045062987221494545, 0.0069225531380565095, 0.0089766338992443, 0.02478720435856947, 0.028394598301087915], [0.004672469474328571, 0.005169028442685443, 0.007834554951909095, 0.012534379768894021, 0.042845826717862336, 0.052116246563693534, 0.018657450028872327]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 0.0027310056036782093)</code></pre><p>Remove the virtual orbitals (which Newton cannot treat yet)</p><pre><code class="language-julia hljs">ψ, _ = DFTK.select_occupied_orbitals(basis, scfres_start.ψ, scfres_start.occupation)
scfres_newton = newton(basis, ψ; tol)

# Comparison of results

println(&quot;|ρ_newton - ρ_scf|  = &quot;, norm(scfres_newton.ρ - scfres_scf.ρ))
println(&quot;|ρ_newton - ρ_scfv| = &quot;, norm(scfres_newton.ρ - scfres_scfv.ρ))
println(&quot;|ρ_newton - ρ_dm|   = &quot;, norm(scfres_newton.ρ - scfres_dm.ρ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)
---   ---------------   ---------   ---------
  1   -7.852646686708                   -2.56
  2   -7.852646686730      -10.67       -5.90
  3   -7.852646686730   +    -Inf      -12.58
|ρ_newton - ρ_scf|  = 4.7208617636010375e-14
|ρ_newton - ρ_scfv| = 2.387553566330789e-13
|ρ_newton - ρ_dm|   = 6.381401275264758e-10</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scf_callbacks/">« Monitoring self-consistent field calculations</a><a class="docs-footer-nextpage" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 17 September 2022 13:12">Saturday 17 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
