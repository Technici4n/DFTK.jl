<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison of DFT solvers · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/compare_solvers/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li class="is-active"><a class="tocitem" href>Comparison of DFT solvers</a><ul class="internal"><li><a class="tocitem" href="#Density-based-self-consistent-field"><span>Density-based self-consistent field</span></a></li><li><a class="tocitem" href="#Potential-based-SCF"><span>Potential-based SCF</span></a></li><li><a class="tocitem" href="#Direct-minimization"><span>Direct minimization</span></a></li></ul></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/compare_solvers.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-of-DFT-solvers"><a class="docs-heading-anchor" href="#Comparison-of-DFT-solvers">Comparison of DFT solvers</a><a id="Comparison-of-DFT-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-DFT-solvers" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/compare_solvers.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/compare_solvers.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compare four different approaches for solving the DFT minimisation problem, namely a density-based SCF, a potential-based SCF, direct minimisation and Newton.</p><p>First we setup our problem</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra

a = 10.26  # Silicon lattice constant in Bohr
lattice = a / 2 * [[0 1 1.];
                   [1 0 1.];
                   [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=[3, 3, 3])

# Convergence we desire
tol = 1e-12
is_converged = DFTK.ScfConvergenceDensity(tol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">#506 (generic function with 1 method)</code></pre><h2 id="Density-based-self-consistent-field"><a class="docs-heading-anchor" href="#Density-based-self-consistent-field">Density-based self-consistent field</a><a id="Density-based-self-consistent-field-1"></a><a class="docs-heading-anchor-permalink" href="#Density-based-self-consistent-field" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scf = self_consistent_field(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39155563703342783 0.3785174208997239 … 0.34469960027017993 0.37851742089972396; 0.37851742089972384 0.36645844064789546 … 0.3273572817222308 0.3636495426205156; … ; 0.34469960027018 0.32735728172223066 … 0.30751926941851504 0.33438053198654905; 0.37851742089972384 0.3636495426205155 … 0.3343805319865491 0.36645844064789546;;; 0.37851742089972396 0.3664584406478955 … 0.3273572817222307 0.3636495426205155; 0.36645844064789546 0.351028863417695 … 0.31119401346056064 0.35191706634916553; … ; 0.3273572817222307 0.3111940134605605 … 0.298241228412215 0.32142600281506734; 0.3636495426205154 0.35191706634916553 … 0.3214260028150674 0.35191706634916553;;; 0.34469960027018004 0.33438053198654916 … 0.28653515376391414 0.32735728172223083; 0.3343805319865491 0.31861604776294716 … 0.27805891882346373 0.32142600281506745; … ; 0.28653515376391414 0.2780589188234636 … 0.25590185772310037 0.2780589188234636; 0.3273572817222307 0.3214260028150674 … 0.2780589188234636 0.31119401346056064;;; … ;;; 0.30487474928902 0.28303666896235796 … 0.28556433231751865 0.3009573705183875; 0.2830366689623579 0.25898431622271484 … 0.27263300128654905 0.2854141966266022; … ; 0.2855643323175186 0.27263300128654894 … 0.2771603891376782 0.28121087378377174; 0.3009573705183874 0.2854141966266021 … 0.2812108737837718 0.29308272627167087;;; 0.34469960027018004 0.32735728172223083 … 0.30751926941851515 0.33438053198654916; 0.3273572817222308 0.31119401346056064 … 0.2982412284122151 0.32142600281506745; … ; 0.30751926941851515 0.298241228412215 … 0.2771603891376782 0.2931311914702032; 0.33438053198654905 0.3214260028150674 … 0.2931311914702033 0.31861604776294716;;; 0.37851742089972396 0.3636495426205155 … 0.33438053198654916 0.3664584406478955; 0.3636495426205154 0.35191706634916553 … 0.32142600281506745 0.3519170663491656; … ; 0.33438053198654916 0.32142600281506734 … 0.2931311914702033 0.31861604776294705; 0.36645844064789546 0.35191706634916553 … 0.3186160477629471 0.351028863417695]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923121949 -0.49665655722568686 … -0.47719190096487996 -0.49665655722568686; -0.4966565572256868 -0.4848182087107269 … -0.4763804457667683 -0.49204131116941136; … ; -0.47719190096487996 -0.4763804457667683 … -0.41228807087391295 -0.4550700815561154; -0.4966565572256868 -0.49204131116941136 … -0.4550700815561154 -0.4848182087107269;;; -0.4966565572256868 -0.4848182087107269 … -0.47638044576676836 -0.49204131116941147; -0.4848182087107269 -0.45837440791485295 … -0.47065601570570675 -0.4861790251756089; … ; -0.4763804457667683 -0.47065601570570675 … -0.44639843643621063 -0.4688943963915147; -0.49204131116941147 -0.48617902517560896 … -0.4688943963915147 -0.48617902517560896;;; -0.47719190096487996 -0.4550700815561154 … -0.4605141234226577 -0.4763804457667683; -0.45507008155611534 -0.4090661824391256 … -0.4567199083211297 -0.4688943963915147; … ; -0.4605141234226577 -0.4567199083211297 … -0.4451449566034847 -0.4567199083211297; -0.4763804457667683 -0.46889439639151476 … -0.4567199083211297 -0.47065601570570675;;; … ;;; -0.449475950840908 -0.45514997220148445 … -0.37125986261790833 -0.41774571520276166; -0.45514997220148445 -0.44880351099770627 … -0.4174380107134191 -0.4441260992987758; … ; -0.3712598626179082 -0.4174380107134192 … -0.25365698328408115 -0.29979809105960736; -0.41774571520276166 -0.4441260992987758 … -0.29979809105960736 -0.36106343264802715;;; -0.47719190096487996 -0.4763804457667683 … -0.41228807087391295 -0.4550700815561154; -0.4763804457667683 -0.4706560157057068 … -0.4463984364362106 -0.46889439639151476; … ; -0.41228807087391295 -0.4463984364362106 … -0.25365698328408115 -0.34106330230084336; -0.4550700815561154 -0.46889439639151476 … -0.34106330230084336 -0.4090661824391256;;; -0.49665655722568686 -0.49204131116941147 … -0.45507008155611534 -0.4848182087107269; -0.49204131116941147 -0.48617902517560896 … -0.46889439639151476 -0.4861790251756089; … ; -0.45507008155611534 -0.4688943963915147 … -0.34106330230084336 -0.4090661824391256; -0.4848182087107269 -0.48617902517560896 … -0.4090661824391256 -0.45837440791485295])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417761498061 -0.4874266764100616 … -0.7026973955397446 -0.48742667641006143; -0.4874266764100612 -0.7738703031165485 … -0.41393901833939584 -0.38179339122075906; … ; -0.7026973955397449 -0.41393901833939617 … -2.396890218056628 -1.2941386092028402; -0.4874266764100615 -0.38179339122075956 … -1.2941386092028404 -0.7738703031165484;;; -0.4874266764100615 -0.7738703031165484 … -0.413939018339396 -0.3817933912207591; -0.773870303116548 -1.4815303728816689 … -0.32444274393778894 -0.44995655436013504; … ; -0.41393901833939617 -0.32444274393778927 … -1.0113865017682289 -0.6391785259200876; -0.38179339122075945 -0.44995655436013543 … -0.639178525920088 -0.44995655436013526;;; -0.7026973955397446 -1.2941386092028404 … -0.29832133494661994 -0.41393901833939584; -1.29413860920284 -2.9234702459028417 … -0.35179963884327103 -0.6391785259200877; … ; -0.29832133494662016 -0.3517996388432715 … -0.49060647083941666 -0.3517996388432712; -0.41393901833939617 -0.6391785259200882 … -0.351799638843271 -0.32444274393778894;;; … ;;; -1.0150481268738174 -0.5338983581177769 … -3.6380389414927556 -1.999362501979361; -0.5338983581177765 -0.32169882700832086 … -1.4639475300052354 -0.9061370442135981; … ; -3.6380389414927556 -1.4639475300052354 … -10.99362124307686 -8.086551292452924; -1.999362501979361 -0.9061370442135983 … -8.086551292452924 -4.647852558442576;;; -0.7026973955397446 -0.4139390183393959 … -2.3968902180566287 -1.2941386092028409; -0.4139390183393958 -0.32444274393778894 … -1.011386501768228 -0.6391785259200877; … ; -2.396890218056628 -1.0113865017682282 … -11.003061433402284 -6.073393711806174; -1.2941386092028404 -0.6391785259200881 … -6.073393711806176 -2.9234702459028417;;; -0.4874266764100616 -0.38179339122075917 … -1.2941386092028406 -0.7738703031165484; -0.3817933912207592 -0.44995655436013515 … -0.6391785259200877 -0.44995655436013493; … ; -1.2941386092028406 -0.639178525920088 … -6.073393711806176 -2.9234702459028417; -0.7738703031165483 -0.44995655436013543 … -2.923470245902842 -1.4815303728816684]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39155563703342783 0.3785174208997239 … 0.34469960027017993 0.37851742089972396; 0.37851742089972384 0.36645844064789546 … 0.3273572817222308 0.3636495426205156; … ; 0.34469960027018 0.32735728172223066 … 0.30751926941851504 0.33438053198654905; 0.37851742089972384 0.3636495426205155 … 0.3343805319865491 0.36645844064789546;;; 0.37851742089972396 0.3664584406478955 … 0.3273572817222307 0.3636495426205155; 0.36645844064789546 0.351028863417695 … 0.31119401346056064 0.35191706634916553; … ; 0.3273572817222307 0.3111940134605605 … 0.298241228412215 0.32142600281506734; 0.3636495426205154 0.35191706634916553 … 0.3214260028150674 0.35191706634916553;;; 0.34469960027018004 0.33438053198654916 … 0.28653515376391414 0.32735728172223083; 0.3343805319865491 0.31861604776294716 … 0.27805891882346373 0.32142600281506745; … ; 0.28653515376391414 0.2780589188234636 … 0.25590185772310037 0.2780589188234636; 0.3273572817222307 0.3214260028150674 … 0.2780589188234636 0.31119401346056064;;; … ;;; 0.30487474928902 0.28303666896235796 … 0.28556433231751865 0.3009573705183875; 0.2830366689623579 0.25898431622271484 … 0.27263300128654905 0.2854141966266022; … ; 0.2855643323175186 0.27263300128654894 … 0.2771603891376782 0.28121087378377174; 0.3009573705183874 0.2854141966266021 … 0.2812108737837718 0.29308272627167087;;; 0.34469960027018004 0.32735728172223083 … 0.30751926941851515 0.33438053198654916; 0.3273572817222308 0.31119401346056064 … 0.2982412284122151 0.32142600281506745; … ; 0.30751926941851515 0.298241228412215 … 0.2771603891376782 0.2931311914702032; 0.33438053198654905 0.3214260028150674 … 0.2931311914702033 0.31861604776294716;;; 0.37851742089972396 0.3636495426205155 … 0.33438053198654916 0.3664584406478955; 0.3636495426205154 0.35191706634916553 … 0.32142600281506745 0.3519170663491656; … ; 0.33438053198654916 0.32142600281506734 … 0.2931311914702033 0.31861604776294705; 0.36645844064789546 0.35191706634916553 … 0.3186160477629471 0.351028863417695]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923121949 -0.49665655722568686 … -0.47719190096487996 -0.49665655722568686; -0.4966565572256868 -0.4848182087107269 … -0.4763804457667683 -0.49204131116941136; … ; -0.47719190096487996 -0.4763804457667683 … -0.41228807087391295 -0.4550700815561154; -0.4966565572256868 -0.49204131116941136 … -0.4550700815561154 -0.4848182087107269;;; -0.4966565572256868 -0.4848182087107269 … -0.47638044576676836 -0.49204131116941147; -0.4848182087107269 -0.45837440791485295 … -0.47065601570570675 -0.4861790251756089; … ; -0.4763804457667683 -0.47065601570570675 … -0.44639843643621063 -0.4688943963915147; -0.49204131116941147 -0.48617902517560896 … -0.4688943963915147 -0.48617902517560896;;; -0.47719190096487996 -0.4550700815561154 … -0.4605141234226577 -0.4763804457667683; -0.45507008155611534 -0.4090661824391256 … -0.4567199083211297 -0.4688943963915147; … ; -0.4605141234226577 -0.4567199083211297 … -0.4451449566034847 -0.4567199083211297; -0.4763804457667683 -0.46889439639151476 … -0.4567199083211297 -0.47065601570570675;;; … ;;; -0.449475950840908 -0.45514997220148445 … -0.37125986261790833 -0.41774571520276166; -0.45514997220148445 -0.44880351099770627 … -0.4174380107134191 -0.4441260992987758; … ; -0.3712598626179082 -0.4174380107134192 … -0.25365698328408115 -0.29979809105960736; -0.41774571520276166 -0.4441260992987758 … -0.29979809105960736 -0.36106343264802715;;; -0.47719190096487996 -0.4763804457667683 … -0.41228807087391295 -0.4550700815561154; -0.4763804457667683 -0.4706560157057068 … -0.4463984364362106 -0.46889439639151476; … ; -0.41228807087391295 -0.4463984364362106 … -0.25365698328408115 -0.34106330230084336; -0.4550700815561154 -0.46889439639151476 … -0.34106330230084336 -0.4090661824391256;;; -0.49665655722568686 -0.49204131116941147 … -0.45507008155611534 -0.4848182087107269; -0.49204131116941147 -0.48617902517560896 … -0.46889439639151476 -0.4861790251756089; … ; -0.45507008155611534 -0.4688943963915147 … -0.34106330230084336 -0.4090661824391256; -0.4848182087107269 -0.48617902517560896 … -0.4090661824391256 -0.45837440791485295])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417761498061 -0.4874266764100616 … -0.7026973955397446 -0.48742667641006143; -0.4874266764100612 -0.7738703031165485 … -0.41393901833939584 -0.38179339122075906; … ; -0.7026973955397449 -0.41393901833939617 … -2.396890218056628 -1.2941386092028402; -0.4874266764100615 -0.38179339122075956 … -1.2941386092028404 -0.7738703031165484;;; -0.4874266764100615 -0.7738703031165484 … -0.413939018339396 -0.3817933912207591; -0.773870303116548 -1.4815303728816689 … -0.32444274393778894 -0.44995655436013504; … ; -0.41393901833939617 -0.32444274393778927 … -1.0113865017682289 -0.6391785259200876; -0.38179339122075945 -0.44995655436013543 … -0.639178525920088 -0.44995655436013526;;; -0.7026973955397446 -1.2941386092028404 … -0.29832133494661994 -0.41393901833939584; -1.29413860920284 -2.9234702459028417 … -0.35179963884327103 -0.6391785259200877; … ; -0.29832133494662016 -0.3517996388432715 … -0.49060647083941666 -0.3517996388432712; -0.41393901833939617 -0.6391785259200882 … -0.351799638843271 -0.32444274393778894;;; … ;;; -1.0150481268738174 -0.5338983581177769 … -3.6380389414927556 -1.999362501979361; -0.5338983581177765 -0.32169882700832086 … -1.4639475300052354 -0.9061370442135981; … ; -3.6380389414927556 -1.4639475300052354 … -10.99362124307686 -8.086551292452924; -1.999362501979361 -0.9061370442135983 … -8.086551292452924 -4.647852558442576;;; -0.7026973955397446 -0.4139390183393959 … -2.3968902180566287 -1.2941386092028409; -0.4139390183393958 -0.32444274393778894 … -1.011386501768228 -0.6391785259200877; … ; -2.396890218056628 -1.0113865017682282 … -11.003061433402284 -6.073393711806174; -1.2941386092028404 -0.6391785259200881 … -6.073393711806176 -2.9234702459028417;;; -0.4874266764100616 -0.38179339122075917 … -1.2941386092028406 -0.7738703031165484; -0.3817933912207592 -0.44995655436013515 … -0.6391785259200877 -0.44995655436013493; … ; -1.2941386092028406 -0.639178525920088 … -6.073393711806176 -2.9234702459028417; -0.7738703031165483 -0.44995655436013543 … -2.923470245902842 -1.4815303728816684]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39155563703342783 0.3785174208997239 … 0.34469960027017993 0.37851742089972396; 0.37851742089972384 0.36645844064789546 … 0.3273572817222308 0.3636495426205156; … ; 0.34469960027018 0.32735728172223066 … 0.30751926941851504 0.33438053198654905; 0.37851742089972384 0.3636495426205155 … 0.3343805319865491 0.36645844064789546;;; 0.37851742089972396 0.3664584406478955 … 0.3273572817222307 0.3636495426205155; 0.36645844064789546 0.351028863417695 … 0.31119401346056064 0.35191706634916553; … ; 0.3273572817222307 0.3111940134605605 … 0.298241228412215 0.32142600281506734; 0.3636495426205154 0.35191706634916553 … 0.3214260028150674 0.35191706634916553;;; 0.34469960027018004 0.33438053198654916 … 0.28653515376391414 0.32735728172223083; 0.3343805319865491 0.31861604776294716 … 0.27805891882346373 0.32142600281506745; … ; 0.28653515376391414 0.2780589188234636 … 0.25590185772310037 0.2780589188234636; 0.3273572817222307 0.3214260028150674 … 0.2780589188234636 0.31119401346056064;;; … ;;; 0.30487474928902 0.28303666896235796 … 0.28556433231751865 0.3009573705183875; 0.2830366689623579 0.25898431622271484 … 0.27263300128654905 0.2854141966266022; … ; 0.2855643323175186 0.27263300128654894 … 0.2771603891376782 0.28121087378377174; 0.3009573705183874 0.2854141966266021 … 0.2812108737837718 0.29308272627167087;;; 0.34469960027018004 0.32735728172223083 … 0.30751926941851515 0.33438053198654916; 0.3273572817222308 0.31119401346056064 … 0.2982412284122151 0.32142600281506745; … ; 0.30751926941851515 0.298241228412215 … 0.2771603891376782 0.2931311914702032; 0.33438053198654905 0.3214260028150674 … 0.2931311914702033 0.31861604776294716;;; 0.37851742089972396 0.3636495426205155 … 0.33438053198654916 0.3664584406478955; 0.3636495426205154 0.35191706634916553 … 0.32142600281506745 0.3519170663491656; … ; 0.33438053198654916 0.32142600281506734 … 0.2931311914702033 0.31861604776294705; 0.36645844064789546 0.35191706634916553 … 0.3186160477629471 0.351028863417695]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923121949 -0.49665655722568686 … -0.47719190096487996 -0.49665655722568686; -0.4966565572256868 -0.4848182087107269 … -0.4763804457667683 -0.49204131116941136; … ; -0.47719190096487996 -0.4763804457667683 … -0.41228807087391295 -0.4550700815561154; -0.4966565572256868 -0.49204131116941136 … -0.4550700815561154 -0.4848182087107269;;; -0.4966565572256868 -0.4848182087107269 … -0.47638044576676836 -0.49204131116941147; -0.4848182087107269 -0.45837440791485295 … -0.47065601570570675 -0.4861790251756089; … ; -0.4763804457667683 -0.47065601570570675 … -0.44639843643621063 -0.4688943963915147; -0.49204131116941147 -0.48617902517560896 … -0.4688943963915147 -0.48617902517560896;;; -0.47719190096487996 -0.4550700815561154 … -0.4605141234226577 -0.4763804457667683; -0.45507008155611534 -0.4090661824391256 … -0.4567199083211297 -0.4688943963915147; … ; -0.4605141234226577 -0.4567199083211297 … -0.4451449566034847 -0.4567199083211297; -0.4763804457667683 -0.46889439639151476 … -0.4567199083211297 -0.47065601570570675;;; … ;;; -0.449475950840908 -0.45514997220148445 … -0.37125986261790833 -0.41774571520276166; -0.45514997220148445 -0.44880351099770627 … -0.4174380107134191 -0.4441260992987758; … ; -0.3712598626179082 -0.4174380107134192 … -0.25365698328408115 -0.29979809105960736; -0.41774571520276166 -0.4441260992987758 … -0.29979809105960736 -0.36106343264802715;;; -0.47719190096487996 -0.4763804457667683 … -0.41228807087391295 -0.4550700815561154; -0.4763804457667683 -0.4706560157057068 … -0.4463984364362106 -0.46889439639151476; … ; -0.41228807087391295 -0.4463984364362106 … -0.25365698328408115 -0.34106330230084336; -0.4550700815561154 -0.46889439639151476 … -0.34106330230084336 -0.4090661824391256;;; -0.49665655722568686 -0.49204131116941147 … -0.45507008155611534 -0.4848182087107269; -0.49204131116941147 -0.48617902517560896 … -0.46889439639151476 -0.4861790251756089; … ; -0.45507008155611534 -0.4688943963915147 … -0.34106330230084336 -0.4090661824391256; -0.4848182087107269 -0.48617902517560896 … -0.4090661824391256 -0.45837440791485295])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417761498061 -0.4874266764100616 … -0.7026973955397446 -0.48742667641006143; -0.4874266764100612 -0.7738703031165485 … -0.41393901833939584 -0.38179339122075906; … ; -0.7026973955397449 -0.41393901833939617 … -2.396890218056628 -1.2941386092028402; -0.4874266764100615 -0.38179339122075956 … -1.2941386092028404 -0.7738703031165484;;; -0.4874266764100615 -0.7738703031165484 … -0.413939018339396 -0.3817933912207591; -0.773870303116548 -1.4815303728816689 … -0.32444274393778894 -0.44995655436013504; … ; -0.41393901833939617 -0.32444274393778927 … -1.0113865017682289 -0.6391785259200876; -0.38179339122075945 -0.44995655436013543 … -0.639178525920088 -0.44995655436013526;;; -0.7026973955397446 -1.2941386092028404 … -0.29832133494661994 -0.41393901833939584; -1.29413860920284 -2.9234702459028417 … -0.35179963884327103 -0.6391785259200877; … ; -0.29832133494662016 -0.3517996388432715 … -0.49060647083941666 -0.3517996388432712; -0.41393901833939617 -0.6391785259200882 … -0.351799638843271 -0.32444274393778894;;; … ;;; -1.0150481268738174 -0.5338983581177769 … -3.6380389414927556 -1.999362501979361; -0.5338983581177765 -0.32169882700832086 … -1.4639475300052354 -0.9061370442135981; … ; -3.6380389414927556 -1.4639475300052354 … -10.99362124307686 -8.086551292452924; -1.999362501979361 -0.9061370442135983 … -8.086551292452924 -4.647852558442576;;; -0.7026973955397446 -0.4139390183393959 … -2.3968902180566287 -1.2941386092028409; -0.4139390183393958 -0.32444274393778894 … -1.011386501768228 -0.6391785259200877; … ; -2.396890218056628 -1.0113865017682282 … -11.003061433402284 -6.073393711806174; -1.2941386092028404 -0.6391785259200881 … -6.073393711806176 -2.9234702459028417;;; -0.4874266764100616 -0.38179339122075917 … -1.2941386092028406 -0.7738703031165484; -0.3817933912207592 -0.44995655436013515 … -0.6391785259200877 -0.44995655436013493; … ; -1.2941386092028406 -0.639178525920088 … -6.073393711806176 -2.9234702459028417; -0.7738703031165483 -0.44995655436013543 … -2.923470245902842 -1.4815303728816684]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39155563703342783 0.3785174208997239 … 0.34469960027017993 0.37851742089972396; 0.37851742089972384 0.36645844064789546 … 0.3273572817222308 0.3636495426205156; … ; 0.34469960027018 0.32735728172223066 … 0.30751926941851504 0.33438053198654905; 0.37851742089972384 0.3636495426205155 … 0.3343805319865491 0.36645844064789546;;; 0.37851742089972396 0.3664584406478955 … 0.3273572817222307 0.3636495426205155; 0.36645844064789546 0.351028863417695 … 0.31119401346056064 0.35191706634916553; … ; 0.3273572817222307 0.3111940134605605 … 0.298241228412215 0.32142600281506734; 0.3636495426205154 0.35191706634916553 … 0.3214260028150674 0.35191706634916553;;; 0.34469960027018004 0.33438053198654916 … 0.28653515376391414 0.32735728172223083; 0.3343805319865491 0.31861604776294716 … 0.27805891882346373 0.32142600281506745; … ; 0.28653515376391414 0.2780589188234636 … 0.25590185772310037 0.2780589188234636; 0.3273572817222307 0.3214260028150674 … 0.2780589188234636 0.31119401346056064;;; … ;;; 0.30487474928902 0.28303666896235796 … 0.28556433231751865 0.3009573705183875; 0.2830366689623579 0.25898431622271484 … 0.27263300128654905 0.2854141966266022; … ; 0.2855643323175186 0.27263300128654894 … 0.2771603891376782 0.28121087378377174; 0.3009573705183874 0.2854141966266021 … 0.2812108737837718 0.29308272627167087;;; 0.34469960027018004 0.32735728172223083 … 0.30751926941851515 0.33438053198654916; 0.3273572817222308 0.31119401346056064 … 0.2982412284122151 0.32142600281506745; … ; 0.30751926941851515 0.298241228412215 … 0.2771603891376782 0.2931311914702032; 0.33438053198654905 0.3214260028150674 … 0.2931311914702033 0.31861604776294716;;; 0.37851742089972396 0.3636495426205155 … 0.33438053198654916 0.3664584406478955; 0.3636495426205154 0.35191706634916553 … 0.32142600281506745 0.3519170663491656; … ; 0.33438053198654916 0.32142600281506734 … 0.2931311914702033 0.31861604776294705; 0.36645844064789546 0.35191706634916553 … 0.3186160477629471 0.351028863417695]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923121949 -0.49665655722568686 … -0.47719190096487996 -0.49665655722568686; -0.4966565572256868 -0.4848182087107269 … -0.4763804457667683 -0.49204131116941136; … ; -0.47719190096487996 -0.4763804457667683 … -0.41228807087391295 -0.4550700815561154; -0.4966565572256868 -0.49204131116941136 … -0.4550700815561154 -0.4848182087107269;;; -0.4966565572256868 -0.4848182087107269 … -0.47638044576676836 -0.49204131116941147; -0.4848182087107269 -0.45837440791485295 … -0.47065601570570675 -0.4861790251756089; … ; -0.4763804457667683 -0.47065601570570675 … -0.44639843643621063 -0.4688943963915147; -0.49204131116941147 -0.48617902517560896 … -0.4688943963915147 -0.48617902517560896;;; -0.47719190096487996 -0.4550700815561154 … -0.4605141234226577 -0.4763804457667683; -0.45507008155611534 -0.4090661824391256 … -0.4567199083211297 -0.4688943963915147; … ; -0.4605141234226577 -0.4567199083211297 … -0.4451449566034847 -0.4567199083211297; -0.4763804457667683 -0.46889439639151476 … -0.4567199083211297 -0.47065601570570675;;; … ;;; -0.449475950840908 -0.45514997220148445 … -0.37125986261790833 -0.41774571520276166; -0.45514997220148445 -0.44880351099770627 … -0.4174380107134191 -0.4441260992987758; … ; -0.3712598626179082 -0.4174380107134192 … -0.25365698328408115 -0.29979809105960736; -0.41774571520276166 -0.4441260992987758 … -0.29979809105960736 -0.36106343264802715;;; -0.47719190096487996 -0.4763804457667683 … -0.41228807087391295 -0.4550700815561154; -0.4763804457667683 -0.4706560157057068 … -0.4463984364362106 -0.46889439639151476; … ; -0.41228807087391295 -0.4463984364362106 … -0.25365698328408115 -0.34106330230084336; -0.4550700815561154 -0.46889439639151476 … -0.34106330230084336 -0.4090661824391256;;; -0.49665655722568686 -0.49204131116941147 … -0.45507008155611534 -0.4848182087107269; -0.49204131116941147 -0.48617902517560896 … -0.46889439639151476 -0.4861790251756089; … ; -0.45507008155611534 -0.4688943963915147 … -0.34106330230084336 -0.4090661824391256; -0.4848182087107269 -0.48617902517560896 … -0.4090661824391256 -0.45837440791485295])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417761498061 -0.4874266764100616 … -0.7026973955397446 -0.48742667641006143; -0.4874266764100612 -0.7738703031165485 … -0.41393901833939584 -0.38179339122075906; … ; -0.7026973955397449 -0.41393901833939617 … -2.396890218056628 -1.2941386092028402; -0.4874266764100615 -0.38179339122075956 … -1.2941386092028404 -0.7738703031165484;;; -0.4874266764100615 -0.7738703031165484 … -0.413939018339396 -0.3817933912207591; -0.773870303116548 -1.4815303728816689 … -0.32444274393778894 -0.44995655436013504; … ; -0.41393901833939617 -0.32444274393778927 … -1.0113865017682289 -0.6391785259200876; -0.38179339122075945 -0.44995655436013543 … -0.639178525920088 -0.44995655436013526;;; -0.7026973955397446 -1.2941386092028404 … -0.29832133494661994 -0.41393901833939584; -1.29413860920284 -2.9234702459028417 … -0.35179963884327103 -0.6391785259200877; … ; -0.29832133494662016 -0.3517996388432715 … -0.49060647083941666 -0.3517996388432712; -0.41393901833939617 -0.6391785259200882 … -0.351799638843271 -0.32444274393778894;;; … ;;; -1.0150481268738174 -0.5338983581177769 … -3.6380389414927556 -1.999362501979361; -0.5338983581177765 -0.32169882700832086 … -1.4639475300052354 -0.9061370442135981; … ; -3.6380389414927556 -1.4639475300052354 … -10.99362124307686 -8.086551292452924; -1.999362501979361 -0.9061370442135983 … -8.086551292452924 -4.647852558442576;;; -0.7026973955397446 -0.4139390183393959 … -2.3968902180566287 -1.2941386092028409; -0.4139390183393958 -0.32444274393778894 … -1.011386501768228 -0.6391785259200877; … ; -2.396890218056628 -1.0113865017682282 … -11.003061433402284 -6.073393711806174; -1.2941386092028404 -0.6391785259200881 … -6.073393711806176 -2.9234702459028417;;; -0.4874266764100616 -0.38179339122075917 … -1.2941386092028406 -0.7738703031165484; -0.3817933912207592 -0.44995655436013515 … -0.6391785259200877 -0.44995655436013493; … ; -1.2941386092028406 -0.639178525920088 … -6.073393711806176 -2.9234702459028417; -0.7738703031165483 -0.44995655436013543 … -2.923470245902842 -1.4815303728816684]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729848), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09132316917746242 0.08747419134079377 … 0.07684754935962602 0.08747419134079377; 0.08747419134079376 0.08089966872163326 … 0.07642471016970896 0.08486944834425734; … ; 0.076847549359626 0.07642471016970896 … 0.04778466667101843 0.06587895342303085; 0.08747419134079376 0.08486944834425733 … 0.06587895342303085 0.08089966872163326;;; 0.08747419134079376 0.08089966872163327 … 0.07642471016970899 0.08486944834425737; 0.08089966872163326 0.06744471469774356 … 0.07348669934703679 0.08163768629013926; … ; 0.07642471016970896 0.07348669934703679 … 0.06188804119996354 0.07259829028446489; 0.08486944834425736 0.08163768629013925 … 0.07259829028446489 0.08163768629013925;;; 0.076847549359626 0.06587895342303085 … 0.06847203698973184 0.07642471016970896; 0.06587895342303084 0.04657864264980776 … 0.06665759371631466 0.07259829028446489; … ; 0.06847203698973181 0.06665759371631466 … 0.06132515314380715 0.06665759371631468; 0.07642471016970896 0.07259829028446488 … 0.06665759371631468 0.07348669934703679;;; … ;;; 0.06328495229885742 0.06591651445952391 … 0.03394064888051819 0.04987593485998901; 0.0659165144595239 0.06297790960105178 … 0.049756397885276325 0.06087020457146179; … ; 0.033940648880518176 0.04975639788527633 … 0.00969635321407358 0.01683133879259127; 0.04987593485998899 0.06087020457146179 … 0.016831338792591265 0.03098572188504981;;; 0.07684754935962601 0.07642471016970898 … 0.047784666671018446 0.06587895342303085; 0.07642471016970896 0.07348669934703678 … 0.06188804119996352 0.07259829028446488; … ; 0.047784666671018425 0.06188804119996352 … 0.00969635321407358 0.025710010675304838; 0.06587895342303085 0.07259829028446488 … 0.025710010675304838 0.046578642649807746;;; 0.08747419134079377 0.08486944834425737 … 0.06587895342303086 0.08089966872163327; 0.08486944834425736 0.08163768629013925 … 0.07259829028446488 0.08163768629013926; … ; 0.06587895342303084 0.07259829028446486 … 0.02571001067530484 0.04657864264980776; 0.08089966872163326 0.08163768629013925 … 0.04657864264980776 0.06744471469774357;;;;], α = 0.8, eigenvalues = [[-0.16677707596307473, 0.26427771782992754, 0.26427771782992737, 0.26427771782992765, 0.3573203719045125, 0.3573203719045128, 0.35732037190451305], [-0.11613218761083227, 0.0704053232000412, 0.22624813603023344, 0.22624813603023414, 0.33611784894601804, 0.39343797761799504, 0.39343797761799537], [-0.09588938143640079, 0.08764319967958939, 0.17312704142742494, 0.17312704142742508, 0.2919724892212971, 0.3377321250728852, 0.5327646516179597], [-0.04505146348594031, 0.022269526239816345, 0.09831189251533728, 0.18446409322117507, 0.322927015162463, 0.48024696039531284, 0.5024422334902674]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.28971208183818314, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.951356978068945 - 0.08891887240694218im -1.2584979010002883e-15 + 9.981891920299301e-16im … 5.481778870486929e-12 - 1.2863287626709262e-12im -1.000150350992316e-11 + 2.347233434931924e-12im; 0.09587223809018854 - 0.00896072820468855im 0.1732990094657924 + 0.06088791496208456im … -0.22580697794626967 - 0.411934446260444im -0.19937301455592282 + 0.12559989276869157im; … ; 0.011743079859850451 - 0.001097570568982248im -0.03389135392418315 - 0.01696618242312923im … -0.021205407394037257 - 0.04417957733286477im -0.020282067897178176 + 0.05788351229407763im; -0.09587223809018866 + 0.008960728204688405im -0.1585048587712574 - 0.10521477216582067im … 0.05108908948120078 + 0.04792528955118579im 0.0322628049501704 + 0.35132020854467627im], [-0.649839648129606 - 0.6635237602564751im -0.083079948249338 + 0.17876210922539698im … -1.2977130491417596e-12 + 1.5495993129942903e-15im 2.1856079048864996e-12 - 2.8803085840293245e-13im; -0.04430082123492424 - 0.04523369353170286im 0.0036976542984089636 - 0.007956197560278705im … 4.10454866573612e-12 - 1.907403295877587e-12im 1.3807546982866708e-11 + 1.2943536320415947e-11im; … ; -0.005423221566193507 - 0.005537422003511412im -0.03635445305300104 + 0.07822343230146539im … -0.004696903368769573 - 0.020986999954000773im 0.07654284303300006 - 0.07586100014269884im; 0.07901872619414226 + 0.08068267685100962im 0.038229491406211444 - 0.0822579294088891im … -0.019936283464158648 - 0.08908055943578279im 0.3248906129697099 - 0.32199649060641217im], [0.4145735668161556 - 0.8366716864452753im -1.0549138164296873e-15 - 6.629147169413541e-17im … -2.4359424533398595e-13 - 1.0728081616443555e-13im 7.664746305487854e-10 - 8.577498689960022e-10im; 0.030523499533188517 - 0.06160100371755507im -0.021946228415064634 + 0.05281187469340444im … -0.02479947900725757 + 0.004371575732143256im 0.008998033429828746 - 0.01577332865309756im; … ; 0.006158229866941986 - 0.012428232238388912im -7.17435487809387e-16 + 1.9378742758786302e-15im … 5.804577439053078e-14 - 1.9319564156415537e-13im -0.057291719158099524 + 0.0263377783519081im; -0.06802275024912624 + 0.1372801204009675im -0.11018230298802179 + 0.2651450567624127im … 0.37604721030938 - 0.06628844333313981im -0.13747606689653907 + 0.06710414484925675im], [-0.48783188274740347 - 0.645384794087008im 7.509077156069999e-16 - 1.2956522374909727e-15im … 0.18139789771919712 + 0.047169282356757186im -2.432135570348602e-7 + 5.513534772702704e-8im; -0.23364537493457394 - 0.3091047910651026im 0.02085478502010047 - 0.6262395105212899im … -0.17248262036077086 - 0.04485250092891014im 4.6969700196609344e-7 + 7.769382643092378e-7im; … ; -0.006870354169323013 - 0.00908924215018774im 5.4705577532578265e-5 - 0.001642730628084427im … 0.015653410275488083 + 0.004071394372744337im 0.029345329862784174 + 0.033169776011971186im; 0.039303162524179376 + 0.051996731557978314im 0.0004155443718400337 - 0.012478206021531704im … 0.1309847024431931 + 0.034069817115628516im 0.3118528959284327 + 0.35249641823587363im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596307473, 0.26427771782992754, 0.26427771782992737, 0.26427771782992765, 0.3573203719045125, 0.3573203719045128, 0.35732037190451305], [-0.11613218761083227, 0.0704053232000412, 0.22624813603023344, 0.22624813603023414, 0.33611784894601804, 0.39343797761799504, 0.39343797761799537], [-0.09588938143640079, 0.08764319967958939, 0.17312704142742494, 0.17312704142742508, 0.2919724892212971, 0.3377321250728852, 0.5327646516179597], [-0.04505146348594031, 0.022269526239816345, 0.09831189251533728, 0.18446409322117507, 0.322927015162463, 0.48024696039531284, 0.5024422334902674]], X = [[0.951356978068945 - 0.08891887240694218im -1.2584979010002883e-15 + 9.981891920299301e-16im … 5.481778870486929e-12 - 1.2863287626709262e-12im -1.000150350992316e-11 + 2.347233434931924e-12im; 0.09587223809018854 - 0.00896072820468855im 0.1732990094657924 + 0.06088791496208456im … -0.22580697794626967 - 0.411934446260444im -0.19937301455592282 + 0.12559989276869157im; … ; 0.011743079859850451 - 0.001097570568982248im -0.03389135392418315 - 0.01696618242312923im … -0.021205407394037257 - 0.04417957733286477im -0.020282067897178176 + 0.05788351229407763im; -0.09587223809018866 + 0.008960728204688405im -0.1585048587712574 - 0.10521477216582067im … 0.05108908948120078 + 0.04792528955118579im 0.0322628049501704 + 0.35132020854467627im], [-0.649839648129606 - 0.6635237602564751im -0.083079948249338 + 0.17876210922539698im … -1.2977130491417596e-12 + 1.5495993129942903e-15im 2.1856079048864996e-12 - 2.8803085840293245e-13im; -0.04430082123492424 - 0.04523369353170286im 0.0036976542984089636 - 0.007956197560278705im … 4.10454866573612e-12 - 1.907403295877587e-12im 1.3807546982866708e-11 + 1.2943536320415947e-11im; … ; -0.005423221566193507 - 0.005537422003511412im -0.03635445305300104 + 0.07822343230146539im … -0.004696903368769573 - 0.020986999954000773im 0.07654284303300006 - 0.07586100014269884im; 0.07901872619414226 + 0.08068267685100962im 0.038229491406211444 - 0.0822579294088891im … -0.019936283464158648 - 0.08908055943578279im 0.3248906129697099 - 0.32199649060641217im], [0.4145735668161556 - 0.8366716864452753im -1.0549138164296873e-15 - 6.629147169413541e-17im … -2.4359424533398595e-13 - 1.0728081616443555e-13im 7.664746305487854e-10 - 8.577498689960022e-10im; 0.030523499533188517 - 0.06160100371755507im -0.021946228415064634 + 0.05281187469340444im … -0.02479947900725757 + 0.004371575732143256im 0.008998033429828746 - 0.01577332865309756im; … ; 0.006158229866941986 - 0.012428232238388912im -7.17435487809387e-16 + 1.9378742758786302e-15im … 5.804577439053078e-14 - 1.9319564156415537e-13im -0.057291719158099524 + 0.0263377783519081im; -0.06802275024912624 + 0.1372801204009675im -0.11018230298802179 + 0.2651450567624127im … 0.37604721030938 - 0.06628844333313981im -0.13747606689653907 + 0.06710414484925675im], [-0.48783188274740347 - 0.645384794087008im 7.509077156069999e-16 - 1.2956522374909727e-15im … 0.18139789771919712 + 0.047169282356757186im -2.432135570348602e-7 + 5.513534772702704e-8im; -0.23364537493457394 - 0.3091047910651026im 0.02085478502010047 - 0.6262395105212899im … -0.17248262036077086 - 0.04485250092891014im 4.6969700196609344e-7 + 7.769382643092378e-7im; … ; -0.006870354169323013 - 0.00908924215018774im 5.4705577532578265e-5 - 0.001642730628084427im … 0.015653410275488083 + 0.004071394372744337im 0.029345329862784174 + 0.033169776011971186im; 0.039303162524179376 + 0.051996731557978314im 0.0004155443718400337 - 0.012478206021531704im … 0.1309847024431931 + 0.034069817115628516im 0.3118528959284327 + 0.35249641823587363im]], residual_norms = [[8.180495657540265e-14, 7.218391123319952e-14, 1.0040904087247068e-13, 9.064143833373491e-14, 5.217746739567563e-10, 1.730794137312749e-10, 3.1578447536430947e-10], [6.816253485363665e-14, 8.59844837112518e-14, 7.275910771407379e-14, 7.733520850361931e-14, 3.743506103439214e-13, 2.5764002770887986e-11, 4.567374045709409e-11], [9.636823575100503e-14, 3.141556603440487e-14, 3.98910546259931e-14, 3.1281947360181914e-14, 6.660193989215349e-14, 8.866630504636403e-12, 4.457405219442481e-8], [8.036714729811112e-14, 1.165816848805505e-13, 5.596432193292675e-14, 4.567952698894712e-14, 3.5992522580916566e-12, 1.0078705501817313e-5, 1.27055708389258e-6]], iterations = [2, 1, 2, 2], converged = 1, n_matvec = 73)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 3.414956459012105e-13)</code></pre><h2 id="Potential-based-SCF"><a class="docs-heading-anchor" href="#Potential-based-SCF">Potential-based SCF</a><a id="Potential-based-SCF-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-based-SCF" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scfv = DFTK.scf_potential_mixing(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417761498047 -0.4874266764100595 … -0.702697395539741 -0.4874266764100593; -0.4874266764100591 -0.7738703031165446 … -0.41393901833939384 -0.38179339122075767; … ; -0.7026973955397413 -0.41393901833939406 … -2.396890218056623 -1.2941386092028346; -0.48742667641005927 -0.3817933912207581 … -1.2941386092028349 -0.7738703031165446;;; -0.4874266764100595 -0.7738703031165446 … -0.4139390183393938 -0.38179339122075756; -0.7738703031165441 -1.4815303728816624 … -0.3244427439377875 -0.44995655436013304; … ; -0.4139390183393941 -0.3244427439377877 … -1.0113865017682249 -0.6391785259200842; -0.3817933912207577 -0.4499565543601333 … -0.6391785259200845 -0.4499565543601332;;; -0.702697395539741 -1.294138609202835 … -0.29832133494661855 -0.4139390183393937; -1.2941386092028346 -2.9234702459028346 … -0.35179963884326915 -0.6391785259200844; … ; -0.29832133494661883 -0.3517996388432695 … -0.49060647083941405 -0.35179963884326915; -0.4139390183393939 -0.6391785259200846 … -0.35179963884326887 -0.3244427439377875;;; … ;;; -1.015048126873813 -0.5338983581177739 … -3.638038941492754 -1.999362501979356; -0.5338983581177734 -0.32169882700831887 … -1.4639475300052336 -0.9061370442135945; … ; -3.638038941492754 -1.4639475300052336 … -10.993621243076857 -8.086551292452922; -1.999362501979356 -0.9061370442135945 … -8.086551292452922 -4.647852558442571;;; -0.702697395539741 -0.4139390183393939 … -2.396890218056623 -1.294138609202835; -0.4139390183393937 -0.3244427439377875 … -1.0113865017682242 -0.6391785259200842; … ; -2.396890218056623 -1.0113865017682242 … -11.003061433402282 -6.073393711806169; -1.2941386092028346 -0.6391785259200845 … -6.073393711806171 -2.9234702459028346;;; -0.4874266764100596 -0.38179339122075767 … -1.2941386092028353 -0.7738703031165445; -0.38179339122075767 -0.44995655436013304 … -0.6391785259200844 -0.449956554360133; … ; -1.2941386092028355 -0.6391785259200845 … -6.073393711806171 -2.923470245902834; -0.7738703031165444 -0.44995655436013343 … -2.9234702459028346 -1.4815303728816622])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417761498047 -0.4874266764100595 … -0.702697395539741 -0.4874266764100593; -0.4874266764100591 -0.7738703031165446 … -0.41393901833939384 -0.38179339122075767; … ; -0.7026973955397413 -0.41393901833939406 … -2.396890218056623 -1.2941386092028346; -0.48742667641005927 -0.3817933912207581 … -1.2941386092028349 -0.7738703031165446;;; -0.4874266764100595 -0.7738703031165446 … -0.4139390183393938 -0.38179339122075756; -0.7738703031165441 -1.4815303728816624 … -0.3244427439377875 -0.44995655436013304; … ; -0.4139390183393941 -0.3244427439377877 … -1.0113865017682249 -0.6391785259200842; -0.3817933912207577 -0.4499565543601333 … -0.6391785259200845 -0.4499565543601332;;; -0.702697395539741 -1.294138609202835 … -0.29832133494661855 -0.4139390183393937; -1.2941386092028346 -2.9234702459028346 … -0.35179963884326915 -0.6391785259200844; … ; -0.29832133494661883 -0.3517996388432695 … -0.49060647083941405 -0.35179963884326915; -0.4139390183393939 -0.6391785259200846 … -0.35179963884326887 -0.3244427439377875;;; … ;;; -1.015048126873813 -0.5338983581177739 … -3.638038941492754 -1.999362501979356; -0.5338983581177734 -0.32169882700831887 … -1.4639475300052336 -0.9061370442135945; … ; -3.638038941492754 -1.4639475300052336 … -10.993621243076857 -8.086551292452922; -1.999362501979356 -0.9061370442135945 … -8.086551292452922 -4.647852558442571;;; -0.702697395539741 -0.4139390183393939 … -2.396890218056623 -1.294138609202835; -0.4139390183393937 -0.3244427439377875 … -1.0113865017682242 -0.6391785259200842; … ; -2.396890218056623 -1.0113865017682242 … -11.003061433402282 -6.073393711806169; -1.2941386092028346 -0.6391785259200845 … -6.073393711806171 -2.9234702459028346;;; -0.4874266764100596 -0.38179339122075767 … -1.2941386092028353 -0.7738703031165445; -0.38179339122075767 -0.44995655436013304 … -0.6391785259200844 -0.449956554360133; … ; -1.2941386092028355 -0.6391785259200845 … -6.073393711806171 -2.923470245902834; -0.7738703031165444 -0.44995655436013343 … -2.9234702459028346 -1.4815303728816622]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.0071751917089325195 + 0.04678383430089142im -0.019049124895096484 + 0.00624166277259885im … -0.06233737779695516 + 0.06170259233367925im -0.025418948363971492 + 0.06954132705407254im; -0.026973166013339125 + 0.03608029407382705im 0.004443661661193173 + 0.010100345371752594im … 0.02954970562353814 - 0.007131736566405547im 0.0011865688976403902 - 0.01693588367587991im; … ; 0.02944456371722965 + 0.08947067729766096im 0.007623042143183882 - 0.012423637150698531im … 0.029825764976285467 + 0.01607820601770879im -0.0026722197664672213 + 0.11744540919693229im; -0.03796327597095855 + 0.049453933989578466im -0.04963300419411348 - 0.05709013009613888im … -0.10370680412277072 + 0.030175592627370594im -0.09765316150762078 + 0.10107148388005358im;;; -0.010411966198439548 - 0.027192117265080532im 0.006569124847141287 - 0.05854522148100824im … -0.02042566035201229 + 0.049997076332275944im 0.018292349035064954 + 0.038547975118150765im; 0.017098814967852784 - 0.05896874386606133im 0.018223835035503653 - 0.0583938059138521im … 0.029033089681918086 - 0.018136171285464155im 0.035752205347140895 - 0.029061303270229665im; … ; -0.060456708692404645 + 0.006557058217005808im -0.05761650738071589 - 0.0676108394529594im … -0.00784431451549456 + 0.04492616902098957im -0.04982690534600091 + 0.0676525342150179im; -0.09967330229649311 - 0.04925865592632263im -0.11508426086772872 - 0.11142799364174581im … -0.0753446307620918 + 0.05014393370000543im -0.10331090100007952 + 0.04631992143905979im;;; 0.05678638553970773 - 0.04216325231837425im 0.08090385089165927 - 0.041421097552132524im … 0.003103485405532758 + 0.026327667692448497im 0.02139756106592036 + 0.010935186553254364im; 0.035280775560722795 - 0.08004184591344085im 0.0506224757567328 - 0.05712403270678468im … 0.024270734025039896 - 0.015349060127096793im 0.029021037024879397 - 0.03554397993376411im; … ; -0.04748998662382226 - 0.03402969116341393im -0.04376364972897255 - 0.05579909831588147im … -0.026578544350912604 + 0.0210928149265429im -0.057481389014266124 + 0.012459190256346588im; -0.0420652372851401 - 0.06872918551705601im -0.004010681280451903 - 0.06008180560806434im … -0.04006504879029744 + 0.025745639749900597im -0.056047979247157556 + 0.006122911732863647im;;; … ;;; 0.008477624346770476 - 0.059492135878175735im -0.0021485330631009656 - 0.02559885396786723im … -0.03739162742185777 - 0.004649497286871506im 0.001893302370283304 - 0.06515327848663581im; 0.030254721272406294 - 0.027819202473075184im 0.006005922813914023 - 0.00698336202312897im … 0.012543773637621648 - 0.014315178743738138im 0.047612208456313435 - 0.03557428735463318im; … ; -0.01276258412642835 - 0.02892973967852757im -0.013779896458633646 - 0.012025858414110361im … 0.037921489009632034 + 0.09709566711005965im 0.0076044098810643165 - 0.00772441270129411im; -0.01823166413280418 - 0.05803577977430213im -0.010166877897580725 - 0.0321842276963149im … -0.025523388322775342 + 0.04199574954374921im -0.023352486203072086 - 0.048468865373845565im;;; 0.018266745526984242 - 0.04964928083649601im 0.0006287275071871384 + 0.007232033132400345im … 0.007944386039967416 - 0.06253101080403281im 0.049877683161167495 - 0.11956552027821919im; 0.03235195960871318 - 0.001804023100251747im -0.00855117096904194 + 0.02916304245581245im … 0.08257665154539263 - 0.014920685659064629im 0.08994661311247168 - 0.056414992769566505im; … ; -0.03737820464270396 - 0.02411954535776012im -0.017562837204087516 + 0.010139505085603366im … 0.05710940995519688 - 0.0719015511497069im -0.01218966267482757 - 0.11300759603496022im; -0.03314158062304076 - 0.06837965758643413im -0.020034712038382304 - 0.005354893877563613im … -0.008597624454622066 - 0.10012683201890384im -0.033179317657123494 - 0.15426829160727001im;;; -0.007357109648554256 + 0.056995458373531im 0.007566513034085553 + 0.04494505048589355im … -0.023924329214881794 - 0.003102995482407141im 0.016779505502719883 - 0.00574568279962164im; -0.01699883684052697 + 0.06073482814556096im -0.011951439028320958 + 0.0869423429895359im … 0.07180588533330637 + 0.0039265359323975004im 0.048055592382066435 - 0.013419455826471431im; … ; -0.002473440084001538 + 0.08674078058601023im 0.02305471554819244 + 0.03754032478604635im … 0.06468075250806657 - 0.09470438681534414im 0.005815642869430935 - 0.007956633256702487im; -0.006621335228655373 + 0.07456150515389554im 0.01369528146033033 + 0.022390129348984884im … -0.04039631332093063 - 0.07796037233820695im -0.051252157681061665 - 0.017731589520499053im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417761498047 -0.4874266764100595 … -0.702697395539741 -0.4874266764100593; -0.4874266764100591 -0.7738703031165446 … -0.41393901833939384 -0.38179339122075767; … ; -0.7026973955397413 -0.41393901833939406 … -2.396890218056623 -1.2941386092028346; -0.48742667641005927 -0.3817933912207581 … -1.2941386092028349 -0.7738703031165446;;; -0.4874266764100595 -0.7738703031165446 … -0.4139390183393938 -0.38179339122075756; -0.7738703031165441 -1.4815303728816624 … -0.3244427439377875 -0.44995655436013304; … ; -0.4139390183393941 -0.3244427439377877 … -1.0113865017682249 -0.6391785259200842; -0.3817933912207577 -0.4499565543601333 … -0.6391785259200845 -0.4499565543601332;;; -0.702697395539741 -1.294138609202835 … -0.29832133494661855 -0.4139390183393937; -1.2941386092028346 -2.9234702459028346 … -0.35179963884326915 -0.6391785259200844; … ; -0.29832133494661883 -0.3517996388432695 … -0.49060647083941405 -0.35179963884326915; -0.4139390183393939 -0.6391785259200846 … -0.35179963884326887 -0.3244427439377875;;; … ;;; -1.015048126873813 -0.5338983581177739 … -3.638038941492754 -1.999362501979356; -0.5338983581177734 -0.32169882700831887 … -1.4639475300052336 -0.9061370442135945; … ; -3.638038941492754 -1.4639475300052336 … -10.993621243076857 -8.086551292452922; -1.999362501979356 -0.9061370442135945 … -8.086551292452922 -4.647852558442571;;; -0.702697395539741 -0.4139390183393939 … -2.396890218056623 -1.294138609202835; -0.4139390183393937 -0.3244427439377875 … -1.0113865017682242 -0.6391785259200842; … ; -2.396890218056623 -1.0113865017682242 … -11.003061433402282 -6.073393711806169; -1.2941386092028346 -0.6391785259200845 … -6.073393711806171 -2.9234702459028346;;; -0.4874266764100596 -0.38179339122075767 … -1.2941386092028353 -0.7738703031165445; -0.38179339122075767 -0.44995655436013304 … -0.6391785259200844 -0.449956554360133; … ; -1.2941386092028355 -0.6391785259200845 … -6.073393711806171 -2.923470245902834; -0.7738703031165444 -0.44995655436013343 … -2.9234702459028346 -1.4815303728816622])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417761498047 -0.4874266764100595 … -0.702697395539741 -0.4874266764100593; -0.4874266764100591 -0.7738703031165446 … -0.41393901833939384 -0.38179339122075767; … ; -0.7026973955397413 -0.41393901833939406 … -2.396890218056623 -1.2941386092028346; -0.48742667641005927 -0.3817933912207581 … -1.2941386092028349 -0.7738703031165446;;; -0.4874266764100595 -0.7738703031165446 … -0.4139390183393938 -0.38179339122075756; -0.7738703031165441 -1.4815303728816624 … -0.3244427439377875 -0.44995655436013304; … ; -0.4139390183393941 -0.3244427439377877 … -1.0113865017682249 -0.6391785259200842; -0.3817933912207577 -0.4499565543601333 … -0.6391785259200845 -0.4499565543601332;;; -0.702697395539741 -1.294138609202835 … -0.29832133494661855 -0.4139390183393937; -1.2941386092028346 -2.9234702459028346 … -0.35179963884326915 -0.6391785259200844; … ; -0.29832133494661883 -0.3517996388432695 … -0.49060647083941405 -0.35179963884326915; -0.4139390183393939 -0.6391785259200846 … -0.35179963884326887 -0.3244427439377875;;; … ;;; -1.015048126873813 -0.5338983581177739 … -3.638038941492754 -1.999362501979356; -0.5338983581177734 -0.32169882700831887 … -1.4639475300052336 -0.9061370442135945; … ; -3.638038941492754 -1.4639475300052336 … -10.993621243076857 -8.086551292452922; -1.999362501979356 -0.9061370442135945 … -8.086551292452922 -4.647852558442571;;; -0.702697395539741 -0.4139390183393939 … -2.396890218056623 -1.294138609202835; -0.4139390183393937 -0.3244427439377875 … -1.0113865017682242 -0.6391785259200842; … ; -2.396890218056623 -1.0113865017682242 … -11.003061433402282 -6.073393711806169; -1.2941386092028346 -0.6391785259200845 … -6.073393711806171 -2.9234702459028346;;; -0.4874266764100596 -0.38179339122075767 … -1.2941386092028353 -0.7738703031165445; -0.38179339122075767 -0.44995655436013304 … -0.6391785259200844 -0.449956554360133; … ; -1.2941386092028355 -0.6391785259200845 … -6.073393711806171 -2.923470245902834; -0.7738703031165444 -0.44995655436013343 … -2.9234702459028346 -1.4815303728816622]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.035986194732235265 - 0.12234733861143439im 0.003935994328544126 + 0.0403170729476717im … -0.002852843496379255 - 0.07989528103464515im 0.06051446853577868 - 0.11696610251800361im; -0.002423695774191305 + 0.012288950058307178im -0.041471040863731996 + 0.09765713422517142im … 0.06334167326385504 - 0.020474757180506887im 0.0883039061651511 - 0.017762467939416073im; … ; 0.005840734428183741 - 0.06550777707718619im -0.027362824579470715 - 0.0027378683352686332im … -0.008686696012934054 - 0.014347614903225465im 0.030826455783324033 - 0.06804446253794733im; -0.003932200890417352 - 0.07899666953174675im 0.0038181869694169455 + 0.022473654890512666im … -0.02907584850751483 - 0.027613384076339748im 0.019068468976159315 - 0.07692795680469985im;;; 0.0015231741352550953 + 0.049620643760787814im -0.013704127757693956 + 0.09157457413365468im … 0.01737917789701239 - 0.05720546568316552im 0.045439156437122104 - 0.06168414349093978im; -0.03149739893842467 + 0.1106005382458509im -0.049470595318205295 + 0.13986452971661284im … 0.04012350387444243 - 0.012596507493045795im 0.03243718668302524 + 0.03462127043969008im; … ; -0.026220308327728648 - 0.00022621913651809863im -0.022753530620691746 + 0.06932674175685756im … 0.011282225014919552 - 0.012231322994364156im 0.016378357021212514 - 0.020753800588512963im; -0.02888521881346685 + 0.010200581323820939im -0.010648684881761275 + 0.10199757325554885im … -0.007240493673290672 - 0.04122790451701723im -0.002625055084051432 - 0.05002704710688094im;;; 0.0045116228689958794 + 0.05351109611756203im 0.024532488224019135 + 0.07885150504928445im … 0.0065931772330806646 - 0.01996728532579354im 0.00547469906531925 + 0.0003634149356240455im; -0.015439088185963356 + 0.10339910619873087im -0.012430370155288238 + 0.0952591517667615im … 0.009085513084309965 + 0.0005971621938980569im 4.1663399056602376e-5 + 0.04935978256078555im; … ; -0.02906437613000013 + 0.025954608892311312im -0.00959534350690409 + 0.0567617902205262im … 0.004383059923637458 - 0.004731037870734509im -0.005977983557494656 + 0.0042727984146294935im; -0.02106204909139312 + 0.03049934737971242im 0.015824392853549456 + 0.07513181447785618im … 0.0016610584051232856 - 0.014942849125232601im -0.015307978599379633 - 0.005177615409092304im;;; … ;;; 0.019094579841219414 + 0.006286914015080973im 0.0033477554586038146 - 0.016546347646840806im … -0.014791298341157014 + 0.016445835033004355im 0.005512832903345913 + 0.03715089547050733im; 0.009724508081146579 - 0.016527165279201166im 0.0007499137207654266 - 0.020990195887891805im … -0.006835357767206757 + 0.008566102363025494im 0.00741453663705913 + 0.006971110440266669im; … ; 0.018348259573180384 + 0.010372276317699842im 0.009395543062931735 + 0.002202163765082433im … -0.014300888850205027 - 0.06686463313199248im -0.006257616591394108 + 0.0021812406036802335im; 0.017171101353809993 + 0.03273952492129691im -0.001814533150279702 - 0.002950072419563508im … -0.016680541501188487 - 0.00538092984735699im -0.001458343413231985 + 0.0605428669647721im;;; 0.0352921749851597 - 0.07029747130524991im 0.0006131103633331689 - 0.06168456602721213im … -0.03846369236205259 + 0.015376639760432777im 0.02673860889288615 + 0.04634488485310971im; 0.008818157002616032 - 0.05459124780767838im -0.012434468446415927 - 0.04326197956783128im … 0.000773459273140765 + 0.007979243196958238im 0.026036487741107082 - 0.0174723203826071im; … ; 0.020931461291259043 + 0.002007384462812043im -0.005981092970327236 - 0.012783257146873506im … -0.018127931106382663 - 0.021426899175694323im 0.009352365296671711 + 0.026071953403873464im; 0.0269783288698578 + 0.008290838945218744im -0.00964402657745527 - 0.028535780811608142im … -0.03361860546780614 + 0.05700206911111334im 0.005277699753057227 + 0.08980254972336918im;;; 0.03075614072349838 - 0.1370076744637177im -0.006860395277869818 - 0.0855907583199084im … -0.0223196526432907 + 0.016766917340383703im 0.04348170737349707 - 0.05439095084048927im; 0.001697603533310625 - 0.07411208022885377im -0.021311413405461995 - 0.0017065714775532737im … 0.02421318880010629 - 0.015129724851434951im 0.0645744646838349 - 0.018331883473866134im; … ; 0.010994230592090537 - 0.06290311759546674im -0.022802209770094818 - 0.023176988727864927im … -0.030423155163532237 + 0.009150632554922149im 0.005835196742538455 - 0.005437251684373621im; 0.015103038650296607 - 0.07355505778808528im -0.02097467283613299 - 0.047045163224083905im … -0.060075795260103176 + 0.04707102503068218im 0.0077588218204142564 - 0.0005128195763547961im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417761498047 -0.4874266764100595 … -0.702697395539741 -0.4874266764100593; -0.4874266764100591 -0.7738703031165446 … -0.41393901833939384 -0.38179339122075767; … ; -0.7026973955397413 -0.41393901833939406 … -2.396890218056623 -1.2941386092028346; -0.48742667641005927 -0.3817933912207581 … -1.2941386092028349 -0.7738703031165446;;; -0.4874266764100595 -0.7738703031165446 … -0.4139390183393938 -0.38179339122075756; -0.7738703031165441 -1.4815303728816624 … -0.3244427439377875 -0.44995655436013304; … ; -0.4139390183393941 -0.3244427439377877 … -1.0113865017682249 -0.6391785259200842; -0.3817933912207577 -0.4499565543601333 … -0.6391785259200845 -0.4499565543601332;;; -0.702697395539741 -1.294138609202835 … -0.29832133494661855 -0.4139390183393937; -1.2941386092028346 -2.9234702459028346 … -0.35179963884326915 -0.6391785259200844; … ; -0.29832133494661883 -0.3517996388432695 … -0.49060647083941405 -0.35179963884326915; -0.4139390183393939 -0.6391785259200846 … -0.35179963884326887 -0.3244427439377875;;; … ;;; -1.015048126873813 -0.5338983581177739 … -3.638038941492754 -1.999362501979356; -0.5338983581177734 -0.32169882700831887 … -1.4639475300052336 -0.9061370442135945; … ; -3.638038941492754 -1.4639475300052336 … -10.993621243076857 -8.086551292452922; -1.999362501979356 -0.9061370442135945 … -8.086551292452922 -4.647852558442571;;; -0.702697395539741 -0.4139390183393939 … -2.396890218056623 -1.294138609202835; -0.4139390183393937 -0.3244427439377875 … -1.0113865017682242 -0.6391785259200842; … ; -2.396890218056623 -1.0113865017682242 … -11.003061433402282 -6.073393711806169; -1.2941386092028346 -0.6391785259200845 … -6.073393711806171 -2.9234702459028346;;; -0.4874266764100596 -0.38179339122075767 … -1.2941386092028353 -0.7738703031165445; -0.38179339122075767 -0.44995655436013304 … -0.6391785259200844 -0.449956554360133; … ; -1.2941386092028355 -0.6391785259200845 … -6.073393711806171 -2.923470245902834; -0.7738703031165444 -0.44995655436013343 … -2.9234702459028346 -1.4815303728816622])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417761498047 -0.4874266764100595 … -0.702697395539741 -0.4874266764100593; -0.4874266764100591 -0.7738703031165446 … -0.41393901833939384 -0.38179339122075767; … ; -0.7026973955397413 -0.41393901833939406 … -2.396890218056623 -1.2941386092028346; -0.48742667641005927 -0.3817933912207581 … -1.2941386092028349 -0.7738703031165446;;; -0.4874266764100595 -0.7738703031165446 … -0.4139390183393938 -0.38179339122075756; -0.7738703031165441 -1.4815303728816624 … -0.3244427439377875 -0.44995655436013304; … ; -0.4139390183393941 -0.3244427439377877 … -1.0113865017682249 -0.6391785259200842; -0.3817933912207577 -0.4499565543601333 … -0.6391785259200845 -0.4499565543601332;;; -0.702697395539741 -1.294138609202835 … -0.29832133494661855 -0.4139390183393937; -1.2941386092028346 -2.9234702459028346 … -0.35179963884326915 -0.6391785259200844; … ; -0.29832133494661883 -0.3517996388432695 … -0.49060647083941405 -0.35179963884326915; -0.4139390183393939 -0.6391785259200846 … -0.35179963884326887 -0.3244427439377875;;; … ;;; -1.015048126873813 -0.5338983581177739 … -3.638038941492754 -1.999362501979356; -0.5338983581177734 -0.32169882700831887 … -1.4639475300052336 -0.9061370442135945; … ; -3.638038941492754 -1.4639475300052336 … -10.993621243076857 -8.086551292452922; -1.999362501979356 -0.9061370442135945 … -8.086551292452922 -4.647852558442571;;; -0.702697395539741 -0.4139390183393939 … -2.396890218056623 -1.294138609202835; -0.4139390183393937 -0.3244427439377875 … -1.0113865017682242 -0.6391785259200842; … ; -2.396890218056623 -1.0113865017682242 … -11.003061433402282 -6.073393711806169; -1.2941386092028346 -0.6391785259200845 … -6.073393711806171 -2.9234702459028346;;; -0.4874266764100596 -0.38179339122075767 … -1.2941386092028353 -0.7738703031165445; -0.38179339122075767 -0.44995655436013304 … -0.6391785259200844 -0.449956554360133; … ; -1.2941386092028355 -0.6391785259200845 … -6.073393711806171 -2.923470245902834; -0.7738703031165444 -0.44995655436013343 … -2.9234702459028346 -1.4815303728816622]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.011778573897783386 - 0.0024021740653889572im 0.01619161432467476 - 0.007150528456388058im … 0.004986367722521919 + 0.023902356145655935im 0.005455442198391688 + 0.008221146084247465im; 0.013618767502146915 - 0.017047361581256366im 0.017905358590009284 - 0.007936958168672657im … 0.0019436916754331894 + 0.002869904269228526im 0.013040103699186527 - 0.0028983168786955197im; … ; -0.02190264022357899 + 0.012544357327502132im -0.012343122788146503 - 0.008008065365471741im … -0.006647360025851061 + 0.03003141049519359im -0.01834826241349082 + 0.03494457786056251im; -0.010071800642200505 - 0.0175005768309053im -0.0004714700148176578 - 0.01780048706376833im … 0.0009777594298792614 + 0.03336345893372429im -0.00695037798044567 + 0.021952693138992858im;;; -0.01974740126207644 + 0.04828684983772799im 0.02089736045094777 - 0.009257633987069743im … 0.01600337484948504 - 0.030729875219838842im -0.0020990408216634733 - 0.005996857234351831im; -0.03771815490883305 + 0.04252992100555304im 0.0155319168122499 - 0.049872984486863184im … -0.0008480688098246526 - 0.014601718270245428im -0.029497800529468515 + 0.02523175661370517im; … ; -0.014225110445573669 + 0.012163986786268247im 0.01949228783877689 - 0.03796091516615324im … -0.015978404512973225 + 0.045123849723763376im -0.026495125601474306 + 0.05408313870903236im; 0.009343292175994347 - 0.016100951012348187im 0.03306815701716295 - 0.040683828175518036im … 0.004576984996367951 + 0.019953117777446086im 0.005429538338412732 - 0.0034491407878413736im;;; -0.0050778363081261735 - 0.009105216293173934im 0.01981321599783873 - 0.050346142135359886im … 0.004452584470237147 - 0.014943230189073807im -0.008245613946270726 + 0.00642426693961878im; -0.020132156832651932 - 0.013103974666996279im 0.05369483927556702 - 0.12706256307758976im … -0.010663861627141433 + 0.0001935309732938378im -0.03359218825560956 + 0.02404296388388704im; … ; 0.023973426748265428 - 0.04198560016314999im 0.0261260009207329 - 0.046318039206991415im … -0.0032088414625223508 + 0.01494579849145717im 0.006176630546170058 - 0.002705143819331096im; 0.03006623054740601 - 0.054154382176907975im 0.023673361004642495 - 0.03661126107610016im … 0.01861370667471512 - 0.02066007333476091im 0.028501040767468913 - 0.04608739705193238im;;; … ;;; -0.030850686778426034 + 0.058465012531119104im -0.01761071240144237 + 0.03971319876629795im … -0.0049131657778748675 - 0.022613794401329008im -0.04192223305503839 + 0.07408786856466043im; -0.019713006599385886 + 0.043887168284356404im -0.004100526429372913 + 0.016423750814772473im … -0.018792075684481397 + 0.02528001692492759im -0.031838666634612045 + 0.06197547420340982im; … ; 0.0022937947728986314 - 0.004518496208283956im 0.00030131821148815903 + 0.0010586167028918659im … 0.05210937056817208 - 0.09726955525213196im 0.018837514051584226 - 0.02545350712564501im; -0.02081746891769548 + 0.03207666492946265im -0.010584528193132426 + 0.02172716508781452im … 0.03683421335940398 - 0.09670708957755164im -0.020657589015870892 + 0.024013671705455226im;;; -0.04434843808626095 + 0.08594738633836843im -0.004215331797568484 + 0.02197618401238527im … -0.04665274662128849 + 0.06322723359455915im -0.08708403217793406 + 0.1760027028588566im; 0.0038491583970255714 + 0.02041608291356707im 0.014685933429362898 - 0.007222881964294327im … -0.03078566247264205 + 0.07192532128749665im -0.04287277524269892 + 0.11109032442011949im; … ; -0.009886244381294474 + 0.02248451812391707im -0.0022912607654815573 + 0.005178670241156193im … -0.0009792929398504044 - 0.010957763847535894im -0.03134204127188917 + 0.05899060427431721im; -0.04289150179834515 + 0.06473591887517055im -0.023343367837465018 + 0.035836732312221065im … -0.008583912373015035 - 0.02235147386037405im -0.07097547494160207 + 0.11874358060453782im;;; 0.014679868000933037 - 0.010881333794587618im 0.014742576877538716 - 0.02221011515852184im … -0.02634036844404255 + 0.07899238406397444im -0.03970125158630513 + 0.099579802417043im; 0.051641174848557785 - 0.05248020685135294im 0.03681163680680748 - 0.044981804855717136im … -0.009808418369845924 + 0.06339564594347079im -0.006777230886439932 + 0.054118002795347966im; … ; -0.006796506011493491 - 0.006563163197864836im -0.014067612682202912 + 0.0015906152410174277im … -0.01578982888606982 + 0.012653444559056155im -0.016107682321647724 + 0.029856916936006648im; -0.016330688457264854 - 0.0036937689107437955im -0.013149832642662907 - 0.012617119986942961im … -0.015528084426848767 + 0.035134952277993764im -0.054168703784455555 + 0.09057516771307197im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417761498047 -0.4874266764100595 … -0.702697395539741 -0.4874266764100593; -0.4874266764100591 -0.7738703031165446 … -0.41393901833939384 -0.38179339122075767; … ; -0.7026973955397413 -0.41393901833939406 … -2.396890218056623 -1.2941386092028346; -0.48742667641005927 -0.3817933912207581 … -1.2941386092028349 -0.7738703031165446;;; -0.4874266764100595 -0.7738703031165446 … -0.4139390183393938 -0.38179339122075756; -0.7738703031165441 -1.4815303728816624 … -0.3244427439377875 -0.44995655436013304; … ; -0.4139390183393941 -0.3244427439377877 … -1.0113865017682249 -0.6391785259200842; -0.3817933912207577 -0.4499565543601333 … -0.6391785259200845 -0.4499565543601332;;; -0.702697395539741 -1.294138609202835 … -0.29832133494661855 -0.4139390183393937; -1.2941386092028346 -2.9234702459028346 … -0.35179963884326915 -0.6391785259200844; … ; -0.29832133494661883 -0.3517996388432695 … -0.49060647083941405 -0.35179963884326915; -0.4139390183393939 -0.6391785259200846 … -0.35179963884326887 -0.3244427439377875;;; … ;;; -1.015048126873813 -0.5338983581177739 … -3.638038941492754 -1.999362501979356; -0.5338983581177734 -0.32169882700831887 … -1.4639475300052336 -0.9061370442135945; … ; -3.638038941492754 -1.4639475300052336 … -10.993621243076857 -8.086551292452922; -1.999362501979356 -0.9061370442135945 … -8.086551292452922 -4.647852558442571;;; -0.702697395539741 -0.4139390183393939 … -2.396890218056623 -1.294138609202835; -0.4139390183393937 -0.3244427439377875 … -1.0113865017682242 -0.6391785259200842; … ; -2.396890218056623 -1.0113865017682242 … -11.003061433402282 -6.073393711806169; -1.2941386092028346 -0.6391785259200845 … -6.073393711806171 -2.9234702459028346;;; -0.4874266764100596 -0.38179339122075767 … -1.2941386092028353 -0.7738703031165445; -0.38179339122075767 -0.44995655436013304 … -0.6391785259200844 -0.449956554360133; … ; -1.2941386092028355 -0.6391785259200845 … -6.073393711806171 -2.923470245902834; -0.7738703031165444 -0.44995655436013343 … -2.9234702459028346 -1.4815303728816622])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417761498047 -0.4874266764100595 … -0.702697395539741 -0.4874266764100593; -0.4874266764100591 -0.7738703031165446 … -0.41393901833939384 -0.38179339122075767; … ; -0.7026973955397413 -0.41393901833939406 … -2.396890218056623 -1.2941386092028346; -0.48742667641005927 -0.3817933912207581 … -1.2941386092028349 -0.7738703031165446;;; -0.4874266764100595 -0.7738703031165446 … -0.4139390183393938 -0.38179339122075756; -0.7738703031165441 -1.4815303728816624 … -0.3244427439377875 -0.44995655436013304; … ; -0.4139390183393941 -0.3244427439377877 … -1.0113865017682249 -0.6391785259200842; -0.3817933912207577 -0.4499565543601333 … -0.6391785259200845 -0.4499565543601332;;; -0.702697395539741 -1.294138609202835 … -0.29832133494661855 -0.4139390183393937; -1.2941386092028346 -2.9234702459028346 … -0.35179963884326915 -0.6391785259200844; … ; -0.29832133494661883 -0.3517996388432695 … -0.49060647083941405 -0.35179963884326915; -0.4139390183393939 -0.6391785259200846 … -0.35179963884326887 -0.3244427439377875;;; … ;;; -1.015048126873813 -0.5338983581177739 … -3.638038941492754 -1.999362501979356; -0.5338983581177734 -0.32169882700831887 … -1.4639475300052336 -0.9061370442135945; … ; -3.638038941492754 -1.4639475300052336 … -10.993621243076857 -8.086551292452922; -1.999362501979356 -0.9061370442135945 … -8.086551292452922 -4.647852558442571;;; -0.702697395539741 -0.4139390183393939 … -2.396890218056623 -1.294138609202835; -0.4139390183393937 -0.3244427439377875 … -1.0113865017682242 -0.6391785259200842; … ; -2.396890218056623 -1.0113865017682242 … -11.003061433402282 -6.073393711806169; -1.2941386092028346 -0.6391785259200845 … -6.073393711806171 -2.9234702459028346;;; -0.4874266764100596 -0.38179339122075767 … -1.2941386092028353 -0.7738703031165445; -0.38179339122075767 -0.44995655436013304 … -0.6391785259200844 -0.449956554360133; … ; -1.2941386092028355 -0.6391785259200845 … -6.073393711806171 -2.923470245902834; -0.7738703031165444 -0.44995655436013343 … -2.9234702459028346 -1.4815303728816622]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.02610526073033706 - 0.0559789574123861im 0.05588000910356062 - 0.06124925937116342im … 0.010616318319861146 + 0.003001227508329499im 0.023484959604417013 - 0.0394983779532513im; 0.0169320454626029 - 0.021885293244329557im 0.03967406666474572 - 0.029833917008375378im … 0.023862051580541065 - 0.007924980437938666im 0.009316056571901883 - 0.014238091887111084im; … ; -0.05919625381054125 + 0.014956674057924396im -0.03261715228211691 + 0.0036103509509274887im … -0.04145796229501948 + 0.026245037321277007im -0.032389635089830754 + 0.002013763473437051im; -0.039909219020408705 - 0.0062556340261991795im 0.005461207561175284 - 0.033254969391768786im … -0.025112715843137613 + 0.021369070213894295im -0.02598920215517589 - 0.0037681186771138567im;;; 0.10064689387835163 - 0.06040737222625307im 0.1040008186255542 - 0.0534813720949719im … 0.0031045455279407504 - 0.012846225019491965im 0.06371663490121854 - 0.055143205411338894im; 0.08441204596406925 - 0.04372934725524702im 0.0076796225060912285 + 0.00903328663322854im … 0.001127543400632822 - 0.009360126195626005im 0.04308349766489136 - 0.039243857795063im; … ; -0.01638220494767025 - 0.00936685289491623im 0.010389842340553117 - 0.016826288682877034im … -0.03908042965279518 + 0.012954978984026384im -0.04041095424118395 - 0.002642087267708852im; 0.06418074476298936 - 0.04654668567885857im 0.08264342784066026 - 0.050974895896497854im … -0.021972474339047598 + 0.0016801828162813903im 0.021488387663826262 - 0.03645376943524968im;;; 0.07124282971753725 - 0.025872380173278836im 0.004012727130560877 + 0.009941560379990244im … 0.012668219113403293 - 0.01654620717815759im 0.07008260899332369 - 0.04402897646571218im; 0.009299100346751651 + 0.007692890310756746im -0.08476570079380422 + 0.06504526760208906im … 0.03021117871776331 - 0.0227413922985374im 0.06810689451382927 - 0.036837827358375076im; … ; 0.023724731326521302 - 0.016630384253511626im 0.03432467401456743 - 0.016655806228657803im … -0.01471695839865706 + 0.0018514160584285327im -0.004878075262748655 - 0.007720197123748048im; 0.08826926564812362 - 0.03602339860457843im 0.04837664877337272 - 0.017065236946763245im … 0.005035603776684211 - 0.00826279213079825im 0.043447557823315455 - 0.028813559341044057im;;; … ;;; 0.024996629842434184 + 0.004646471328026383im -0.010327763782625673 + 0.013429760078014157im … -0.003308152830220924 - 0.012327373730962841im 0.005182049904903979 + 0.0005731835997020327im; -0.002052912771316859 + 0.010246353888324563im -0.029209439756215226 + 0.015256829264798481im … -0.009284725941552913 - 0.0001861849507772827im -0.0005169428893308957 + 0.005195975845673016im; … ; 0.05724628156091835 - 0.020990746552890918im 0.029306371934560364 - 0.004647095687667648im … -0.021515577474389237 - 0.007195119722057105im 0.03926710418509827 - 0.026159313260727138im; 0.0586788739845797 - 0.012695905086028006im 0.020445485058261468 + 0.0020229889982774883im … 0.015442424705254993 - 0.025518914255729296im 0.03912361125119366 - 0.02080160275916941im;;; -1.6694907158961326e-5 + 0.019684937303088797im -0.08694197252496644 + 0.03385821650672821im … -0.018287748188500576 + 0.012113958313796445im 0.0001731482561393941 + 0.020790888189658224im; -0.012393426951472409 + 0.01341912686290363im -0.06304555584519081 + 0.01909309090080895im … 0.01305220531310491 - 0.0022679583829341462im -0.003361129767447171 + 0.020438353109420763im; … ; 0.05909931120669594 - 0.003384461608717961im -0.00284716339478752 + 0.013734722348280617im … 0.011004506501591037 - 0.0037185445520132275im 0.08504183466923408 - 0.021350371477536226im; 0.04033079989777018 + 0.014605179743652014im -0.028703734838040416 + 0.02446460320870926im … 0.016335921044514336 + 0.0004395281389102609im 0.05962145598729873 + 0.005546947334176476im;;; -0.05249197792085923 + 0.00754219680319997im -0.07003686824427166 - 0.0072511303389329995im … 0.001754786863745962 + 0.021315920612543737im 0.004943377913249872 + 0.013036215811383266im; 0.0030640051042912612 - 0.011044330631387121im -0.05185648310544177 + 0.0009700928458776015im … 0.028883597068178692 + 0.004783545687567855im -0.0006232111938170356 + 0.004709142923628378im; … ; -0.01764712535175296 + 0.02433473171059511im -0.04971529702288929 + 0.026470317106330278im … -0.01781170600773615 + 0.033507064882866304im 0.03577279019770091 + 0.007019891348506092im; -0.050440384771613285 + 0.03244100103730585im -0.08688838672815649 + 0.025273534122622204im … -0.01617902168408901 + 0.03519428890479417im 0.009350007430083164 + 0.0168193136667965im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.8526466867298454), converged = true, ρ = [0.09132316917746403 0.08747419134079425 … 0.07684754935962446 0.08747419134079425; 0.08747419134079423 0.08089966872163121 … 0.07642471016970971 0.08486944834425897; … ; 0.07684754935962446 0.07642471016970971 … 0.047784666671015906 0.06587895342302752; 0.08747419134079423 0.08486944834425898 … 0.06587895342302752 0.08089966872163121;;; 0.08747419134079423 0.08089966872163121 … 0.07642471016970971 0.08486944834425898; 0.08089966872163121 0.06744471469773916 … 0.07348669934703836 0.08163768629013994; … ; 0.07642471016970971 0.07348669934703836 … 0.0618880411999624 0.07259829028446406; 0.08486944834425898 0.08163768629013995 … 0.07259829028446406 0.08163768629013997;;; 0.07684754935962446 0.06587895342302753 … 0.06847203698973334 0.07642471016970971; 0.06587895342302752 0.04657864264980387 … 0.06665759371631574 0.07259829028446405; … ; 0.06847203698973334 0.06665759371631574 … 0.06132515314380778 0.06665759371631573; 0.0764247101697097 0.07259829028446406 … 0.06665759371631573 0.07348669934703835;;; … ;;; 0.06328495229885517 0.06591651445952339 … 0.03394064888051767 0.04987593485998673; 0.06591651445952337 0.06297790960105251 … 0.04975639788527666 0.06087020457146072; … ; 0.033940648880517656 0.04975639788527666 … 0.009696353214072907 0.016831338792590533; 0.04987593485998671 0.06087020457146074 … 0.016831338792590526 0.03098572188504791;;; 0.07684754935962446 0.07642471016970971 … 0.04778466667101591 0.06587895342302753; 0.0764247101697097 0.07348669934703835 … 0.061888041199962385 0.07259829028446403; … ; 0.047784666671015906 0.061888041199962385 … 0.009696353214072907 0.02571001067530279; 0.06587895342302752 0.07259829028446407 … 0.025710010675302788 0.04657864264980387;;; 0.08747419134079425 0.084869448344259 … 0.06587895342302753 0.08089966872163121; 0.08486944834425898 0.08163768629013995 … 0.07259829028446405 0.08163768629013995; … ; 0.06587895342302752 0.07259829028446405 … 0.025710010675302788 0.04657864264980387; 0.08089966872163121 0.08163768629013997 … 0.04657864264980386 0.06744471469773916;;;;], eigenvalues = [[-0.16677707596307398, 0.26427771782990345, 0.26427771782992693, 0.26427771782994236, 0.3573203719044589, 0.3573203719045559, 0.3573203719045621], [-0.11613218761083309, 0.07040532320004121, 0.2262481360302291, 0.2262481360302301, 0.33611784894602653, 0.3934379776179949, 0.3934379776179956], [-0.09588938143640174, 0.08764319967958782, 0.17312704142742041, 0.1731270414274243, 0.2919724892213032, 0.33773212507289463, 0.5327646516179886], [-0.045051463485941926, 0.02226952623981516, 0.09831189251533855, 0.18446409322117222, 0.3229270151624708, 0.48024696047004983, 0.5024422335276463]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2897120818381903, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.9086728341213407 + 0.2954663197735379im -2.3270064623315503e-14 - 1.432503317141597e-14im … 1.7194738027771417e-9 - 1.7842358207924437e-8im 1.097533857554212e-9 - 1.1375683620624751e-8im; -0.0915707776441375 + 0.02977538191231935im -0.015843681548028357 + 0.3843458851565685im … -0.3384198750210702 + 0.09071712962873851im -0.1671848943994364 - 0.18309143641872885im; … ; -0.011216207904661473 + 0.003647090071321477im -0.02094555739814992 - 0.03608886305654801im … -0.07168078161747185 - 0.02068528810861935im 0.0018892283173007238 - 0.0045909152064805845im; 0.0915707776441356 - 0.02977538191232414im -0.22090533186248973 + 0.031027915351150043im … -0.25218019551220966 - 0.26114946150232693im 0.18275081993862474 + 0.14526555587239298im], [-0.7044118122007985 - 0.6052762572066382im 0.034920593031170455 - 0.19400701450765398im … 3.8773473014380574e-11 - 1.9398947354431847e-11im -4.4537788891137414e-11 + 5.44602892625148e-11im; -0.04802111083541043 - 0.04126284898964322im -0.0015542171564391072 + 0.008634705319841935im … 3.420937192167971e-11 + 1.5292774468660145e-13im -1.6017516689121316e-11 + 1.7994462641580817e-11im; … ; -0.0058786522835340485 - 0.005051318830784151im 0.015280691510843393 - 0.08489435838002887im … 0.02047972963803604 - 0.06491260046982956im -0.00276728932276199 - 0.08622928926808744im; 0.08565455228289186 + 0.07359993958153635im -0.01606881731772962 + 0.08927291903945613im … 0.08692742068591637 - 0.2755253623617185im -0.011745922885230166 - 0.36600530497114436im], [-0.3873828813602983 - 0.8496029993066314im 6.120139945701817e-15 - 4.582681408686942e-15im … 1.1408410938858848e-10 + 6.124145249740071e-11im -3.1135461794128277e-9 - 4.344860652025029e-9im; -0.028521551166852167 - 0.06255308786785897im -0.04707312309027535 + 0.032478487230930275im … -0.02202954839055871 - 0.012199335060888857im -0.0016114428403616416 - 0.003411692587986801im; … ; -0.005754329317847133 - 0.012620318766471855im -1.0439287795352069e-14 + 1.8126757224101137e-15im … 1.3867382143971378e-10 + 3.075324697783566e-11im 3.6950796687378513e-5 - 0.06572064480427318im; 0.06356133410031155 + 0.13940187522465416im -0.23633332401484655 + 0.163060114612305im … 0.334045347352775 + 0.18498477807092104im 0.0006274063508480098 - 0.1530940026582437im], [0.3439995594424335 + 0.7322334200014428im -9.188944699873276e-16 - 4.876751895554597e-16im … -0.18703863082007863 - 0.012171756795954638im 1.7063902264808644e-6 + 2.544857799623898e-6im; 0.1647573864803634 + 0.3507006368512645im -0.26767946554394273 - 0.5665320382134539im … 0.1778450248047801 + 0.011573396553382005im -9.429473867735908e-7 - 1.504017069133301e-6im; … ; 0.004844699354524992 + 0.010312370117543454im -0.0007021678593740355 - 0.0014861079751885184im … -0.016141548206344957 - 0.0010503966184409715im -0.004961613728641236 - 0.04400995834942836im; -0.027715020422344777 - 0.05899386680074716im -0.005333677391273988 - 0.0112884980456414im … -0.13507171521631242 - 0.008790739462077453im -0.05272335369571953 - 0.46768787712568466im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596307398, 0.26427771782990345, 0.26427771782992693, 0.26427771782994236, 0.3573203719044589, 0.3573203719045559, 0.3573203719045621], [-0.11613218761083309, 0.07040532320004121, 0.2262481360302291, 0.2262481360302301, 0.33611784894602653, 0.3934379776179949, 0.3934379776179956], [-0.09588938143640174, 0.08764319967958782, 0.17312704142742041, 0.1731270414274243, 0.2919724892213032, 0.33773212507289463, 0.5327646516179886], [-0.045051463485941926, 0.02226952623981516, 0.09831189251533855, 0.18446409322117222, 0.3229270151624708, 0.48024696047004983, 0.5024422335276463]], X = [[-0.9086728341213407 + 0.2954663197735379im -2.3270064623315503e-14 - 1.432503317141597e-14im … 1.7194738027771417e-9 - 1.7842358207924437e-8im 1.097533857554212e-9 - 1.1375683620624751e-8im; -0.0915707776441375 + 0.02977538191231935im -0.015843681548028357 + 0.3843458851565685im … -0.3384198750210702 + 0.09071712962873851im -0.1671848943994364 - 0.18309143641872885im; … ; -0.011216207904661473 + 0.003647090071321477im -0.02094555739814992 - 0.03608886305654801im … -0.07168078161747185 - 0.02068528810861935im 0.0018892283173007238 - 0.0045909152064805845im; 0.0915707776441356 - 0.02977538191232414im -0.22090533186248973 + 0.031027915351150043im … -0.25218019551220966 - 0.26114946150232693im 0.18275081993862474 + 0.14526555587239298im], [-0.7044118122007985 - 0.6052762572066382im 0.034920593031170455 - 0.19400701450765398im … 3.8773473014380574e-11 - 1.9398947354431847e-11im -4.4537788891137414e-11 + 5.44602892625148e-11im; -0.04802111083541043 - 0.04126284898964322im -0.0015542171564391072 + 0.008634705319841935im … 3.420937192167971e-11 + 1.5292774468660145e-13im -1.6017516689121316e-11 + 1.7994462641580817e-11im; … ; -0.0058786522835340485 - 0.005051318830784151im 0.015280691510843393 - 0.08489435838002887im … 0.02047972963803604 - 0.06491260046982956im -0.00276728932276199 - 0.08622928926808744im; 0.08565455228289186 + 0.07359993958153635im -0.01606881731772962 + 0.08927291903945613im … 0.08692742068591637 - 0.2755253623617185im -0.011745922885230166 - 0.36600530497114436im], [-0.3873828813602983 - 0.8496029993066314im 6.120139945701817e-15 - 4.582681408686942e-15im … 1.1408410938858848e-10 + 6.124145249740071e-11im -3.1135461794128277e-9 - 4.344860652025029e-9im; -0.028521551166852167 - 0.06255308786785897im -0.04707312309027535 + 0.032478487230930275im … -0.02202954839055871 - 0.012199335060888857im -0.0016114428403616416 - 0.003411692587986801im; … ; -0.005754329317847133 - 0.012620318766471855im -1.0439287795352069e-14 + 1.8126757224101137e-15im … 1.3867382143971378e-10 + 3.075324697783566e-11im 3.6950796687378513e-5 - 0.06572064480427318im; 0.06356133410031155 + 0.13940187522465416im -0.23633332401484655 + 0.163060114612305im … 0.334045347352775 + 0.18498477807092104im 0.0006274063508480098 - 0.1530940026582437im], [0.3439995594424335 + 0.7322334200014428im -9.188944699873276e-16 - 4.876751895554597e-16im … -0.18703863082007863 - 0.012171756795954638im 1.7063902264808644e-6 + 2.544857799623898e-6im; 0.1647573864803634 + 0.3507006368512645im -0.26767946554394273 - 0.5665320382134539im … 0.1778450248047801 + 0.011573396553382005im -9.429473867735908e-7 - 1.504017069133301e-6im; … ; 0.004844699354524992 + 0.010312370117543454im -0.0007021678593740355 - 0.0014861079751885184im … -0.016141548206344957 - 0.0010503966184409715im -0.004961613728641236 - 0.04400995834942836im; -0.027715020422344777 - 0.05899386680074716im -0.005333677391273988 - 0.0112884980456414im … -0.13507171521631242 - 0.008790739462077453im -0.05272335369571953 - 0.46768787712568466im]], residual_norms = [[2.5050623535837205e-13, 3.702826705252162e-13, 3.490699061360178e-13, 9.344273914970233e-14, 9.275083855919825e-9, 1.5566413348534066e-7, 9.924803454715354e-8], [1.181306445897594e-13, 1.224526756641911e-13, 2.774476905891927e-13, 3.2163912286041226e-13, 2.963780120429021e-10, 5.671243149647893e-10, 3.4999461437086724e-10], [7.939814637957394e-14, 1.2887821277108346e-13, 3.5421216328490973e-13, 4.1758291164048496e-13, 5.750289446350292e-11, 1.3961895074613302e-9, 1.4604688142469213e-7], [1.4405472458159308e-13, 7.704568893511737e-14, 1.2733638848051202e-13, 1.6764997368317497e-13, 1.533486022459269e-9, 1.2222161535852864e-5, 4.210918986314159e-6]], iterations = [28, 21, 21, 20], converged = 1, n_matvec = 626)], stage = :finalize, algorithm = &quot;SCF&quot;, occupation_threshold = 1.0e-6)</code></pre><h2 id="Direct-minimization"><a class="docs-heading-anchor" href="#Direct-minimization">Direct minimization</a><a id="Direct-minimization-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-minimization" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_dm = direct_minimization(basis; tol)

# Newton algorithm</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.39155563712673486 0.37851742098725805 … 0.3446996003417713 0.3785174209872581; 0.378517420987258 0.36645844072845535 … 0.32735728179230383 0.36364954270445193; … ; 0.3446996003417713 0.3273572817923039 … 0.3075192694718448 0.33438053205175144; 0.3785174209872581 0.36364954270445204 … 0.3343805320517515 0.36645844072845535;;; 0.3785174209872581 0.36645844072845535 … 0.3273572817923039 0.3636495427044521; 0.36645844072845524 0.3510288634916206 … 0.31119401352806253 0.35191706642752374; … ; 0.3273572817923039 0.3111940135280626 … 0.2982412284613895 0.3214260028781497; 0.36364954270445204 0.3519170664275238 … 0.3214260028781497 0.3519170664275238;;; 0.3446996003417713 0.3343805320517515 … 0.286535153824198 0.327357281792304; 0.3343805320517514 0.3186160478236603 … 0.27805891887876105 0.32142600287814965; … ; 0.286535153824198 0.2780589188787611 … 0.25590185776500496 0.2780589188787611; 0.32735728179230394 0.3214260028781497 … 0.27805891887876116 0.3111940135280626;;; … ;;; 0.30487474934010333 0.28303666901175356 … 0.2855643323608194 0.3009573705669117; 0.28303666901175345 0.25898431627201407 … 0.27263300132129503 0.28541419667024676; … ; 0.2855643323608194 0.2726330013212951 … 0.27716038918572206 0.2812108738311416; 0.3009573705669117 0.28541419667024687 … 0.2812108738311416 0.29308272632096877;;; 0.34469960034177133 0.32735728179230394 … 0.3075192694718447 0.3343805320517515; 0.32735728179230383 0.31119401352806253 … 0.2982412284613894 0.32142600287814965; … ; 0.30751926947184477 0.2982412284613895 … 0.27716038918572206 0.29313119152221684; 0.3343805320517515 0.32142600287814976 … 0.2931311915222168 0.3186160478236604;;; 0.3785174209872581 0.36364954270445204 … 0.33438053205175144 0.3664584407284554; 0.363649542704452 0.3519170664275238 … 0.3214260028781496 0.35191706642752374; … ; 0.3343805320517515 0.3214260028781497 … 0.29313119152221695 0.31861604782366043; 0.36645844072845535 0.35191706642752385 … 0.31861604782366043 0.35102886349162066]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923513814 -0.4966565572633309 … -0.4771919009960247 -0.4966565572633309; -0.4966565572633309 -0.4848182087479057 … -0.47638044579648736 -0.49204131120509526; … ; -0.4771919009960247 -0.47638044579648736 … -0.4122880708972777 -0.45507008158715795; -0.4966565572633309 -0.49204131120509526 … -0.45507008158715795 -0.4848182087479057;;; -0.4966565572633309 -0.4848182087479057 … -0.47638044579648736 -0.49204131120509526; -0.4848182087479057 -0.4583744079541183 … -0.47065601573522137 -0.48617902520930145; … ; -0.47638044579648736 -0.47065601573522137 … -0.4463984364536632 -0.4688943964177422; -0.49204131120509526 -0.48617902520930145 … -0.4688943964177423 -0.4861790252093015;;; -0.4771919009960247 -0.4550700815871579 … -0.4605141234494436 -0.4763804457964873; -0.4550700815871579 -0.40906618247145227 … -0.45671990834491283 -0.4688943964177422; … ; -0.4605141234494436 -0.45671990834491283 … -0.4451449566177331 -0.45671990834491283; -0.47638044579648736 -0.4688943964177422 … -0.4567199083449129 -0.47065601573522137;;; … ;;; -0.44947595085833303 -0.4551499722181841 … -0.37125986262624533 -0.4177457152196678; -0.4551499722181841 -0.44880351101759225 … -0.4174380107165489 -0.4441260993106733; … ; -0.37125986262624533 -0.4174380107165489 … -0.2536569832615724 -0.2997980910577913; -0.4177457152196678 -0.4441260993106733 … -0.2997980910577913 -0.36106343266332697;;; -0.4771919009960247 -0.4763804457964873 … -0.41228807089727765 -0.4550700815871579; -0.4763804457964873 -0.47065601573522137 … -0.4463984364536632 -0.4688943964177422; … ; -0.41228807089727765 -0.4463984364536632 … -0.2536569832615725 -0.3410633023183163; -0.45507008158715795 -0.4688943964177423 … -0.3410633023183163 -0.4090661824714523;;; -0.4966565572633309 -0.49204131120509526 … -0.45507008158715795 -0.4848182087479057; -0.49204131120509526 -0.48617902520930145 … -0.4688943964177422 -0.48617902520930145; … ; -0.45507008158715795 -0.4688943964177422 … -0.3410633023183163 -0.4090661824714523; -0.4848182087479057 -0.4861790252093015 … -0.4090661824714523 -0.4583744079541183])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4127417760956855 -0.4874266763601715 … -0.7026973954992981 -0.48742667636017134; -0.4874266763601712 -0.7738703030731674 … -0.41393901829904184 -0.3817933911725066; … ; -0.7026973954992983 -0.413939018299042 … -2.396890218026663 -1.2941386091686804; -0.48742667636017134 -0.38179339117250694 … -1.2941386091686806 -0.7738703030731673;;; -0.48742667636017145 -0.7738703030731673 … -0.41393901829904184 -0.3817933911725063; -0.7738703030731671 -1.4815303728470086 … -0.32444274389980166 -0.4499565543154694; … ; -0.41393901829904206 -0.32444274389980177 … -1.0113865017365071 -0.6391785258832328; -0.3817933911725066 -0.44995655431546966 … -0.6391785258832332 -0.44995655431546955;;; -0.7026973954992981 -1.2941386091686806 … -0.298321334913122 -0.41393901829904167; -1.2941386091686802 -2.9234702458744555 … -0.35179963881175685 -0.639178525883233; … ; -0.2983213349131222 -0.35179963881175713 … -0.4906064708117605 -0.35179963881175685; -0.413939018299042 -0.6391785258832333 … -0.35179963881175663 -0.32444274389980154;;; … ;;; -1.015048126840159 -0.5338983580850809 … -3.638038941457792 -1.9993625019477428; -0.5338983580850807 -0.3216988269789076 … -1.463947529973619 -0.9061370441818511; … ; -3.638038941457792 -1.463947529973619 … -10.993621243006308 -8.086551292403739; -1.9993625019477428 -0.906137044181851 … -8.086551292403739 -4.6478525584085775;;; -0.7026973954992981 -0.4139390182990418 … -2.396890218026664 -1.294138609168681; -0.4139390182990417 -0.32444274389980166 … -1.0113865017365065 -0.639178525883233; … ; -2.3968902180266634 -1.0113865017365065 … -11.003061433331732 -6.073393711771634; -1.2941386091686806 -0.6391785258832332 … -6.073393711771636 -2.923470245874455;;; -0.4874266763601715 -0.38179339117250644 … -1.294138609168681 -0.7738703030731673; -0.38179339117250644 -0.4499565543154694 … -0.6391785258832331 -0.4499565543154693; … ; -1.294138609168681 -0.6391785258832331 … -6.073393711771636 -2.9234702458744546; -0.7738703030731672 -0.44995655431546966 … -2.923470245874455 -1.4815303728470084]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.11551633398245174 + 0.21488963733316316im -0.003102920192641632 + 0.13309208081471036im … 0.05821324628268008 + 0.019590244184734186im -0.0031029220817573753 + 0.1330920835269727im; -0.10492580931087189 + 0.1494040836107225im 0.020660239009704037 + 0.056638071235830534im … 0.026002676288789838 + 0.021708837383827125im -0.036582258910380736 + 0.09182329275557558im; … ; -0.04405890591957294 + 0.03597421612403319im -0.03703699954139968 + 0.03180777609600282im … 0.016057181457957433 - 0.029870423145033086im 0.020436845725623095 - 0.006625716427895313im; -0.1049258091972878 + 0.14940408236475894im -0.036582257281330736 + 0.09182328949245923im … 0.038496056817967875 - 0.009518797832862856im 0.02066023952208779 + 0.05663807090830959im;;; 0.019989648120035095 + 0.18052511398144327im 0.16631336452306789 + 0.09292561669081699im … 0.012605391379116955 + 0.018371081376805227im -0.00016409202946002233 + 0.10089639623802371im; 0.04758648966351101 + 0.1119456318080865im 0.16345576654452723 - 0.0048228362831066315im … 0.0033480130785482343 + 0.022051273752305003im -0.010132260560368853 + 0.07958330884696767im; … ; -0.039513696644702986 + 0.026720544917079366im -0.008748412776822256 + 0.023989117013441683im … -0.004340362908422379 - 0.008628950197233738im -0.023517040816279915 + 0.005941466940680473im; -0.029849792411923246 + 0.10565203640996688im 0.057270631886211315 + 0.0687853814959981im … -0.00048798111464881774 + 0.002252217699414006im -0.025418666314751634 + 0.04818444000085193im;;; 0.08140770554730299 + 0.06723255990177758im 0.10312614193783873 + 0.013975226601301741im … 0.007191018844708991 + 0.015554853516437477im 0.026902257107062535 + 0.04773739541213505im; 0.05378246141990094 + 0.021880070851636818im 0.04691376279904268 - 0.0635004559183514im … 0.003860944297435622 + 0.017161751994192793im 0.016128440451931028 + 0.036382989875533414im; … ; -0.0013471660996155939 + 0.0169226681391683im 0.018547127846119914 + 0.014809028872603804im … -0.007261082589719696 - 0.0015006082125217403im -0.010859629775844494 + 0.007482725097945661im; 0.03782284517334722 + 0.045987919781307195im 0.06636675821037633 + 0.028334824449933117im … -0.0015753533250874568 + 0.0059953865703592495im 0.006091380442926137 + 0.02768625563865293im;;; … ;;; 0.021895069999699868 + 0.005610965957833622im 0.016703583842189968 + 0.015382201032875655im … -0.03584708639856507 - 0.033831768101232486im 0.0009572618765493997 - 0.022047914133193444im; 0.025420863804445477 + 0.013985694919041084im 0.012955908931084358 + 0.013312661866523495im … 0.0017294041950732524 - 0.00913997507906959im 0.02310754719112775 + 0.0023146133838082353im; … ; -0.015840547091329954 - 0.037036810324075714im -0.0017783826735375983 - 0.008578028103350753im … -0.06947285638219824 - 0.04728484693127644im -0.05239509324459802 - 0.06539336457512013im; -0.0035185748847840694 - 0.02133088588858708im 0.006045932199921656 + 0.005047880122458525im … -0.07960435118228226 - 0.06103444831705791im -0.044100231208429465 - 0.06149437608420895im;;; 0.08140770587579549 + 0.06723255938784539im 0.02690225760761043 + 0.047737394480841855im … 0.016057181257182793 - 0.02987042324069536im 0.10312614286180394 + 0.013975225921192429im; 0.03782284540509835 + 0.04598791930248276im 0.006091381014535335 + 0.027686254957647993im … 0.03897917018348672 + 0.002163537284186728im 0.06636675824412695 + 0.028334824118196163im; … ; 0.016057180610001952 - 0.029870421955763116im 0.003667927635291926 + 0.007820390073623127im … -0.10284711223925365 - 0.10924495329282008im -0.01830776862320562 - 0.10233301959481297im; 0.0537824616436484 + 0.0218800719527422im 0.01612844030780807 + 0.0363829902062999im … -0.0676514489815152 - 0.09442817524619665im 0.04691376452731772 - 0.06350045587204564im;;; 0.01998964875548702 + 0.1805251129808076im -0.00016408995725236306 + 0.10089639319099002im … 0.09903046689877841 + 0.0055625480866860165im 0.16631336500609076 + 0.09292561655218376im; -0.029849791974958524 + 0.10565203662348227im -0.02541866529129934 + 0.04818443928596791im … 0.06114396212904839 + 0.017606999495231677im 0.05727063119722103 + 0.0687853825513068im; … ; 0.03162757459285191 + 0.016360475521445504im -0.012123415512756312 + 0.02934441482547092im … -0.0071170386526471455 - 0.07934682920841762im 0.0833319318754194 - 0.05442735215278795im; 0.04758649032163273 + 0.11194563177913056im -0.010132259882516415 + 0.07958330746180053im … 0.05364623149854128 - 0.04967171197326412im 0.16345576930801203 - 0.004822837230328171im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.39155563712673486 0.37851742098725805 … 0.3446996003417713 0.3785174209872581; 0.378517420987258 0.36645844072845535 … 0.32735728179230383 0.36364954270445193; … ; 0.3446996003417713 0.3273572817923039 … 0.3075192694718448 0.33438053205175144; 0.3785174209872581 0.36364954270445204 … 0.3343805320517515 0.36645844072845535;;; 0.3785174209872581 0.36645844072845535 … 0.3273572817923039 0.3636495427044521; 0.36645844072845524 0.3510288634916206 … 0.31119401352806253 0.35191706642752374; … ; 0.3273572817923039 0.3111940135280626 … 0.2982412284613895 0.3214260028781497; 0.36364954270445204 0.3519170664275238 … 0.3214260028781497 0.3519170664275238;;; 0.3446996003417713 0.3343805320517515 … 0.286535153824198 0.327357281792304; 0.3343805320517514 0.3186160478236603 … 0.27805891887876105 0.32142600287814965; … ; 0.286535153824198 0.2780589188787611 … 0.25590185776500496 0.2780589188787611; 0.32735728179230394 0.3214260028781497 … 0.27805891887876116 0.3111940135280626;;; … ;;; 0.30487474934010333 0.28303666901175356 … 0.2855643323608194 0.3009573705669117; 0.28303666901175345 0.25898431627201407 … 0.27263300132129503 0.28541419667024676; … ; 0.2855643323608194 0.2726330013212951 … 0.27716038918572206 0.2812108738311416; 0.3009573705669117 0.28541419667024687 … 0.2812108738311416 0.29308272632096877;;; 0.34469960034177133 0.32735728179230394 … 0.3075192694718447 0.3343805320517515; 0.32735728179230383 0.31119401352806253 … 0.2982412284613894 0.32142600287814965; … ; 0.30751926947184477 0.2982412284613895 … 0.27716038918572206 0.29313119152221684; 0.3343805320517515 0.32142600287814976 … 0.2931311915222168 0.3186160478236604;;; 0.3785174209872581 0.36364954270445204 … 0.33438053205175144 0.3664584407284554; 0.363649542704452 0.3519170664275238 … 0.3214260028781496 0.35191706642752374; … ; 0.3343805320517515 0.3214260028781497 … 0.29313119152221695 0.31861604782366043; 0.36645844072845535 0.35191706642752385 … 0.31861604782366043 0.35102886349162066]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923513814 -0.4966565572633309 … -0.4771919009960247 -0.4966565572633309; -0.4966565572633309 -0.4848182087479057 … -0.47638044579648736 -0.49204131120509526; … ; -0.4771919009960247 -0.47638044579648736 … -0.4122880708972777 -0.45507008158715795; -0.4966565572633309 -0.49204131120509526 … -0.45507008158715795 -0.4848182087479057;;; -0.4966565572633309 -0.4848182087479057 … -0.47638044579648736 -0.49204131120509526; -0.4848182087479057 -0.4583744079541183 … -0.47065601573522137 -0.48617902520930145; … ; -0.47638044579648736 -0.47065601573522137 … -0.4463984364536632 -0.4688943964177422; -0.49204131120509526 -0.48617902520930145 … -0.4688943964177423 -0.4861790252093015;;; -0.4771919009960247 -0.4550700815871579 … -0.4605141234494436 -0.4763804457964873; -0.4550700815871579 -0.40906618247145227 … -0.45671990834491283 -0.4688943964177422; … ; -0.4605141234494436 -0.45671990834491283 … -0.4451449566177331 -0.45671990834491283; -0.47638044579648736 -0.4688943964177422 … -0.4567199083449129 -0.47065601573522137;;; … ;;; -0.44947595085833303 -0.4551499722181841 … -0.37125986262624533 -0.4177457152196678; -0.4551499722181841 -0.44880351101759225 … -0.4174380107165489 -0.4441260993106733; … ; -0.37125986262624533 -0.4174380107165489 … -0.2536569832615724 -0.2997980910577913; -0.4177457152196678 -0.4441260993106733 … -0.2997980910577913 -0.36106343266332697;;; -0.4771919009960247 -0.4763804457964873 … -0.41228807089727765 -0.4550700815871579; -0.4763804457964873 -0.47065601573522137 … -0.4463984364536632 -0.4688943964177422; … ; -0.41228807089727765 -0.4463984364536632 … -0.2536569832615725 -0.3410633023183163; -0.45507008158715795 -0.4688943964177423 … -0.3410633023183163 -0.4090661824714523;;; -0.4966565572633309 -0.49204131120509526 … -0.45507008158715795 -0.4848182087479057; -0.49204131120509526 -0.48617902520930145 … -0.4688943964177422 -0.48617902520930145; … ; -0.45507008158715795 -0.4688943964177422 … -0.3410633023183163 -0.4090661824714523; -0.4848182087479057 -0.4861790252093015 … -0.4090661824714523 -0.4583744079541183])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4127417760956855 -0.4874266763601715 … -0.7026973954992981 -0.48742667636017134; -0.4874266763601712 -0.7738703030731674 … -0.41393901829904184 -0.3817933911725066; … ; -0.7026973954992983 -0.413939018299042 … -2.396890218026663 -1.2941386091686804; -0.48742667636017134 -0.38179339117250694 … -1.2941386091686806 -0.7738703030731673;;; -0.48742667636017145 -0.7738703030731673 … -0.41393901829904184 -0.3817933911725063; -0.7738703030731671 -1.4815303728470086 … -0.32444274389980166 -0.4499565543154694; … ; -0.41393901829904206 -0.32444274389980177 … -1.0113865017365071 -0.6391785258832328; -0.3817933911725066 -0.44995655431546966 … -0.6391785258832332 -0.44995655431546955;;; -0.7026973954992981 -1.2941386091686806 … -0.298321334913122 -0.41393901829904167; -1.2941386091686802 -2.9234702458744555 … -0.35179963881175685 -0.639178525883233; … ; -0.2983213349131222 -0.35179963881175713 … -0.4906064708117605 -0.35179963881175685; -0.413939018299042 -0.6391785258832333 … -0.35179963881175663 -0.32444274389980154;;; … ;;; -1.015048126840159 -0.5338983580850809 … -3.638038941457792 -1.9993625019477428; -0.5338983580850807 -0.3216988269789076 … -1.463947529973619 -0.9061370441818511; … ; -3.638038941457792 -1.463947529973619 … -10.993621243006308 -8.086551292403739; -1.9993625019477428 -0.906137044181851 … -8.086551292403739 -4.6478525584085775;;; -0.7026973954992981 -0.4139390182990418 … -2.396890218026664 -1.294138609168681; -0.4139390182990417 -0.32444274389980166 … -1.0113865017365065 -0.639178525883233; … ; -2.3968902180266634 -1.0113865017365065 … -11.003061433331732 -6.073393711771634; -1.2941386091686806 -0.6391785258832332 … -6.073393711771636 -2.923470245874455;;; -0.4874266763601715 -0.38179339117250644 … -1.294138609168681 -0.7738703030731673; -0.38179339117250644 -0.4499565543154694 … -0.6391785258832331 -0.4499565543154693; … ; -1.294138609168681 -0.6391785258832331 … -6.073393711771636 -2.9234702458744546; -0.7738703030731672 -0.44995655431546966 … -2.923470245874455 -1.4815303728470084]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.27288913581435054 + 0.11154790206147222im -0.29755922460003914 + 0.028705702240516027im … -0.04822555218324698 - 0.027713200255159755im -0.17421024249923298 + 0.03683754739443714im; -0.18185079644646007 + 0.06877460489452755im -0.08810056152933908 - 0.026588054503059375im … -0.05267912716652008 + 0.006518278379151969im -0.1226347480432688 + 0.05000909643189409im; … ; 0.08752777503332967 - 0.018698734584752817im 0.0520029701298749 - 0.005073598589244225im … -0.003855560818803122 - 0.01693796402885286im 0.007453801309007439 - 0.048689003947428255im; -0.014071697787397898 + 0.02858008906132338im -0.08008668872152039 + 0.005240419851345876im … 0.0017799546486351315 - 0.06027725529023005im 0.01730507665441148 - 0.0687057781804146im;;; -0.21714530372810198 + 0.09123603371647213im -0.2041272751575342 - 0.002181913981836647im … -0.04189789471183945 - 0.0015306930389972786im -0.11028056766816494 + 0.0518344397083887im; -0.030879319422426204 + 0.017907515084509894im 0.08882011282270942 - 0.06923792173779865im … -0.03207122174268122 + 0.014140522729862576im -0.04950189317193813 + 0.03932845530289944im; … ; 0.04718569608041769 - 0.008819538591286018im 0.009789242111459477 - 0.005448777708346638im … -0.007412967318484458 - 0.018348018363416537im 0.014571570701446362 - 0.025019808455840307im; -0.0440481984452744 + 0.03326415933411004im -0.12423403304033519 + 0.004377989385160681im … -0.015909019828878487 - 0.026934305175211115im -0.018871794044545243 - 0.012315836107888422im;;; -0.05546512659749156 + 0.026401541782221802im -0.04803785989940948 - 0.013072318791295019im … -0.01409983000577043 + 0.007845052875361582im -0.026114187970898924 + 0.026891576039934768im; 0.041500945311057386 - 0.014495208147261405im 0.11840724948707329 - 0.04875085668150385im … -0.005652858440094307 + 0.010800902417986516im 0.005033862977150254 + 0.013138753268630378im; … ; 0.009148459783670345 + 0.0007226241785433571im -0.015621307760271623 + 0.00022523652965269618im … -0.0010455218515387265 - 0.00871867255149475im 0.009742241239138043 - 0.005990919122691795im; -0.03395685725902261 + 0.019103732187793147im -0.0690627374756825 + 0.004343716016929968im … -0.006320143370533297 - 0.0047819510254405485im -0.007479221280242821 + 0.008589579538135772im;;; … ;;; 0.01590570023826237 - 0.002978985745677297im 0.004695673550005679 + 0.004916245842571029im … 0.027943710514041785 - 0.007047139813978708im 0.02527899054013119 - 0.013793204578866488im; -0.00444581238836231 + 0.003043213012978037im -0.01024162075269604 + 0.004933819352842185im … 0.012638043942223159 - 0.007015934673324974im 0.005065371769751321 - 0.004945450387026098im; … ; -0.00182701923148616 - 0.003626079798043135im 0.005456792648283513 + 0.001698886325390117im … 0.018672730092559556 + 0.02352243544100746im 0.0035437123864794154 + 0.003313852288550757im; 0.022054167739515455 - 0.007268825711488905im 0.016514092602431862 + 0.003113148747940956im … 0.029210315785389594 + 0.007888916391601159im 0.02675944639876495 - 0.01191920642332145im;;; -0.001405725381171154 + 0.008694167885881995im -0.022544739691687257 + 0.013518431868518983im … 0.0388575054052413 - 0.026160690697649307im 0.024112280679243182 - 0.030869457236742358im; -0.04015672984437077 + 0.016255766711075544im -0.03941628458440199 + 0.008428958901285585im … 0.0018541281595906738 - 0.011240478421808128im -0.021282026469378233 - 0.00024187296970722383im; … ; 0.011117750911043976 - 0.005294629778715249im 0.025082107100847587 + 0.0069203397713306445im … 0.041864917239509775 + 0.03642166297644821im -0.0016071739142683459 - 0.008292283035683322im; 0.06346843047011866 - 0.012307939058680339im 0.031630317194862936 + 0.010032558425710948im … 0.0661010399089072 - 0.01196263024888853im 0.06505736501076198 - 0.05424322364162683im;;; -0.13921541264089832 + 0.06404972912199221im -0.14732707833519848 + 0.023026857243746215im … 0.00769968065457331 - 0.04363199013627024im -0.05152375988965276 - 0.026390906301017737im; -0.12651281523381525 + 0.04699348840873156im -0.09494222495038013 + 0.00399378949254907im … -0.030252177629315417 - 0.007217114378235882im -0.08441040400204465 + 0.021778291926433234im; … ; 0.05531301284369853 - 0.011473403767525515im 0.05410848174560047 + 0.005724322440177941im … 0.025813933930640427 + 0.01303052883262091im -0.007850056812430133 - 0.03860708125912315im; 0.09386908935818716 - 0.009169158609406515im 0.013369981885570217 + 0.012755554922699523im … 0.06172686511674426 - 0.05683304006752386im 0.10134294617504966 - 0.10315787843092644im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.39155563712673486 0.37851742098725805 … 0.3446996003417713 0.3785174209872581; 0.378517420987258 0.36645844072845535 … 0.32735728179230383 0.36364954270445193; … ; 0.3446996003417713 0.3273572817923039 … 0.3075192694718448 0.33438053205175144; 0.3785174209872581 0.36364954270445204 … 0.3343805320517515 0.36645844072845535;;; 0.3785174209872581 0.36645844072845535 … 0.3273572817923039 0.3636495427044521; 0.36645844072845524 0.3510288634916206 … 0.31119401352806253 0.35191706642752374; … ; 0.3273572817923039 0.3111940135280626 … 0.2982412284613895 0.3214260028781497; 0.36364954270445204 0.3519170664275238 … 0.3214260028781497 0.3519170664275238;;; 0.3446996003417713 0.3343805320517515 … 0.286535153824198 0.327357281792304; 0.3343805320517514 0.3186160478236603 … 0.27805891887876105 0.32142600287814965; … ; 0.286535153824198 0.2780589188787611 … 0.25590185776500496 0.2780589188787611; 0.32735728179230394 0.3214260028781497 … 0.27805891887876116 0.3111940135280626;;; … ;;; 0.30487474934010333 0.28303666901175356 … 0.2855643323608194 0.3009573705669117; 0.28303666901175345 0.25898431627201407 … 0.27263300132129503 0.28541419667024676; … ; 0.2855643323608194 0.2726330013212951 … 0.27716038918572206 0.2812108738311416; 0.3009573705669117 0.28541419667024687 … 0.2812108738311416 0.29308272632096877;;; 0.34469960034177133 0.32735728179230394 … 0.3075192694718447 0.3343805320517515; 0.32735728179230383 0.31119401352806253 … 0.2982412284613894 0.32142600287814965; … ; 0.30751926947184477 0.2982412284613895 … 0.27716038918572206 0.29313119152221684; 0.3343805320517515 0.32142600287814976 … 0.2931311915222168 0.3186160478236604;;; 0.3785174209872581 0.36364954270445204 … 0.33438053205175144 0.3664584407284554; 0.363649542704452 0.3519170664275238 … 0.3214260028781496 0.35191706642752374; … ; 0.3343805320517515 0.3214260028781497 … 0.29313119152221695 0.31861604782366043; 0.36645844072845535 0.35191706642752385 … 0.31861604782366043 0.35102886349162066]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923513814 -0.4966565572633309 … -0.4771919009960247 -0.4966565572633309; -0.4966565572633309 -0.4848182087479057 … -0.47638044579648736 -0.49204131120509526; … ; -0.4771919009960247 -0.47638044579648736 … -0.4122880708972777 -0.45507008158715795; -0.4966565572633309 -0.49204131120509526 … -0.45507008158715795 -0.4848182087479057;;; -0.4966565572633309 -0.4848182087479057 … -0.47638044579648736 -0.49204131120509526; -0.4848182087479057 -0.4583744079541183 … -0.47065601573522137 -0.48617902520930145; … ; -0.47638044579648736 -0.47065601573522137 … -0.4463984364536632 -0.4688943964177422; -0.49204131120509526 -0.48617902520930145 … -0.4688943964177423 -0.4861790252093015;;; -0.4771919009960247 -0.4550700815871579 … -0.4605141234494436 -0.4763804457964873; -0.4550700815871579 -0.40906618247145227 … -0.45671990834491283 -0.4688943964177422; … ; -0.4605141234494436 -0.45671990834491283 … -0.4451449566177331 -0.45671990834491283; -0.47638044579648736 -0.4688943964177422 … -0.4567199083449129 -0.47065601573522137;;; … ;;; -0.44947595085833303 -0.4551499722181841 … -0.37125986262624533 -0.4177457152196678; -0.4551499722181841 -0.44880351101759225 … -0.4174380107165489 -0.4441260993106733; … ; -0.37125986262624533 -0.4174380107165489 … -0.2536569832615724 -0.2997980910577913; -0.4177457152196678 -0.4441260993106733 … -0.2997980910577913 -0.36106343266332697;;; -0.4771919009960247 -0.4763804457964873 … -0.41228807089727765 -0.4550700815871579; -0.4763804457964873 -0.47065601573522137 … -0.4463984364536632 -0.4688943964177422; … ; -0.41228807089727765 -0.4463984364536632 … -0.2536569832615725 -0.3410633023183163; -0.45507008158715795 -0.4688943964177423 … -0.3410633023183163 -0.4090661824714523;;; -0.4966565572633309 -0.49204131120509526 … -0.45507008158715795 -0.4848182087479057; -0.49204131120509526 -0.48617902520930145 … -0.4688943964177422 -0.48617902520930145; … ; -0.45507008158715795 -0.4688943964177422 … -0.3410633023183163 -0.4090661824714523; -0.4848182087479057 -0.4861790252093015 … -0.4090661824714523 -0.4583744079541183])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4127417760956855 -0.4874266763601715 … -0.7026973954992981 -0.48742667636017134; -0.4874266763601712 -0.7738703030731674 … -0.41393901829904184 -0.3817933911725066; … ; -0.7026973954992983 -0.413939018299042 … -2.396890218026663 -1.2941386091686804; -0.48742667636017134 -0.38179339117250694 … -1.2941386091686806 -0.7738703030731673;;; -0.48742667636017145 -0.7738703030731673 … -0.41393901829904184 -0.3817933911725063; -0.7738703030731671 -1.4815303728470086 … -0.32444274389980166 -0.4499565543154694; … ; -0.41393901829904206 -0.32444274389980177 … -1.0113865017365071 -0.6391785258832328; -0.3817933911725066 -0.44995655431546966 … -0.6391785258832332 -0.44995655431546955;;; -0.7026973954992981 -1.2941386091686806 … -0.298321334913122 -0.41393901829904167; -1.2941386091686802 -2.9234702458744555 … -0.35179963881175685 -0.639178525883233; … ; -0.2983213349131222 -0.35179963881175713 … -0.4906064708117605 -0.35179963881175685; -0.413939018299042 -0.6391785258832333 … -0.35179963881175663 -0.32444274389980154;;; … ;;; -1.015048126840159 -0.5338983580850809 … -3.638038941457792 -1.9993625019477428; -0.5338983580850807 -0.3216988269789076 … -1.463947529973619 -0.9061370441818511; … ; -3.638038941457792 -1.463947529973619 … -10.993621243006308 -8.086551292403739; -1.9993625019477428 -0.906137044181851 … -8.086551292403739 -4.6478525584085775;;; -0.7026973954992981 -0.4139390182990418 … -2.396890218026664 -1.294138609168681; -0.4139390182990417 -0.32444274389980166 … -1.0113865017365065 -0.639178525883233; … ; -2.3968902180266634 -1.0113865017365065 … -11.003061433331732 -6.073393711771634; -1.2941386091686806 -0.6391785258832332 … -6.073393711771636 -2.923470245874455;;; -0.4874266763601715 -0.38179339117250644 … -1.294138609168681 -0.7738703030731673; -0.38179339117250644 -0.4499565543154694 … -0.6391785258832331 -0.4499565543154693; … ; -1.294138609168681 -0.6391785258832331 … -6.073393711771636 -2.9234702458744546; -0.7738703030731672 -0.44995655431546966 … -2.923470245874455 -1.4815303728470084]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.09701496972160534 + 0.21038179485436975im -0.0705310521469115 + 0.11393076687010509im … -0.044620917936517596 - 0.057416943973111825im -0.10349423062820835 + 0.02720267848212711im; -0.04645009978311923 + 0.1280639581625707im -0.0016537134252733164 + 0.002179431028790598im … -0.054956211997360144 - 0.02098561918253583im -0.08735329690410215 + 0.038833293911989426im; … ; 0.08072988925108476 + 0.016151865739376957im 0.050830430775035275 + 0.041100917011916024im … 0.009577840295092156 - 0.020770023893283612im 0.03861283608080075 - 0.06868413597925896im; 0.058410756038399424 + 0.12222525928339195im 0.02481576259264062 + 0.10466569243547015im … 0.044432620531567324 - 0.06526848464829534im 0.05574389860581876 - 0.07346496907281502im;;; -0.04843241718913792 + 0.3033031589312739im -0.052077309047215886 + 0.09542561757526542im … -0.04151838715261714 - 0.024165575635480687im -0.061678273642738646 + 0.13435275195235935im; 0.05564534817861187 + 0.15864840677962377im 0.049936543577766626 - 0.08079980198022292im … -0.02778250411080358 + 0.011312410917362722im -0.0031523494664957856 + 0.11474355223338936im; … ; 0.051447878983105266 + 0.030396638427066747im 0.026570265719949727 + 0.043212234423736465im … 0.0060299017280396015 - 0.043164254405832825im 0.028425210347344288 - 0.04480412547422223im; 0.03130501963561932 + 0.18892495953964278im -0.014188227158494465 + 0.10826655906632668im … -0.0010958459598183871 - 0.06213013254265787im 0.013965490320970792 + 0.0008385799570600639im;;; 0.0014879262237261067 + 0.1517623082547803im -0.027160803947085137 - 0.03302562925168782im … -0.010229852359744246 + 0.022361200188972086im 0.00026889033178857506 + 0.11423757638167525im; 0.04521808972339021 + 0.009453786664347404im 0.016397248834824983 - 0.1868791480284182im … 0.0019993873243074325 + 0.03245924757929637im 0.028221116004254358 + 0.07455434169695813im; … ; 0.01722415350090085 + 0.03847404858982402im 0.001391623040404841 + 0.03210254883846335im … 0.0031211125406661 - 0.021718313413006583im 0.013564013449810099 + 0.0007673176827313211im; 0.003394259495883888 + 0.11607186619671582im -0.023669140321091013 + 0.04409977605435452im … -0.0029462054077847967 - 0.008922585253821218im 0.005806135521363882 + 0.05571694615904587im;;; … ;;; 0.012787847561752289 + 0.019080834021276895im 0.005324275384936584 + 0.018586008138022938im … 0.017182563659648282 - 0.007344038137293175im 0.019360087529010347 + 0.006505072597947562im; -0.00030377317532224204 + 0.015282887565223724im -0.0030433822955221778 + 0.0101082009852157im … 0.011778303590870922 + 0.006051937972805418im 0.006302868100588527 + 0.012442392476758744im; … ; -0.011509526349542979 - 0.024183522172818883im 0.0003391979931577255 - 0.0006617116324659425im … -0.03795743352462328 - 0.06969966095884132im -0.029171988715046067 - 0.05863360088844678im; 0.011617564722946668 + 0.0019609598703260516im 0.009839764309258882 + 0.014518208636189075im … -0.006980235337611799 - 0.04560918637574643im 0.006162671022947959 - 0.026901381310615244im;;; 0.013376330273352822 + 0.05708784962410961im -0.00017299342829959818 + 0.03583329022286326im … 0.045538189931431564 + 0.023218985174417617im 0.036385412028815595 + 0.04219669158133202im; -0.01744796991144953 + 0.02569454847539772im -0.012499382164075947 + 0.010922543928246712im … 0.007508929434642311 + 0.014235021153774747im -0.009889100532004473 + 0.02159178866454987im; … ; 0.001376419937321363 - 0.0026997063124041877im 0.014319161030902468 + 0.018231968703195676im … -0.0524631837264032 - 0.07825894824700422im -0.03191065628851697 - 0.05327668678760121im; 0.04982712550640288 + 0.05008567807949im 0.024522704943034924 + 0.041788192731214244im … 0.04046823712260156 - 0.010797271029684821im 0.06467492161885992 + 0.018953335829552366im;;; -0.039572078204428277 + 0.12498883469899151im -0.029124033945910763 + 0.06300210282073436im … 0.03430429609511083 + 0.01807317566081945im -0.00928141122741174 + 0.039024839176784454im; -0.053102535857490925 + 0.04892903919102082im -0.02290082523083433 + 0.010156204286321246im … -0.024576090041083506 - 0.0010189248825189453im -0.06014169135141257 + 0.016924492879036704im; … ; 0.04534017353187805 + 0.02455016863720185im 0.03927509094956013 + 0.03645554753617629im … -0.011460649411867556 + 0.009840841820840024im 0.008715080677115293 - 0.018298743079595954im; 0.09844124570904988 + 0.10224762818270168im 0.03823981430892408 + 0.07466492915518957im … 0.10169837395588308 + 0.0362734645269984im 0.11811648164057749 - 0.006204246683450196im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.39155563712673486 0.37851742098725805 … 0.3446996003417713 0.3785174209872581; 0.378517420987258 0.36645844072845535 … 0.32735728179230383 0.36364954270445193; … ; 0.3446996003417713 0.3273572817923039 … 0.3075192694718448 0.33438053205175144; 0.3785174209872581 0.36364954270445204 … 0.3343805320517515 0.36645844072845535;;; 0.3785174209872581 0.36645844072845535 … 0.3273572817923039 0.3636495427044521; 0.36645844072845524 0.3510288634916206 … 0.31119401352806253 0.35191706642752374; … ; 0.3273572817923039 0.3111940135280626 … 0.2982412284613895 0.3214260028781497; 0.36364954270445204 0.3519170664275238 … 0.3214260028781497 0.3519170664275238;;; 0.3446996003417713 0.3343805320517515 … 0.286535153824198 0.327357281792304; 0.3343805320517514 0.3186160478236603 … 0.27805891887876105 0.32142600287814965; … ; 0.286535153824198 0.2780589188787611 … 0.25590185776500496 0.2780589188787611; 0.32735728179230394 0.3214260028781497 … 0.27805891887876116 0.3111940135280626;;; … ;;; 0.30487474934010333 0.28303666901175356 … 0.2855643323608194 0.3009573705669117; 0.28303666901175345 0.25898431627201407 … 0.27263300132129503 0.28541419667024676; … ; 0.2855643323608194 0.2726330013212951 … 0.27716038918572206 0.2812108738311416; 0.3009573705669117 0.28541419667024687 … 0.2812108738311416 0.29308272632096877;;; 0.34469960034177133 0.32735728179230394 … 0.3075192694718447 0.3343805320517515; 0.32735728179230383 0.31119401352806253 … 0.2982412284613894 0.32142600287814965; … ; 0.30751926947184477 0.2982412284613895 … 0.27716038918572206 0.29313119152221684; 0.3343805320517515 0.32142600287814976 … 0.2931311915222168 0.3186160478236604;;; 0.3785174209872581 0.36364954270445204 … 0.33438053205175144 0.3664584407284554; 0.363649542704452 0.3519170664275238 … 0.3214260028781496 0.35191706642752374; … ; 0.3343805320517515 0.3214260028781497 … 0.29313119152221695 0.31861604782366043; 0.36645844072845535 0.35191706642752385 … 0.31861604782366043 0.35102886349162066]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923513814 -0.4966565572633309 … -0.4771919009960247 -0.4966565572633309; -0.4966565572633309 -0.4848182087479057 … -0.47638044579648736 -0.49204131120509526; … ; -0.4771919009960247 -0.47638044579648736 … -0.4122880708972777 -0.45507008158715795; -0.4966565572633309 -0.49204131120509526 … -0.45507008158715795 -0.4848182087479057;;; -0.4966565572633309 -0.4848182087479057 … -0.47638044579648736 -0.49204131120509526; -0.4848182087479057 -0.4583744079541183 … -0.47065601573522137 -0.48617902520930145; … ; -0.47638044579648736 -0.47065601573522137 … -0.4463984364536632 -0.4688943964177422; -0.49204131120509526 -0.48617902520930145 … -0.4688943964177423 -0.4861790252093015;;; -0.4771919009960247 -0.4550700815871579 … -0.4605141234494436 -0.4763804457964873; -0.4550700815871579 -0.40906618247145227 … -0.45671990834491283 -0.4688943964177422; … ; -0.4605141234494436 -0.45671990834491283 … -0.4451449566177331 -0.45671990834491283; -0.47638044579648736 -0.4688943964177422 … -0.4567199083449129 -0.47065601573522137;;; … ;;; -0.44947595085833303 -0.4551499722181841 … -0.37125986262624533 -0.4177457152196678; -0.4551499722181841 -0.44880351101759225 … -0.4174380107165489 -0.4441260993106733; … ; -0.37125986262624533 -0.4174380107165489 … -0.2536569832615724 -0.2997980910577913; -0.4177457152196678 -0.4441260993106733 … -0.2997980910577913 -0.36106343266332697;;; -0.4771919009960247 -0.4763804457964873 … -0.41228807089727765 -0.4550700815871579; -0.4763804457964873 -0.47065601573522137 … -0.4463984364536632 -0.4688943964177422; … ; -0.41228807089727765 -0.4463984364536632 … -0.2536569832615725 -0.3410633023183163; -0.45507008158715795 -0.4688943964177423 … -0.3410633023183163 -0.4090661824714523;;; -0.4966565572633309 -0.49204131120509526 … -0.45507008158715795 -0.4848182087479057; -0.49204131120509526 -0.48617902520930145 … -0.4688943964177422 -0.48617902520930145; … ; -0.45507008158715795 -0.4688943964177422 … -0.3410633023183163 -0.4090661824714523; -0.4848182087479057 -0.4861790252093015 … -0.4090661824714523 -0.4583744079541183])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4127417760956855 -0.4874266763601715 … -0.7026973954992981 -0.48742667636017134; -0.4874266763601712 -0.7738703030731674 … -0.41393901829904184 -0.3817933911725066; … ; -0.7026973954992983 -0.413939018299042 … -2.396890218026663 -1.2941386091686804; -0.48742667636017134 -0.38179339117250694 … -1.2941386091686806 -0.7738703030731673;;; -0.48742667636017145 -0.7738703030731673 … -0.41393901829904184 -0.3817933911725063; -0.7738703030731671 -1.4815303728470086 … -0.32444274389980166 -0.4499565543154694; … ; -0.41393901829904206 -0.32444274389980177 … -1.0113865017365071 -0.6391785258832328; -0.3817933911725066 -0.44995655431546966 … -0.6391785258832332 -0.44995655431546955;;; -0.7026973954992981 -1.2941386091686806 … -0.298321334913122 -0.41393901829904167; -1.2941386091686802 -2.9234702458744555 … -0.35179963881175685 -0.639178525883233; … ; -0.2983213349131222 -0.35179963881175713 … -0.4906064708117605 -0.35179963881175685; -0.413939018299042 -0.6391785258832333 … -0.35179963881175663 -0.32444274389980154;;; … ;;; -1.015048126840159 -0.5338983580850809 … -3.638038941457792 -1.9993625019477428; -0.5338983580850807 -0.3216988269789076 … -1.463947529973619 -0.9061370441818511; … ; -3.638038941457792 -1.463947529973619 … -10.993621243006308 -8.086551292403739; -1.9993625019477428 -0.906137044181851 … -8.086551292403739 -4.6478525584085775;;; -0.7026973954992981 -0.4139390182990418 … -2.396890218026664 -1.294138609168681; -0.4139390182990417 -0.32444274389980166 … -1.0113865017365065 -0.639178525883233; … ; -2.3968902180266634 -1.0113865017365065 … -11.003061433331732 -6.073393711771634; -1.2941386091686806 -0.6391785258832332 … -6.073393711771636 -2.923470245874455;;; -0.4874266763601715 -0.38179339117250644 … -1.294138609168681 -0.7738703030731673; -0.38179339117250644 -0.4499565543154694 … -0.6391785258832331 -0.4499565543154693; … ; -1.294138609168681 -0.6391785258832331 … -6.073393711771636 -2.9234702458744546; -0.7738703030731672 -0.44995655431546966 … -2.923470245874455 -1.4815303728470084]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.22631283647137168 - 0.03255172480285292im -0.09848534454809418 - 0.03580257002198377im … -0.08004041655395486 + 0.05361100731846093im -0.217595005626342 + 0.07150195080350247im; -0.015713318749032687 - 0.23470689296096564im 0.06248127679361543 - 0.15706680606513662im … -0.04100377101877145 - 0.00034245379377829im -0.06374093476854611 - 0.1171931581772538im; … ; -0.001167848311753053 - 0.010154049567238749im -0.02584857427765492 + 0.0070351281572725325im … 0.05111516839928204 - 0.01941872218713611im 0.0467214553461112 - 0.028318724712316393im; -0.15038790341346653 + 0.042921869087056544im -0.09206579938546885 + 0.02595388994076421im … 0.024727643280825478 + 0.0003663869812015343im -0.06037906216110411 + 0.029284531294716355im;;; -0.03784688752850393 + 0.003999219387396303im 0.06383429868124744 - 0.005377198282365959im … -0.06437012780294492 + 0.0013299382710262727im -0.10593228757955336 + 0.011143808035064857im; 0.18773500035005158 - 0.1080702024919395im 0.20850811201513536 - 0.03145254479214636im … -0.009359112801587958 - 0.01747820063945496im 0.06240750370966171 - 0.06300463137165532im; … ; -0.031445208346100574 + 0.001914883351208468im -0.0281533384744074 + 0.01413938130415724im … 0.006665759163589626 - 0.018362405892454244im -0.012193050430460905 - 0.017663707005771183im; -0.09358539828791312 + 0.036677031812949595im -0.03667098453491854 + 0.029064636836555077im … -0.033877708957088914 - 0.011786940117130927im -0.0854587148784133 + 0.006793191947410985im;;; 0.06812615643626656 + 0.02526443785770588im 0.07862907092299248 - 0.0010509336360921958im … -0.012013537502909913 + 0.004870133106807475im 0.01606804352432889 + 0.021847682642243915im; 0.13407113408209986 + 0.004307377895989648im 0.08394066808371142 - 0.0037660368039259817im … 0.018750862378141435 + 0.0009820333951567014im 0.07466003522812746 + 0.005973187715910902im; … ; -0.017210466256773457 + 0.011643148582612393im -0.008557190455249221 + 0.014263895950181238im … -0.008157232504342301 - 0.00905841052598213im -0.01625855620848554 - 0.0013700513004504208im; -0.007869261401885107 + 0.02990913001304428im 0.014174357345826134 + 0.01793527052437279im … -0.02140721475746063 - 0.0019779731234171247im -0.02409881299887523 + 0.015508186457806536im;;; … ;;; 0.013917545580593719 + 0.032534697041808516im 0.008578319899360094 + 0.01924892483817772im … -0.015137518761043866 - 0.029294603585294537im 0.0029019995349380515 + 0.015305123937241358im; 0.009760847742551567 + 0.03227118005108335im 0.004921558959727333 + 0.009153134351572344im … -0.006473775973283459 + 0.01571382305202942im 0.0044228076467217 + 0.040362760662830385im; … ; 0.0029893470291902455 - 0.01500233356937308im 0.00991733939244075 - 0.004304395121086359im … -0.04322582466676893 - 0.025638371185228048im -0.023556667546673266 - 0.029290544432987307im; 0.015728088475021884 - 0.0022735212342426966im 0.01314295219542783 + 0.007518004558335221im … -0.030015033197868808 - 0.0691773671474711im -0.004029021411166327 - 0.03878139674983887im;;; 0.021164840485331703 + 0.09649412937131194im -0.005362304431283041 + 0.026106643483359032im … 0.016258685468971714 + 0.03627673094530583im 0.04614895067414505 + 0.13766543818484306im; 0.009336521484553682 + 0.032057878505610204im -0.003690733788893712 - 0.015446252434404567im … 0.0024561624019156926 + 0.06690650509822146im 0.01610588525622078 + 0.09478658547855089im; … ; 0.0424281803143185 - 0.015014619383831616im 0.021538172779727485 - 0.0017102728762684303im … -0.029877106402059886 - 0.04890994359447953im 0.028588184948700954 - 0.038924690798460254im; 0.05736825306034295 + 0.03119691705346859im 0.01296779552373097 + 0.01976535192119113im … 0.021928296420110807 - 0.08056862882757217im 0.08394066824188622 - 0.0037660369062094386im;;; -0.10673203553237165 + 0.10848240399901257im -0.07116727537591762 + 0.0026738114296657413im … 0.02796486227418646 + 0.13140352071960368im -0.032317171712679324 + 0.2256991564259126im; -0.03064334382672527 - 0.10305248559687692im -0.016697868584962722 - 0.09750145479542717im … -0.007402525694261953 + 0.08036121235289224im -0.01823004264592025 + 0.0593042824223531im; … ; 0.05999017352635426 - 0.01141536297349628im 0.008197537513079157 + 0.001918573388502066im … 0.059698569821063946 - 0.026289918480024245im 0.10623371005957533 - 0.027104077992194803im; 0.0166053424902489 + 0.06625844317804344im -0.03545294869800589 + 0.027217152180254472im … 0.121965459276098 + 0.000990998244638706im 0.13962296420836473 + 0.07303063972809937im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729848), converged = true, ρ = [0.09132316920047084 0.08747419136225823 … 0.07684754937588564 0.08747419136225822; 0.08747419136225823 0.08089966874173432 … 0.07642471018516611 0.08486944836418969; … ; 0.07684754937588564 0.07642471018516611 … 0.0477846666798408 0.06587895343762287; 0.08747419136225823 0.08486944836418972 … 0.06587895343762287 0.08089966874173432;;; 0.08747419136225822 0.0808996687417343 … 0.07642471018516611 0.08486944836418969; 0.0808996687417343 0.06744471471649865 … 0.07348669936198307 0.08163768630846838; … ; 0.07642471018516611 0.07348669936198307 … 0.06188804120782525 0.07259829029763702; 0.0848694483641897 0.08163768630846839 … 0.07259829029763704 0.0816376863084684;;; 0.07684754937588563 0.06587895343762286 … 0.0684720370026586 0.0764247101851661; 0.06587895343762286 0.0465786426618029 … 0.06665759372758419 0.07259829029763702; … ; 0.0684720370026586 0.06665759372758419 … 0.06132515315018561 0.06665759372758419; 0.07642471018516611 0.07259829029763702 … 0.0666575937275842 0.07348669936198307;;; … ;;; 0.06328495230682704 0.06591651446737684 … 0.033940648883009954 0.049875934866562076; 0.06591651446737684 0.06297790961011686 … 0.04975639788649119 0.06087020457676085; … ; 0.033940648883009954 0.04975639788649119 … 0.009696353211227478 0.016831338792255665; 0.04987593486656209 0.060870204576760865 … 0.016831338792255665 0.030985721889346302;;; 0.07684754937588564 0.0764247101851661 … 0.047784666679840805 0.06587895343762286; 0.0764247101851661 0.07348669936198307 … 0.061888041207825234 0.07259829029763702; … ; 0.047784666679840805 0.061888041207825234 … 0.009696353211227488 0.025710010679622884; 0.06587895343762287 0.07259829029763704 … 0.025710010679622888 0.04657864266180291;;; 0.08747419136225823 0.08486944836418969 … 0.06587895343762287 0.0808996687417343; 0.08486944836418969 0.08163768630846839 … 0.07259829029763702 0.08163768630846839; … ; 0.06587895343762287 0.07259829029763702 … 0.02571001067962289 0.04657864266180291; 0.08089966874173432 0.0816376863084684 … 0.04657864266180291 0.06744471471649865;;;;], ψ = Matrix{ComplexF64}[[0.4524164530830477 - 0.8416091839168962im -1.9721460575716776e-11 - 1.3623432243425881e-10im -3.724943270499992e-11 - 2.759034840871255e-11im -1.4132112147180464e-11 - 1.9278657836796498e-10im; 0.04559190614270972 - 0.08481249201790342im 0.4549029335585956 + 0.11011080200330844im -0.03658625801323839 - 0.13646972665749105im 0.09277690052479723 + 0.06768986439303165im; … ; 0.005584405009392742 - 0.010388407342156484im -0.046634530172184864 - 0.00559251929712148im -0.026704311892980954 - 0.02396541654877239im 0.0019630321802089137 + 0.0033358550416650833im; -0.045591905683825026 + 0.08481249237905773im -0.0016594507137823056 + 0.05535880192850248im -0.2980273918827993 - 0.3710964635836408im 0.11199541810498254 + 0.10034862149985012im], [0.8615764499493552 - 0.3467583735223321im 0.19073802167112552 - 0.04977124162662271im -5.410266956662468e-10 - 4.963579547379027e-10im 3.5219205329894976e-10 - 5.123886176461312e-10im; 0.05873532724946392 - 0.02363918654877699im -0.008489212267943299 + 0.0022151774915021923im -7.62290680231259e-10 - 8.763543155043685e-10im 8.651933804809664e-10 - 7.401749499771904e-10im; … ; 0.0071902660841336695 - 0.0028938637309085472im 0.08346389951028554 - 0.021779096839668548im -0.0023770559377587677 - 0.009553410121643275im -0.09542424753836035 - 0.021097114955432813im; -0.1047653430403749 + 0.04216487122112875im -0.0877686823703112 + 0.022902388786267165im -0.014886278030350225 - 0.05982808983545121im -0.5975929458777791 - 0.13212037012823533im], [-0.39101576301951146 + 0.8479371594012393im 3.099681622487083e-11 + 3.649838764552271e-11im 1.4440218465416876e-10 - 3.8872183250049375e-11im 1.7240059380085881e-10 + 9.070938444821763e-13im; -0.0287890267443309 + 0.062430438008789974im 0.03456971316337894 - 0.04555947744685239im -0.023464605910410608 - 0.024028233842251244im 0.0033340138343340054 + 0.015725489722412205im; … ; -0.005808293338805039 + 0.012595573671842338im -1.1634913865687935e-10 - 1.2626386047820404e-11im 0.03724183809383004 + 0.026691446927908584im -0.009384729445665048 - 0.124813709055725im; 0.06415741306313821 - 0.13912854606438987im 0.1735592331796993 - 0.22873397898645212im -0.15414970140433443 - 0.23748771253902856im -0.006577932048738078 - 0.5914945799869742im], [0.7933944058299487 + 0.15819859398491054im -2.802483245467613e-11 + 4.417184500116189e-12im 0.22512525585608387 - 0.44112229555896737im -2.471465653658411e-10 + 2.085837058629636e-10im; 0.3799934771162866 + 0.07576866354526024im 0.3448931170887351 - 0.5231248272917284im -0.24490233662929456 + 0.47987454902566945im 1.817658523695087e-10 - 1.7436604937692834e-10im; … ; 0.011173727585662888 + 0.0022279814242200974im 0.0009047121605059226 - 0.001372243821917119im -0.009489111156004815 + 0.018593464239968046im -0.007335568504408605 - 0.005551971077394581im; -0.06392142523907685 - 0.012745589733147145im 0.006872206893308896 - 0.010423583767281433im -0.05735361813631393 + 0.11238170012981749im -0.14248461587386058 - 0.10784037370817673im]], eigenvalues = Any[[-0.16677707594707614, 0.26427771785331294, 0.2642777178533131, 0.2642777178533133], [-0.11613218759351254, 0.0704053232165448, 0.22624813605121216, 0.2262481360512123], [-0.095889381419029, 0.08764319970124974, 0.17312704144490748, 0.17312704144490773], [-0.04505146346619582, 0.022269526259351302, 0.09831189252660744, 0.18446409323951485]], occupation = [[2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0]], εF = nothing, optim_res =  * Status: success

 * Candidate solution
    Final objective value:     -7.852647e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 5.03e-09 ≰ 1.0e-12
    |x - x&#39;|/|x&#39;|          = 6.97e-09 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 0.00e+00 ≤ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 0.00e+00 ≰ -1.0e+00
    |g(x)|                 = 3.81e-09 ≰ -1.0e+00

 * Work counters
    Seconds run:   2  (vs limit Inf)
    Iterations:    45
    f(x) calls:    50
    ∇f(x) calls:   47
)</code></pre><p>Start not too far from the solution to ensure convergence: We run first a very crude SCF to get close and then switch to Newton.</p><pre><code class="language-julia hljs">scfres_start = self_consistent_field(basis; tol=1e-1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3930197306088847 0.3797265624666173 … 0.3452309471934772 0.3797265624666173; 0.3797265624666173 0.36717003729371006 … 0.3281972487142082 0.36490120509495205; … ; 0.3452309471934773 0.3281972487142082 … 0.3067539297179811 0.3343063281021195; 0.37972656246661735 0.3649012050949521 … 0.3343063281021195 0.3671700372937101;;; 0.3797265624666173 0.36717003729371006 … 0.32819724871420813 0.36490120509495205; 0.36717003729371006 0.3511293859294481 … 0.31210153318001665 0.35292382482143975; … ; 0.3281972487142082 0.31210153318001665 … 0.2978571906764189 0.3217821206667258; 0.3649012050949521 0.35292382482143975 … 0.3217821206667259 0.3529238248214398;;; 0.34523094719347724 0.3343063281021195 … 0.28730488772851165 0.32819724871420813; 0.3343063281021195 0.31800571871511313 … 0.27861247163741604 0.3217821206667258; … ; 0.2873048877285117 0.2786124716374161 … 0.25588212768142515 0.27861247163741604; 0.3281972487142082 0.3217821206667258 … 0.2786124716374161 0.31210153318001665;;; … ;;; 0.30457732773639057 0.2831761057412766 … 0.28432960645587535 0.30014591527569834; 0.28317610574127666 0.25945413040241855 … 0.2715638421009945 0.28497553279327376; … ; 0.2843296064558754 0.2715638421009945 … 0.27592215824219407 0.2799587735660179; 0.3001459152756984 0.2849755327932738 … 0.27995877356601795 0.2919850161427644;;; 0.3452309471934772 0.32819724871420813 … 0.306753929717981 0.3343063281021195; 0.32819724871420813 0.3121015331800166 … 0.29785719067641886 0.32178212066672573; … ; 0.30675392971798104 0.29785719067641886 … 0.27592215824219407 0.2920624184660546; 0.3343063281021195 0.32178212066672585 … 0.2920624184660546 0.31800571871511313;;; 0.3797265624666173 0.364901205094952 … 0.3343063281021195 0.36717003729371006; 0.364901205094952 0.3529238248214398 … 0.32178212066672585 0.35292382482143975; … ; 0.3343063281021196 0.32178212066672585 … 0.2920624184660547 0.3180057187151131; 0.3671700372937101 0.35292382482143975 … 0.3180057187151131 0.35112938592944815]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.504529838344268 -0.49777105047566084 … -0.47794643505852524 -0.49777105047566084; -0.49777105047566084 -0.48576328261604707 … -0.4772014139925923 -0.4931168276894151; … ; -0.47794643505852524 -0.4772014139925923 … -0.41222454493481075 -0.45556459239236835; -0.49777105047566084 -0.49311682768941506 … -0.45556459239236835 -0.48576328261604707;;; -0.49777105047566084 -0.4857632826160471 … -0.4772014139925923 -0.4931168276894151; -0.48576328261604707 -0.45912869354461094 … -0.47148313777008705 -0.487139106443907; … ; -0.4772014139925923 -0.47148313777008705 … -0.44644454677480455 -0.4694733795135404; -0.49311682768941506 -0.487139106443907 … -0.4694733795135405 -0.487139106443907;;; -0.4779464350585252 -0.45556459239236835 … -0.4612366348754974 -0.4772014139925923; -0.45556459239236835 -0.4093360412707736 … -0.45731085330421495 -0.4694733795135404; … ; -0.4612366348754974 -0.45731085330421495 … -0.44531860495387704 -0.45731085330421495; -0.4772014139925923 -0.4694733795135404 … -0.457310853304215 -0.47148313777008705;;; … ;;; -0.4495959969714919 -0.4554612184464642 … -0.37047831518743046 -0.4175261828995339; -0.4554612184464642 -0.44929521503988995 … -0.41672646609733766 -0.4440502049523115; … ; -0.37047831518743046 -0.41672646609733766 … -0.25287680680354685 -0.2990288642483112; -0.41752618289953386 -0.4440502049523115 … -0.2990288642483112 -0.3606421533621921;;; -0.4779464350585252 -0.4772014139925923 … -0.41222454493481087 -0.45556459239236835; -0.4772014139925923 -0.47148313777008705 … -0.44644454677480455 -0.4694733795135404; … ; -0.41222454493481075 -0.44644454677480455 … -0.25287680680354696 -0.34080653040991016; -0.45556459239236835 -0.4694733795135404 … -0.34080653040991016 -0.4093360412707736;;; -0.49777105047566084 -0.4931168276894151 … -0.45556459239236835 -0.4857632826160471; -0.49311682768941506 -0.487139106443907 … -0.4694733795135404 -0.4871391064439069; … ; -0.45556459239236835 -0.4694733795135404 … -0.34080653040991016 -0.4093360412707736; -0.48576328261604707 -0.487139106443907 … -0.40933604127077367 -0.45912869354461094])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41249932860642236 -0.4873320280931422 … -0.7029205827100927 -0.4873320280931421; -0.4873320280931418 -0.774103780376054 … -0.4139200195732424 -0.38161724526632634; … ; -0.7029205827100928 -0.41392001957324265 … -2.3975920318180597 -1.2947073239235227; -0.487332028093142 -0.3816172452663267 … -1.294707323923523 -0.7741037803760539;;; -0.4873320280931422 -0.774103780376054 … -0.41392001957324254 -0.38161724526632623; -0.7741037803760535 -1.4821841359996735 … -0.3243623462827132 -0.44990987715615893; … ; -0.4139200195732427 -0.32436234628271343 … -1.0118166498426189 -0.6394013911904548; -0.38161724526632634 -0.44990987715615927 … -0.6394013911904552 -0.44990987715615904;;; -0.7029205827100926 -1.2947073239235232 … -0.2982741124348621 -0.41392001957324254; -1.2947073239235227 -2.924350433782324 … -0.351837031012404 -0.639401391190455; … ; -0.29827411243486224 -0.35183703101240427 … -0.49079984923148423 -0.35183703101240404; -0.4139200195732427 -0.6394013911904555 … -0.3518370310124038 -0.3243623462827132;;; … ;;; -1.0154655945570306 -0.534070167583838 … -3.638492119923921 -1.9999544249188221; -0.5340701675838375 -0.32172071687080084 … -1.4643051445747082 -0.9064998137004623; … ; -3.638492119923921 -1.4643051445747082 … -10.99407929749181 -8.087034165859382; -1.9999544249188221 -0.9064998137004623 … -8.087034165859382 -4.648528989285647;;; -0.7029205827100926 -0.4139200195732426 … -2.3975920318180606 -1.2947073239235234; -0.4139200195732424 -0.3243623462827132 … -1.0118166498426182 -0.6394013911904551; … ; -2.3975920318180597 -1.0118166498426184 … -11.003519487817234 -6.07420571291939; -1.294707323923523 -0.6394013911904552 … -6.074205712919392 -2.924350433782324;;; -0.48733202809314224 -0.38161724526632634 … -1.2947073239235234 -0.774103780376054; -0.38161724526632623 -0.44990987715615893 … -0.639401391190455 -0.44990987715615877; … ; -1.2947073239235234 -0.6394013911904551 … -6.074205712919392 -2.9243504337823234; -0.7741037803760538 -0.44990987715615927 … -2.924350433782324 -1.4821841359996735]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3930197306088847 0.3797265624666173 … 0.3452309471934772 0.3797265624666173; 0.3797265624666173 0.36717003729371006 … 0.3281972487142082 0.36490120509495205; … ; 0.3452309471934773 0.3281972487142082 … 0.3067539297179811 0.3343063281021195; 0.37972656246661735 0.3649012050949521 … 0.3343063281021195 0.3671700372937101;;; 0.3797265624666173 0.36717003729371006 … 0.32819724871420813 0.36490120509495205; 0.36717003729371006 0.3511293859294481 … 0.31210153318001665 0.35292382482143975; … ; 0.3281972487142082 0.31210153318001665 … 0.2978571906764189 0.3217821206667258; 0.3649012050949521 0.35292382482143975 … 0.3217821206667259 0.3529238248214398;;; 0.34523094719347724 0.3343063281021195 … 0.28730488772851165 0.32819724871420813; 0.3343063281021195 0.31800571871511313 … 0.27861247163741604 0.3217821206667258; … ; 0.2873048877285117 0.2786124716374161 … 0.25588212768142515 0.27861247163741604; 0.3281972487142082 0.3217821206667258 … 0.2786124716374161 0.31210153318001665;;; … ;;; 0.30457732773639057 0.2831761057412766 … 0.28432960645587535 0.30014591527569834; 0.28317610574127666 0.25945413040241855 … 0.2715638421009945 0.28497553279327376; … ; 0.2843296064558754 0.2715638421009945 … 0.27592215824219407 0.2799587735660179; 0.3001459152756984 0.2849755327932738 … 0.27995877356601795 0.2919850161427644;;; 0.3452309471934772 0.32819724871420813 … 0.306753929717981 0.3343063281021195; 0.32819724871420813 0.3121015331800166 … 0.29785719067641886 0.32178212066672573; … ; 0.30675392971798104 0.29785719067641886 … 0.27592215824219407 0.2920624184660546; 0.3343063281021195 0.32178212066672585 … 0.2920624184660546 0.31800571871511313;;; 0.3797265624666173 0.364901205094952 … 0.3343063281021195 0.36717003729371006; 0.364901205094952 0.3529238248214398 … 0.32178212066672585 0.35292382482143975; … ; 0.3343063281021196 0.32178212066672585 … 0.2920624184660547 0.3180057187151131; 0.3671700372937101 0.35292382482143975 … 0.3180057187151131 0.35112938592944815]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.504529838344268 -0.49777105047566084 … -0.47794643505852524 -0.49777105047566084; -0.49777105047566084 -0.48576328261604707 … -0.4772014139925923 -0.4931168276894151; … ; -0.47794643505852524 -0.4772014139925923 … -0.41222454493481075 -0.45556459239236835; -0.49777105047566084 -0.49311682768941506 … -0.45556459239236835 -0.48576328261604707;;; -0.49777105047566084 -0.4857632826160471 … -0.4772014139925923 -0.4931168276894151; -0.48576328261604707 -0.45912869354461094 … -0.47148313777008705 -0.487139106443907; … ; -0.4772014139925923 -0.47148313777008705 … -0.44644454677480455 -0.4694733795135404; -0.49311682768941506 -0.487139106443907 … -0.4694733795135405 -0.487139106443907;;; -0.4779464350585252 -0.45556459239236835 … -0.4612366348754974 -0.4772014139925923; -0.45556459239236835 -0.4093360412707736 … -0.45731085330421495 -0.4694733795135404; … ; -0.4612366348754974 -0.45731085330421495 … -0.44531860495387704 -0.45731085330421495; -0.4772014139925923 -0.4694733795135404 … -0.457310853304215 -0.47148313777008705;;; … ;;; -0.4495959969714919 -0.4554612184464642 … -0.37047831518743046 -0.4175261828995339; -0.4554612184464642 -0.44929521503988995 … -0.41672646609733766 -0.4440502049523115; … ; -0.37047831518743046 -0.41672646609733766 … -0.25287680680354685 -0.2990288642483112; -0.41752618289953386 -0.4440502049523115 … -0.2990288642483112 -0.3606421533621921;;; -0.4779464350585252 -0.4772014139925923 … -0.41222454493481087 -0.45556459239236835; -0.4772014139925923 -0.47148313777008705 … -0.44644454677480455 -0.4694733795135404; … ; -0.41222454493481075 -0.44644454677480455 … -0.25287680680354696 -0.34080653040991016; -0.45556459239236835 -0.4694733795135404 … -0.34080653040991016 -0.4093360412707736;;; -0.49777105047566084 -0.4931168276894151 … -0.45556459239236835 -0.4857632826160471; -0.49311682768941506 -0.487139106443907 … -0.4694733795135404 -0.4871391064439069; … ; -0.45556459239236835 -0.4694733795135404 … -0.34080653040991016 -0.4093360412707736; -0.48576328261604707 -0.487139106443907 … -0.40933604127077367 -0.45912869354461094])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41249932860642236 -0.4873320280931422 … -0.7029205827100927 -0.4873320280931421; -0.4873320280931418 -0.774103780376054 … -0.4139200195732424 -0.38161724526632634; … ; -0.7029205827100928 -0.41392001957324265 … -2.3975920318180597 -1.2947073239235227; -0.487332028093142 -0.3816172452663267 … -1.294707323923523 -0.7741037803760539;;; -0.4873320280931422 -0.774103780376054 … -0.41392001957324254 -0.38161724526632623; -0.7741037803760535 -1.4821841359996735 … -0.3243623462827132 -0.44990987715615893; … ; -0.4139200195732427 -0.32436234628271343 … -1.0118166498426189 -0.6394013911904548; -0.38161724526632634 -0.44990987715615927 … -0.6394013911904552 -0.44990987715615904;;; -0.7029205827100926 -1.2947073239235232 … -0.2982741124348621 -0.41392001957324254; -1.2947073239235227 -2.924350433782324 … -0.351837031012404 -0.639401391190455; … ; -0.29827411243486224 -0.35183703101240427 … -0.49079984923148423 -0.35183703101240404; -0.4139200195732427 -0.6394013911904555 … -0.3518370310124038 -0.3243623462827132;;; … ;;; -1.0154655945570306 -0.534070167583838 … -3.638492119923921 -1.9999544249188221; -0.5340701675838375 -0.32172071687080084 … -1.4643051445747082 -0.9064998137004623; … ; -3.638492119923921 -1.4643051445747082 … -10.99407929749181 -8.087034165859382; -1.9999544249188221 -0.9064998137004623 … -8.087034165859382 -4.648528989285647;;; -0.7029205827100926 -0.4139200195732426 … -2.3975920318180606 -1.2947073239235234; -0.4139200195732424 -0.3243623462827132 … -1.0118166498426182 -0.6394013911904551; … ; -2.3975920318180597 -1.0118166498426184 … -11.003519487817234 -6.07420571291939; -1.294707323923523 -0.6394013911904552 … -6.074205712919392 -2.924350433782324;;; -0.48733202809314224 -0.38161724526632634 … -1.2947073239235234 -0.774103780376054; -0.38161724526632623 -0.44990987715615893 … -0.639401391190455 -0.44990987715615877; … ; -1.2947073239235234 -0.6394013911904551 … -6.074205712919392 -2.9243504337823234; -0.7741037803760538 -0.44990987715615927 … -2.924350433782324 -1.4821841359996735]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3930197306088847 0.3797265624666173 … 0.3452309471934772 0.3797265624666173; 0.3797265624666173 0.36717003729371006 … 0.3281972487142082 0.36490120509495205; … ; 0.3452309471934773 0.3281972487142082 … 0.3067539297179811 0.3343063281021195; 0.37972656246661735 0.3649012050949521 … 0.3343063281021195 0.3671700372937101;;; 0.3797265624666173 0.36717003729371006 … 0.32819724871420813 0.36490120509495205; 0.36717003729371006 0.3511293859294481 … 0.31210153318001665 0.35292382482143975; … ; 0.3281972487142082 0.31210153318001665 … 0.2978571906764189 0.3217821206667258; 0.3649012050949521 0.35292382482143975 … 0.3217821206667259 0.3529238248214398;;; 0.34523094719347724 0.3343063281021195 … 0.28730488772851165 0.32819724871420813; 0.3343063281021195 0.31800571871511313 … 0.27861247163741604 0.3217821206667258; … ; 0.2873048877285117 0.2786124716374161 … 0.25588212768142515 0.27861247163741604; 0.3281972487142082 0.3217821206667258 … 0.2786124716374161 0.31210153318001665;;; … ;;; 0.30457732773639057 0.2831761057412766 … 0.28432960645587535 0.30014591527569834; 0.28317610574127666 0.25945413040241855 … 0.2715638421009945 0.28497553279327376; … ; 0.2843296064558754 0.2715638421009945 … 0.27592215824219407 0.2799587735660179; 0.3001459152756984 0.2849755327932738 … 0.27995877356601795 0.2919850161427644;;; 0.3452309471934772 0.32819724871420813 … 0.306753929717981 0.3343063281021195; 0.32819724871420813 0.3121015331800166 … 0.29785719067641886 0.32178212066672573; … ; 0.30675392971798104 0.29785719067641886 … 0.27592215824219407 0.2920624184660546; 0.3343063281021195 0.32178212066672585 … 0.2920624184660546 0.31800571871511313;;; 0.3797265624666173 0.364901205094952 … 0.3343063281021195 0.36717003729371006; 0.364901205094952 0.3529238248214398 … 0.32178212066672585 0.35292382482143975; … ; 0.3343063281021196 0.32178212066672585 … 0.2920624184660547 0.3180057187151131; 0.3671700372937101 0.35292382482143975 … 0.3180057187151131 0.35112938592944815]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.504529838344268 -0.49777105047566084 … -0.47794643505852524 -0.49777105047566084; -0.49777105047566084 -0.48576328261604707 … -0.4772014139925923 -0.4931168276894151; … ; -0.47794643505852524 -0.4772014139925923 … -0.41222454493481075 -0.45556459239236835; -0.49777105047566084 -0.49311682768941506 … -0.45556459239236835 -0.48576328261604707;;; -0.49777105047566084 -0.4857632826160471 … -0.4772014139925923 -0.4931168276894151; -0.48576328261604707 -0.45912869354461094 … -0.47148313777008705 -0.487139106443907; … ; -0.4772014139925923 -0.47148313777008705 … -0.44644454677480455 -0.4694733795135404; -0.49311682768941506 -0.487139106443907 … -0.4694733795135405 -0.487139106443907;;; -0.4779464350585252 -0.45556459239236835 … -0.4612366348754974 -0.4772014139925923; -0.45556459239236835 -0.4093360412707736 … -0.45731085330421495 -0.4694733795135404; … ; -0.4612366348754974 -0.45731085330421495 … -0.44531860495387704 -0.45731085330421495; -0.4772014139925923 -0.4694733795135404 … -0.457310853304215 -0.47148313777008705;;; … ;;; -0.4495959969714919 -0.4554612184464642 … -0.37047831518743046 -0.4175261828995339; -0.4554612184464642 -0.44929521503988995 … -0.41672646609733766 -0.4440502049523115; … ; -0.37047831518743046 -0.41672646609733766 … -0.25287680680354685 -0.2990288642483112; -0.41752618289953386 -0.4440502049523115 … -0.2990288642483112 -0.3606421533621921;;; -0.4779464350585252 -0.4772014139925923 … -0.41222454493481087 -0.45556459239236835; -0.4772014139925923 -0.47148313777008705 … -0.44644454677480455 -0.4694733795135404; … ; -0.41222454493481075 -0.44644454677480455 … -0.25287680680354696 -0.34080653040991016; -0.45556459239236835 -0.4694733795135404 … -0.34080653040991016 -0.4093360412707736;;; -0.49777105047566084 -0.4931168276894151 … -0.45556459239236835 -0.4857632826160471; -0.49311682768941506 -0.487139106443907 … -0.4694733795135404 -0.4871391064439069; … ; -0.45556459239236835 -0.4694733795135404 … -0.34080653040991016 -0.4093360412707736; -0.48576328261604707 -0.487139106443907 … -0.40933604127077367 -0.45912869354461094])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41249932860642236 -0.4873320280931422 … -0.7029205827100927 -0.4873320280931421; -0.4873320280931418 -0.774103780376054 … -0.4139200195732424 -0.38161724526632634; … ; -0.7029205827100928 -0.41392001957324265 … -2.3975920318180597 -1.2947073239235227; -0.487332028093142 -0.3816172452663267 … -1.294707323923523 -0.7741037803760539;;; -0.4873320280931422 -0.774103780376054 … -0.41392001957324254 -0.38161724526632623; -0.7741037803760535 -1.4821841359996735 … -0.3243623462827132 -0.44990987715615893; … ; -0.4139200195732427 -0.32436234628271343 … -1.0118166498426189 -0.6394013911904548; -0.38161724526632634 -0.44990987715615927 … -0.6394013911904552 -0.44990987715615904;;; -0.7029205827100926 -1.2947073239235232 … -0.2982741124348621 -0.41392001957324254; -1.2947073239235227 -2.924350433782324 … -0.351837031012404 -0.639401391190455; … ; -0.29827411243486224 -0.35183703101240427 … -0.49079984923148423 -0.35183703101240404; -0.4139200195732427 -0.6394013911904555 … -0.3518370310124038 -0.3243623462827132;;; … ;;; -1.0154655945570306 -0.534070167583838 … -3.638492119923921 -1.9999544249188221; -0.5340701675838375 -0.32172071687080084 … -1.4643051445747082 -0.9064998137004623; … ; -3.638492119923921 -1.4643051445747082 … -10.99407929749181 -8.087034165859382; -1.9999544249188221 -0.9064998137004623 … -8.087034165859382 -4.648528989285647;;; -0.7029205827100926 -0.4139200195732426 … -2.3975920318180606 -1.2947073239235234; -0.4139200195732424 -0.3243623462827132 … -1.0118166498426182 -0.6394013911904551; … ; -2.3975920318180597 -1.0118166498426184 … -11.003519487817234 -6.07420571291939; -1.294707323923523 -0.6394013911904552 … -6.074205712919392 -2.924350433782324;;; -0.48733202809314224 -0.38161724526632634 … -1.2947073239235234 -0.774103780376054; -0.38161724526632623 -0.44990987715615893 … -0.639401391190455 -0.44990987715615877; … ; -1.2947073239235234 -0.6394013911904551 … -6.074205712919392 -2.9243504337823234; -0.7741037803760538 -0.44990987715615927 … -2.924350433782324 -1.4821841359996735]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3930197306088847 0.3797265624666173 … 0.3452309471934772 0.3797265624666173; 0.3797265624666173 0.36717003729371006 … 0.3281972487142082 0.36490120509495205; … ; 0.3452309471934773 0.3281972487142082 … 0.3067539297179811 0.3343063281021195; 0.37972656246661735 0.3649012050949521 … 0.3343063281021195 0.3671700372937101;;; 0.3797265624666173 0.36717003729371006 … 0.32819724871420813 0.36490120509495205; 0.36717003729371006 0.3511293859294481 … 0.31210153318001665 0.35292382482143975; … ; 0.3281972487142082 0.31210153318001665 … 0.2978571906764189 0.3217821206667258; 0.3649012050949521 0.35292382482143975 … 0.3217821206667259 0.3529238248214398;;; 0.34523094719347724 0.3343063281021195 … 0.28730488772851165 0.32819724871420813; 0.3343063281021195 0.31800571871511313 … 0.27861247163741604 0.3217821206667258; … ; 0.2873048877285117 0.2786124716374161 … 0.25588212768142515 0.27861247163741604; 0.3281972487142082 0.3217821206667258 … 0.2786124716374161 0.31210153318001665;;; … ;;; 0.30457732773639057 0.2831761057412766 … 0.28432960645587535 0.30014591527569834; 0.28317610574127666 0.25945413040241855 … 0.2715638421009945 0.28497553279327376; … ; 0.2843296064558754 0.2715638421009945 … 0.27592215824219407 0.2799587735660179; 0.3001459152756984 0.2849755327932738 … 0.27995877356601795 0.2919850161427644;;; 0.3452309471934772 0.32819724871420813 … 0.306753929717981 0.3343063281021195; 0.32819724871420813 0.3121015331800166 … 0.29785719067641886 0.32178212066672573; … ; 0.30675392971798104 0.29785719067641886 … 0.27592215824219407 0.2920624184660546; 0.3343063281021195 0.32178212066672585 … 0.2920624184660546 0.31800571871511313;;; 0.3797265624666173 0.364901205094952 … 0.3343063281021195 0.36717003729371006; 0.364901205094952 0.3529238248214398 … 0.32178212066672585 0.35292382482143975; … ; 0.3343063281021196 0.32178212066672585 … 0.2920624184660547 0.3180057187151131; 0.3671700372937101 0.35292382482143975 … 0.3180057187151131 0.35112938592944815]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.504529838344268 -0.49777105047566084 … -0.47794643505852524 -0.49777105047566084; -0.49777105047566084 -0.48576328261604707 … -0.4772014139925923 -0.4931168276894151; … ; -0.47794643505852524 -0.4772014139925923 … -0.41222454493481075 -0.45556459239236835; -0.49777105047566084 -0.49311682768941506 … -0.45556459239236835 -0.48576328261604707;;; -0.49777105047566084 -0.4857632826160471 … -0.4772014139925923 -0.4931168276894151; -0.48576328261604707 -0.45912869354461094 … -0.47148313777008705 -0.487139106443907; … ; -0.4772014139925923 -0.47148313777008705 … -0.44644454677480455 -0.4694733795135404; -0.49311682768941506 -0.487139106443907 … -0.4694733795135405 -0.487139106443907;;; -0.4779464350585252 -0.45556459239236835 … -0.4612366348754974 -0.4772014139925923; -0.45556459239236835 -0.4093360412707736 … -0.45731085330421495 -0.4694733795135404; … ; -0.4612366348754974 -0.45731085330421495 … -0.44531860495387704 -0.45731085330421495; -0.4772014139925923 -0.4694733795135404 … -0.457310853304215 -0.47148313777008705;;; … ;;; -0.4495959969714919 -0.4554612184464642 … -0.37047831518743046 -0.4175261828995339; -0.4554612184464642 -0.44929521503988995 … -0.41672646609733766 -0.4440502049523115; … ; -0.37047831518743046 -0.41672646609733766 … -0.25287680680354685 -0.2990288642483112; -0.41752618289953386 -0.4440502049523115 … -0.2990288642483112 -0.3606421533621921;;; -0.4779464350585252 -0.4772014139925923 … -0.41222454493481087 -0.45556459239236835; -0.4772014139925923 -0.47148313777008705 … -0.44644454677480455 -0.4694733795135404; … ; -0.41222454493481075 -0.44644454677480455 … -0.25287680680354696 -0.34080653040991016; -0.45556459239236835 -0.4694733795135404 … -0.34080653040991016 -0.4093360412707736;;; -0.49777105047566084 -0.4931168276894151 … -0.45556459239236835 -0.4857632826160471; -0.49311682768941506 -0.487139106443907 … -0.4694733795135404 -0.4871391064439069; … ; -0.45556459239236835 -0.4694733795135404 … -0.34080653040991016 -0.4093360412707736; -0.48576328261604707 -0.487139106443907 … -0.40933604127077367 -0.45912869354461094])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41249932860642236 -0.4873320280931422 … -0.7029205827100927 -0.4873320280931421; -0.4873320280931418 -0.774103780376054 … -0.4139200195732424 -0.38161724526632634; … ; -0.7029205827100928 -0.41392001957324265 … -2.3975920318180597 -1.2947073239235227; -0.487332028093142 -0.3816172452663267 … -1.294707323923523 -0.7741037803760539;;; -0.4873320280931422 -0.774103780376054 … -0.41392001957324254 -0.38161724526632623; -0.7741037803760535 -1.4821841359996735 … -0.3243623462827132 -0.44990987715615893; … ; -0.4139200195732427 -0.32436234628271343 … -1.0118166498426189 -0.6394013911904548; -0.38161724526632634 -0.44990987715615927 … -0.6394013911904552 -0.44990987715615904;;; -0.7029205827100926 -1.2947073239235232 … -0.2982741124348621 -0.41392001957324254; -1.2947073239235227 -2.924350433782324 … -0.351837031012404 -0.639401391190455; … ; -0.29827411243486224 -0.35183703101240427 … -0.49079984923148423 -0.35183703101240404; -0.4139200195732427 -0.6394013911904555 … -0.3518370310124038 -0.3243623462827132;;; … ;;; -1.0154655945570306 -0.534070167583838 … -3.638492119923921 -1.9999544249188221; -0.5340701675838375 -0.32172071687080084 … -1.4643051445747082 -0.9064998137004623; … ; -3.638492119923921 -1.4643051445747082 … -10.99407929749181 -8.087034165859382; -1.9999544249188221 -0.9064998137004623 … -8.087034165859382 -4.648528989285647;;; -0.7029205827100926 -0.4139200195732426 … -2.3975920318180606 -1.2947073239235234; -0.4139200195732424 -0.3243623462827132 … -1.0118166498426182 -0.6394013911904551; … ; -2.3975920318180597 -1.0118166498426184 … -11.003519487817234 -6.07420571291939; -1.294707323923523 -0.6394013911904552 … -6.074205712919392 -2.924350433782324;;; -0.48733202809314224 -0.38161724526632634 … -1.2947073239235234 -0.774103780376054; -0.38161724526632623 -0.44990987715615893 … -0.639401391190455 -0.44990987715615877; … ; -1.2947073239235234 -0.6394013911904551 … -6.074205712919392 -2.9243504337823234; -0.7741037803760538 -0.44990987715615927 … -2.924350433782324 -1.4821841359996735]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852321908857885), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09204237905285897 0.08811124189559524 … 0.07724215466552364 0.08811124189559523; 0.08811124189559523 0.08141173060062884 … 0.0768525159060249 0.08547166117547697; … ; 0.07724215466552364 0.0768525159060249 … 0.04776068378347488 0.06611168495084926; 0.08811124189559523 0.08547166117547696 … 0.06611168495084928 0.08141173060062884;;; 0.08811124189559523 0.08141173060062885 … 0.0768525159060249 0.08547166117547697; 0.08141173060062884 0.06780565553649733 … 0.07390637156778702 0.08216112037507911; … ; 0.0768525159060249 0.07390637156778702 … 0.0619088144324316 0.07288946760640111; 0.08547166117547696 0.08216112037507911 … 0.07288946760640112 0.08216112037507911;;; 0.07724215466552363 0.06611168495084928 … 0.06882132370840974 0.0768525159060249; 0.06611168495084926 0.04667885010591027 … 0.06693801041923052 0.07288946760640111; … ; 0.06882132370840974 0.06693801041923052 … 0.06140292256679697 0.06693801041923052; 0.0768525159060249 0.07288946760640111 … 0.06693801041923053 0.07390637156778702;;; … ;;; 0.06333987368977279 0.06606298784155959 … 0.03370761004597192 0.04979063098507122; 0.06606298784155958 0.06320232648580174 … 0.04948072643191215 0.060836407994158674; … ; 0.03370761004597191 0.04948072643191215 … 0.009598050027787994 0.016689596168559376; 0.0497906309850712 0.060836407994158674 … 0.016689596168559376 0.030867572472415145;;; 0.07724215466552363 0.0768525159060249 … 0.04776068378347489 0.06611168495084928; 0.0768525159060249 0.07390637156778702 … 0.0619088144324316 0.0728894676064011; … ; 0.04776068378347488 0.0619088144324316 … 0.009598050027788001 0.02564660875609344; 0.06611168495084926 0.07288946760640111 … 0.025646608756093446 0.046678850105910275;;; 0.08811124189559523 0.08547166117547698 … 0.06611168495084928 0.08141173060062885; 0.08547166117547696 0.08216112037507911 … 0.07288946760640111 0.0821611203750791; … ; 0.06611168495084926 0.07288946760640111 … 0.02564660875609344 0.046678850105910275; 0.08141173060062884 0.08216112037507911 … 0.04667885010591029 0.06780565553649733;;;;], α = 0.8, eigenvalues = [[-0.16693029947026278, 0.26421593052566283, 0.2642480192592844, 0.264379660636932, 0.35729290354669596, 0.3573783056222507, 0.361871471144452], [-0.11627578111264526, 0.07023248662827031, 0.22618252346672893, 0.2261843345624827, 0.33631452581608645, 0.3933131616696637, 0.3933478464177962], [-0.09603298526781742, 0.08779907166136508, 0.17289855572080728, 0.1729200366133099, 0.2914794663960703, 0.3377968655776385, 0.5338767954578266], [-0.045037145143081714, 0.02228279737612641, 0.09778975368978299, 0.1843803231909753, 0.32497551456985524, 0.5030298333983233, 0.5046899950608331]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2899894729393559, n_iter = 2, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.9468561478626696 - 0.13815388215215677im 9.311953708470442e-5 + 9.8030905617329e-5im … 0.00027564944032562664 - 0.00022695260881737834im -0.001259813700390658 - 0.00282334844659911im; 0.09351815686130466 - 0.013113408128374002im -0.04122692584890986 + 0.17542626991884644im … 0.282463423050678 - 0.3579865066810515im 0.06494205497500179 - 0.36659932037109916im; … ; 0.01104895952484096 - 0.001138257728346993im -0.021854778476182495 + 0.0017237111619816203im … 0.033789637128454904 - 0.03995840082992281im 0.025489424192184203 - 0.06998533471805216im; -0.09409463030767382 + 0.012660016050709383im -0.25158904057073617 + 0.1913443009542863im … 0.003574865066559528 + 0.025927595223039366im 0.11613102843246241 - 0.22412120227582283im], [-0.27521129103953107 - 0.8877071458580216im 0.18297747618906934 - 0.0718771770939387im … -6.061622896413618e-5 - 0.00021393158178540208im 0.000259012549968959 - 0.0005801472349880816im; -0.018562682198390957 - 0.05976699595592007im -0.010608663965369247 + 0.004354051093062962im … -0.0002832323799468998 - 0.00018701649427510882im -0.0001442471857905429 - 0.002530391260705963im; … ; -0.0023348613230834057 - 0.007667465574169172im 0.07972917574952983 - 0.031327900920108634im … 0.08269477493989619 + 0.04801003489932269im -0.023916950974879714 + 0.040794714796504095im; 0.03322348280755822 + 0.10728166150561451im -0.08267151275224625 + 0.032333323319482486im … 0.3627153568719 + 0.20825525820274066im -0.0995621770808921 + 0.17211667656092217im], [0.8038301210506188 + 0.4765250095230609im -2.6257656043029244e-5 - 0.00010966328579562455im … -0.0017264455327728233 - 0.00040466255619377406im -0.00010429429678984388 - 0.00020123604658214166im; 0.05809396910849888 + 0.034446722503724im -0.02123509280070805 - 0.05593888362855679im … 0.003924310295447781 + 0.0017589526580233262im 0.0001687338527552693 + 0.002689602504323171im; … ; 0.012517020092206137 + 0.007410581283994622im 4.36236084640527e-5 - 4.310862467499254e-5im … 0.008816004301520745 + 0.002756876911032615im -0.019960567225109062 + 0.06118179465090194im; -0.13098544704832416 - 0.07766685250163052im -0.10199731764408417 - 0.26790238931519084im … 0.36887329014236286 + 0.09132079200851356im -0.045418087027875156 + 0.14113467814474762im], [-0.44560213800886095 + 0.6758511059175986im -4.0585120479414414e-5 - 0.00017227074635626778im … -0.0065737930345220975 - 0.017338703782524695im -0.07123148041693235 - 0.21521558204315747im; -0.2131875215819395 + 0.32333862813623615im -0.15547101809668445 - 0.6076893957769638im … 0.006474955062901693 + 0.016837230051569403im 0.06945183779934062 + 0.20686887524010722im; … ; -0.006248282065865775 + 0.009424599358458187im -0.0002889269418144324 - 0.00127671845039779im … -0.014179785725308263 - 0.044276963194862434im -0.0026605821835477476 - 0.009298009677353494im; 0.035168376661272385 - 0.05336920044627316im -0.0033664707738948383 - 0.013075374191934016im … -0.16156328068350587 - 0.4974382058259327im -0.12009965138509297 - 0.363448133215983im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16693029947026278, 0.26421593052566283, 0.2642480192592844, 0.264379660636932, 0.35729290354669596, 0.3573783056222507, 0.361871471144452], [-0.11627578111264526, 0.07023248662827031, 0.22618252346672893, 0.2261843345624827, 0.33631452581608645, 0.3933131616696637, 0.3933478464177962], [-0.09603298526781742, 0.08779907166136508, 0.17289855572080728, 0.1729200366133099, 0.2914794663960703, 0.3377968655776385, 0.5338767954578266], [-0.045037145143081714, 0.02228279737612641, 0.09778975368978299, 0.1843803231909753, 0.32497551456985524, 0.5030298333983233, 0.5046899950608331]], X = [[0.9468561478626696 - 0.13815388215215677im 9.311953708470442e-5 + 9.8030905617329e-5im … 0.00027564944032562664 - 0.00022695260881737834im -0.001259813700390658 - 0.00282334844659911im; 0.09351815686130466 - 0.013113408128374002im -0.04122692584890986 + 0.17542626991884644im … 0.282463423050678 - 0.3579865066810515im 0.06494205497500179 - 0.36659932037109916im; … ; 0.01104895952484096 - 0.001138257728346993im -0.021854778476182495 + 0.0017237111619816203im … 0.033789637128454904 - 0.03995840082992281im 0.025489424192184203 - 0.06998533471805216im; -0.09409463030767382 + 0.012660016050709383im -0.25158904057073617 + 0.1913443009542863im … 0.003574865066559528 + 0.025927595223039366im 0.11613102843246241 - 0.22412120227582283im], [-0.27521129103953107 - 0.8877071458580216im 0.18297747618906934 - 0.0718771770939387im … -6.061622896413618e-5 - 0.00021393158178540208im 0.000259012549968959 - 0.0005801472349880816im; -0.018562682198390957 - 0.05976699595592007im -0.010608663965369247 + 0.004354051093062962im … -0.0002832323799468998 - 0.00018701649427510882im -0.0001442471857905429 - 0.002530391260705963im; … ; -0.0023348613230834057 - 0.007667465574169172im 0.07972917574952983 - 0.031327900920108634im … 0.08269477493989619 + 0.04801003489932269im -0.023916950974879714 + 0.040794714796504095im; 0.03322348280755822 + 0.10728166150561451im -0.08267151275224625 + 0.032333323319482486im … 0.3627153568719 + 0.20825525820274066im -0.0995621770808921 + 0.17211667656092217im], [0.8038301210506188 + 0.4765250095230609im -2.6257656043029244e-5 - 0.00010966328579562455im … -0.0017264455327728233 - 0.00040466255619377406im -0.00010429429678984388 - 0.00020123604658214166im; 0.05809396910849888 + 0.034446722503724im -0.02123509280070805 - 0.05593888362855679im … 0.003924310295447781 + 0.0017589526580233262im 0.0001687338527552693 + 0.002689602504323171im; … ; 0.012517020092206137 + 0.007410581283994622im 4.36236084640527e-5 - 4.310862467499254e-5im … 0.008816004301520745 + 0.002756876911032615im -0.019960567225109062 + 0.06118179465090194im; -0.13098544704832416 - 0.07766685250163052im -0.10199731764408417 - 0.26790238931519084im … 0.36887329014236286 + 0.09132079200851356im -0.045418087027875156 + 0.14113467814474762im], [-0.44560213800886095 + 0.6758511059175986im -4.0585120479414414e-5 - 0.00017227074635626778im … -0.0065737930345220975 - 0.017338703782524695im -0.07123148041693235 - 0.21521558204315747im; -0.2131875215819395 + 0.32333862813623615im -0.15547101809668445 - 0.6076893957769638im … 0.006474955062901693 + 0.016837230051569403im 0.06945183779934062 + 0.20686887524010722im; … ; -0.006248282065865775 + 0.009424599358458187im -0.0002889269418144324 - 0.00127671845039779im … -0.014179785725308263 - 0.044276963194862434im -0.0026605821835477476 - 0.009298009677353494im; 0.035168376661272385 - 0.05336920044627316im -0.0033664707738948383 - 0.013075374191934016im … -0.16156328068350587 - 0.4974382058259327im -0.12009965138509297 - 0.363448133215983im]], residual_norms = [[0.01285719461434571, 0.00640899330757061, 0.00849155533505598, 0.011717195570065307, 0.0045963124814494705, 0.00916672620451196, 0.029811023716472363], [0.0040598103900318485, 0.006381977580068226, 0.005922575028027216, 0.006119102016693063, 0.007717193118048994, 0.010825204369885046, 0.012440656484409115], [0.0059183528675054555, 0.005907607819781665, 0.004558695343291326, 0.007111922198455464, 0.009386606727890915, 0.026895138976367798, 0.03004368070081343], [0.004727518461224398, 0.005077290610286368, 0.007796011820903466, 0.01251727412571137, 0.04210203111715295, 0.019721962736469797, 0.04984509175992705]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 0.002702868487726987)</code></pre><p>Remove the virtual orbitals (which Newton cannot treat yet)</p><pre><code class="language-julia hljs">ψ, _ = DFTK.select_occupied_orbitals(basis, scfres_start.ψ, scfres_start.occupation)
scfres_newton = newton(basis, ψ; tol)

# Comparison of results

println(&quot;|ρ_newton - ρ_scf|  = &quot;, norm(scfres_newton.ρ - scfres_scf.ρ))
println(&quot;|ρ_newton - ρ_scfv| = &quot;, norm(scfres_newton.ρ - scfres_scfv.ρ))
println(&quot;|ρ_newton - ρ_dm|   = &quot;, norm(scfres_newton.ρ - scfres_dm.ρ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)
---   ---------------   ---------   ---------
  1   -7.852646686686                   -2.55
  2   -7.852646686730      -10.36       -5.86
  3   -7.852646686730   +  -15.05      -12.61
|ρ_newton - ρ_scf|  = 5.822066419836055e-14
|ρ_newton - ρ_scfv| = 6.668419917183421e-14
|ρ_newton - ρ_dm|   = 4.063812771206607e-10</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scf_callbacks/">« Monitoring self-consistent field calculations</a><a class="docs-footer-nextpage" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 30 August 2022 08:15">Tuesday 30 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
