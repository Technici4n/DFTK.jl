<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Eigenvalues of the dielectric matrix · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/dielectric/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../energy_cutoff_smearing/">Energy cutoff smearing</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li class="is-active"><a class="tocitem" href>Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../compare_solvers/">Comparison of DFT solvers</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Response and properties</a></li><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/dielectric.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Eigenvalues-of-the-dielectric-matrix"><a class="docs-heading-anchor" href="#Eigenvalues-of-the-dielectric-matrix">Eigenvalues of the dielectric matrix</a><a id="Eigenvalues-of-the-dielectric-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalues-of-the-dielectric-matrix" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=v0.5.8/examples/dielectric.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/v0.5.8/examples/dielectric.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compute a few eigenvalues of the dielectric matrix (q=0,ω=0) iteratively.</p><pre><code class="language-julia hljs">using DFTK
using Plots
using KrylovKit
using Printf

# Calculation parameters
kgrid = [1, 1, 1]
Ecut = 5

# Silicon lattice
a = 10.26
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

# Compute the dielectric operator without symmetries
model = model_LDA(lattice, atoms, positions, symmetries=false)
basis = PlaneWaveBasis(model; Ecut, kgrid)
scfres = self_consistent_field(basis, tol=1e-14)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.527466675916143 0.5044274747526603 … 0.4441271545894983 0.5044274724696728; 0.5044274737593356 0.47725917547652147 … 0.42889200278274947 0.48607514506706057; … ; 0.4441271566953169 0.4288920054510507 … 0.3670951019525462 0.4173035775006301; 0.5044274734398572 0.4860751468756347 … 0.41730357625939907 0.4772591734778398;;; 0.5044274743636256 0.4772591762745327 … 0.4288920033927892 0.4860751456062724; 0.4772591751206874 0.4445296900191133 … 0.4098211896753976 0.4647445367454545; … ; 0.42889200510865666 0.4098211921164447 … 0.36030626973387103 0.4089019891647012; 0.48607514649537154 0.4647445386468532 … 0.40890198821091156 0.46474453647181824;;; 0.4441271579200516 0.4173035799152288 … 0.37467442777642634 0.4288920050292692; 0.4173035785235728 0.38733679068025156 … 0.3577719549493405 0.4089019895389173; … ; 0.3746744293132539 0.35777195748600166 … 0.31349195718994977 0.35777195558786395; 0.4288920059488237 0.4089019917296017 … 0.35777195483572494 0.40982119096328484;;; … ;;; 0.37207165187937213 0.3538533874156496 … 0.327935494850201 0.35637416006780137; 0.35385338628805085 0.3317820385964354 … 0.3099360146890849 0.3421493071631359; … ; 0.3279354991061812 0.30993601973418633 … 0.32417733048623376 0.32702015231747406; 0.3563741618758138 0.3421493099674643 … 0.3270201497912737 0.3434110414244128;;; 0.4441271552629074 0.42889200437392117 … 0.36709509925637945 0.4173035755059977; 0.4288920034117427 0.40982119059044414 … 0.3603062666746631 0.4089019869259358; … ; 0.36709510262288336 0.3603062706561613 … 0.3241773302399488 0.3459587541001747; 0.4173035769341594 0.4089019891793386 … 0.34595875208701643 0.38733678820772527;;; 0.5044274728289664 0.48607514632686083 … 0.4173035751669669 0.4772591726749986; 0.4860751454047453 0.46474453741514443 … 0.4089019866135388 0.46474453524889237; … ; 0.41730357782624483 0.4089019898043213 … 0.3459587537248463 0.38733678944402294; 0.4772591738269762 0.46474453717248254 … 0.3873367878539989 0.4445296875034216]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5575517640454106 -0.5479471305496769 … -0.5185332232445934 -0.5479471296927849; -0.5479471304004624 -0.5318143677660928 … -0.5184377226588491 -0.5418065874754043; … ; -0.5185332236321414 -0.5184377229942241 … -0.42962122634415034 -0.4895688409218661; -0.5479471298170067 -0.5418065876780338 … -0.4895688406113632 -0.5318143665821826;;; -0.5479471304188307 -0.5318143678570492 … -0.5184377226593212 -0.5418065874615766; -0.5318143676559192 -0.5005477199540626 … -0.51211833073019 -0.5325945676241737; … ; -0.518437722904649 -0.5121183309745729 … -0.4661344032816882 -0.5043253390661799; -0.5418065875572495 -0.5325945678602532 … -0.5043253388526431 -0.5325945670377985;;; -0.518533224562142 -0.4895688422316121 … -0.49813277550439106 -0.5184377233554802; -0.48956884196342365 -0.43645079431352785 … -0.4900722205919728 -0.5043253399119826; … ; -0.4981327756455522 -0.49007222082963725 … -0.4651952795319891 -0.4900722201112529; -0.5184377234465962 -0.5043253402243725 … -0.4900722199921026 -0.5121183307687664;;; … ;;; -0.47260172252868615 -0.48204415556428437 … -0.3634524740855991 -0.43056197882741065; -0.4820441554461279 -0.47922052968657125 … -0.412664635907778 -0.46009328581542075; … ; -0.3634524757655324 -0.41266463725183866 … -0.22859973556208707 -0.2848129675265925; -0.4305619792656086 -0.46009328628658286 … -0.2848129657089999 -0.3648044484313014;;; -0.5185332234317781 -0.5184377229424658 … -0.42962122554140775 -0.4895688404992756; -0.5184377228553487 -0.5121183310076655 … -0.46613440264154693 -0.5043253387954345; … ; -0.4296212263893516 -0.46613440338909096 … -0.2285997351496379 -0.34831028404171155; -0.4895688407433248 -0.5043253390716659 … -0.3483102832735757 -0.43645079279920523;;; -0.5479471297934977 -0.54180658768241 … -0.48956884040023035 -0.5318143664879948; -0.5418065875765252 -0.5325945678268048 … -0.5043253386895707 -0.532594567012658; … ; -0.4895688409520746 -0.5043253391793399 … -0.3483102840007526 -0.43645079315291846; -0.5318143666568587 -0.5325945672231039 … -0.4364507927272543 -0.5005477185538838])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.3312464541168356 -0.4122172637482685 … -0.6446250905795206 -0.4122172651743641; -0.4122172645923784 -0.7106258192672141 … -0.35415988427089445 -0.3096704236539601; … ; -0.6446250888612501 -0.3541598819379684 … -2.3545190055242893 -1.2473824720266613; -0.412217264328401 -0.3096704220480153 … -1.2473824729573897 -0.7106258200819853;;; -0.41221726400645686 -0.7106258185601593 … -0.3541598836613268 -0.3096704231009208; -0.7106258195128743 -1.4301202338296939 … -0.2674197082429427 -0.3835074686229905; … ; -0.3541598821907872 -0.2674197060462789 … -0.9690282241355467 -0.5852827355182394; -0.30967042230749414 -0.3835074669576713 … -0.585282736258492 -0.3835074683102515;;; -0.6446250885665159 -1.247382470921809 … -0.24768286744480994 -0.354159882721006; -1.2473824720452764 -2.8783362626110183 … -0.30736886080643544 -0.5852827359898257; … ; -0.24768286604914352 -0.3073688585074393 … -0.45283283156885085 -0.3073688596871925; -0.3541598818925673 -0.5852827341115312 … -0.3073688603201806 -0.26741970699363193;;; … ;;; -0.9726032903532232 -0.4893652792161232 … -3.585959706057901 -1.9561597361258831; -0.48936528022556525 -0.27936054378904807 … -1.4246575525421048 -0.8654259701270159; … ; -3.5859597034818536 -1.424657548841064 … -10.916103635395379 -8.026581766141488; -1.9561597347560684 -0.8654259677938496 … -8.026581766850096 -4.601291071773793;;; -0.6446250900932962 -0.35415988296333945 … -2.354519007417714 -1.2473824735987034; -0.3541598838384007 -0.26741970760537187 … -0.9690282265546134 -0.5852827374862591; … ; -2.3545190048991538 -0.9690282233206594 … -10.930732001638322 -6.0317236055049985; -1.2473824724145908 -0.5852827355090875 … -6.031723606750021 -2.8783362635692216;;; -0.4122172649157831 -0.3096704226011656 … -1.247382473838689 -0.710625820790639; -0.3096704234173962 -0.3835074681559318 … -0.5852827376927923 -0.38350746950803694; … ; -1.2473824717312554 -0.5852827349917791 … -6.031723605839367 -2.878336262686637; -0.7106258198075248 -0.3835074677948926 … -2.8783362638509966 -1.430120234945207]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -7.251338798704541), converged = true, occupation_threshold = 1.0e-6, ρ = [0.12710827563042476 0.12017965647215254 … 0.10056375665699155 0.12017965586573746; 0.12017965636655473 0.10912705030299769 … 0.1005038952763701 0.11588721227534922; … ; 0.1005637568999623 0.10050389548654617 … 0.05464060712405553 0.08349600545441278; 0.12017965595364812 0.11588721241524715 … 0.08349600528288717 0.10912704951833624;;; 0.1201796563795538 0.10912705036328092 … 0.10050389527666591 0.11588721226580243; 0.10912705022997778 0.08971212071754876 … 0.0965964188741443 0.10964497762373213; … ; 0.10050389543041036 0.09659641902322069 … 0.07122114426248895 0.0919217182115623; 0.11588721233185621 0.1096449777807033 … 0.09192171808562517 0.10964497723384653;;; 0.10056375748302047 0.0834960061779327 … 0.08831868270734469 0.10050389571294185; 0.0834960060297821 0.057516676897215235 … 0.083774393963537 0.09192171871038907; … ; 0.08831868278836205 0.08377439409512369 … 0.07075664163951088 0.08377439369737898; 0.10050389577004325 0.09192171889462639 … 0.08377439363140955 0.0965964188976764;;; … ;;; 0.07447652141324625 0.07940929813663912 … 0.03166159773006894 0.05503081388308447; 0.07940929807356058 0.07791160773350442 … 0.04792699975992559 0.06826914749418383; … ; 0.031661598208847015 0.04792700026846608 … 0.006870415719934681 0.014215397825093184; 0.05503081406528229 0.06826914772110555 … 0.014215397526014733 0.032048514815830896;;; 0.10056375677434581 0.10050389545410984 … 0.0546406067919006 0.08349600522096862; 0.10050389539951439 0.09659641904340754 … 0.07122114394516085 0.09192171805188547; … ; 0.05464060714275865 0.0712211443157302 … 0.006870415678818513 0.027544042754136362; 0.08349600535578439 0.09192171821479765 … 0.02754404255513355 0.0575166762483118;;; 0.120179655937011 0.11588721241826848 … 0.08349600516625477 0.10912704945591126; 0.11588721234516429 0.10964497775846327 … 0.09192171798945048 0.10964497721713039; … ; 0.08349600547110034 0.09192171827830029 … 0.02754404274352504 0.05751667639988168; 0.10912704956782938 0.10964497735705765 … 0.057516676217480016 0.0897121199053293;;;;], α = 0.8, eigenvalues = [[-0.14431559215984852, 0.29698169226315135, 0.2969816926054474, 0.29698169264110896, 0.3757382671549512, 0.3757382671862967, 0.37573826736856364]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.3442393821412773, n_iter = 14, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.08098906060552502 - 0.960095225602809im -1.0395269238532031e-11 + 2.903188131995018e-10im … -1.4076912405950033e-9 + 7.154013367171868e-10im -3.4133929623039833e-10 + 3.2835104103182457e-10im; 0.007248312467853465 - 0.08592604010156511im -0.007709943559263139 - 0.17326024219134942im … 0.23856825704986903 + 0.45639401028033294im 0.1503183818711676 + 0.14907665115875215im; … ; 0.0010771671453669955 - 0.01276941136775374im 0.0013393462478894992 + 0.03009819044758784im … 0.049952288814410495 + 0.09556131937814542im 0.00028967646517768147 + 0.0002873219199343335im; -0.007248311332053543 + 0.08592604001204558im 0.00686189521620593 + 0.15420253573728523im … 0.20741219710068293 + 0.3967897381124936im -0.14773211380388956 - 0.1465114027977208im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.14431559215984852, 0.29698169226315135, 0.2969816926054474, 0.29698169264110896, 0.3757382671549512, 0.3757382671862967, 0.37573826736856364]], X = [[0.08098906060552502 - 0.960095225602809im -1.0395269238532031e-11 + 2.903188131995018e-10im … -1.4076912405950033e-9 + 7.154013367171868e-10im -3.4133929623039833e-10 + 3.2835104103182457e-10im; 0.007248312467853465 - 0.08592604010156511im -0.007709943559263139 - 0.17326024219134942im … 0.23856825704986903 + 0.45639401028033294im 0.1503183818711676 + 0.14907665115875215im; … ; 0.0010771671453669955 - 0.01276941136775374im 0.0013393462478894992 + 0.03009819044758784im … 0.049952288814410495 + 0.09556131937814542im 0.00028967646517768147 + 0.0002873219199343335im; -0.007248311332053543 + 0.08592604001204558im 0.00686189521620593 + 0.15420253573728523im … 0.20741219710068293 + 0.3967897381124936im -0.14773211380388956 - 0.1465114027977208im]], residual_norms = [[1.79250140133459e-9, 2.082026094011579e-9, 1.495851879292969e-9, 1.4178569443932614e-9, 7.185441977409927e-10, 6.720318539720825e-10, 7.683037183542331e-10]], iterations = [2], converged = 1, n_matvec = 19)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 8.078192284594398e-9)</code></pre><p>Apply ε† = 1 - χ0 (vc + fxc)</p><pre><code class="language-julia hljs">function eps_fun(δρ)
    δV = apply_kernel(basis, δρ; ρ=scfres.ρ)
    χ0δV = apply_χ0(scfres, δV)
    δρ - χ0δV
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">eps_fun (generic function with 1 method)</code></pre><p>eager diagonalizes the subspace matrix at each iteration</p><pre><code class="language-julia hljs">eigsolve(eps_fun, randn(size(scfres.ρ)), 5, :LM; eager=true, verbosity=3);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Arnoldi iteration step 1: normres = 0.05706616263111269
[ Info: Arnoldi iteration step 2: normres = 0.5150385884084546
[ Info: Arnoldi iteration step 3: normres = 0.91964496547963
[ Info: Arnoldi iteration step 4: normres = 0.33959586389940044
[ Info: Arnoldi iteration step 5: normres = 0.5018115034078253
[ Info: Arnoldi schursolve in iter 1, krylovdim = 5: 0 values converged, normres = (5.88e-02, 7.89e-02, 3.96e-01, 2.92e-01, 7.84e-03)
[ Info: Arnoldi iteration step 6: normres = 0.2974168036442264
[ Info: Arnoldi schursolve in iter 1, krylovdim = 6: 0 values converged, normres = (1.51e-02, 1.53e-01, 2.10e-01, 8.37e-02, 6.01e-02)
[ Info: Arnoldi iteration step 7: normres = 0.09072010351701704
[ Info: Arnoldi schursolve in iter 1, krylovdim = 7: 0 values converged, normres = (6.75e-04, 1.46e-02, 1.44e-02, 4.46e-02, 7.05e-02)
[ Info: Arnoldi iteration step 8: normres = 0.10806102667889064
[ Info: Arnoldi schursolve in iter 1, krylovdim = 8: 0 values converged, normres = (3.12e-05, 1.11e-03, 1.21e-03, 1.50e-02, 3.52e-02)
[ Info: Arnoldi iteration step 9: normres = 0.06218383894421555
[ Info: Arnoldi schursolve in iter 1, krylovdim = 9: 0 values converged, normres = (8.42e-07, 4.93e-05, 5.99e-05, 3.27e-03, 1.65e-02)
[ Info: Arnoldi iteration step 10: normres = 0.08306904826423787
[ Info: Arnoldi schursolve in iter 1, krylovdim = 10: 0 values converged, normres = (3.01e-08, 2.89e-06, 3.90e-06, 8.62e-04, 8.55e-03)
[ Info: Arnoldi iteration step 11: normres = 0.07333502016720975
[ Info: Arnoldi schursolve in iter 1, krylovdim = 11: 0 values converged, normres = (9.61e-10, 1.53e-07, 2.29e-07, 2.21e-04, 5.09e-03)
[ Info: Arnoldi iteration step 12: normres = 0.07524036378156714
[ Info: Arnoldi schursolve in iter 1, krylovdim = 12: 0 values converged, normres = (3.07e-11, 7.94e-09, 1.32e-08, 4.81e-05, 2.19e-03)
[ Info: Arnoldi iteration step 13: normres = 0.17063862838016133
[ Info: Arnoldi schursolve in iter 1, krylovdim = 13: 0 values converged, normres = (2.29e-12, 9.82e-10, 1.81e-09, 2.93e-05, 3.13e-03)
[ Info: Arnoldi iteration step 14: normres = 0.2907231280436172
[ Info: Arnoldi schursolve in iter 1, krylovdim = 14: 1 values converged, normres = (6.18e-13, 1.79e-09, 3.24e-08, 2.84e-01, 3.10e-04)
[ Info: Arnoldi iteration step 15: normres = 0.2628596421617171
[ Info: Arnoldi schursolve in iter 1, krylovdim = 15: 1 values converged, normres = (7.07e-14, 4.31e-10, 5.49e-02, 1.17e-03, 1.59e-06)
[ Info: Arnoldi iteration step 16: normres = 0.1376450932400215
[ Info: Arnoldi schursolve in iter 1, krylovdim = 16: 1 values converged, normres = (1.02e-14, 5.48e-09, 1.20e-01, 3.50e-04, 6.21e-02)
[ Info: Arnoldi iteration step 17: normres = 0.034368282441055005
[ Info: Arnoldi schursolve in iter 1, krylovdim = 17: 1 values converged, normres = (1.47e-16, 1.02e-04, 2.80e-03, 6.23e-07, 1.46e-03)
[ Info: Arnoldi iteration step 18: normres = 0.022693342365215058
[ Info: Arnoldi schursolve in iter 1, krylovdim = 18: 1 values converged, normres = (1.38e-18, 1.66e-08, 4.21e-05, 2.37e-05, 5.06e-06)
[ Info: Arnoldi iteration step 19: normres = 0.16776506989113993
[ Info: Arnoldi schursolve in iter 1, krylovdim = 19: 1 values converged, normres = (9.90e-20, 2.26e-06, 4.41e-06, 1.30e-07, 3.15e-06)
[ Info: Arnoldi iteration step 20: normres = 0.06649315473434332
[ Info: Arnoldi schursolve in iter 1, krylovdim = 20: 1 values converged, normres = (3.15e-21, 2.83e-08, 2.79e-07, 7.14e-08, 1.90e-07)
[ Info: Arnoldi iteration step 21: normres = 0.023505047374673294
[ Info: Arnoldi schursolve in iter 1, krylovdim = 21: 1 values converged, normres = (3.09e-23, 3.23e-09, 3.04e-09, 2.98e-09, 1.93e-09)
[ Info: Arnoldi iteration step 22: normres = 0.056554558401133596
[ Info: Arnoldi schursolve in iter 1, krylovdim = 22: 1 values converged, normres = (7.19e-25, 1.59e-10, 4.26e-11, 1.13e-10, 9.09e-11)
[ Info: Arnoldi iteration step 23: normres = 0.3645889068704435
[ Info: Arnoldi schursolve in iter 1, krylovdim = 23: 1 values converged, normres = (2.27e-25, 2.38e-10, 4.29e-11, 3.84e-10, 3.03e-10)
[ Info: Arnoldi iteration step 24: normres = 0.016123041392266807
[ Info: Arnoldi schursolve in iter 1, krylovdim = 24: 1 values converged, normres = (1.65e-27, 4.35e-12, 1.17e-12, 4.76e-09, 3.62e-09)
[ Info: Arnoldi iteration step 25: normres = 0.04212488854400647
[ Info: Arnoldi schursolve in iter 1, krylovdim = 25: 3 values converged, normres = (2.86e-29, 1.20e-13, 3.20e-14, 1.64e-08, 1.24e-08)
[ Info: Arnoldi iteration step 26: normres = 0.07186755174222588
[ Info: Arnoldi schursolve in iter 1, krylovdim = 26: 3 values converged, normres = (9.26e-31, 6.56e-15, 1.75e-15, 3.74e-06, 4.18e-06)
[ Info: Arnoldi iteration step 27: normres = 0.019902274030141838
[ Info: Arnoldi schursolve in iter 1, krylovdim = 27: 3 values converged, normres = (7.64e-33, 8.70e-17, 2.32e-17, 4.44e-08, 3.77e-08)
[ Info: Arnoldi iteration step 28: normres = 0.10886765214279819
[ Info: Arnoldi schursolve in iter 1, krylovdim = 28: 3 values converged, normres = (3.57e-34, 6.64e-18, 1.77e-18, 1.81e-09, 9.87e-09)
[ Info: Arnoldi iteration step 29: normres = 0.08162552473830866
[ Info: Arnoldi schursolve in iter 1, krylovdim = 29: 3 values converged, normres = (1.25e-35, 3.83e-19, 1.02e-19, 1.24e-10, 6.31e-10)
[ Info: Arnoldi iteration step 30: normres = 0.09443205442453817
[ Info: Arnoldi schursolve in iter 1, krylovdim = 30: 3 values converged, normres = (5.80e-37, 3.20e-20, 8.52e-21, 1.17e-11, 6.01e-11)
[ Info: Arnoldi schursolve in iter 2, krylovdim = 19: 3 values converged, normres = (5.81e-37, 3.20e-20, 8.52e-21, 1.17e-11, 6.01e-11)
[ Info: Arnoldi iteration step 20: normres = 0.026624448434514555
[ Info: Arnoldi schursolve in iter 2, krylovdim = 20: 4 values converged, normres = (6.43e-39, 5.70e-22, 1.52e-22, 2.32e-13, 1.18e-12)
[ Info: Arnoldi iteration step 21: normres = 0.06591259624714389
┌ Info: Arnoldi eigsolve finished after 2 iterations:
│ *  6 eigenvalues converged
│ *  norm of residuals = (1.757986290559952e-40, 2.4967060797944665e-23, 2.5774596831847805e-23, 1.122011341740021e-14, 5.646128645640764e-14, 3.988340623585226e-15)
└ *  number of operations = 32</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../forwarddiff/">« Polarizability using automatic differentiation</a><a class="docs-footer-nextpage" href="../atomsbase/">AtomsBase integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 17 September 2022 13:58">Saturday 17 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
