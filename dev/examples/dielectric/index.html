<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Eigenvalues of the dielectric matrix · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/dielectric/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../energy_cutoff_smearing/">Energy cutoff smearing</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li class="is-active"><a class="tocitem" href>Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../compare_solvers/">Comparison of DFT solvers</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Response and properties</a></li><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/dielectric.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Eigenvalues-of-the-dielectric-matrix"><a class="docs-heading-anchor" href="#Eigenvalues-of-the-dielectric-matrix">Eigenvalues of the dielectric matrix</a><a id="Eigenvalues-of-the-dielectric-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalues-of-the-dielectric-matrix" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/dielectric.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/dielectric.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compute a few eigenvalues of the dielectric matrix (q=0,ω=0) iteratively.</p><pre><code class="language-julia hljs">using DFTK
using Plots
using KrylovKit
using Printf

# Calculation parameters
kgrid = [1, 1, 1]
Ecut = 5

# Silicon lattice
a = 10.26
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

# Compute the dielectric operator without symmetries
model = model_LDA(lattice, atoms, positions, symmetries=false)
basis = PlaneWaveBasis(model; Ecut, kgrid)
scfres = self_consistent_field(basis, tol=1e-14)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.5274666752429034 0.5044274807285474 … 0.44412714075052745 0.5044274651556122; 0.5044274718133117 0.47725918015166036 … 0.4288919886169127 0.4860751368431545; … ; 0.44412715844210454 0.4288920129579448 … 0.36709509126838263 0.41730357300833193; 0.5044274740145738 0.4860751537865002 … 0.4173035636246965 0.4772591674277681;;; 0.5044274723218682 0.47725918049376925 … 0.42889198915032223 0.48607513741331576; 0.47725917142591906 0.4445296924222583 … 0.409821175114129 0.46474452739035155; … ; 0.42889200567657026 0.40982119844797166 … 0.3603062576301509 0.4089019834758236; 0.4860751459122241 0.46474454420797956 … 0.4089019747540858 0.46474452950506473;;; 0.4441271540260424 0.4173035812976308 … 0.37467441405344426 0.42889199612441564; 0.41730357249520256 0.38733678975864005 … 0.3577719403910224 0.4089019789323773; … ; 0.3746744289433481 0.35777196221035173 … 0.313491945444146 0.3577719496926689; 0.42889200404517175 0.4089019950894449 … 0.3577719420273878 0.4098211836881171;;; … ;;; 0.37207165635293654 0.3538533956893218 … 0.32793549121086446 0.3563741604729475; 0.35385338876282507 0.3317820452071624 … 0.30993600891913586 0.34214930549813893; … ; 0.32793550753791173 0.30993603120905683 … 0.32417733224519546 0.3270201573236267; 0.35637416839194447 0.3421493199408959 … 0.3270201487544875 0.34341104410071016;;; 0.44412715762554195 0.42889201189130266 … 0.36709509115638145 0.41730357257083456; 0.42889200418307716 0.409821196849678 … 0.3603062569618907 0.4089019823597982; … ; 0.3670951084972204 0.3603062806892687 … 0.3241773272103403 0.34595875540464816; 0.4173035810864104 0.40890199802055127 … 0.34595874636529744 0.387336787333507;;; 0.5044274734710709 0.48607515320335404 … 0.417303563384963 0.47725916702434923; 0.4860751447899133 0.4647445432179508 … 0.4089019739472093 0.4647445284718049; … ; 0.4173035813572277 0.4089019984743816 … 0.34595874628295686 0.38733678739439836; 0.4772591759052625 0.46474454501847917 … 0.3873367779510832 0.4445296835110727]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5575517640037643 -0.5479471319157233 … -0.5185332197820203 -0.5479471281986107; -0.5479471298431207 -0.5318143687109517 … -0.5184377192473708 -0.541806585629116; … ; -0.518533224566358 -0.5184377250700669 … -0.4296212231855388 -0.48956884029328146; -0.5479471302503475 -0.5418065894002917 … -0.4895688372179755 -0.5318143654594341;;; -0.5479471300299815 -0.5318143688064276 … -0.5184377194455609 -0.5418065858473745; -0.5318143665563311 -0.5005477202978279 … -0.5121183274339112 -0.5325945654611917; … ; -0.5184377235573984 -0.512118332787614 … -0.46613440013782526 -0.504325338212998; -0.5418065877460255 -0.5325945692981479 … -0.5043253356278465 -0.532594565823681;;; -0.5185332233913598 -0.4895688421108241 … -0.4981327726031752 -0.5184377214085467; -0.48956883981184596 -0.4364507933479996 … -0.49007221717052696 -0.5043253370510845; … ; -0.49813277606320744 -0.4900722221423232 … -0.4651952769420085 -0.4900722193716371; -0.5184377231617773 -0.504325340875534 … -0.49007221731550765 -0.5121183295352936;;; … ;;; -0.472601724743067 -0.4820441579609412 … -0.36345247484616383 -0.4305619806353505; -0.48204415654075466 -0.47922053108718654 … -0.4126646356665229 -0.4600932865187105; … ; -0.36345248044951683 -0.4126646418389465 … -0.22859974014078555 -0.28481297253638016; -0.4305619826255396 -0.4600932897619086 … -0.2848129679677915 -0.36480445150090096;;; -0.518533224357305 -0.5184377246465081 … -0.4296212236633864 -0.489568840394984; -0.5184377229981375 -0.5121183320924622 … -0.4661344003010587 -0.5043253379617243; … ; -0.4296212292379017 -0.466134406735864 … -0.22859973480785453 -0.34831028605809733; -0.48956884256630523 -0.5043253415499496 … -0.34831028201235537 -0.43645079358727495;;; -0.5479471300502331 -0.5418065891541254 … -0.48956883725328026 -0.5318143653613246; -0.5418065872988017 -0.5325945689010392 … -0.5043253354245724 -0.5325945654528166; … ; -0.4895688425523936 -0.5043253416878968 … -0.3483102814850534 -0.4364507933646957; -0.5318143675324559 -0.5325945691651246 … -0.4364507898793842 -0.5005477180055489])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.33124645474842895 -0.41221725913842777 … -0.6446251009559183 -0.41221727099425043; -0.41221726598106057 -0.710625815536934 … -0.3541598950252529 -0.3096704300315778; … ; -0.644625088048679 -0.3541598765069171 … -2.3545190130498415 -1.2473824758903749; -0.4122172641870252 -0.3096704168594077 … -1.2473824821987045 -0.7106258250093085;;; -0.412217265659365 -0.7106258152903011 … -0.3541598946900335 -0.30967042967967534; -0.7106258221080546 -1.4301202317703143 … -0.2674197195079324 -0.38350747581511146; … ; -0.354159882275623 -0.267419701527793 … -0.9690282330954039 -0.585282740353935; -0.30967042307941756 -0.38350746283443965 … -0.5852827464905213 -0.38350747406288754;;; -0.6446250912897428 -1.247382469418619 … -0.24768287826657615 -0.3541598896789261; -1.2473824759220689 -2.878336262567101 … -0.30736887194330764 -0.5852827437354677; … ; -0.24768286683670454 -0.30736885509577516 … -0.45283284072467406 -0.30736886484277176; -0.3541598835114003 -0.5852827314028496 … -0.30736887045192274 -0.26741971303532674;;; … ;;; -0.9726032880940396 -0.48936527333910784 … -3.585959710457802 -1.9561597375286768; -0.4893652788454178 -0.27936053857893633 … -1.4246575580707985 -0.8654259724953026; … ; -3.5859596997341074 -1.4246575419533012 … -10.916103638215116 -8.026581766145124; -1.9561597315998687 -0.8654259612957438 … -8.026581770145675 -4.601291072167095;;; -0.6446250886561884 -0.3541598771500002 … -2.3545190136396905 -1.2473824764295751; -0.35415988320985503 -0.2674197024309347 … -0.9690282339268975 -0.5852827412186865; … ; -2.3545190018733666 -0.9690282166343249 … -10.930732004326146 -6.031723606216911; -1.2473824700853202 -0.5852827291461586 … -6.03172361121052 -2.878336265231509;;; -0.412217264530414 -0.3096704171963878 … -1.2473824824737427 -0.7106258253146182; -0.30967042375450465 -0.3835074634273598 … -0.5852827470941235 -0.383507474725283; … ; -1.2473824698005915 -0.5852827288302758 … -6.031723610765558 -2.8783362649480386; -0.7106258186048358 -0.3835074618909166 … -2.8783362709060425 -1.4301202383892209]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -7.25133879870454), converged = true, occupation_threshold = 1.0e-6, ρ = [0.12710827559980775 0.12017965743889189 … 0.10056375448615268 0.12017965480832313; 0.1201796559721287 0.10912705092922279 … 0.10050389313843086 0.11588721100064901; … ; 0.10056375748566362 0.1005038967874561 … 0.05464060581710062 0.08349600510717489; 0.12017965626031969 0.11588721360431514 … 0.08349600340833788 0.10912704877421092;;; 0.1201796561043686 0.10912705099250149 … 0.10050389326263463 0.11588721115133735; 0.1091270495012026 0.08971212091696106 … 0.09659641686337678 0.10964497618554785; … ; 0.10050389583948183 0.09659642012919635 … 0.07122114270402655 0.0919217177083834; 0.11588721246218946 0.10964497873677116 … 0.09192171618374552 0.10964497642656998;;; 0.10056375674900578 0.08349600611120786 … 0.0883186810422339 0.10050389449281805; 0.08349600484122395 0.05751667648347603 … 0.0837743920692003 0.09192171702312477; … ; 0.08831868302806924 0.08377439482191266 … 0.07075664036132776 0.08377439328787918; 0.10050389559155014 0.09192171927866019 … 0.08377439214947116 0.09659641814524393;;; … ;;; 0.07447652254488593 0.0794092994161099 … 0.03166159794682859 0.0550308146348056; 0.07940929865793417 0.07791160847159943 … 0.04792699966864403 0.06826914783290322; … ; 0.03166159954377443 0.04792700200405009 … 0.006870416176375231 0.014215398649436073; 0.05503081546230395 0.06826914939489674 … 0.01421539789769092 0.03204851569796295;;; 0.10056375735459916 0.10050389652201601 … 0.05464060601482207 0.0834960051633566; 0.10050389548899874 0.09659641970514588 … 0.07122114278494396 0.09192171756019035; … ; 0.054640608321417865 0.07122114597477831 … 0.00687041564474687 0.027544043276526323; 0.08349600636282131 0.09192171967640844 … 0.02754404222838615 0.05751667658600809;;; 0.12017965611870043 0.11588721343435891 … 0.08349600342784061 0.10912704870918692; 0.1158872121534206 0.10964497847273044 … 0.09192171606386106 0.10964497617997926; … ; 0.08349600635513636 0.09192171975776522 … 0.027544042091776754 0.0575166764906305; 0.10912705014814987 0.1096449786483229 … 0.05751667499713718 0.08971211958724967;;;;], α = 0.8, eigenvalues = [[-0.1443155919504752, 0.2969816924046434, 0.29698169275914715, 0.29698169310826644, 0.375738267257811, 0.37573826737769866, 0.3757382675155889]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.34423938217796185, n_iter = 14, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.9620452577609213 + 0.05301881202869575im -6.80799248656881e-10 + 1.3607288116704342e-10im … -3.4482253557141946e-9 - 4.879539279666011e-9im 2.602243417598002e-9 + 3.2700684148078535e-9im; -0.08610056171908023 + 0.004745043134847488im 0.05497539075456727 - 0.02699672589619838im … -0.408883204718714 + 0.28865243719508066im 0.1680556009542833 - 0.13366150601004503im; … ; -0.01279534695264536 + 0.0007051580824643582im -0.03223005595706885 + 0.015827355576443665im … -0.08851934160686532 + 0.06249051607317817im -0.006736280368075899 + 0.005357573918280729im; 0.08610056087332636 - 0.004745049295396137im -0.2956816883690649 + 0.14520200892484247im … -0.3814288719869763 + 0.26927090942073695im -0.2281979803341525 + 0.1814946125975777im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.1443155919504752, 0.2969816924046434, 0.29698169275914715, 0.29698169310826644, 0.375738267257811, 0.37573826737769866, 0.3757382675155889]], X = [[-0.9620452577609213 + 0.05301881202869575im -6.80799248656881e-10 + 1.3607288116704342e-10im … -3.4482253557141946e-9 - 4.879539279666011e-9im 2.602243417598002e-9 + 3.2700684148078535e-9im; -0.08610056171908023 + 0.004745043134847488im 0.05497539075456727 - 0.02699672589619838im … -0.408883204718714 + 0.28865243719508066im 0.1680556009542833 - 0.13366150601004503im; … ; -0.01279534695264536 + 0.0007051580824643582im -0.03223005595706885 + 0.015827355576443665im … -0.08851934160686532 + 0.06249051607317817im -0.006736280368075899 + 0.005357573918280729im; 0.08610056087332636 - 0.004745049295396137im -0.2956816883690649 + 0.14520200892484247im … -0.3814288719869763 + 0.26927090942073695im -0.2281979803341525 + 0.1814946125975777im]], residual_norms = [[8.310086793150982e-9, 7.824667473262013e-9, 5.9517171555776715e-9, 3.8085235999376975e-9, 2.202593413223767e-9, 1.9085107310397758e-9, 2.268314731114804e-9]], iterations = [2], converged = 1, n_matvec = 18)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 2.9048511873203185e-8)</code></pre><p>Apply ε† = 1 - χ0 (vc + fxc)</p><pre><code class="language-julia hljs">function eps_fun(δρ)
    δV = apply_kernel(basis, δρ; ρ=scfres.ρ)
    χ0δV = apply_χ0(scfres, δV)
    δρ - χ0δV
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">eps_fun (generic function with 1 method)</code></pre><p>eager diagonalizes the subspace matrix at each iteration</p><pre><code class="language-julia hljs">eigsolve(eps_fun, randn(size(scfres.ρ)), 5, :LM; eager=true, verbosity=3);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Arnoldi iteration step 1: normres = 0.04937126956080296
[ Info: Arnoldi iteration step 2: normres = 0.5919826547804417
[ Info: Arnoldi iteration step 3: normres = 0.9316892690081165
[ Info: Arnoldi iteration step 4: normres = 0.2750157510012908
[ Info: Arnoldi iteration step 5: normres = 0.4896070553880532
[ Info: Arnoldi schursolve in iter 1, krylovdim = 5: 0 values converged, normres = (3.90e-02, 7.38e-02, 4.29e-01, 2.21e-01, 2.04e-02)
[ Info: Arnoldi iteration step 6: normres = 0.35873769425381835
[ Info: Arnoldi schursolve in iter 1, krylovdim = 6: 0 values converged, normres = (1.12e-02, 1.10e-01, 2.94e-01, 1.32e-01, 1.09e-01)
[ Info: Arnoldi iteration step 7: normres = 0.07795066799213021
[ Info: Arnoldi schursolve in iter 1, krylovdim = 7: 0 values converged, normres = (4.33e-04, 1.06e-02, 1.86e-02, 4.20e-02, 4.95e-02)
[ Info: Arnoldi iteration step 8: normres = 0.08903513745472719
[ Info: Arnoldi schursolve in iter 1, krylovdim = 8: 0 values converged, normres = (1.70e-05, 6.96e-04, 1.35e-03, 1.37e-02, 4.67e-02)
[ Info: Arnoldi iteration step 9: normres = 0.06353627168101546
[ Info: Arnoldi schursolve in iter 1, krylovdim = 9: 0 values converged, normres = (4.51e-07, 2.99e-05, 6.41e-05, 2.36e-03, 1.81e-02)
[ Info: Arnoldi iteration step 10: normres = 0.11077043083332336
[ Info: Arnoldi schursolve in iter 1, krylovdim = 10: 0 values converged, normres = (2.22e-08, 2.46e-06, 5.89e-06, 1.04e-03, 3.31e-02)
[ Info: Arnoldi iteration step 11: normres = 0.0842570793088598
[ Info: Arnoldi schursolve in iter 1, krylovdim = 11: 0 values converged, normres = (8.11e-10, 1.48e-07, 3.95e-07, 3.20e-04, 4.35e-02)
[ Info: Arnoldi iteration step 12: normres = 0.07564061538074197
[ Info: Arnoldi schursolve in iter 1, krylovdim = 12: 0 values converged, normres = (2.68e-11, 8.12e-09, 2.41e-08, 8.84e-05, 2.62e-02)
[ Info: Arnoldi iteration step 13: normres = 0.14446881799367067
[ Info: Arnoldi schursolve in iter 1, krylovdim = 13: 0 values converged, normres = (1.65e-12, 8.15e-10, 2.67e-09, 3.83e-05, 2.10e-02)
[ Info: Arnoldi iteration step 14: normres = 0.2856303506545987
[ Info: Arnoldi schursolve in iter 1, krylovdim = 14: 1 values converged, normres = (4.73e-13, 2.82e-09, 2.78e-01, 5.93e-02, 1.05e-03)
[ Info: Arnoldi iteration step 15: normres = 0.22021373691186272
[ Info: Arnoldi schursolve in iter 1, krylovdim = 15: 1 values converged, normres = (4.66e-14, 2.32e-09, 4.36e-02, 1.57e-04, 1.01e-05)
[ Info: Arnoldi iteration step 16: normres = 0.1431526850123454
[ Info: Arnoldi schursolve in iter 1, krylovdim = 16: 1 values converged, normres = (6.37e-15, 1.77e-08, 4.59e-02, 5.52e-05, 1.33e-01)
[ Info: Arnoldi iteration step 17: normres = 0.0316262792603866
[ Info: Arnoldi schursolve in iter 1, krylovdim = 17: 1 values converged, normres = (8.39e-17, 7.03e-08, 9.70e-04, 5.94e-09, 3.08e-03)
[ Info: Arnoldi iteration step 18: normres = 0.02094882615709418
[ Info: Arnoldi schursolve in iter 1, krylovdim = 18: 1 values converged, normres = (7.27e-19, 1.30e-05, 3.53e-06, 1.86e-07, 4.70e-05)
[ Info: Arnoldi iteration step 19: normres = 0.15769223512754307
[ Info: Arnoldi schursolve in iter 1, krylovdim = 19: 1 values converged, normres = (4.86e-20, 3.72e-08, 1.46e-06, 2.78e-06, 4.92e-06)
[ Info: Arnoldi iteration step 20: normres = 0.07521072389466837
[ Info: Arnoldi schursolve in iter 1, krylovdim = 20: 1 values converged, normres = (1.77e-21, 5.64e-08, 7.76e-08, 5.51e-08, 4.18e-07)
[ Info: Arnoldi iteration step 21: normres = 0.02452693985966681
[ Info: Arnoldi schursolve in iter 1, krylovdim = 21: 1 values converged, normres = (1.82e-23, 1.13e-09, 1.12e-09, 5.63e-09, 5.25e-09)
[ Info: Arnoldi iteration step 22: normres = 0.07467461330647412
[ Info: Arnoldi schursolve in iter 1, krylovdim = 22: 1 values converged, normres = (5.59e-25, 5.53e-11, 5.46e-11, 3.31e-10, 2.51e-10)
[ Info: Arnoldi iteration step 23: normres = 0.2972705216795533
[ Info: Arnoldi schursolve in iter 1, krylovdim = 23: 1 values converged, normres = (1.51e-25, 8.69e-11, 8.50e-11, 1.87e-09, 1.62e-09)
[ Info: Arnoldi iteration step 24: normres = 0.018446370886432324
[ Info: Arnoldi schursolve in iter 1, krylovdim = 24: 1 values converged, normres = (1.20e-27, 1.41e-12, 1.39e-12, 1.60e-03, 1.20e-03)
[ Info: Arnoldi iteration step 25: normres = 0.12106311917457285
[ Info: Arnoldi schursolve in iter 1, krylovdim = 25: 3 values converged, normres = (6.14e-29, 1.18e-13, 1.16e-13, 1.37e-08, 6.66e-09)
[ Info: Arnoldi iteration step 26: normres = 0.03067273853843555
[ Info: Arnoldi schursolve in iter 1, krylovdim = 26: 3 values converged, normres = (8.28e-31, 2.64e-15, 2.61e-15, 4.78e-06, 1.53e-06)
[ Info: Arnoldi iteration step 27: normres = 0.021035645734953486
[ Info: Arnoldi schursolve in iter 1, krylovdim = 27: 3 values converged, normres = (7.15e-33, 3.63e-17, 3.58e-17, 1.16e-07, 7.30e-08)
[ Info: Arnoldi iteration step 28: normres = 0.10392785571652788
[ Info: Arnoldi schursolve in iter 1, krylovdim = 28: 3 values converged, normres = (3.20e-34, 2.67e-18, 2.63e-18, 3.28e-09, 1.06e-08)
[ Info: Arnoldi iteration step 29: normres = 0.11257371807602741
[ Info: Arnoldi schursolve in iter 1, krylovdim = 29: 3 values converged, normres = (1.55e-35, 2.12e-19, 2.09e-19, 2.22e-10, 9.13e-10)
[ Info: Arnoldi iteration step 30: normres = 0.0828011663331057
[ Info: Arnoldi schursolve in iter 1, krylovdim = 30: 3 values converged, normres = (6.26e-37, 1.54e-20, 1.52e-20, 1.87e-11, 7.64e-11)
[ Info: Arnoldi schursolve in iter 2, krylovdim = 19: 3 values converged, normres = (6.27e-37, 1.54e-20, 1.52e-20, 1.87e-11, 7.64e-11)
[ Info: Arnoldi iteration step 20: normres = 0.08679738481625575
[ Info: Arnoldi schursolve in iter 2, krylovdim = 20: 3 values converged, normres = (2.32e-38, 9.29e-22, 9.16e-22, 1.25e-12, 5.10e-12)
[ Info: Arnoldi iteration step 21: normres = 0.0283818298405894
┌ Info: Arnoldi eigsolve finished after 2 iterations:
│ *  6 eigenvalues converged
│ *  norm of residuals = (2.793545187375482e-40, 1.8267102206948135e-23, 2.1664025698691717e-23, 2.726209998036455e-14, 1.0804308863307664e-13, 3.7380905145253434e-14)
└ *  number of operations = 32</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../forwarddiff/">« Polarizability using automatic differentiation</a><a class="docs-footer-nextpage" href="../atomsbase/">AtomsBase integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 17 September 2022 13:14">Saturday 17 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
