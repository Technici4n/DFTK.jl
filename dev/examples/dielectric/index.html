<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Eigenvalues of the dielectric matrix · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/dielectric/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li class="is-active"><a class="tocitem" href>Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../compare_solvers/">Comparison of DFT solvers</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Response and properties</a></li><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/dielectric.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Eigenvalues-of-the-dielectric-matrix"><a class="docs-heading-anchor" href="#Eigenvalues-of-the-dielectric-matrix">Eigenvalues of the dielectric matrix</a><a id="Eigenvalues-of-the-dielectric-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalues-of-the-dielectric-matrix" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/dielectric.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/dielectric.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compute a few eigenvalues of the dielectric matrix (q=0,ω=0) iteratively.</p><pre><code class="language-julia hljs">using DFTK
using Plots
using KrylovKit
using Printf

# Calculation parameters
kgrid = [1, 1, 1]
Ecut = 5

# Silicon lattice
a = 10.26
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

# Compute the dielectric operator without symmetries
model = model_LDA(lattice, atoms, positions, symmetries=false)
basis = PlaneWaveBasis(model; Ecut, kgrid)
scfres = self_consistent_field(basis, tol=1e-14)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.5274666757074681 0.5044274726500472 … 0.4441271577267857 0.5044274741396624; 0.5044274725601311 0.477259172812049 … 0.42889200514930503 0.4860751456801537; … ; 0.444127157910246 0.4288920054045347 … 0.36709510390234856 0.41730357938773854; 0.5044274742327322 0.48607514585525863 … 0.41730357929529793 0.4772591757015133;;; 0.5044274726182224 0.4772591729037661 … 0.4288920052164037 0.48607514573383315; 0.47725917281521685 0.4445296867335544 … 0.40982119053325683 0.46474453592787546; … ; 0.4288920053952714 0.4098211907796984 … 0.3603062717327681 0.4089019906290273; 0.48607514582313055 0.46474453609803645 … 0.40890199053518156 0.4647445375470187;;; 0.44412715507081196 0.41730357588053835 … 0.3746744281618483 0.428892003763217; 0.4173035757996741 0.38733678746529204 … 0.3577719545556543 0.4089019878031503; … ; 0.3746744283217999 0.3577719547791171 … 0.31349195865757296 0.35777195608790785; 0.42889200384383774 0.4089019879596704 … 0.35777195600300077 0.40982119063252065;;; … ;;; 0.3720716548765142 0.3538533892768793 … 0.3279354991570245 0.3563741638512974; 0.3538533892260967 0.33178203998871625 … 0.30993601996195796 0.34214931142655053; … ; 0.3279354992333845 0.3099360200869645 … 0.32417733002053106 0.3270201521027527; 0.35637416389669296 0.3421493115215282 … 0.32702015207075025 0.34341104362096897;;; 0.44412715773176503 0.4288920052949245 … 0.36709510358279024 0.4173035791282349; 0.4288920052241961 0.4098211906523233 … 0.3603062713815145 0.40890199036858255; … ; 0.3670951037068935 0.360306271571286 … 0.32417733075321203 0.34595875497470424; 0.41730357919775235 0.40890199050570714 … 0.34595875492007855 0.3873367909256319;;; 0.5044274741659568 0.4860751458070322 … 0.41730357916084454 0.47725917560042225; 0.48607514572281535 0.4647445359844112 … 0.40890199035073516 0.4647445374137589; … ; 0.4173035793254493 0.40890199058822574 … 0.34595875510736684 0.38733679109296526; 0.47725917568742554 0.46474453757914785 … 0.3873367910150504 0.4445296902921188]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5575517640094976 -0.5479471298650767 … -0.5185332243574314 -0.547947130294226; -0.5479471298423279 -0.5318143667416079 … -0.518437723308513 -0.5418065875153957; … ; -0.5185332244289493 -0.5184377233894075 … -0.4296212273559292 -0.489568841904403; -0.5479471303209866 -0.5418065875593051 … -0.48956884185700267 -0.531814367549469;;; -0.5479471298306469 -0.5318143667326902 … -0.5184377233290194 -0.5418065875171454; -0.5318143667079184 -0.5005477187198462 … -0.512118330827656 -0.5325945671440768; … ; -0.5184377233846804 -0.5121183308907402 … -0.4661344043178213 -0.50432533992747; -0.5418065875372142 -0.5325945671822124 … -0.5043253398883586 -0.5325945676268974;;; -0.5185332235525637 -0.4895688408570332 … -0.4981327756267274 -0.5184377228738111; -0.4895688408277123 -0.4364507930467729 … -0.49007222018350727 -0.504325339058283; … ; -0.49813277566507963 -0.4900722202327653 … -0.46519528041179004 -0.49007222065620193; -0.5184377228888233 -0.5043253390962753 … -0.49007222062795963 -0.5121183308452558;;; … ;;; -0.47260172371458387 -0.48204415642758436 … -0.363452476013823 -0.4305619802530369; -0.4820441564154348 -0.4792205301474024 … -0.4126646377884492 -0.4600932872079871; … ; -0.36345247604155784 -0.4126646378321583 … -0.2285997353321862 -0.2848129673662075; -0.4305619802678751 -0.46009328723487863 … -0.28481296736106937 -0.3648044494806662;;; -0.5185332243750908 -0.51843772339204 … -0.4296212271226731 -0.4895688417747555; -0.5184377233722091 -0.512118330931482 … -0.466134404126787 -0.5043253398359664; … ; -0.42962122719032875 -0.46613440420820473 … -0.2285997360557469 -0.34831028474392944; -0.48956884180275306 -0.5043253398815082 … -0.34831028470183695 -0.4364507939618913;;; -0.5479471303111527 -0.5418065875695111 … -0.48956884178478965 -0.5318143675115536; -0.5418065875473222 -0.5325945672110809 … -0.5043253398108968 -0.5325945675972931; … ; -0.48956884186294897 -0.5043253399017779 … -0.3483102849161352 -0.43645079407883874; -0.5318143675423725 -0.5325945676464566 … -0.43645079402866305 -0.5005477196991504])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.33124645428959754 -0.4122172651662813 … -0.6446250885550712 -0.4122172641058156; -0.41221726523344837 -0.7106258209072016 … -0.35415988255400277 -0.3096704230808583; … ; -0.644625088443129 -0.35415988237966783 … -2.354519004586266 -1.2473824711220898; -0.412217264039506 -0.3096704229496627 … -1.2473824711671302 -0.7106258188255982;;; -0.4122172651636762 -0.7106258208065668 … -0.3541598825074105 -0.30967042302892883; -0.710625820870344 -1.4301202358810365 … -0.2674197074825495 -0.3835074689604727; … ; -0.35415988238420393 -0.26741970729919246 … -0.9690282231727827 -0.5852827349152033; -0.3096704229596998 -0.38350746882844733 … -0.5852827349699374 -0.3835074678241499;;; -0.6446250904061772 -1.2473824735819208 … -0.24768286718172428 -0.3541598835053891; -1.2473824736334638 -2.8783362645592225 … -0.30736886079165604 -0.5852827368718931; … ; -0.24768286706012488 -0.3073688606174519 … -0.4528328309810286 -0.30736885973209765; -0.35415988343978033 -0.5852827367533653 … -0.30736885978876183 -0.2674197074008855;;; … ;;; -0.9726032885419789 -0.4893652782181935 … -3.585959703679301 -1.9561597337680134; -0.4893652782568263 -0.27936054285759837 … -1.4246575491499027 -0.8654259672561676; … ; -3.585959703630676 -1.4246575490686053 … -10.916103635631181 -8.026581766195825; -1.9561597337374559 -0.8654259671880815 … -8.02658176622269 -4.601291070626602;;; -0.6446250885677511 -0.35415988249191027 … -2.3545190046725684 -1.2473824712519461; -0.3541598825428076 -0.2674197074673092 … -0.9690282233330021 -0.5852827350841443; … ; -2.3545190046161206 -0.9690282232246485 … -10.930732002031167 -6.031723605332687; -1.247382471210426 -0.5852827349925613 … -6.03172360534522 -2.8783362620140007;;; -0.4122172640964477 -0.30967042300809533 … -1.2473824712293706 -0.7106258188887742; -0.30967042307012316 -0.3835074689709411 … -0.5852827350769221 -0.38350746792780555; … ; -1.247382471142925 -0.5852827349303127 … -6.031723605372228 -2.878336261963615; -0.7106258188325894 -0.38350746781157996 … -2.878336261991354 -1.4301202333017764]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -7.25133879870454), converged = true, occupation_threshold = 1.0e-6, ρ = [0.1271082756040227 0.12017965598766676 … 0.10056375735467843 0.12017965629137217; 0.12017965597156771 0.10912704962399868 … 0.10050389568350795 0.1158872123029597; … ; 0.1005637573995162 0.10050389573420375 … 0.05464060754270444 0.08349600599717832; 0.1201796563103104 0.11588721233327537 … 0.08349600597099383 0.10912705015942567;;; 0.1201796559633011 0.1091270496180883 … 0.1005038956963591 0.11588721230416772; 0.10912704960167022 0.08971212000160121 … 0.09659641893359971 0.10964497730451185; … ; 0.10050389573124129 0.09659641897208185 … 0.07122114477611649 0.09192171871952294; 0.11588721231802353 0.10964497732986854 … 0.09192171869645634 0.10964497762554316;;; 0.1005637568500716 0.08349600541859836 … 0.08831868277755787 0.10050389541108458; 0.08349600540240111 0.057516676354397195 … 0.08377439373738375 0.09192171820690492; … ; 0.08831868279956955 0.08377439376465624 … 0.07075664207370207 0.08377439399909851; 0.10050389542049261 0.0919217182293115 … 0.0837743939834617 0.09659641894433584;;; … ;;; 0.07447652201928875 0.07940929859751746 … 0.03166159827960942 0.05503081447584389; 0.07940929859103132 0.07791160797635284 … 0.04792700047149875 0.06826914816487353; … ; 0.0316615982875138 0.04792700048803659 … 0.006870415697016355 0.014215397798702392; 0.0550308144820135 0.0682691481778251 … 0.014215397797856936 0.032048515117394115;;; 0.10056375736574986 0.10050389573585344 … 0.054640607446188885 0.08349600592555943; 0.10050389572342558 0.09659641899693469 … 0.07122114468141777 0.09192171866555719; … ; 0.0546406074741831 0.07122114472177778 … 0.00687041576914656 0.027544042936061656; 0.08349600594102564 0.09192171869241626 … 0.027544042925156657 0.05751667674653523;;; 0.12017965630335103 0.11588721234032164 … 0.08349600593110248 0.10912705013429648; 0.11588721232500222 0.1096449773490634 … 0.09192171865077191 0.10964497760585898; … ; 0.08349600597427864 0.09192171870437066 … 0.027544042980675414 0.05751667679664846; 0.10912705015472232 0.10964497763854822 … 0.057516676775147636 0.08971212056967864;;;;], α = 0.8, eigenvalues = [[-0.14431559193822902, 0.2969816927412817, 0.2969816928398239, 0.29698169284906106, 0.37573826734279336, 0.3757382674092167, 0.37573826748349276]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.3442393821699535, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.9626396058184029 - 0.040829644675056065im -1.2235118653767194e-10 + 1.8518115634406276e-11im … 2.306579829907558e-10 + 6.503593303084418e-11im -1.2719978259954385e-9 - 2.7123007685438355e-10im; -0.08615375509321482 - 0.003654147399238316im 0.20233096523133293 + 0.000432351096363825im … -0.10971727380297551 + 0.4794797019089377im 0.018172315600482405 - 0.09040677417486243im; … ; -0.01280325195926465 - 0.0005430403101938614im -0.030139360793393487 - 6.430388736428035e-5im … -0.017118083924185408 + 0.07480831847642837im 0.014284499574626793 - 0.07106518689170517im; 0.08615375517756628 + 0.003654148297415644im -0.12557973925617943 - 0.0002672592176311838im … -0.04311517696725615 + 0.18841858540285297im 0.10936153408738133 - 0.5440723520210661im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.14431559193822902, 0.2969816927412817, 0.2969816928398239, 0.29698169284906106, 0.37573826734279336, 0.3757382674092167, 0.37573826748349276]], X = [[-0.9626396058184029 - 0.040829644675056065im -1.2235118653767194e-10 + 1.8518115634406276e-11im … 2.306579829907558e-10 + 6.503593303084418e-11im -1.2719978259954385e-9 - 2.7123007685438355e-10im; -0.08615375509321482 - 0.003654147399238316im 0.20233096523133293 + 0.000432351096363825im … -0.10971727380297551 + 0.4794797019089377im 0.018172315600482405 - 0.09040677417486243im; … ; -0.01280325195926465 - 0.0005430403101938614im -0.030139360793393487 - 6.430388736428035e-5im … -0.017118083924185408 + 0.07480831847642837im 0.014284499574626793 - 0.07106518689170517im; 0.08615375517756628 + 0.003654148297415644im -0.12557973925617943 - 0.0002672592176311838im … -0.04311517696725615 + 0.18841858540285297im 0.10936153408738133 - 0.5440723520210661im]], residual_norms = [[6.718856883141385e-10, 1.0489768250069786e-9, 8.432439184465333e-10, 5.463955508624759e-10, 6.658609787263908e-10, 8.649508227522769e-10, 1.109180917431699e-9]], iterations = [3], converged = 1, n_matvec = 26)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 1.7364202131622298e-9)</code></pre><p>Apply ε† = 1 - χ0 (vc + fxc)</p><pre><code class="language-julia hljs">function eps_fun(δρ)
    δV = apply_kernel(basis, δρ; ρ=scfres.ρ)
    χ0δV = apply_χ0(scfres, δV)
    δρ - χ0δV
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">eps_fun (generic function with 1 method)</code></pre><p>eager diagonalizes the subspace matrix at each iteration</p><pre><code class="language-julia hljs">eigsolve(eps_fun, randn(size(scfres.ρ)), 5, :LM; eager=true, verbosity=3);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Arnoldi iteration step 1: normres = 0.07511618449095807
[ Info: Arnoldi iteration step 2: normres = 0.32911305702883764
[ Info: Arnoldi iteration step 3: normres = 0.3009982619370074
[ Info: Arnoldi iteration step 4: normres = 0.9612808155125391
[ Info: Arnoldi iteration step 5: normres = 0.5861275069494364
[ Info: Arnoldi schursolve in iter 1, krylovdim = 5: 0 values converged, normres = (3.80e-01, 6.18e-02, 3.30e-01, 2.93e-01, 1.70e-02)
[ Info: Arnoldi iteration step 6: normres = 0.35198184671123967
[ Info: Arnoldi schursolve in iter 1, krylovdim = 6: 0 values converged, normres = (1.36e-01, 2.20e-01, 2.02e-01, 8.43e-02, 9.12e-02)
[ Info: Arnoldi iteration step 7: normres = 0.0713111247452428
[ Info: Arnoldi schursolve in iter 1, krylovdim = 7: 0 values converged, normres = (4.64e-03, 1.48e-02, 6.79e-03, 2.19e-02, 5.26e-02)
[ Info: Arnoldi iteration step 8: normres = 0.12354040312051497
[ Info: Arnoldi schursolve in iter 1, krylovdim = 8: 0 values converged, normres = (2.49e-04, 1.31e-03, 6.64e-04, 9.00e-03, 6.03e-02)
[ Info: Arnoldi iteration step 9: normres = 0.07137685883058306
[ Info: Arnoldi schursolve in iter 1, krylovdim = 9: 0 values converged, normres = (7.67e-06, 6.67e-05, 3.75e-05, 2.27e-03, 3.78e-02)
[ Info: Arnoldi iteration step 10: normres = 0.08142504594872241
[ Info: Arnoldi schursolve in iter 1, krylovdim = 10: 0 values converged, normres = (2.78e-07, 4.06e-06, 2.55e-06, 7.94e-04, 3.53e-02)
[ Info: Arnoldi iteration step 11: normres = 0.09161283232072143
[ Info: Arnoldi schursolve in iter 1, krylovdim = 11: 0 values converged, normres = (1.09e-08, 2.60e-07, 1.81e-07, 2.25e-04, 2.00e-02)
[ Info: Arnoldi iteration step 12: normres = 0.06319210422182739
[ Info: Arnoldi schursolve in iter 1, krylovdim = 12: 0 values converged, normres = (3.00e-10, 1.18e-08, 9.16e-09, 5.03e-05, 1.08e-02)
[ Info: Arnoldi iteration step 13: normres = 0.08968983287878672
[ Info: Arnoldi schursolve in iter 1, krylovdim = 13: 0 values converged, normres = (1.13e-11, 7.27e-10, 6.22e-10, 1.25e-05, 4.87e-03)
[ Info: Arnoldi iteration step 14: normres = 0.36891035335086514
[ Info: Arnoldi schursolve in iter 1, krylovdim = 14: 0 values converged, normres = (3.66e-12, 1.15e-09, 2.44e-09, 3.67e-01, 8.67e-03)
[ Info: Arnoldi iteration step 15: normres = 0.0779065365406587
[ Info: Arnoldi schursolve in iter 1, krylovdim = 15: 1 values converged, normres = (1.28e-13, 9.95e-11, 2.12e-02, 1.27e-03, 9.24e-08)
[ Info: Arnoldi iteration step 16: normres = 0.37933431990362165
[ Info: Arnoldi schursolve in iter 1, krylovdim = 16: 1 values converged, normres = (4.79e-14, 3.67e-10, 3.23e-01, 1.34e-02, 1.95e-01)
[ Info: Arnoldi iteration step 17: normres = 0.03456274116097148
[ Info: Arnoldi schursolve in iter 1, krylovdim = 17: 1 values converged, normres = (7.62e-16, 1.06e-08, 8.84e-03, 1.11e-03, 9.50e-04)
[ Info: Arnoldi iteration step 18: normres = 0.029234385315519664
[ Info: Arnoldi schursolve in iter 1, krylovdim = 18: 1 values converged, normres = (9.29e-18, 1.44e-04, 9.59e-05, 3.53e-08, 3.17e-05)
[ Info: Arnoldi iteration step 19: normres = 0.21895361306502617
[ Info: Arnoldi schursolve in iter 1, krylovdim = 19: 1 values converged, normres = (9.33e-19, 1.04e-08, 2.98e-05, 4.83e-06, 3.75e-06)
[ Info: Arnoldi iteration step 20: normres = 0.020481904247686783
[ Info: Arnoldi schursolve in iter 1, krylovdim = 20: 1 values converged, normres = (8.57e-21, 2.40e-07, 4.01e-07, 1.57e-08, 1.07e-07)
[ Info: Arnoldi iteration step 21: normres = 0.02083148700043202
[ Info: Arnoldi schursolve in iter 1, krylovdim = 21: 1 values converged, normres = (7.33e-23, 2.39e-09, 5.89e-09, 6.67e-10, 1.47e-09)
[ Info: Arnoldi iteration step 22: normres = 0.3758253636503933
[ Info: Arnoldi schursolve in iter 1, krylovdim = 22: 1 values converged, normres = (1.20e-23, 8.47e-10, 1.49e-09, 2.01e-10, 4.42e-10)
[ Info: Arnoldi iteration step 23: normres = 0.10327911703535868
[ Info: Arnoldi schursolve in iter 1, krylovdim = 23: 1 values converged, normres = (1.12e-24, 4.98e-10, 9.76e-10, 1.90e-09, 4.23e-09)
[ Info: Arnoldi iteration step 24: normres = 0.01992266926703408
[ Info: Arnoldi schursolve in iter 1, krylovdim = 24: 1 values converged, normres = (9.24e-27, 7.36e-12, 1.34e-11, 4.62e-09, 1.13e-08)
[ Info: Arnoldi iteration step 25: normres = 0.02284535772060365
[ Info: Arnoldi schursolve in iter 1, krylovdim = 25: 3 values converged, normres = (8.65e-29, 1.10e-13, 2.01e-13, 6.66e-09, 1.41e-08)
[ Info: Arnoldi iteration step 26: normres = 0.1216151463707272
[ Info: Arnoldi schursolve in iter 1, krylovdim = 26: 3 values converged, normres = (4.63e-30, 9.79e-15, 1.79e-14, 1.37e-06, 1.71e-06)
[ Info: Arnoldi iteration step 27: normres = 0.025039293553961214
[ Info: Arnoldi schursolve in iter 1, krylovdim = 27: 3 values converged, normres = (4.91e-32, 1.69e-16, 3.08e-16, 4.65e-09, 3.52e-09)
[ Info: Arnoldi iteration step 28: normres = 0.09867678151218932
[ Info: Arnoldi schursolve in iter 1, krylovdim = 28: 3 values converged, normres = (2.02e-33, 1.12e-17, 2.05e-17, 1.51e-09, 2.32e-09)
[ Info: Arnoldi iteration step 29: normres = 0.08946484600878628
[ Info: Arnoldi schursolve in iter 1, krylovdim = 29: 3 values converged, normres = (8.00e-35, 7.40e-19, 1.35e-18, 7.88e-11, 1.76e-10)
[ Info: Arnoldi iteration step 30: normres = 0.1069487621265497
[ Info: Arnoldi schursolve in iter 1, krylovdim = 30: 3 values converged, normres = (4.19e-36, 6.96e-20, 1.27e-19, 8.40e-12, 1.89e-11)
[ Info: Arnoldi schursolve in iter 2, krylovdim = 19: 3 values converged, normres = (4.19e-36, 6.96e-20, 1.27e-19, 8.40e-12, 1.89e-11)
[ Info: Arnoldi iteration step 20: normres = 0.07252195637886136
[ Info: Arnoldi schursolve in iter 2, krylovdim = 20: 4 values converged, normres = (1.28e-37, 3.46e-21, 6.32e-21, 4.64e-13, 1.04e-12)
[ Info: Arnoldi iteration step 21: normres = 0.04093386394432948
┌ Info: Arnoldi eigsolve finished after 2 iterations:
│ *  6 eigenvalues converged
│ *  norm of residuals = (2.25419603628763e-39, 9.969371713212697e-23, 2.0142158535035486e-22, 1.4809916923760135e-14, 3.550954308775954e-14, 1.933791755958086e-14)
└ *  number of operations = 32</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../forwarddiff/">« Polarizability using automatic differentiation</a><a class="docs-footer-nextpage" href="../atomsbase/">AtomsBase integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 16 September 2022 18:19">Friday 16 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
