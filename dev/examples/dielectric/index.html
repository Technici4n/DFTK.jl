<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Eigenvalues of the dielectric matrix · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/dielectric/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li class="is-active"><a class="tocitem" href>Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li><a class="tocitem" href="../compare_solvers/">Comparison of DFT solvers</a></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Response and properties</a></li><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Eigenvalues of the dielectric matrix</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/dielectric.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Eigenvalues-of-the-dielectric-matrix"><a class="docs-heading-anchor" href="#Eigenvalues-of-the-dielectric-matrix">Eigenvalues of the dielectric matrix</a><a id="Eigenvalues-of-the-dielectric-matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Eigenvalues-of-the-dielectric-matrix" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/dielectric.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/dielectric.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compute a few eigenvalues of the dielectric matrix (q=0,ω=0) iteratively.</p><pre><code class="language-julia hljs">using DFTK
using Plots
using KrylovKit
using Printf

# Calculation parameters
kgrid = [1, 1, 1]
Ecut = 5

# Silicon lattice
a = 10.26
lattice = a / 2 .* [[0 1 1.]; [1 0 1.]; [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

# Compute the dielectric operator without symmetries
model = model_LDA(lattice, atoms, positions, symmetries=false)
basis = PlaneWaveBasis(model; Ecut, kgrid)
scfres = self_consistent_field(basis, tol=1e-14)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.300989220871039 -0.36928754008409864 … -0.5702050948450447 -0.36928754008409853; -0.36928754008409825 -0.655510535053717 … -0.2649158542948583 -0.2534016226718633; … ; -0.5702050948450449 -0.26491585429485853 … -2.2921214166012303 -1.1734490596332738; -0.36928754008409853 -0.2534016226718637 … -1.173449059633274 -0.6555105350537169;;; -0.36928754008409864 -0.6555105350537169 … -0.26491585429485837 -0.25340162267186317; -0.6555105350537166 -1.3741848283845108 … -0.1649807416926428 -0.31569459553369167; … ; -0.2649158542948586 -0.164980741692643 … -0.8632292937442333 -0.49171013234364025; -0.2534016226718634 -0.315694595533692 … -0.4917101323436407 -0.31569459553369184;;; -0.5702050948450447 -1.1734490596332743 … -0.12434236528787639 -0.26491585429485837; -1.1734490596332738 -2.8330201112266633 … -0.17313864934560508 -0.49171013234364047; … ; -0.1243423652878766 -0.17313864934560538 … -0.30136337195903234 -0.17313864934560513; -0.2649158542948586 -0.4917101323436408 … -0.1731386493456049 -0.1649807416926428;;; … ;;; -0.8704469253219294 -0.36178505487865037 … -3.552343411192366 -1.8825741572949868; -0.36178505487865 -0.13187963223332946 … -1.3191425205783651 -0.7474251415414246; … ; -3.552343411192366 -1.3191425205783651 … -11.017124648930457 -8.06796407517709; -1.8825741572949868 -0.7474251415414246 … -8.06796407517709 -4.579871852066219;;; -0.5702050948450447 -0.2649158542948584 … -2.2921214166012307 -1.1734490596332745; -0.26491585429485826 -0.1649807416926428 … -0.8632292937442325 -0.49171013234364047; … ; -2.2921214166012303 -0.8632292937442326 … -11.026564839255881 -6.025461600975534; -1.173449059633274 -0.4917101323436407 … -6.025461600975536 -2.8330201112266633;;; -0.3692875400840987 -0.2534016226718632 … -1.1734490596332745 -0.6555105350537169; -0.25340162267186317 -0.3156945955336917 … -0.49171013234364047 -0.3156945955336916; … ; -1.1734490596332745 -0.4917101323436406 … -6.025461600975536 -2.833020111226663; -0.6555105350537168 -0.315694595533692 … -2.8330201112266633 -1.3741848283845106]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.5274666762876064 0.5044274747681158 … 0.4441271553700846 0.5044274731154805; 0.5044274755990498 0.47725917715810845 … 0.42889200492255164 0.48607514707972493; … ; 0.4441271537530112 0.4288920027376672 … 0.3670950984145205 0.41730357423787723; 0.5044274723038099 0.48607514553059433 … 0.41730357511652133 0.4772591723929058;;; 0.5044274734309139 0.47725917498570775 … 0.42889200311302955 0.48607514504432275; 0.47725917571398796 0.44452969050509855 … 0.40982119062369426 0.46474453750653877; … ; 0.42889200154759116 0.4098211885764939 … 0.3603062657626816 0.4089019854298149; 0.4860751442835778 0.4647445360984002 … 0.4089019863181545 0.4647445344917791;;; 0.4441271556343154 0.4173035772370221 … 0.3746744264747696 0.42889200324060794; 0.4173035777378035 0.387336789763115 … 0.35777195469517964 0.4089019889781179; … ; 0.37467442517208543 0.3577719530719586 … 0.31349195314540923 0.3577719515719903; 0.428892002638129 0.40890198792837745 … 0.35777195234498715 0.40982118812812757;;; … ;;; 0.3720716560636137 0.3538533909690493 … 0.32793549968789665 0.35637416464069505; 0.3538533914302608 0.33178204298496217 … 0.3099360208277666 0.3421493128909844; … ; 0.3279354993498613 0.30993602006642595 … 0.32417733064500215 0.3270201524718835; 0.35637416436377256 0.34214931218013683 … 0.3270201525223598 0.34341104402998895;;; 0.4441271581852546 0.42889200679535533 … 0.36709510261907935 0.417303578719506; 0.4288920074714053 0.40982119414051515 … 0.360306271387474 0.40890199138669986; … ; 0.36709510164731607 0.36030626987398745 … 0.32417732899480994 0.34595875294591133; 0.41730357816099845 0.40890199021350887 … 0.3459587533701786 0.3873367894707403;;; 0.5044274744722262 0.48607514756783526 … 0.41730357714269906 0.47725917456128275; 0.48607514837574123 0.46474454008769506 … 0.40890198998629146 0.46474453847382724; … ; 0.4173035757239144 0.40890198798079574 … 0.3459587511379481 0.3873367870502911; 0.47725917381767713 0.4647445370087094 … 0.38733678777014047 0.4445296874834876]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5575517641408763 -0.5479471304189719 … -0.5185332235926222 -0.5479471299601724; -0.5479471306798129 -0.5318143679436264 … -0.5184377231877197 -0.5418065878883266; … ; -0.5185332230544804 -0.5184377225472725 … -0.42962122523939744 -0.4895688400975389; -0.5479471297216633 -0.5418065874382327 … -0.4895688404694526 -0.5318143665056878;;; -0.5479471301358887 -0.5318143673710249 … -0.518437722799475 -0.5418065874070621; -0.5318143676183616 -0.5005477198811747 … -0.5121183309481749 -0.5325945676894721; … ; -0.5184377223097946 -0.5121183303567396 … -0.46613440239483617 -0.5043253383606445; -0.5418065871857947 -0.5325945672686794 … -0.5043253386908633 -0.5325945668161999;;; -0.5185332238219663 -0.48956884128547434 … -0.49813277534830896 -0.5184377228903375; -0.4895688414816711 -0.43645079376139345 … -0.49007222041301185 -0.5043253395387048; … ; -0.4981327749421925 -0.490072219936819 … -0.46519527888286755 -0.49007221948837587; -0.518437722710618 -0.504325339205726 … -0.49007221976526594 -0.5121183303172676;;; … ;;; -0.4726017241212594 -0.48204415679758394 … -0.3634524765358423 -0.430561980724056; -0.4820441569516638 -0.47922053075927945 … -0.4126646381897754 -0.4600932876850628; … ; -0.36345247640360756 -0.4126646378805519 … -0.2285997371584544 -0.284812968399185; -0.4305619806153528 -0.46009328744077016 … -0.2848129682622497 -0.36480445006217566;;; -0.5185332243467444 -0.5184377235975138 … -0.42962122670589764 -0.4895688415444165; -0.518437723812894 -0.5121183316708258 … -0.4661344039584754 -0.5043253399712075; … ; -0.4296212262157976 -0.46613440339469897 … -0.22859973482001683 -0.3483102837100076; -0.48956884133723866 -0.5043253395953012 … -0.3483102840458417 -0.4364507933911255;;; -0.5479471302577064 -0.54180658791019 … -0.48956884099726145 -0.5318143670692742; -0.5418065881597176 -0.5325945682164562 … -0.5043253395255886 -0.5325945677613241; … ; -0.489568840443801 -0.5043253388894118 … -0.34831028288541377 -0.4364507923560845; -0.5318143668333738 -0.5325945673266442 … -0.43645079275297505 -0.500547718670342])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.33107430872430893 -0.4128071957349548 … -0.6446111630675823 -0.41280719692879037; -0.4128071951648614 -0.7100657258392349 … -0.3544615725600264 -0.30913306348046493; … ; -0.644611164146514 -0.35446157410446383 … -2.354647543426107 -1.2457143254929355; -0.4128071975019519 -0.3091330645795021 … -1.2457143249862055 -0.7100657291664989;;; -0.41280719678907346 -0.7100657274390341 … -0.3544615739813038 -0.3091330650346025; -0.7100657269580903 -1.430202857760587 … -0.26727788201712344 -0.383544625716625; … ; -0.354461575057062 -0.2672778834728887 … -0.9690574303763879 -0.5871334852744698; -0.30913306557408027 -0.38354462670397116 … -0.5871334847163494 -0.3835446278581126;;; -0.6446111630326956 -1.2457143236817265 … -0.24780071416141575 -0.35446157394458794; -1.2457143233771415 -2.882134115224942 … -0.3054389150634373 -0.5871334829042274; … ; -0.24780071505798368 -0.3054389162104658 … -0.45306669769649066 -0.3054389172619907; -0.35446157436734765 -0.5871334836209894 … -0.3054389167658837 -0.26727788388178286;;; … ;;; -0.9709769933795751 -0.48997582070718504 … -3.587860388040312 -1.9567619733783477; -0.489975820400053 -0.2793181200076468 … -1.421871137940374 -0.8653691163355031; … ; -3.5878603882461126 -1.4218711383924911 … -10.92154705544391 -8.025756891104391; -1.9567619735465671 -0.8653691168020579 … -8.025756890916979 -4.6012652580984055;;; -0.6446111610065345 -0.3544615710970169 … -2.354647540688049 -1.245714322458185; -0.3544615706363469 -0.26727787922295343 … -0.9690574263152338 -0.5871334809281481; … ; -2.3546475411697116 -0.9690574272649441 … -10.930987245081088 -6.027813131739631; -1.2457143228095142 -0.587133481725433 … -6.027813131651199 -2.8821341151470485;;; -0.4128071958695788 -0.30913306301421795 … -1.245714323487837 -0.7100657275617084; -0.30913306245583955 -0.3835446236624529 … -0.5871334818829376 -0.38354462482118845; … ; -1.2457143243531612 -0.5871334832522566 … -6.027813132723002 -2.8821341165324563; -0.7100657280694135 -0.38354462585162685 … -2.8821341162094978 -1.430202859571365]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [1, 1, 1]), energies = Energies(total = -7.2513387987045395), converged = true, occupation_threshold = 1.0e-6, ρ = [0.1271082757006078 0.12017965637965378 … 0.10056375687518607 0.12017965605496525; 0.12017965656424874 0.10912705042066177 … 0.10050389560780804 0.11588721256043584; … ; 0.10056375653780131 0.1005038952064461 … 0.054640606666936244 0.08349600499904428; 0.12017965588617431 0.11588721224968551 … 0.08349600520449399 0.10912704946763764;;; 0.12017965617931815 0.10912705004115814 … 0.10050389536449893 0.11588721222816495; 0.10912705020508577 0.08971212067526782 … 0.09659641900711763 0.10964497766714963; … ; 0.10050389505762113 0.09659641864633531 … 0.07122114382286242 0.09192171779546053; 0.11588721207539913 0.1096449773873611 … 0.09192171799021272 0.1096449770865038;;; 0.10056375701897186 0.08349600565527446 … 0.08831868261776363 0.1005038954214415; 0.08349600576365603 0.05751667666061973 … 0.08377439386445248 0.091921718490242; … ; 0.08831868238467895 0.08377439360080097 … 0.07075664131916244 0.08377439335251342; 0.10050389530881307 0.09192171829386195 … 0.08377439350581795 0.09659641862225696;;; … ;;; 0.07447652222711666 0.07940929879504412 … 0.031661598428384 0.055030814671688355; 0.07940929887730065 0.07791160829879924 … 0.04792700062334505 0.06826914839464339; … ; 0.03166159839069731 0.04792700050634682 … 0.006870415879073087 0.014215397968675197; 0.05503081462649079 0.06826914827698688 … 0.014215397946142985 0.0320485152845065;;; 0.10056375734797827 0.10050389586462183 … 0.054640607273737554 0.08349600579831733; 0.10050389599959839 0.09659641944794292 … 0.07122114459798301 0.09192171874531799; … ; 0.054640607070946326 0.07122114431851015 … 0.006870415645959303 0.02754404266820103; 0.08349600568386975 0.09192171852362073 … 0.02754404275520637 0.05751667650195596;;; 0.12017965626552748 0.11588721257553057 … 0.08349600549606213 0.10912704984116649; 0.1158872127478075 0.10964497801754558 … 0.09192171848250642 0.10964497771492455; … ; 0.08349600519032374 0.0919217181073102 … 0.027544042454571507 0.057516676058429805; 0.10912704968481853 0.10964497742590237 … 0.057516676228501644 0.08971211997288467;;;;], α = 0.8, eigenvalues = [[-0.14431559214090142, 0.29698169253076057, 0.29698169255870144, 0.29698169259401574, 0.3757382671920734, 0.3757382672740609, 0.37573826732459004]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.3442393821303054, n_iter = 15, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.21042683974893572 - 0.9402460395683374im 1.9044946665084896e-11 + 2.2355972024399268e-11im … -2.1983097236998222e-10 - 6.187444475845524e-10im 2.55850401493359e-10 - 1.280279836207943e-9im; -0.01883265820556737 - 0.08414958926436336im -0.3573478657355956 - 0.363041038408978im … 0.5096834692464447 - 0.20412422351587167im -0.05334315622204266 - 0.0106466034536273im; … ; -0.0027987086888518597 - 0.012505414242863633im 0.020281411577453543 + 0.02060453849025913im … 0.055390581311478795 - 0.022183454374773374im 0.0015274822964072392 + 0.00030471918150073524im; 0.018832657947424523 + 0.08414958939897235im -0.13668983686493585 - 0.13886744483263083im … -0.015149236227792278 + 0.006067491729437755im 0.06698071343733729 + 0.013367180510263005im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.14431559214090142, 0.29698169253076057, 0.29698169255870144, 0.29698169259401574, 0.3757382671920734, 0.3757382672740609, 0.37573826732459004]], X = [[-0.21042683974893572 - 0.9402460395683374im 1.9044946665084896e-11 + 2.2355972024399268e-11im … -2.1983097236998222e-10 - 6.187444475845524e-10im 2.55850401493359e-10 - 1.280279836207943e-9im; -0.01883265820556737 - 0.08414958926436336im -0.3573478657355956 - 0.363041038408978im … 0.5096834692464447 - 0.20412422351587167im -0.05334315622204266 - 0.0106466034536273im; … ; -0.0027987086888518597 - 0.012505414242863633im 0.020281411577453543 + 0.02060453849025913im … 0.055390581311478795 - 0.022183454374773374im 0.0015274822964072392 + 0.00030471918150073524im; 0.018832657947424523 + 0.08414958939897235im -0.13668983686493585 - 0.13886744483263083im … -0.015149236227792278 + 0.006067491729437755im 0.06698071343733729 + 0.013367180510263005im]], residual_norms = [[2.8359235175158627e-9, 3.402964302862625e-9, 2.64673987449077e-9, 3.059143539260554e-9, 1.0185865747332244e-9, 1.394371959936296e-9, 1.2083917314807326e-9]], iterations = [2], converged = 1, n_matvec = 19)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 5.157950420318062e-9)</code></pre><p>Apply ε† = 1 - χ0 (vc + fxc)</p><pre><code class="language-julia hljs">function eps_fun(δρ)
    δV = apply_kernel(basis, δρ; ρ=scfres.ρ)
    χ0δV = apply_χ0(scfres, δV)
    δρ - χ0δV
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">eps_fun (generic function with 1 method)</code></pre><p>eager diagonalizes the subspace matrix at each iteration</p><pre><code class="language-julia hljs">eigsolve(eps_fun, randn(size(scfres.ρ)), 5, :LM; eager=true, verbosity=3);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Arnoldi iteration step 1: normres = 0.03551066731098906
[ Info: Arnoldi iteration step 2: normres = 0.581147460078247
[ Info: Arnoldi iteration step 3: normres = 0.9281184431811371
[ Info: Arnoldi iteration step 4: normres = 0.31175985547895896
[ Info: Arnoldi iteration step 5: normres = 0.4057930312085696
[ Info: Arnoldi schursolve in iter 1, krylovdim = 5: 0 values converged, normres = (3.91e-02, 5.46e-02, 3.38e-01, 2.10e-01, 4.49e-02)
[ Info: Arnoldi iteration step 6: normres = 0.35806657423552873
[ Info: Arnoldi schursolve in iter 1, krylovdim = 6: 0 values converged, normres = (1.13e-02, 6.98e-02, 3.27e-01, 1.10e-01, 4.37e-02)
[ Info: Arnoldi iteration step 7: normres = 0.09486401556163376
[ Info: Arnoldi schursolve in iter 1, krylovdim = 7: 0 values converged, normres = (5.68e-04, 1.04e-02, 2.93e-02, 6.05e-02, 5.89e-02)
[ Info: Arnoldi iteration step 8: normres = 0.10984181575062049
[ Info: Arnoldi schursolve in iter 1, krylovdim = 8: 0 values converged, normres = (2.73e-05, 8.30e-04, 2.60e-03, 2.34e-02, 5.05e-02)
[ Info: Arnoldi iteration step 9: normres = 0.08604748082415119
[ Info: Arnoldi schursolve in iter 1, krylovdim = 9: 0 values converged, normres = (1.01e-06, 5.07e-05, 1.77e-04, 7.00e-03, 3.97e-02)
[ Info: Arnoldi iteration step 10: normres = 0.09383332695602539
[ Info: Arnoldi schursolve in iter 1, krylovdim = 10: 0 values converged, normres = (4.19e-08, 3.49e-06, 1.36e-05, 2.55e-03, 3.51e-02)
[ Info: Arnoldi iteration step 11: normres = 0.07848402623826128
[ Info: Arnoldi schursolve in iter 1, krylovdim = 11: 0 values converged, normres = (1.42e-09, 1.94e-07, 8.38e-07, 6.70e-04, 2.07e-02)
[ Info: Arnoldi iteration step 12: normres = 0.08138254581869754
[ Info: Arnoldi schursolve in iter 1, krylovdim = 12: 0 values converged, normres = (4.95e-11, 1.11e-08, 5.33e-08, 1.74e-04, 1.15e-02)
[ Info: Arnoldi iteration step 13: normres = 0.04074822629323246
[ Info: Arnoldi schursolve in iter 1, krylovdim = 13: 1 values converged, normres = (8.57e-13, 3.14e-10, 1.66e-09, 2.06e-05, 2.54e-03)
[ Info: Arnoldi iteration step 14: normres = 0.7346700320461266
[ Info: Arnoldi schursolve in iter 1, krylovdim = 14: 1 values converged, normres = (3.79e-13, 3.05e-10, 1.98e-09, 7.30e-01, 2.75e-02)
[ Info: Arnoldi iteration step 15: normres = 0.07431086841194932
[ Info: Arnoldi schursolve in iter 1, krylovdim = 15: 1 values converged, normres = (2.08e-14, 6.65e-10, 5.12e-02, 2.83e-05, 1.05e-06)
[ Info: Arnoldi iteration step 16: normres = 0.517356695221672
[ Info: Arnoldi schursolve in iter 1, krylovdim = 16: 1 values converged, normres = (8.41e-15, 1.21e-09, 7.23e-02, 2.92e-04, 5.10e-01)
[ Info: Arnoldi iteration step 17: normres = 0.035536355426176065
[ Info: Arnoldi schursolve in iter 1, krylovdim = 17: 1 values converged, normres = (1.54e-16, 4.78e-03, 2.86e-04, 1.38e-02, 2.01e-03)
[ Info: Arnoldi iteration step 18: normres = 0.02091393579922855
[ Info: Arnoldi schursolve in iter 1, krylovdim = 18: 1 values converged, normres = (1.34e-18, 6.12e-05, 2.49e-05, 3.68e-08, 2.13e-04)
[ Info: Arnoldi iteration step 19: normres = 0.05428431660758234
[ Info: Arnoldi schursolve in iter 1, krylovdim = 19: 1 values converged, normres = (2.98e-20, 8.44e-09, 2.36e-06, 4.12e-06, 7.26e-06)
[ Info: Arnoldi iteration step 20: normres = 0.19986699631199192
[ Info: Arnoldi schursolve in iter 1, krylovdim = 20: 1 values converged, normres = (2.79e-21, 3.76e-07, 7.25e-08, 2.42e-07, 1.51e-06)
[ Info: Arnoldi iteration step 21: normres = 0.031153755048546814
[ Info: Arnoldi schursolve in iter 1, krylovdim = 21: 1 values converged, normres = (3.86e-23, 7.49e-09, 4.93e-09, 3.55e-08, 1.88e-08)
[ Info: Arnoldi iteration step 22: normres = 0.015763943285596264
[ Info: Arnoldi schursolve in iter 1, krylovdim = 22: 1 values converged, normres = (2.50e-25, 8.39e-11, 3.92e-11, 4.55e-10, 4.00e-11)
[ Info: Arnoldi iteration step 23: normres = 0.11717365252599189
[ Info: Arnoldi schursolve in iter 1, krylovdim = 23: 1 values converged, normres = (1.21e-26, 6.47e-12, 2.99e-12, 3.85e-11, 4.14e-12)
[ Info: Arnoldi iteration step 24: normres = 0.1643148674362635
[ Info: Arnoldi schursolve in iter 1, krylovdim = 24: 1 values converged, normres = (2.00e-27, 6.85e-12, 3.17e-12, 4.43e-10, 3.52e-11)
[ Info: Arnoldi iteration step 25: normres = 0.05207088278382638
[ Info: Arnoldi schursolve in iter 1, krylovdim = 25: 3 values converged, normres = (4.05e-29, 2.58e-13, 1.19e-13, 1.25e-09, 1.28e-10)
[ Info: Arnoldi iteration step 26: normres = 0.07279984229154006
[ Info: Arnoldi schursolve in iter 1, krylovdim = 26: 3 values converged, normres = (1.32e-30, 1.43e-14, 6.61e-15, 2.63e-04, 6.06e-05)
[ Info: Arnoldi iteration step 27: normres = 0.040331811725013385
[ Info: Arnoldi schursolve in iter 1, krylovdim = 27: 3 values converged, normres = (2.21e-32, 3.83e-16, 1.77e-16, 7.34e-07, 1.18e-07)
[ Info: Arnoldi iteration step 28: normres = 0.0714700591364581
[ Info: Arnoldi schursolve in iter 1, krylovdim = 28: 3 values converged, normres = (6.97e-34, 2.01e-17, 9.28e-18, 2.74e-07, 3.50e-07)
[ Info: Arnoldi iteration step 29: normres = 0.014458125647794045
[ Info: Arnoldi schursolve in iter 1, krylovdim = 29: 3 values converged, normres = (4.18e-36, 1.93e-19, 8.92e-20, 2.27e-10, 3.01e-10)
[ Info: Arnoldi iteration step 30: normres = 0.14777498742844994
[ Info: Arnoldi schursolve in iter 1, krylovdim = 30: 3 values converged, normres = (2.59e-37, 1.94e-20, 8.95e-21, 2.33e-11, 2.45e-11)
[ Info: Arnoldi schursolve in iter 2, krylovdim = 19: 3 values converged, normres = (2.59e-37, 1.94e-20, 8.95e-21, 2.33e-11, 2.45e-11)
[ Info: Arnoldi iteration step 20: normres = 0.07197480979693331
[ Info: Arnoldi schursolve in iter 2, krylovdim = 20: 3 values converged, normres = (9.09e-39, 1.22e-21, 5.63e-22, 1.67e-12, 1.76e-12)
[ Info: Arnoldi iteration step 21: normres = 0.08499740336337279
┌ Info: Arnoldi eigsolve finished after 2 iterations:
│ *  5 eigenvalues converged
│ *  norm of residuals = (3.292287878536722e-40, 7.204507096020697e-23, 3.175485774826062e-23, 1.0983672547858485e-13, 1.564649779846323e-13)
└ *  number of operations = 32</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../forwarddiff/">« Polarizability using automatic differentiation</a><a class="docs-footer-nextpage" href="../atomsbase/">AtomsBase integration »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Friday 26 August 2022 16:56">Friday 26 August 2022</span>. Using Julia version 1.8.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
