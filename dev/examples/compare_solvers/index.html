<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Comparison of DFT solvers · DFTK.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://docs.dftk.org/stable/examples/compare_solvers/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="DFTK.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DFTK.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../features/">DFTK features</a></li><li><span class="tocitem">Getting started</span><ul><li><a class="tocitem" href="../../guide/installation/">Installation</a></li><li><a class="tocitem" href="../../guide/tutorial/">Tutorial</a></li><li><a class="tocitem" href="../../guide/periodic_problems/">Problems and plane-wave discretisations</a></li><li><a class="tocitem" href="../../guide/introductory_resources/">Introductory resources</a></li><li><a class="tocitem" href="../../school2022/">DFTK School 2022</a></li></ul></li><li><span class="tocitem">Basic DFT calculations</span><ul><li><a class="tocitem" href="../metallic_systems/">Temperature and metallic systems</a></li><li><a class="tocitem" href="../collinear_magnetism/">Collinear spin and magnetic systems</a></li><li><a class="tocitem" href="../convergence_study/">Performing a convergence study</a></li><li><a class="tocitem" href="../supercells/">Creating and modelling metallic supercells</a></li><li><a class="tocitem" href="../gaas_surface/">Modelling a gallium arsenide surface</a></li><li><a class="tocitem" href="../graphene/">Graphene band structure</a></li><li><a class="tocitem" href="../geometry_optimization/">Geometry optimization</a></li><li><a class="tocitem" href="../energy_cutoff_smearing/">Energy cutoff smearing</a></li></ul></li><li><span class="tocitem">Response and properties</span><ul><li><a class="tocitem" href="../polarizability/">Polarizability by linear response</a></li><li><a class="tocitem" href="../forwarddiff/">Polarizability using automatic differentiation</a></li><li><a class="tocitem" href="../dielectric/">Eigenvalues of the dielectric matrix</a></li></ul></li><li><span class="tocitem">Ecosystem integration</span><ul><li><a class="tocitem" href="../atomsbase/">AtomsBase integration</a></li><li><a class="tocitem" href="../input_output/">Input and output formats</a></li><li><a class="tocitem" href="../wannier90/">Wannierization using Wannier90</a></li></ul></li><li><span class="tocitem">Tipps and tricks</span><ul><li><a class="tocitem" href="../../tricks/parallelization/">Timings and parallelization</a></li><li><a class="tocitem" href="../../tricks/scf_checkpoints/">Saving SCF results on disk and SCF checkpoints</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../custom_solvers/">Custom solvers</a></li><li><a class="tocitem" href="../scf_callbacks/">Monitoring self-consistent field calculations</a></li><li class="is-active"><a class="tocitem" href>Comparison of DFT solvers</a><ul class="internal"><li><a class="tocitem" href="#Density-based-self-consistent-field"><span>Density-based self-consistent field</span></a></li><li><a class="tocitem" href="#Potential-based-SCF"><span>Potential-based SCF</span></a></li><li><a class="tocitem" href="#Direct-minimization"><span>Direct minimization</span></a></li></ul></li></ul></li><li><span class="tocitem">Nonstandard models</span><ul><li><a class="tocitem" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension</a></li><li><a class="tocitem" href="../gross_pitaevskii_2D/">Gross-Pitaevskii equation with external magnetic field</a></li><li><a class="tocitem" href="../custom_potential/">Custom potential</a></li><li><a class="tocitem" href="../cohen_bergstresser/">Cohen-Bergstresser model</a></li><li><a class="tocitem" href="../anyons/">Anyonic models</a></li></ul></li><li><span class="tocitem">Error control</span><ul><li><a class="tocitem" href="../arbitrary_floattype/">Arbitrary floating-point types</a></li><li><a class="tocitem" href="../error_estimates_forces/">Practical error bounds for the forces</a></li></ul></li><li><span class="tocitem">Developer resources</span><ul><li><a class="tocitem" href="../../developer/conventions/">Notation and conventions</a></li><li><a class="tocitem" href="../../developer/data_structures/">Data structures</a></li><li><a class="tocitem" href="../../developer/useful_formulas/">Useful formulas</a></li><li><a class="tocitem" href="../../developer/symmetries/">Crystal symmetries</a></li></ul></li><li><a class="tocitem" href="../../api/">API reference</a></li><li><a class="tocitem" href="../../publications/">Publications</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solvers</a></li><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Comparison of DFT solvers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaMolSim/DFTK.jl/blob/master/examples/compare_solvers.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Comparison-of-DFT-solvers"><a class="docs-heading-anchor" href="#Comparison-of-DFT-solvers">Comparison of DFT solvers</a><a id="Comparison-of-DFT-solvers-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison-of-DFT-solvers" title="Permalink"></a></h1><p><a href="https://mybinder.org/v2/gh/JuliaMolSim/DFTK.jl/gh-pages?filepath=dev/examples/compare_solvers.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt/></a> <a href="https://nbviewer.jupyter.org/github/JuliaMolSim/DFTK.jl/blob/gh-pages/dev/examples/compare_solvers.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt/></a></p><p>We compare four different approaches for solving the DFT minimisation problem, namely a density-based SCF, a potential-based SCF, direct minimisation and Newton.</p><p>First we setup our problem</p><pre><code class="language-julia hljs">using DFTK
using LinearAlgebra

a = 10.26  # Silicon lattice constant in Bohr
lattice = a / 2 * [[0 1 1.];
                   [1 0 1.];
                   [1 1 0.]]
Si = ElementPsp(:Si, psp=load_psp(&quot;hgh/lda/Si-q4&quot;))
atoms     = [Si, Si]
positions = [ones(3)/8, -ones(3)/8]

model = model_LDA(lattice, atoms, positions)
basis = PlaneWaveBasis(model; Ecut=5, kgrid=[3, 3, 3])

# Convergence we desire
tol = 1e-12
is_converged = DFTK.ScfConvergenceDensity(tol)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">#512 (generic function with 1 method)</code></pre><h2 id="Density-based-self-consistent-field"><a class="docs-heading-anchor" href="#Density-based-self-consistent-field">Density-based self-consistent field</a><a id="Density-based-self-consistent-field-1"></a><a class="docs-heading-anchor-permalink" href="#Density-based-self-consistent-field" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scf = self_consistent_field(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3915556370334939 0.37851742089978796 … 0.3446996002702393 0.37851742089978807; 0.37851742089978796 0.36645844064795946 … 0.327357281722284 0.36364954262057564; … ; 0.3446996002702393 0.327357281722284 … 0.30751926941857555 0.33438053198661033; 0.37851742089978796 0.36364954262057564 … 0.33438053198661033 0.3664584406479594;;; 0.378517420899788 0.3664584406479595 … 0.32735728172228407 0.3636495426205757; 0.36645844064795946 0.3510288634177598 … 0.3111940134606099 0.351917066349224; … ; 0.327357281722284 0.3111940134606099 … 0.29824122841226897 0.32142600281512207; 0.3636495426205756 0.351917066349224 … 0.3214260028151221 0.3519170663492239;;; 0.3446996002702394 0.3343805319866103 … 0.28653515376395844 0.32735728172228407; 0.3343805319866102 0.3186160477630099 … 0.27805891882350714 0.3214260028151221; … ; 0.2865351537639584 0.27805891882350714 … 0.2559018577231421 0.27805891882350714; 0.32735728172228395 0.32142600281512207 … 0.2780589188235072 0.3111940134606098;;; … ;;; 0.30487474928907426 0.28303666896240415 … 0.2855643323175779 0.3009573705184457; 0.28303666896240415 0.2589843162227541 … 0.27263300128660156 0.2854141966266528; … ; 0.2855643323175779 0.27263300128660156 … 0.2771603891377398 0.28121087378383314; 0.30095737051844557 0.2854141966266527 … 0.28121087378383314 0.2930827262717318;;; 0.34469960027023944 0.32735728172228407 … 0.3075192694185755 0.3343805319866104; 0.327357281722284 0.3111940134606098 … 0.298241228412269 0.3214260028151221; … ; 0.3075192694185755 0.298241228412269 … 0.2771603891377398 0.2931311914702652; 0.3343805319866103 0.321426002815122 … 0.2931311914702652 0.31861604776300984;;; 0.378517420899788 0.3636495426205756 … 0.33438053198661033 0.36645844064795957; 0.3636495426205756 0.3519170663492239 … 0.321426002815122 0.35191706634922404; … ; 0.33438053198661033 0.32142600281512207 … 0.2931311914702652 0.31861604776300995; 0.36645844064795946 0.35191706634922393 … 0.31861604776300995 0.35102886341775974]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923122154 -0.4966565572257062 … -0.4771919009648967 -0.4966565572257062; -0.4966565572257062 -0.4848182087107448 … -0.47638044576678396 -0.4920413111694297; … ; -0.47719190096489666 -0.4763804457667839 … -0.4122880708739264 -0.4550700815561307; -0.49665655722570623 -0.4920413111694297 … -0.4550700815561307 -0.4848182087107448;;; -0.4966565572257062 -0.4848182087107449 … -0.47638044576678396 -0.4920413111694297; -0.4848182087107448 -0.4583744079148685 … -0.4706560157057212 -0.4861790251756264; … ; -0.4763804457667839 -0.47065601570572113 … -0.4463984364362253 -0.4688943963915302; -0.4920413111694297 -0.4861790251756264 … -0.4688943963915303 -0.4861790251756263;;; -0.47719190096489666 -0.4550700815561307 … -0.46051412342267006 -0.47638044576678396; -0.4550700815561307 -0.40906618243913767 … -0.4567199083211418 -0.4688943963915303; … ; -0.46051412342267006 -0.45671990832114173 … -0.4451449566034964 -0.45671990832114173; -0.4763804457667839 -0.4688943963915303 … -0.45671990832114173 -0.47065601570572113;;; … ;;; -0.4494759508409223 -0.4551499722014971 … -0.37125986261792093 -0.41774571520277526; -0.4551499722014971 -0.44880351099771654 … -0.417438010713434 -0.44412609929878977; … ; -0.37125986261792093 -0.417438010713434 … -0.25365698328407915 -0.2997980910596125; -0.4177457152027752 -0.44412609929878977 … -0.2997980910596126 -0.36106343264803725;;; -0.47719190096489666 -0.47638044576678396 … -0.4122880708739264 -0.45507008155613077; -0.47638044576678396 -0.47065601570572113 … -0.4463984364362253 -0.4688943963915303; … ; -0.4122880708739264 -0.4463984364362253 … -0.25365698328407915 -0.3410633023008511; -0.4550700815561307 -0.4688943963915303 … -0.3410633023008511 -0.4090661824391377;;; -0.4966565572257062 -0.4920413111694297 … -0.45507008155613077 -0.4848182087107448; -0.4920413111694297 -0.4861790251756263 … -0.4688943963915303 -0.4861790251756264; … ; -0.45507008155613077 -0.4688943963915302 … -0.34106330230085113 -0.4090661824391377; -0.4848182087107449 -0.4861790251756264 … -0.4090661824391378 -0.4583744079148685])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.4129139212662895 -0.48683674427717005 … -0.7027113226190829 -0.48683674427717005; -0.48683674427716983 -0.7744303950404281 … -0.41363732843929474 -0.38233074979447035; … ; -0.702711322619083 -0.4136373284392949 … -2.396761682588036 -1.2958067581749457; -0.4868367442771698 -0.38233074979447024 … -1.295806758174946 -0.7744303950404279;;; -0.4868367442771699 -0.7744303950404281 … -0.4136373284392947 -0.38233074979447057; -0.7744303950404279 -1.4814477483918536 … -0.32458456943326164 -0.44991939657067376; … ; -0.4136373284392948 -0.3245845694332619 … -1.0113572986116859 -0.6373277791931689; -0.38233074979447024 -0.44991939657067376 … -0.6373277791931686 -0.44991939657067365;;; -0.7027113226190826 -1.2958067581749462 … -0.29820348937555685 -0.4136373284392949; -1.2958067581749462 -2.9196723936538693 … -0.3537295846614378 -0.6373277791931686; … ; -0.29820348937555685 -0.3537295846614383 … -0.4903726081071658 -0.35372958466143817; -0.41363732843929474 -0.6373277791931686 … -0.35372958466143745 -0.32458456943326164;;; … ;;; -1.0166744212557572 -0.5332878143065813 … -3.6361382571228456 -1.9987602620506035; -0.5332878143065811 -0.32174124747387467 … -1.466733940750244 -0.906193894146868; … ; -3.6361382571228456 -1.466733940750244 … -10.988177824465867 -8.08737616820815; -1.9987602620506033 -0.9061938941468681 … -8.08737616820815 -4.64787837114321;;; -0.7027113226190826 -0.4136373284392947 … -2.3967616825880365 -1.295806758174946; -0.4136373284392946 -0.32458456943326186 … -1.0113572986116857 -0.6373277791931686; … ; -2.3967616825880365 -1.0113572986116859 … -11.002806190874972 -6.077304186394048; -1.2958067581749457 -0.6373277791931686 … -6.077304186394048 -2.9196723936538693;;; -0.48683674427716994 -0.38233074979447057 … -1.295806758174946 -0.774430395040428; -0.38233074979447035 -0.4499193965706738 … -0.6373277791931686 -0.4499193965706737; … ; -1.295806758174946 -0.6373277791931686 … -6.077304186394047 -2.919672393653869; -0.7744303950404279 -0.44991939657067365 … -2.919672393653869 -1.4814477483918536]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3915556370334939 0.37851742089978796 … 0.3446996002702393 0.37851742089978807; 0.37851742089978796 0.36645844064795946 … 0.327357281722284 0.36364954262057564; … ; 0.3446996002702393 0.327357281722284 … 0.30751926941857555 0.33438053198661033; 0.37851742089978796 0.36364954262057564 … 0.33438053198661033 0.3664584406479594;;; 0.378517420899788 0.3664584406479595 … 0.32735728172228407 0.3636495426205757; 0.36645844064795946 0.3510288634177598 … 0.3111940134606099 0.351917066349224; … ; 0.327357281722284 0.3111940134606099 … 0.29824122841226897 0.32142600281512207; 0.3636495426205756 0.351917066349224 … 0.3214260028151221 0.3519170663492239;;; 0.3446996002702394 0.3343805319866103 … 0.28653515376395844 0.32735728172228407; 0.3343805319866102 0.3186160477630099 … 0.27805891882350714 0.3214260028151221; … ; 0.2865351537639584 0.27805891882350714 … 0.2559018577231421 0.27805891882350714; 0.32735728172228395 0.32142600281512207 … 0.2780589188235072 0.3111940134606098;;; … ;;; 0.30487474928907426 0.28303666896240415 … 0.2855643323175779 0.3009573705184457; 0.28303666896240415 0.2589843162227541 … 0.27263300128660156 0.2854141966266528; … ; 0.2855643323175779 0.27263300128660156 … 0.2771603891377398 0.28121087378383314; 0.30095737051844557 0.2854141966266527 … 0.28121087378383314 0.2930827262717318;;; 0.34469960027023944 0.32735728172228407 … 0.3075192694185755 0.3343805319866104; 0.327357281722284 0.3111940134606098 … 0.298241228412269 0.3214260028151221; … ; 0.3075192694185755 0.298241228412269 … 0.2771603891377398 0.2931311914702652; 0.3343805319866103 0.321426002815122 … 0.2931311914702652 0.31861604776300984;;; 0.378517420899788 0.3636495426205756 … 0.33438053198661033 0.36645844064795957; 0.3636495426205756 0.3519170663492239 … 0.321426002815122 0.35191706634922404; … ; 0.33438053198661033 0.32142600281512207 … 0.2931311914702652 0.31861604776300995; 0.36645844064795946 0.35191706634922393 … 0.31861604776300995 0.35102886341775974]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923122154 -0.4966565572257062 … -0.4771919009648967 -0.4966565572257062; -0.4966565572257062 -0.4848182087107448 … -0.47638044576678396 -0.4920413111694297; … ; -0.47719190096489666 -0.4763804457667839 … -0.4122880708739264 -0.4550700815561307; -0.49665655722570623 -0.4920413111694297 … -0.4550700815561307 -0.4848182087107448;;; -0.4966565572257062 -0.4848182087107449 … -0.47638044576678396 -0.4920413111694297; -0.4848182087107448 -0.4583744079148685 … -0.4706560157057212 -0.4861790251756264; … ; -0.4763804457667839 -0.47065601570572113 … -0.4463984364362253 -0.4688943963915302; -0.4920413111694297 -0.4861790251756264 … -0.4688943963915303 -0.4861790251756263;;; -0.47719190096489666 -0.4550700815561307 … -0.46051412342267006 -0.47638044576678396; -0.4550700815561307 -0.40906618243913767 … -0.4567199083211418 -0.4688943963915303; … ; -0.46051412342267006 -0.45671990832114173 … -0.4451449566034964 -0.45671990832114173; -0.4763804457667839 -0.4688943963915303 … -0.45671990832114173 -0.47065601570572113;;; … ;;; -0.4494759508409223 -0.4551499722014971 … -0.37125986261792093 -0.41774571520277526; -0.4551499722014971 -0.44880351099771654 … -0.417438010713434 -0.44412609929878977; … ; -0.37125986261792093 -0.417438010713434 … -0.25365698328407915 -0.2997980910596125; -0.4177457152027752 -0.44412609929878977 … -0.2997980910596126 -0.36106343264803725;;; -0.47719190096489666 -0.47638044576678396 … -0.4122880708739264 -0.45507008155613077; -0.47638044576678396 -0.47065601570572113 … -0.4463984364362253 -0.4688943963915303; … ; -0.4122880708739264 -0.4463984364362253 … -0.25365698328407915 -0.3410633023008511; -0.4550700815561307 -0.4688943963915303 … -0.3410633023008511 -0.4090661824391377;;; -0.4966565572257062 -0.4920413111694297 … -0.45507008155613077 -0.4848182087107448; -0.4920413111694297 -0.4861790251756263 … -0.4688943963915303 -0.4861790251756264; … ; -0.45507008155613077 -0.4688943963915302 … -0.34106330230085113 -0.4090661824391377; -0.4848182087107449 -0.4861790251756264 … -0.4090661824391378 -0.4583744079148685])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.4129139212662895 -0.48683674427717005 … -0.7027113226190829 -0.48683674427717005; -0.48683674427716983 -0.7744303950404281 … -0.41363732843929474 -0.38233074979447035; … ; -0.702711322619083 -0.4136373284392949 … -2.396761682588036 -1.2958067581749457; -0.4868367442771698 -0.38233074979447024 … -1.295806758174946 -0.7744303950404279;;; -0.4868367442771699 -0.7744303950404281 … -0.4136373284392947 -0.38233074979447057; -0.7744303950404279 -1.4814477483918536 … -0.32458456943326164 -0.44991939657067376; … ; -0.4136373284392948 -0.3245845694332619 … -1.0113572986116859 -0.6373277791931689; -0.38233074979447024 -0.44991939657067376 … -0.6373277791931686 -0.44991939657067365;;; -0.7027113226190826 -1.2958067581749462 … -0.29820348937555685 -0.4136373284392949; -1.2958067581749462 -2.9196723936538693 … -0.3537295846614378 -0.6373277791931686; … ; -0.29820348937555685 -0.3537295846614383 … -0.4903726081071658 -0.35372958466143817; -0.41363732843929474 -0.6373277791931686 … -0.35372958466143745 -0.32458456943326164;;; … ;;; -1.0166744212557572 -0.5332878143065813 … -3.6361382571228456 -1.9987602620506035; -0.5332878143065811 -0.32174124747387467 … -1.466733940750244 -0.906193894146868; … ; -3.6361382571228456 -1.466733940750244 … -10.988177824465867 -8.08737616820815; -1.9987602620506033 -0.9061938941468681 … -8.08737616820815 -4.64787837114321;;; -0.7027113226190826 -0.4136373284392947 … -2.3967616825880365 -1.295806758174946; -0.4136373284392946 -0.32458456943326186 … -1.0113572986116857 -0.6373277791931686; … ; -2.3967616825880365 -1.0113572986116859 … -11.002806190874972 -6.077304186394048; -1.2958067581749457 -0.6373277791931686 … -6.077304186394048 -2.9196723936538693;;; -0.48683674427716994 -0.38233074979447057 … -1.295806758174946 -0.774430395040428; -0.38233074979447035 -0.4499193965706738 … -0.6373277791931686 -0.4499193965706737; … ; -1.295806758174946 -0.6373277791931686 … -6.077304186394047 -2.919672393653869; -0.7744303950404279 -0.44991939657067365 … -2.919672393653869 -1.4814477483918536]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3915556370334939 0.37851742089978796 … 0.3446996002702393 0.37851742089978807; 0.37851742089978796 0.36645844064795946 … 0.327357281722284 0.36364954262057564; … ; 0.3446996002702393 0.327357281722284 … 0.30751926941857555 0.33438053198661033; 0.37851742089978796 0.36364954262057564 … 0.33438053198661033 0.3664584406479594;;; 0.378517420899788 0.3664584406479595 … 0.32735728172228407 0.3636495426205757; 0.36645844064795946 0.3510288634177598 … 0.3111940134606099 0.351917066349224; … ; 0.327357281722284 0.3111940134606099 … 0.29824122841226897 0.32142600281512207; 0.3636495426205756 0.351917066349224 … 0.3214260028151221 0.3519170663492239;;; 0.3446996002702394 0.3343805319866103 … 0.28653515376395844 0.32735728172228407; 0.3343805319866102 0.3186160477630099 … 0.27805891882350714 0.3214260028151221; … ; 0.2865351537639584 0.27805891882350714 … 0.2559018577231421 0.27805891882350714; 0.32735728172228395 0.32142600281512207 … 0.2780589188235072 0.3111940134606098;;; … ;;; 0.30487474928907426 0.28303666896240415 … 0.2855643323175779 0.3009573705184457; 0.28303666896240415 0.2589843162227541 … 0.27263300128660156 0.2854141966266528; … ; 0.2855643323175779 0.27263300128660156 … 0.2771603891377398 0.28121087378383314; 0.30095737051844557 0.2854141966266527 … 0.28121087378383314 0.2930827262717318;;; 0.34469960027023944 0.32735728172228407 … 0.3075192694185755 0.3343805319866104; 0.327357281722284 0.3111940134606098 … 0.298241228412269 0.3214260028151221; … ; 0.3075192694185755 0.298241228412269 … 0.2771603891377398 0.2931311914702652; 0.3343805319866103 0.321426002815122 … 0.2931311914702652 0.31861604776300984;;; 0.378517420899788 0.3636495426205756 … 0.33438053198661033 0.36645844064795957; 0.3636495426205756 0.3519170663492239 … 0.321426002815122 0.35191706634922404; … ; 0.33438053198661033 0.32142600281512207 … 0.2931311914702652 0.31861604776300995; 0.36645844064795946 0.35191706634922393 … 0.31861604776300995 0.35102886341775974]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923122154 -0.4966565572257062 … -0.4771919009648967 -0.4966565572257062; -0.4966565572257062 -0.4848182087107448 … -0.47638044576678396 -0.4920413111694297; … ; -0.47719190096489666 -0.4763804457667839 … -0.4122880708739264 -0.4550700815561307; -0.49665655722570623 -0.4920413111694297 … -0.4550700815561307 -0.4848182087107448;;; -0.4966565572257062 -0.4848182087107449 … -0.47638044576678396 -0.4920413111694297; -0.4848182087107448 -0.4583744079148685 … -0.4706560157057212 -0.4861790251756264; … ; -0.4763804457667839 -0.47065601570572113 … -0.4463984364362253 -0.4688943963915302; -0.4920413111694297 -0.4861790251756264 … -0.4688943963915303 -0.4861790251756263;;; -0.47719190096489666 -0.4550700815561307 … -0.46051412342267006 -0.47638044576678396; -0.4550700815561307 -0.40906618243913767 … -0.4567199083211418 -0.4688943963915303; … ; -0.46051412342267006 -0.45671990832114173 … -0.4451449566034964 -0.45671990832114173; -0.4763804457667839 -0.4688943963915303 … -0.45671990832114173 -0.47065601570572113;;; … ;;; -0.4494759508409223 -0.4551499722014971 … -0.37125986261792093 -0.41774571520277526; -0.4551499722014971 -0.44880351099771654 … -0.417438010713434 -0.44412609929878977; … ; -0.37125986261792093 -0.417438010713434 … -0.25365698328407915 -0.2997980910596125; -0.4177457152027752 -0.44412609929878977 … -0.2997980910596126 -0.36106343264803725;;; -0.47719190096489666 -0.47638044576678396 … -0.4122880708739264 -0.45507008155613077; -0.47638044576678396 -0.47065601570572113 … -0.4463984364362253 -0.4688943963915303; … ; -0.4122880708739264 -0.4463984364362253 … -0.25365698328407915 -0.3410633023008511; -0.4550700815561307 -0.4688943963915303 … -0.3410633023008511 -0.4090661824391377;;; -0.4966565572257062 -0.4920413111694297 … -0.45507008155613077 -0.4848182087107448; -0.4920413111694297 -0.4861790251756263 … -0.4688943963915303 -0.4861790251756264; … ; -0.45507008155613077 -0.4688943963915302 … -0.34106330230085113 -0.4090661824391377; -0.4848182087107449 -0.4861790251756264 … -0.4090661824391378 -0.4583744079148685])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.4129139212662895 -0.48683674427717005 … -0.7027113226190829 -0.48683674427717005; -0.48683674427716983 -0.7744303950404281 … -0.41363732843929474 -0.38233074979447035; … ; -0.702711322619083 -0.4136373284392949 … -2.396761682588036 -1.2958067581749457; -0.4868367442771698 -0.38233074979447024 … -1.295806758174946 -0.7744303950404279;;; -0.4868367442771699 -0.7744303950404281 … -0.4136373284392947 -0.38233074979447057; -0.7744303950404279 -1.4814477483918536 … -0.32458456943326164 -0.44991939657067376; … ; -0.4136373284392948 -0.3245845694332619 … -1.0113572986116859 -0.6373277791931689; -0.38233074979447024 -0.44991939657067376 … -0.6373277791931686 -0.44991939657067365;;; -0.7027113226190826 -1.2958067581749462 … -0.29820348937555685 -0.4136373284392949; -1.2958067581749462 -2.9196723936538693 … -0.3537295846614378 -0.6373277791931686; … ; -0.29820348937555685 -0.3537295846614383 … -0.4903726081071658 -0.35372958466143817; -0.41363732843929474 -0.6373277791931686 … -0.35372958466143745 -0.32458456943326164;;; … ;;; -1.0166744212557572 -0.5332878143065813 … -3.6361382571228456 -1.9987602620506035; -0.5332878143065811 -0.32174124747387467 … -1.466733940750244 -0.906193894146868; … ; -3.6361382571228456 -1.466733940750244 … -10.988177824465867 -8.08737616820815; -1.9987602620506033 -0.9061938941468681 … -8.08737616820815 -4.64787837114321;;; -0.7027113226190826 -0.4136373284392947 … -2.3967616825880365 -1.295806758174946; -0.4136373284392946 -0.32458456943326186 … -1.0113572986116857 -0.6373277791931686; … ; -2.3967616825880365 -1.0113572986116859 … -11.002806190874972 -6.077304186394048; -1.2958067581749457 -0.6373277791931686 … -6.077304186394048 -2.9196723936538693;;; -0.48683674427716994 -0.38233074979447057 … -1.295806758174946 -0.774430395040428; -0.38233074979447035 -0.4499193965706738 … -0.6373277791931686 -0.4499193965706737; … ; -1.295806758174946 -0.6373277791931686 … -6.077304186394047 -2.919672393653869; -0.7744303950404279 -0.44991939657067365 … -2.919672393653869 -1.4814477483918536]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3915556370334939 0.37851742089978796 … 0.3446996002702393 0.37851742089978807; 0.37851742089978796 0.36645844064795946 … 0.327357281722284 0.36364954262057564; … ; 0.3446996002702393 0.327357281722284 … 0.30751926941857555 0.33438053198661033; 0.37851742089978796 0.36364954262057564 … 0.33438053198661033 0.3664584406479594;;; 0.378517420899788 0.3664584406479595 … 0.32735728172228407 0.3636495426205757; 0.36645844064795946 0.3510288634177598 … 0.3111940134606099 0.351917066349224; … ; 0.327357281722284 0.3111940134606099 … 0.29824122841226897 0.32142600281512207; 0.3636495426205756 0.351917066349224 … 0.3214260028151221 0.3519170663492239;;; 0.3446996002702394 0.3343805319866103 … 0.28653515376395844 0.32735728172228407; 0.3343805319866102 0.3186160477630099 … 0.27805891882350714 0.3214260028151221; … ; 0.2865351537639584 0.27805891882350714 … 0.2559018577231421 0.27805891882350714; 0.32735728172228395 0.32142600281512207 … 0.2780589188235072 0.3111940134606098;;; … ;;; 0.30487474928907426 0.28303666896240415 … 0.2855643323175779 0.3009573705184457; 0.28303666896240415 0.2589843162227541 … 0.27263300128660156 0.2854141966266528; … ; 0.2855643323175779 0.27263300128660156 … 0.2771603891377398 0.28121087378383314; 0.30095737051844557 0.2854141966266527 … 0.28121087378383314 0.2930827262717318;;; 0.34469960027023944 0.32735728172228407 … 0.3075192694185755 0.3343805319866104; 0.327357281722284 0.3111940134606098 … 0.298241228412269 0.3214260028151221; … ; 0.3075192694185755 0.298241228412269 … 0.2771603891377398 0.2931311914702652; 0.3343805319866103 0.321426002815122 … 0.2931311914702652 0.31861604776300984;;; 0.378517420899788 0.3636495426205756 … 0.33438053198661033 0.36645844064795957; 0.3636495426205756 0.3519170663492239 … 0.321426002815122 0.35191706634922404; … ; 0.33438053198661033 0.32142600281512207 … 0.2931311914702652 0.31861604776300995; 0.36645844064795946 0.35191706634922393 … 0.31861604776300995 0.35102886341775974]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923122154 -0.4966565572257062 … -0.4771919009648967 -0.4966565572257062; -0.4966565572257062 -0.4848182087107448 … -0.47638044576678396 -0.4920413111694297; … ; -0.47719190096489666 -0.4763804457667839 … -0.4122880708739264 -0.4550700815561307; -0.49665655722570623 -0.4920413111694297 … -0.4550700815561307 -0.4848182087107448;;; -0.4966565572257062 -0.4848182087107449 … -0.47638044576678396 -0.4920413111694297; -0.4848182087107448 -0.4583744079148685 … -0.4706560157057212 -0.4861790251756264; … ; -0.4763804457667839 -0.47065601570572113 … -0.4463984364362253 -0.4688943963915302; -0.4920413111694297 -0.4861790251756264 … -0.4688943963915303 -0.4861790251756263;;; -0.47719190096489666 -0.4550700815561307 … -0.46051412342267006 -0.47638044576678396; -0.4550700815561307 -0.40906618243913767 … -0.4567199083211418 -0.4688943963915303; … ; -0.46051412342267006 -0.45671990832114173 … -0.4451449566034964 -0.45671990832114173; -0.4763804457667839 -0.4688943963915303 … -0.45671990832114173 -0.47065601570572113;;; … ;;; -0.4494759508409223 -0.4551499722014971 … -0.37125986261792093 -0.41774571520277526; -0.4551499722014971 -0.44880351099771654 … -0.417438010713434 -0.44412609929878977; … ; -0.37125986261792093 -0.417438010713434 … -0.25365698328407915 -0.2997980910596125; -0.4177457152027752 -0.44412609929878977 … -0.2997980910596126 -0.36106343264803725;;; -0.47719190096489666 -0.47638044576678396 … -0.4122880708739264 -0.45507008155613077; -0.47638044576678396 -0.47065601570572113 … -0.4463984364362253 -0.4688943963915303; … ; -0.4122880708739264 -0.4463984364362253 … -0.25365698328407915 -0.3410633023008511; -0.4550700815561307 -0.4688943963915303 … -0.3410633023008511 -0.4090661824391377;;; -0.4966565572257062 -0.4920413111694297 … -0.45507008155613077 -0.4848182087107448; -0.4920413111694297 -0.4861790251756263 … -0.4688943963915303 -0.4861790251756264; … ; -0.45507008155613077 -0.4688943963915302 … -0.34106330230085113 -0.4090661824391377; -0.4848182087107449 -0.4861790251756264 … -0.4090661824391378 -0.4583744079148685])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.4129139212662895 -0.48683674427717005 … -0.7027113226190829 -0.48683674427717005; -0.48683674427716983 -0.7744303950404281 … -0.41363732843929474 -0.38233074979447035; … ; -0.702711322619083 -0.4136373284392949 … -2.396761682588036 -1.2958067581749457; -0.4868367442771698 -0.38233074979447024 … -1.295806758174946 -0.7744303950404279;;; -0.4868367442771699 -0.7744303950404281 … -0.4136373284392947 -0.38233074979447057; -0.7744303950404279 -1.4814477483918536 … -0.32458456943326164 -0.44991939657067376; … ; -0.4136373284392948 -0.3245845694332619 … -1.0113572986116859 -0.6373277791931689; -0.38233074979447024 -0.44991939657067376 … -0.6373277791931686 -0.44991939657067365;;; -0.7027113226190826 -1.2958067581749462 … -0.29820348937555685 -0.4136373284392949; -1.2958067581749462 -2.9196723936538693 … -0.3537295846614378 -0.6373277791931686; … ; -0.29820348937555685 -0.3537295846614383 … -0.4903726081071658 -0.35372958466143817; -0.41363732843929474 -0.6373277791931686 … -0.35372958466143745 -0.32458456943326164;;; … ;;; -1.0166744212557572 -0.5332878143065813 … -3.6361382571228456 -1.9987602620506035; -0.5332878143065811 -0.32174124747387467 … -1.466733940750244 -0.906193894146868; … ; -3.6361382571228456 -1.466733940750244 … -10.988177824465867 -8.08737616820815; -1.9987602620506033 -0.9061938941468681 … -8.08737616820815 -4.64787837114321;;; -0.7027113226190826 -0.4136373284392947 … -2.3967616825880365 -1.295806758174946; -0.4136373284392946 -0.32458456943326186 … -1.0113572986116857 -0.6373277791931686; … ; -2.3967616825880365 -1.0113572986116859 … -11.002806190874972 -6.077304186394048; -1.2958067581749457 -0.6373277791931686 … -6.077304186394048 -2.9196723936538693;;; -0.48683674427716994 -0.38233074979447057 … -1.295806758174946 -0.774430395040428; -0.38233074979447035 -0.4499193965706738 … -0.6373277791931686 -0.4499193965706737; … ; -1.295806758174946 -0.6373277791931686 … -6.077304186394047 -2.919672393653869; -0.7744303950404279 -0.44991939657067365 … -2.919672393653869 -1.4814477483918536]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729845), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09132316917747446 0.08747419134080481 … 0.07684754935963473 0.08747419134080481; 0.08747419134080481 0.08089966872164299 … 0.07642471016971708 0.0848694483442676; … ; 0.07684754935963471 0.07642471016971707 … 0.04778466667102349 0.06587895342303807; 0.0874741913408048 0.0848694483442676 … 0.06587895342303807 0.08089966872164299;;; 0.08747419134080481 0.080899668721643 … 0.07642471016971708 0.0848694483442676; 0.08089966872164299 0.067444714697751 … 0.07348669934704405 0.08163768629014875; … ; 0.07642471016971707 0.07348669934704402 … 0.061888041199970184 0.07259829028447265; 0.08486944834426757 0.08163768629014875 … 0.07259829028447266 0.08163768629014874;;; 0.07684754935963471 0.06587895342303807 … 0.06847203698973778 0.07642471016971708; 0.06587895342303807 0.046578642649812235 … 0.0666575937163204 0.07259829028447266; … ; 0.06847203698973778 0.06665759371632038 … 0.061325153143812386 0.06665759371632038; 0.07642471016971707 0.07259829028447266 … 0.06665759371632038 0.07348669934704402;;; … ;;; 0.06328495229886393 0.06591651445952988 … 0.033940648880521965 0.0498759348599943; 0.06591651445952988 0.06297790960105648 … 0.049756397885282085 0.06087020457146799; … ; 0.03394064888052196 0.049756397885282085 … 0.009696353214073326 0.016831338792592226; 0.04987593485999429 0.06087020457146799 … 0.016831338792592236 0.030985721885052633;;; 0.07684754935963471 0.07642471016971708 … 0.04778466667102348 0.06587895342303808; 0.07642471016971708 0.07348669934704403 … 0.061888041199970184 0.07259829028447266; … ; 0.04778466667102348 0.061888041199970156 … 0.009696353214073323 0.025710010675306743; 0.06587895342303805 0.07259829028447266 … 0.025710010675306746 0.04657864264981224;;; 0.08747419134080481 0.08486944834426759 … 0.06587895342303808 0.08089966872164299; 0.08486944834426759 0.08163768629014874 … 0.07259829028447266 0.08163768629014875; … ; 0.06587895342303808 0.07259829028447265 … 0.025710010675306757 0.04657864264981224; 0.08089966872164298 0.08163768629014875 … 0.046578642649812256 0.067444714697751;;;;], α = 0.8, eigenvalues = [[-0.16677707596311098, 0.2642777178298678, 0.2642777178298677, 0.2642777178298682, 0.35732037190448124, 0.35732037190448146, 0.3573203719044812], [-0.11613218761087452, 0.07040532320000203, 0.22624813603017924, 0.22624813603017957, 0.33611784894599006, 0.39343797761796895, 0.3934379776179687], [-0.0958893814364425, 0.08764319967953606, 0.17312704142738045, 0.17312704142738045, 0.2919724892212867, 0.33773212507288397, 0.5327646516179148], [-0.045051463485988326, 0.022269526239768928, 0.0983118925153119, 0.18446409322112806, 0.32292701516245537, 0.4802469607237757, 0.5024422335026896]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2897120818381719, n_iter = 22, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[-0.4575416527664438 + 0.8388338939112595im -3.0218768672598477e-15 + 1.0396864622995997e-15im … 5.799330344421183e-12 - 1.2660987294412818e-11im 3.300183542335539e-11 - 5.2797765694548144e-11im; -0.0461083938851711 + 0.08453281433687163im 0.222149356607583 + 0.05763451484318869im … 0.12680601760162286 + 0.04371350050977735im 0.37371334766227543 + 0.1799297332872384im; … ; -0.005647667796114499 + 0.010354150579050581im -0.010664329793992098 - 0.02071663336078669im … -0.004667858977858304 - 0.007797576636640323im 0.05018475180414205 - 0.007531026363554414im; 0.04610839388517086 - 0.08453281433687113im 0.11774320376650718 - 0.14518591839557934im … -0.1652659465370711 - 0.10796013803146383im 0.03977429319491756 - 0.24198018047187667im], [0.8587022323386387 + 0.3538160890670245im -0.17990065977376407 - 0.08058487518631562im … -1.331915075979448e-13 + 3.0295422404947305e-14im -1.194852841173623e-13 + 1.8753387522946223e-14im; 0.05853938613680514 + 0.024120324693811503im 0.008006871235710243 + 0.003586605629873835im … 6.277892333488055e-12 - 5.598096449932721e-13im 4.200284614511324e-12 + 1.9777300924881228e-12im; … ; 0.007166279371779373 + 0.0029527638860091716im -0.07872164376321862 - 0.035262649092550315im … 0.0652484807038405 - 0.08121883885753024im 0.00504905240729647 - 0.03459561072948972im; -0.10441584593181062 - 0.04302306999203066im 0.0827818369139326 + 0.03708137593154032im … 0.2769510257280226 - 0.34473815310478656im 0.021431000809520824 - 0.1468431107414394im], [-0.27115713794789403 + 0.8935124843793161im -1.980026047912034e-16 + 4.735332813789316e-16im … -1.5502269576522365e-15 - 4.777127402066599e-15im -5.047653598626667e-12 + 6.477783936215638e-12im; -0.01996428483644275 + 0.06578597885368691im 0.055367350108629865 - 0.014324370570038237im … 0.0165736281971473 - 0.01895889453254867im -0.008182466170954061 + 0.009145418363395722im; … ; -0.004027868921716998 + 0.013272566579784663im -2.0265013316354655e-15 + 9.620730948380324e-16im … 3.0889490084815837e-14 + 1.5326610202701736e-14im -0.06620793393814928 - 0.003453313551299105im; 0.0444911488558096 - 0.14660649263337308im 0.2779749681782873 - 0.07191632696108126im … -0.2513144185756861 + 0.2874834345087013im -0.15263672053543553 - 0.011173121480333293im], [-0.7107318291732527 + 0.386473472910619im 1.4274628657907057e-15 - 9.389837015809185e-16im … -0.18640321269607696 + 0.019688202294096183im 3.524232947633961e-6 - 8.49654055191665e-7im; -0.3404025250869501 + 0.18510011886048383im -0.33987261892234427 + 0.5264004649532684im … 0.17723895227195202 - 0.01872100525723018im -2.392748940759126e-6 + 3.708691666869085e-7im; … ; -0.01000955361574623 + 0.005442878437936696im -0.000891542535038817 + 0.001380836168734622im … -0.016083954021693502 + 0.0016991283715507405im -0.037356464613755316 - 0.023789344789195102im; 0.057261547637671675 - 0.031137017186230045im -0.006772170214007443 + 0.010488851854858379im … -0.1346204266732756 + 0.014219015465412257im -0.3969761669257651 - 0.2528132483350913im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596311098, 0.2642777178298678, 0.2642777178298677, 0.2642777178298682, 0.35732037190448124, 0.35732037190448146, 0.3573203719044812], [-0.11613218761087452, 0.07040532320000203, 0.22624813603017924, 0.22624813603017957, 0.33611784894599006, 0.39343797761796895, 0.3934379776179687], [-0.0958893814364425, 0.08764319967953606, 0.17312704142738045, 0.17312704142738045, 0.2919724892212867, 0.33773212507288397, 0.5327646516179148], [-0.045051463485988326, 0.022269526239768928, 0.0983118925153119, 0.18446409322112806, 0.32292701516245537, 0.4802469607237757, 0.5024422335026896]], X = [[-0.4575416527664438 + 0.8388338939112595im -3.0218768672598477e-15 + 1.0396864622995997e-15im … 5.799330344421183e-12 - 1.2660987294412818e-11im 3.300183542335539e-11 - 5.2797765694548144e-11im; -0.0461083938851711 + 0.08453281433687163im 0.222149356607583 + 0.05763451484318869im … 0.12680601760162286 + 0.04371350050977735im 0.37371334766227543 + 0.1799297332872384im; … ; -0.005647667796114499 + 0.010354150579050581im -0.010664329793992098 - 0.02071663336078669im … -0.004667858977858304 - 0.007797576636640323im 0.05018475180414205 - 0.007531026363554414im; 0.04610839388517086 - 0.08453281433687113im 0.11774320376650718 - 0.14518591839557934im … -0.1652659465370711 - 0.10796013803146383im 0.03977429319491756 - 0.24198018047187667im], [0.8587022323386387 + 0.3538160890670245im -0.17990065977376407 - 0.08058487518631562im … -1.331915075979448e-13 + 3.0295422404947305e-14im -1.194852841173623e-13 + 1.8753387522946223e-14im; 0.05853938613680514 + 0.024120324693811503im 0.008006871235710243 + 0.003586605629873835im … 6.277892333488055e-12 - 5.598096449932721e-13im 4.200284614511324e-12 + 1.9777300924881228e-12im; … ; 0.007166279371779373 + 0.0029527638860091716im -0.07872164376321862 - 0.035262649092550315im … 0.0652484807038405 - 0.08121883885753024im 0.00504905240729647 - 0.03459561072948972im; -0.10441584593181062 - 0.04302306999203066im 0.0827818369139326 + 0.03708137593154032im … 0.2769510257280226 - 0.34473815310478656im 0.021431000809520824 - 0.1468431107414394im], [-0.27115713794789403 + 0.8935124843793161im -1.980026047912034e-16 + 4.735332813789316e-16im … -1.5502269576522365e-15 - 4.777127402066599e-15im -5.047653598626667e-12 + 6.477783936215638e-12im; -0.01996428483644275 + 0.06578597885368691im 0.055367350108629865 - 0.014324370570038237im … 0.0165736281971473 - 0.01895889453254867im -0.008182466170954061 + 0.009145418363395722im; … ; -0.004027868921716998 + 0.013272566579784663im -2.0265013316354655e-15 + 9.620730948380324e-16im … 3.0889490084815837e-14 + 1.5326610202701736e-14im -0.06620793393814928 - 0.003453313551299105im; 0.0444911488558096 - 0.14660649263337308im 0.2779749681782873 - 0.07191632696108126im … -0.2513144185756861 + 0.2874834345087013im -0.15263672053543553 - 0.011173121480333293im], [-0.7107318291732527 + 0.386473472910619im 1.4274628657907057e-15 - 9.389837015809185e-16im … -0.18640321269607696 + 0.019688202294096183im 3.524232947633961e-6 - 8.49654055191665e-7im; -0.3404025250869501 + 0.18510011886048383im -0.33987261892234427 + 0.5264004649532684im … 0.17723895227195202 - 0.01872100525723018im -2.392748940759126e-6 + 3.708691666869085e-7im; … ; -0.01000955361574623 + 0.005442878437936696im -0.000891542535038817 + 0.001380836168734622im … -0.016083954021693502 + 0.0016991283715507405im -0.037356464613755316 - 0.023789344789195102im; 0.057261547637671675 - 0.031137017186230045im -0.006772170214007443 + 0.010488851854858379im … -0.1346204266732756 + 0.014219015465412257im -0.3969761669257651 - 0.2528132483350913im]], residual_norms = [[4.957665175637668e-14, 1.1352248282336424e-13, 1.0812576642226655e-13, 1.0846233617124076e-13, 2.6389126590717168e-11, 2.443627951846319e-10, 1.0925494216334218e-9], [4.2707303873839496e-14, 9.131071333738055e-14, 7.84328527181709e-14, 7.602401203020962e-14, 1.6414683656247716e-12, 8.292669224602034e-12, 7.412765535539243e-12], [3.85879877454854e-14, 6.148639481686137e-14, 8.163409186282698e-14, 9.460415045905326e-14, 6.853829185773171e-14, 2.134333706051606e-13, 5.970151176825277e-10], [4.6950627324578516e-14, 8.137969669115986e-14, 8.931157119013084e-14, 1.6386130191815537e-13, 5.923376654330181e-13, 1.1147691135656067e-5, 1.5542788931043615e-6]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 1.245267852893923e-13)</code></pre><h2 id="Potential-based-SCF"><a class="docs-heading-anchor" href="#Potential-based-SCF">Potential-based SCF</a><a id="Potential-based-SCF-1"></a><a class="docs-heading-anchor-permalink" href="#Potential-based-SCF" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_scfv = DFTK.scf_potential_mixing(basis; is_converged)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392126631654 -0.4868367442771962 … -0.7027113226191073 -0.48683674427719636; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449516; … ; -0.7027113226191074 -0.41363732843931705 … -2.3967616825880627 -1.2958067581749715; -0.486836744277196 -0.38233074979449505 … -1.295806758174972 -0.7744303950404543;;; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449533; -0.7744303950404543 -1.4814477483918813 … -0.3245845694332824 -0.44991939657069785; … ; -0.4136373284393169 -0.32458456943328273 … -1.0113572986117076 -0.6373277791931914; -0.382330749794495 -0.44991939657069785 … -0.6373277791931913 -0.44991939657069774;;; -0.7027113226191071 -1.2958067581749722 … -0.29820348937557584 -0.41363732843931694; -1.295806758174972 -2.9196723936538986 … -0.3537295846614562 -0.6373277791931913; … ; -0.29820348937557584 -0.35372958466145676 … -0.490372608107183 -0.3537295846614566; -0.4136373284393168 -0.6373277791931912 … -0.353729584661456 -0.3245845694332823;;; … ;;; -1.0166744212557797 -0.5332878143066007 … -3.6361382571228726 -1.9987602620506286; -0.5332878143066004 -0.32174124747389177 … -1.4667339407502653 -0.9061938941468888; … ; -3.636138257122873 -1.4667339407502653 … -10.988177824465911 -8.087376168208188; -1.9987602620506286 -0.9061938941468888 … -8.087376168208186 -4.64787837114324;;; -0.7027113226191071 -0.4136373284393167 … -2.396761682588063 -1.295806758174972; -0.41363732843931666 -0.32458456943328257 … -1.0113572986117079 -0.6373277791931912; … ; -2.396761682588063 -1.011357298611708 … -11.002806190875017 -6.07730418639408; -1.295806758174972 -0.6373277791931911 … -6.07730418639408 -2.9196723936538986;;; -0.48683674427719614 -0.3823307497944952 … -1.295806758174972 -0.7744303950404545; -0.3823307497944951 -0.44991939657069796 … -0.6373277791931913 -0.44991939657069785; … ; -1.295806758174972 -0.6373277791931913 … -6.0773041863940795 -2.9196723936538977; -0.7744303950404542 -0.4499193965706976 … -2.919672393653898 -1.4814477483918813])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392126631654 -0.4868367442771962 … -0.7027113226191073 -0.48683674427719636; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449516; … ; -0.7027113226191074 -0.41363732843931705 … -2.3967616825880627 -1.2958067581749715; -0.486836744277196 -0.38233074979449505 … -1.295806758174972 -0.7744303950404543;;; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449533; -0.7744303950404543 -1.4814477483918813 … -0.3245845694332824 -0.44991939657069785; … ; -0.4136373284393169 -0.32458456943328273 … -1.0113572986117076 -0.6373277791931914; -0.382330749794495 -0.44991939657069785 … -0.6373277791931913 -0.44991939657069774;;; -0.7027113226191071 -1.2958067581749722 … -0.29820348937557584 -0.41363732843931694; -1.295806758174972 -2.9196723936538986 … -0.3537295846614562 -0.6373277791931913; … ; -0.29820348937557584 -0.35372958466145676 … -0.490372608107183 -0.3537295846614566; -0.4136373284393168 -0.6373277791931912 … -0.353729584661456 -0.3245845694332823;;; … ;;; -1.0166744212557797 -0.5332878143066007 … -3.6361382571228726 -1.9987602620506286; -0.5332878143066004 -0.32174124747389177 … -1.4667339407502653 -0.9061938941468888; … ; -3.636138257122873 -1.4667339407502653 … -10.988177824465911 -8.087376168208188; -1.9987602620506286 -0.9061938941468888 … -8.087376168208186 -4.64787837114324;;; -0.7027113226191071 -0.4136373284393167 … -2.396761682588063 -1.295806758174972; -0.41363732843931666 -0.32458456943328257 … -1.0113572986117079 -0.6373277791931912; … ; -2.396761682588063 -1.011357298611708 … -11.002806190875017 -6.07730418639408; -1.295806758174972 -0.6373277791931911 … -6.07730418639408 -2.9196723936538986;;; -0.48683674427719614 -0.3823307497944952 … -1.295806758174972 -0.7744303950404545; -0.3823307497944951 -0.44991939657069796 … -0.6373277791931913 -0.44991939657069785; … ; -1.295806758174972 -0.6373277791931913 … -6.0773041863940795 -2.9196723936538977; -0.7744303950404542 -0.4499193965706976 … -2.919672393653898 -1.4814477483918813]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.048650827246640854 + 0.08621667956058089im -0.16536396380956536 + 0.050660028114590853im … 0.17711599778247572 + 0.03674830715293555im 0.11289862594394627 + 0.049214745736393506im; -0.1263404964397331 + 0.0671940781188333im -0.12602665345864517 + 0.038925838660574114im … 0.07680013079024875 - 0.028199625403906865im -0.03528761969457961 - 0.020736947550808453im; … ; 0.14345071262748102 - 0.017981073678015734im 0.04247997836154632 - 0.028547365710493166im … -0.0002840589728246379 - 0.045243761711900504im 0.12163390035438038 - 0.02312241448837917im; 0.09913203737204898 + 0.01540776401313097im -0.04294688086035028 + 0.00044485466715902047im … 0.12754003853272647 - 0.023349259215735295im 0.2049736662155851 - 0.005376537056259137im;;; -0.1125448205454062 + 0.04032497364148883im -0.1759997508856644 + 0.03176466983758861im … 0.12363372963348213 + 0.02122549186208275im 0.046841559717907676 + 0.04052647938756814im; -0.12249021164205234 + 0.016895673413724516im -0.034404835004276095 - 0.008125300811591837im … 0.02529094389119931 - 0.020038863972642693im -0.051704246999781614 - 0.026246574874364232im; … ; 0.048468983549534196 + 0.019320676335546988im -0.033580889265237036 - 0.02236898255146305im … 0.043693248935587625 - 0.004737771607429956im 0.11374733237940565 + 0.012426940687804758im; -0.03200501710173044 + 0.019710276554273654im -0.1486476077402012 - 0.0025609080079105227im … 0.12342388336018405 + 0.020571367888270083im 0.12223748344720835 + 0.04079583114486522im;;; -0.12249633712191887 + 0.013566881556315809im -0.062248080179075904 + 0.03704029291108207im … 0.03739730537193049 + 0.01161103198533941im -0.017877740976375497 + 0.018805768314324248im; -0.08020710089416591 - 0.023612790752258785im 0.038033472273119415 - 0.018771946722532178im … -0.024619113953403843 - 0.013507007078636163im -0.08768008189994259 - 0.02081473285898363im; … ; -0.01777386258725575 - 0.004213472429882011im -0.06272013389823938 - 0.004824123857739652im … 0.03860097018700283 + 0.006953426058275123im 0.03595998351526487 + 0.012426139990492071im; -0.07886553896582456 + 0.008613955986492228im -0.11249050359703411 + 0.004043575974674822im … 0.05355241991472597 + 0.011809034300998465im 0.02283311648385416 + 0.011548940693108077im;;; … ;;; 0.07649580025736508 - 0.05079977963106719im 0.028964473579577692 - 0.023183731645962935im … 0.013300986456822653 + 0.015765999266926824im 0.08996858210363742 - 0.031626267719941675im; 0.02457247279495651 - 0.009605073866972035im -0.010694289452481954 + 0.011916997670049079im … 0.04332872585094262 + 0.011003012208141674im 0.06802534027082108 - 0.010938084882679425im; … ; -0.023687164881150816 + 0.00958426057639891im 0.016550801515258944 - 0.015836210551674015im … -0.14437477776940633 + 0.04396848128841116im -0.09604429395561025 + 0.035475652976954056im; 0.047397441167216475 - 0.033711917381580365im 0.037759590985276564 - 0.038430089280620666im … -0.09687603497588398 + 0.0179442669789105im 0.005403605211830613 - 0.0059552535637297874im;;; 0.0922590897758325 - 0.04134269853415706im 0.004570214932595726 - 0.005947647514242772im … 0.07032322806367944 + 0.03520598400807019im 0.15592949816704066 - 0.056555907225778954im; -0.04259413052877138 + 0.033560636123136214im -0.06611113286457942 + 0.06767343011269691im … 0.06457161627025136 + 0.028141583449158184im 0.041478334783160986 - 0.006181655657786101im; … ; 0.04542249019899256 - 0.0427410437252166im 0.05923005286291358 - 0.05141240481481306im … -0.17255241875732286 + 0.025009986111222286im -0.05438806980897233 - 0.012020501765995822im; 0.13024618058610987 - 0.07885973980177012im 0.07203790478584476 - 0.04430104580604175im … -0.056149603703737005 - 0.012351223301186872im 0.09043850972668938 - 0.07314949120263944im;;; 0.02117265031552351 + 0.039077323557187245im -0.057268952716690094 + 0.05934264391872933im … 0.1282641664073809 + 0.04424937234074457im 0.14815897286800153 - 0.010412063380149543im; -0.13195289125742665 + 0.11106801685875446im -0.1299590769515891 + 0.10568134920795685im … 0.06360515975789119 + 0.01916679804206233im -0.021786584112853023 + 0.007133259906863455im; … ; 0.12021573512028763 - 0.043069150776560164im 0.09205223649487558 - 0.06028834157820844im … -0.11895254467846031 - 0.03975184882113193im 0.04795791867397467 - 0.06596719490776785im; 0.16180757489482805 - 0.04185832174372424im 0.04576021765016497 - 0.03288954156913862im … 0.028519953623262498 - 0.024111478736857043im 0.18367828330279454 - 0.05500144131940881im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392126631654 -0.4868367442771962 … -0.7027113226191073 -0.48683674427719636; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449516; … ; -0.7027113226191074 -0.41363732843931705 … -2.3967616825880627 -1.2958067581749715; -0.486836744277196 -0.38233074979449505 … -1.295806758174972 -0.7744303950404543;;; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449533; -0.7744303950404543 -1.4814477483918813 … -0.3245845694332824 -0.44991939657069785; … ; -0.4136373284393169 -0.32458456943328273 … -1.0113572986117076 -0.6373277791931914; -0.382330749794495 -0.44991939657069785 … -0.6373277791931913 -0.44991939657069774;;; -0.7027113226191071 -1.2958067581749722 … -0.29820348937557584 -0.41363732843931694; -1.295806758174972 -2.9196723936538986 … -0.3537295846614562 -0.6373277791931913; … ; -0.29820348937557584 -0.35372958466145676 … -0.490372608107183 -0.3537295846614566; -0.4136373284393168 -0.6373277791931912 … -0.353729584661456 -0.3245845694332823;;; … ;;; -1.0166744212557797 -0.5332878143066007 … -3.6361382571228726 -1.9987602620506286; -0.5332878143066004 -0.32174124747389177 … -1.4667339407502653 -0.9061938941468888; … ; -3.636138257122873 -1.4667339407502653 … -10.988177824465911 -8.087376168208188; -1.9987602620506286 -0.9061938941468888 … -8.087376168208186 -4.64787837114324;;; -0.7027113226191071 -0.4136373284393167 … -2.396761682588063 -1.295806758174972; -0.41363732843931666 -0.32458456943328257 … -1.0113572986117079 -0.6373277791931912; … ; -2.396761682588063 -1.011357298611708 … -11.002806190875017 -6.07730418639408; -1.295806758174972 -0.6373277791931911 … -6.07730418639408 -2.9196723936538986;;; -0.48683674427719614 -0.3823307497944952 … -1.295806758174972 -0.7744303950404545; -0.3823307497944951 -0.44991939657069796 … -0.6373277791931913 -0.44991939657069785; … ; -1.295806758174972 -0.6373277791931913 … -6.0773041863940795 -2.9196723936538977; -0.7744303950404542 -0.4499193965706976 … -2.919672393653898 -1.4814477483918813])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392126631654 -0.4868367442771962 … -0.7027113226191073 -0.48683674427719636; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449516; … ; -0.7027113226191074 -0.41363732843931705 … -2.3967616825880627 -1.2958067581749715; -0.486836744277196 -0.38233074979449505 … -1.295806758174972 -0.7744303950404543;;; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449533; -0.7744303950404543 -1.4814477483918813 … -0.3245845694332824 -0.44991939657069785; … ; -0.4136373284393169 -0.32458456943328273 … -1.0113572986117076 -0.6373277791931914; -0.382330749794495 -0.44991939657069785 … -0.6373277791931913 -0.44991939657069774;;; -0.7027113226191071 -1.2958067581749722 … -0.29820348937557584 -0.41363732843931694; -1.295806758174972 -2.9196723936538986 … -0.3537295846614562 -0.6373277791931913; … ; -0.29820348937557584 -0.35372958466145676 … -0.490372608107183 -0.3537295846614566; -0.4136373284393168 -0.6373277791931912 … -0.353729584661456 -0.3245845694332823;;; … ;;; -1.0166744212557797 -0.5332878143066007 … -3.6361382571228726 -1.9987602620506286; -0.5332878143066004 -0.32174124747389177 … -1.4667339407502653 -0.9061938941468888; … ; -3.636138257122873 -1.4667339407502653 … -10.988177824465911 -8.087376168208188; -1.9987602620506286 -0.9061938941468888 … -8.087376168208186 -4.64787837114324;;; -0.7027113226191071 -0.4136373284393167 … -2.396761682588063 -1.295806758174972; -0.41363732843931666 -0.32458456943328257 … -1.0113572986117079 -0.6373277791931912; … ; -2.396761682588063 -1.011357298611708 … -11.002806190875017 -6.07730418639408; -1.295806758174972 -0.6373277791931911 … -6.07730418639408 -2.9196723936538986;;; -0.48683674427719614 -0.3823307497944952 … -1.295806758174972 -0.7744303950404545; -0.3823307497944951 -0.44991939657069796 … -0.6373277791931913 -0.44991939657069785; … ; -1.295806758174972 -0.6373277791931913 … -6.0773041863940795 -2.9196723936538977; -0.7744303950404542 -0.4499193965706976 … -2.919672393653898 -1.4814477483918813]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0014589422227822202 - 0.019873743783590008im 0.0231702427091351 + 0.02074450733930302im … -0.13848222003952954 - 0.05543003532454173im -0.11736782709575386 - 0.056339841838991225im; -0.0012232605737761736 - 0.005153537721005825im -0.042103386815468935 + 0.001613078896082918im … -0.09899500950136372 - 0.03901943038692777im -0.05664719062848173 - 0.02921961263435121im; … ; 0.00732455591395575 - 0.027445171892554097im 0.006497141815616593 - 0.0025543644443347317im … 0.10257856058236758 + 0.022711002362776365im 0.058598695851725835 - 0.02007989120338232im; -0.007981460240286346 - 0.020623190194741098im 0.044471381396770135 + 0.02573580127760678im … -0.007075388989899083 - 0.005239081396337293im -0.09058654821102424 - 0.053775931799352306im;;; -0.015988045714822343 - 0.004435394006087414im -0.04621460284924434 + 0.009936362428071464im … -0.08526962667742094 - 0.04616523718738765im -0.03980085404669764 - 0.04834440344749903im; 0.03309954885271926 + 0.017767303546336367im -0.020467063630589442 + 0.022078838491885334im … -0.02460333212205849 - 0.02020300969586499im 0.00528465731850509 - 0.014646428526333324im; … ; 0.015751074527516395 - 0.0019221752874455976im 0.006624112835782741 + 0.013878207618779368im … 0.012651677879273638 + 0.0008149335957420662im -0.014618879073311589 - 0.02284834350315467im; -0.018390354302542065 - 0.010266185233494202im -0.012332343528320388 + 0.021367317409365875im … -0.0889147112483716 - 0.0416379273998214im -0.059589506000424695 - 0.05070457016774389im;;; 0.01268860679735593 + 0.0169140807735332im -0.04696723357009307 + 0.01283559006972108im … -0.016920832705104 - 0.022806060588650198im 0.015549199137709743 - 0.016601066280765818im; 0.04934732895138347 + 0.04458747135538425im 0.014498723494884446 + 0.03101983812646695im … 0.013884765011071052 - 0.005546914679601896im 0.06162686970859145 + 0.01876330561792902im; … ; -0.015828363323764517 - 0.005826781637877198im -0.01947097973651585 + 0.0020766151980162063im … -0.0134270291045361 - 0.008656160223851244im -0.010617350596813912 - 0.01182551070816386im; -0.013307292584473298 - 0.004641427442708025im -0.06226393976130293 - 0.0031909720399626185im … -0.02916214398202241 - 0.02099736135977859im -0.030696720838990277 - 0.03168301889464383im;;; … ;;; 0.02938709342879766 + 0.00394041157659831im 0.037426420195364976 + 0.005154166693533682im … -0.007321852195126507 - 0.0055555267460967415im 0.003484139094036432 - 0.00431224711655674im; 0.041962925060481125 + 0.008490252589476272im 0.038939605728085136 + 0.008535365821423715im … 0.012606288805396718 - 0.00015060932420681166im 0.030947393063472904 + 0.005228402750529943im; … ; -0.06089115876264047 - 0.012359970661792653im -0.04131489163578731 - 0.01073498036294177im … -0.03816252575797116 + 0.005056333615438069im -0.06709152991737005 - 0.015082309060992435im; -0.04263643180091445 - 0.010251335890594463im -0.011732698236741083 - 0.00956258389972609im … -0.05247206500675846 - 0.008981489394754936im -0.07214217488467144 - 0.020038065195190094im;;; 0.12112238624394522 + 0.025959907774598223im 0.1153080654981131 + 0.020177618118848606im … 0.05623560686496133 + 0.00760185593215968im 0.03930232744253537 + 0.006746442463191464im; 0.09245555058339777 + 0.024238453940942574im 0.0625705023368523 + 0.01474794667932072im … 0.02302695925967451 + 0.0013671074776972064im 0.05499461690873441 + 0.013599624739659234im; … ; -0.06618094370517294 - 0.03717284826274714im -0.04572787287158733 - 0.026638920996477574im … 0.03297585096351828 + 0.009032711920968915im -0.0004218153604804601 - 0.018516274857502894im; -0.014260150091321457 - 0.02131926653122193im 0.06268982725778444 + 0.005776840979851629im … 0.07211539729670126 + 0.01120801827894467im -0.003976505622419767 - 0.010462195763057392im;;; 0.10081604985505262 + 0.01578064090110065im 0.1301922374156272 + 0.02420307276435im … 0.0021814613226400804 + 0.002559535317789783im -0.012336635007959725 - 0.007737492282579037im; 0.04771503605301354 + 0.011338230331186944im 0.04734454621440784 + 0.01962489225916752im … -0.05425136991667466 - 0.01620577522816025im -0.029928099600560955 - 0.002753239690632009im; … ; -0.0017154831886004242 - 0.04852865187939548im 0.010895269810589199 - 0.016365378695754322im … 0.1620430391477228 + 0.03489741964580875im 0.08511476441925542 - 0.017827951796218183im; 0.06181946962669757 + 0.0007491245561231748im 0.10467607226251804 + 0.014156329243244144im … 0.10857550890330236 + 0.0342809028339634im 0.03849806535518066 - 0.011687602918178342im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392126631654 -0.4868367442771962 … -0.7027113226191073 -0.48683674427719636; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449516; … ; -0.7027113226191074 -0.41363732843931705 … -2.3967616825880627 -1.2958067581749715; -0.486836744277196 -0.38233074979449505 … -1.295806758174972 -0.7744303950404543;;; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449533; -0.7744303950404543 -1.4814477483918813 … -0.3245845694332824 -0.44991939657069785; … ; -0.4136373284393169 -0.32458456943328273 … -1.0113572986117076 -0.6373277791931914; -0.382330749794495 -0.44991939657069785 … -0.6373277791931913 -0.44991939657069774;;; -0.7027113226191071 -1.2958067581749722 … -0.29820348937557584 -0.41363732843931694; -1.295806758174972 -2.9196723936538986 … -0.3537295846614562 -0.6373277791931913; … ; -0.29820348937557584 -0.35372958466145676 … -0.490372608107183 -0.3537295846614566; -0.4136373284393168 -0.6373277791931912 … -0.353729584661456 -0.3245845694332823;;; … ;;; -1.0166744212557797 -0.5332878143066007 … -3.6361382571228726 -1.9987602620506286; -0.5332878143066004 -0.32174124747389177 … -1.4667339407502653 -0.9061938941468888; … ; -3.636138257122873 -1.4667339407502653 … -10.988177824465911 -8.087376168208188; -1.9987602620506286 -0.9061938941468888 … -8.087376168208186 -4.64787837114324;;; -0.7027113226191071 -0.4136373284393167 … -2.396761682588063 -1.295806758174972; -0.41363732843931666 -0.32458456943328257 … -1.0113572986117079 -0.6373277791931912; … ; -2.396761682588063 -1.011357298611708 … -11.002806190875017 -6.07730418639408; -1.295806758174972 -0.6373277791931911 … -6.07730418639408 -2.9196723936538986;;; -0.48683674427719614 -0.3823307497944952 … -1.295806758174972 -0.7744303950404545; -0.3823307497944951 -0.44991939657069796 … -0.6373277791931913 -0.44991939657069785; … ; -1.295806758174972 -0.6373277791931913 … -6.0773041863940795 -2.9196723936538977; -0.7744303950404542 -0.4499193965706976 … -2.919672393653898 -1.4814477483918813])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392126631654 -0.4868367442771962 … -0.7027113226191073 -0.48683674427719636; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449516; … ; -0.7027113226191074 -0.41363732843931705 … -2.3967616825880627 -1.2958067581749715; -0.486836744277196 -0.38233074979449505 … -1.295806758174972 -0.7744303950404543;;; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449533; -0.7744303950404543 -1.4814477483918813 … -0.3245845694332824 -0.44991939657069785; … ; -0.4136373284393169 -0.32458456943328273 … -1.0113572986117076 -0.6373277791931914; -0.382330749794495 -0.44991939657069785 … -0.6373277791931913 -0.44991939657069774;;; -0.7027113226191071 -1.2958067581749722 … -0.29820348937557584 -0.41363732843931694; -1.295806758174972 -2.9196723936538986 … -0.3537295846614562 -0.6373277791931913; … ; -0.29820348937557584 -0.35372958466145676 … -0.490372608107183 -0.3537295846614566; -0.4136373284393168 -0.6373277791931912 … -0.353729584661456 -0.3245845694332823;;; … ;;; -1.0166744212557797 -0.5332878143066007 … -3.6361382571228726 -1.9987602620506286; -0.5332878143066004 -0.32174124747389177 … -1.4667339407502653 -0.9061938941468888; … ; -3.636138257122873 -1.4667339407502653 … -10.988177824465911 -8.087376168208188; -1.9987602620506286 -0.9061938941468888 … -8.087376168208186 -4.64787837114324;;; -0.7027113226191071 -0.4136373284393167 … -2.396761682588063 -1.295806758174972; -0.41363732843931666 -0.32458456943328257 … -1.0113572986117079 -0.6373277791931912; … ; -2.396761682588063 -1.011357298611708 … -11.002806190875017 -6.07730418639408; -1.295806758174972 -0.6373277791931911 … -6.07730418639408 -2.9196723936538986;;; -0.48683674427719614 -0.3823307497944952 … -1.295806758174972 -0.7744303950404545; -0.3823307497944951 -0.44991939657069796 … -0.6373277791931913 -0.44991939657069785; … ; -1.295806758174972 -0.6373277791931913 … -6.0773041863940795 -2.9196723936538977; -0.7744303950404542 -0.4499193965706976 … -2.919672393653898 -1.4814477483918813]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.06106882368298841 - 0.0015895346241427272im 0.014306244882649127 - 0.004672618574003748im … 0.0037524916398881288 + 0.0010803357361952124im -0.02812355941097219 + 0.002117170297342813im; -0.011621454270845696 - 0.0061200733837592555im 0.043243390303999464 - 0.006167639210389058im … 0.0012666484545615468 - 0.00185384044922945im -0.017803368414404375 - 0.00456055211534922im; … ; -0.009609609027629768 + 0.0005422778509965116im -0.03562830982807394 - 0.00023078834058032262im … 0.06144956440683647 - 0.0034091721285606164im 0.03945652421868038 - 0.0016824425741213981im; -0.048239354619494974 + 0.003648365025176033im -0.035339143293215164 - 0.001846741508961895im … 0.027866700325141415 + 0.00126288765011826im -0.026060631429181455 + 0.00326884592413858im;;; 0.018878741499102875 - 0.008804309356941473im 0.0039355303893751845 + 0.004279795878524647im … -0.023526153728862832 + 0.0006828486736019713im -0.025030997124854827 - 0.00545035257228175im; 0.04148045126301284 - 0.014152988509591357im 0.03312656872338901 + 0.0007886182988067715im … 0.010653861665978245 - 0.009279795991925075im 0.06760412898025615 - 0.025216149920311744im; … ; -0.01689696049513726 + 0.00030256973396948863im -0.001993800970179059 - 0.0029053075958640493im … 0.017155633738318184 - 0.0005225490027387171im -0.009149665183102472 + 0.00244077791312264im; -0.08373668916734531 + 0.008938951955481056im -0.03422448283650161 + 0.0071348267951940846im … -0.046208439185294034 + 0.010351186728944304im -0.05598330867982971 + 0.0059725301289481145im;;; 0.08265529417230949 - 0.011563206416384225im 0.05365496035626891 - 0.0009730640801402081im … 0.00511078368291888 - 0.005719930968461215im 0.0743354797742891 - 0.016123635635210985im; 0.06381405859198888 - 0.0072545591344987765im 0.07551264030005779 - 0.004587455687266067im … 0.02635796950641673 - 0.010527798168006166im 0.08508167052563063 - 0.020991062635967152im; … ; -0.012978278631698432 + 0.0014879444262351103im -0.005365611113328603 + 0.0012202061225882106im … -0.006643953876552188 + 0.0011180109419089306im -0.02574108264566004 + 0.004993115925078118im; -0.0014394080662412274 + 0.00285603511443874im -0.0017694315957675038 + 0.004052018491300712im … -0.020243537413955674 + 0.003296816100891993im -0.03941154508079474 + 0.005068601117929208im;;; … ;;; -0.055727551712373494 + 0.007110915328528528im -0.06819533815247462 + 0.00935484097021494im … 0.013801458767322267 + 0.0023623012365461427im 0.012342474240942893 + 0.00031585372788129164im; -0.05507648467777973 + 0.007478977485232734im -0.036917072323929906 + 0.00537234633410094im … 0.0021764365690249586 + 0.00033369179963765617im -0.019482430177048614 + 0.001921715895773151im; … ; 0.05303773884389745 - 0.005952367054471482im -0.007669739667027515 + 0.0017035688592130598im … 0.038982310240718396 - 0.005465084842296306im 0.08920021912176647 - 0.014242741148988523im; -0.008590380630423427 + 0.0018145682743361644im -0.05580596740306428 + 0.007338616632724459im … 0.0330515050546218 - 0.001653747221115906im 0.06244358581460557 - 0.004306894327035611im;;; -0.12871125554847346 + 0.019295201595538842im -0.07889751310171929 + 0.01079564954911379im … 0.025066869354420495 - 0.0014875944940813128im -0.0011980937232276868 - 0.0014272893963391759im; -0.06949576899143828 + 0.008404804677489101im -0.009571989373794918 + 0.0025207109112482346im … 0.017533009171006697 - 0.0031242753173428826im -0.021493695030989253 + 0.0015842741403444631im; … ; -0.025564669569841547 + 0.007967037400797782im -0.0647841820337347 + 0.011031217620921687im … -0.003295735152520578 + 0.006286816940726202im 0.053300796558592656 - 0.0047599050306524095im; -0.10740952712782384 + 0.020603708181924037im -0.1049610447316632 + 0.013949260086354767im … 0.011539201329275862 + 0.005438493326236474im 0.0013894308289345736 + 0.007837714316214587im;;; -0.05457651050555319 + 0.003124652146443881im -0.01135850724930568 - 0.0008948745588638527im … 0.10603121894848687 - 0.020012187046171033im 0.025417406486853734 - 0.00753571176087634im; -0.03065862937334339 + 0.00014601611703977043im 0.07023616842872678 - 0.008514768815247233im … 0.06019259251593205 - 0.009254494325259844im 0.01608645999014001 - 0.007092353410120742im; … ; -0.028593710399926225 + 0.010809799101125079im -0.06501185780882018 + 0.008208088219878385im … 0.03967378879252523 - 0.002738517466700325im 0.03706937707339777 + 0.0029291114803425703im; -0.07755209602210177 + 0.014377684839404574im -0.06646473567648448 + 0.007181356339624094im … 0.06832930855041433 - 0.006779343110796324im 0.04018151875189422 - 0.0036538983147389116im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), DFTK.RealFourierOperator[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392126631654 -0.4868367442771962 … -0.7027113226191073 -0.48683674427719636; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449516; … ; -0.7027113226191074 -0.41363732843931705 … -2.3967616825880627 -1.2958067581749715; -0.486836744277196 -0.38233074979449505 … -1.295806758174972 -0.7744303950404543;;; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449533; -0.7744303950404543 -1.4814477483918813 … -0.3245845694332824 -0.44991939657069785; … ; -0.4136373284393169 -0.32458456943328273 … -1.0113572986117076 -0.6373277791931914; -0.382330749794495 -0.44991939657069785 … -0.6373277791931913 -0.44991939657069774;;; -0.7027113226191071 -1.2958067581749722 … -0.29820348937557584 -0.41363732843931694; -1.295806758174972 -2.9196723936538986 … -0.3537295846614562 -0.6373277791931913; … ; -0.29820348937557584 -0.35372958466145676 … -0.490372608107183 -0.3537295846614566; -0.4136373284393168 -0.6373277791931912 … -0.353729584661456 -0.3245845694332823;;; … ;;; -1.0166744212557797 -0.5332878143066007 … -3.6361382571228726 -1.9987602620506286; -0.5332878143066004 -0.32174124747389177 … -1.4667339407502653 -0.9061938941468888; … ; -3.636138257122873 -1.4667339407502653 … -10.988177824465911 -8.087376168208188; -1.9987602620506286 -0.9061938941468888 … -8.087376168208186 -4.64787837114324;;; -0.7027113226191071 -0.4136373284393167 … -2.396761682588063 -1.295806758174972; -0.41363732843931666 -0.32458456943328257 … -1.0113572986117079 -0.6373277791931912; … ; -2.396761682588063 -1.011357298611708 … -11.002806190875017 -6.07730418639408; -1.295806758174972 -0.6373277791931911 … -6.07730418639408 -2.9196723936538986;;; -0.48683674427719614 -0.3823307497944952 … -1.295806758174972 -0.7744303950404545; -0.3823307497944951 -0.44991939657069796 … -0.6373277791931913 -0.44991939657069785; … ; -1.295806758174972 -0.6373277791931913 … -6.0773041863940795 -2.9196723936538977; -0.7744303950404542 -0.4499193965706976 … -2.919672393653898 -1.4814477483918813])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392126631654 -0.4868367442771962 … -0.7027113226191073 -0.48683674427719636; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449516; … ; -0.7027113226191074 -0.41363732843931705 … -2.3967616825880627 -1.2958067581749715; -0.486836744277196 -0.38233074979449505 … -1.295806758174972 -0.7744303950404543;;; -0.4868367442771961 -0.7744303950404545 … -0.41363732843931683 -0.38233074979449533; -0.7744303950404543 -1.4814477483918813 … -0.3245845694332824 -0.44991939657069785; … ; -0.4136373284393169 -0.32458456943328273 … -1.0113572986117076 -0.6373277791931914; -0.382330749794495 -0.44991939657069785 … -0.6373277791931913 -0.44991939657069774;;; -0.7027113226191071 -1.2958067581749722 … -0.29820348937557584 -0.41363732843931694; -1.295806758174972 -2.9196723936538986 … -0.3537295846614562 -0.6373277791931913; … ; -0.29820348937557584 -0.35372958466145676 … -0.490372608107183 -0.3537295846614566; -0.4136373284393168 -0.6373277791931912 … -0.353729584661456 -0.3245845694332823;;; … ;;; -1.0166744212557797 -0.5332878143066007 … -3.6361382571228726 -1.9987602620506286; -0.5332878143066004 -0.32174124747389177 … -1.4667339407502653 -0.9061938941468888; … ; -3.636138257122873 -1.4667339407502653 … -10.988177824465911 -8.087376168208188; -1.9987602620506286 -0.9061938941468888 … -8.087376168208186 -4.64787837114324;;; -0.7027113226191071 -0.4136373284393167 … -2.396761682588063 -1.295806758174972; -0.41363732843931666 -0.32458456943328257 … -1.0113572986117079 -0.6373277791931912; … ; -2.396761682588063 -1.011357298611708 … -11.002806190875017 -6.07730418639408; -1.295806758174972 -0.6373277791931911 … -6.07730418639408 -2.9196723936538986;;; -0.48683674427719614 -0.3823307497944952 … -1.295806758174972 -0.7744303950404545; -0.3823307497944951 -0.44991939657069796 … -0.6373277791931913 -0.44991939657069785; … ; -1.295806758174972 -0.6373277791931913 … -6.0773041863940795 -2.9196723936538977; -0.7744303950404542 -0.4499193965706976 … -2.919672393653898 -1.4814477483918813]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.008750441296384397 + 0.09610798333083254im 0.0106028281834004 + 0.07587284311421019im … -0.014748997495657053 + 0.011025016139032165im -0.012399504902522611 + 0.041363723661143416im; 0.006312665469945002 - 0.007561210549142553im 0.01423808072530714 - 0.02805811382363988im … -0.020422591834168217 + 0.026240048914132116im -0.00855997923731306 + 0.015655312217122488im; … ; 0.004487156617167641 + 0.022578349539079626im -0.009185576581641196 + 0.048040251517028384im … 0.0077102452104685325 + 0.029438831257419626im 0.014654707419723911 + 0.028968163774939784im; -0.013724462590399587 + 0.05975921779477336im -0.013912983784548798 + 0.10246323274003141im … -0.0024083141216247597 + 0.015097057413890804im 0.0032492908791241283 + 0.015300515798754431im;;; 0.008883814393939125 - 0.009653970584716325im 0.018206490849224582 - 0.007351521051905704im … -0.028547726493737654 + 0.06561048196129612im -0.003361275107550016 + 0.010426646677632254im; 0.019505139271316693 - 0.04401127116578316im 0.0026780838102546628 - 0.030103918976670224im … -0.017176249872300937 + 0.03477004906427621im 0.009261904050930029 - 0.0180401514060761im; … ; -0.0034612927296383267 + 0.035308715989339386im -0.004843277305841109 + 0.019597832072694058im … -0.003723444795647694 + 0.06456773241140662im 0.0018847837618516652 + 0.06263004261318361im; -0.002688462869363924 - 0.006309528266319274im 0.0047596010769377275 + 0.010572306410357566im … -0.02025951691114735 + 0.07013395022213262im -0.005726994953928658 + 0.037342631089411285im;;; 0.008860812382960472 - 0.05755726492900118im -0.00924900541199101 + 0.005215111274648743im … -0.006902052524065684 + 0.010740501729672296im 0.013978286543680229 - 0.057555006931688316im; 0.01154371030209195 - 0.03221654335743249im -0.010656922370811868 + 0.003256474821084561im … 0.010062427932513026 - 0.027783012229663645im 0.0327075570530435 - 0.079804269180618im; … ; -0.002784418661010881 - 0.011127608493806933im -0.000750038322348769 - 0.013471399335164946im … -0.004534108764296127 + 0.031582947419027965im -0.0011524492490074265 + 0.01717150902315834im; 0.005797905577109387 - 0.06811940837663966im -0.003271023879644031 - 0.016755571995705855im … -0.006857548487162978 + 0.0186040748517661im 0.0022116693516390767 - 0.027121227223577016im;;; … ;;; 0.013779980271334988 - 0.048357355198056964im -0.003400515447170094 + 0.002835594672633716im … -0.003323968767719121 + 0.04062022276983823im 0.002139983600974673 - 0.004965269084009433im; -0.0028872688462395655 + 0.010064904709685327im -0.013460790839927014 + 0.03857075217788504im … -0.005506767014811563 + 0.04201548023242601im -0.002952475450302491 + 0.018829475389084607im; … ; 0.01537903644987059 - 0.06876007553698532im 0.013359655621415249 - 0.05932311180486073im … -0.029709068625349222 + 0.10004862084290714im -0.008591386335765413 + 0.021108329566105997im; 0.028679695746113537 - 0.11089715331687186im 0.011414383361697505 - 0.053630419492009127im … -0.008626336896807616 + 0.04891068294185395im 0.011882096527002187 - 0.04052308904465491im;;; 0.0005551221962286106 - 0.010652732123646987im -0.0344797051572394 + 0.11176544180586284im … -0.004628601354882552 + 0.035593883054184795im 0.00020085582174841741 - 0.016053432283182886im; -0.005889159688895843 + 0.020964579360508474im -0.02369545063784214 + 0.07781245799807929im … -0.0016494221780575821 + 0.03350225398207061im 0.001954937852197327 + 0.008647940422849412im; … ; 0.03373088290209025 - 0.14875367680155552im 0.0091338338766156 - 0.060130321398866954im … -0.021618412730923638 + 0.057061688845760836im 0.017200591819415103 - 0.07908491600617888im; 0.03161526572450825 - 0.14513793166046066im -0.005807463863817007 - 0.007265134275153612im … 0.0007646080398020657 + 0.020613267699004574im 0.03312730616482437 - 0.1369875828646779im;;; -0.021398030448768292 + 0.09269225742854251im -0.03307381762719422 + 0.18138805497878716im … 0.0005766305908662184 - 0.02524622786511954im 0.007409087099101837 - 0.03421612487943762im; 0.005073900308375453 + 0.006743601093306958im -0.007784819970412009 + 0.04525255902876866im … 0.0014618219554602555 - 0.0020183497265163124im -0.00029351521963007525 - 0.0014743219756921193im; … ; 0.019764594224507666 - 0.08770691877462272im -0.004733512627688409 + 0.0015467403191478436im … -0.00487127934599397 + 0.0102978295049462im 0.030548490261649464 - 0.08751813102075723im; 0.00041641717400784804 - 0.032516116143513046im -0.03215893528992167 + 0.11735212927344761im … 0.00705944316534707 - 0.02013001372193306im 0.022768622316947013 - 0.0955195398745442im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729846), converged = true, ρ = [0.09132316917746625 0.08747419134079733 … 0.076847549359629 0.08747419134079733; 0.08747419134079733 0.0808996687216366 … 0.07642471016971165 0.08486944834426065; … ; 0.07684754935962901 0.07642471016971165 … 0.04778466667102118 0.06587895342303376; 0.08747419134079733 0.08486944834426065 … 0.06587895342303376 0.08089966872163662;;; 0.08747419134079733 0.08089966872163662 … 0.07642471016971164 0.08486944834426065; 0.08089966872163659 0.06744471469774659 … 0.07348669934703922 0.08163768629014236; … ; 0.07642471016971167 0.07348669934703922 … 0.06188804119996616 0.07259829028446758; 0.08486944834426065 0.08163768629014236 … 0.07259829028446758 0.08163768629014236;;; 0.076847549359629 0.06587895342303376 … 0.06847203698973384 0.07642471016971165; 0.06587895342303375 0.04657864264981038 … 0.0666575937163166 0.07259829028446758; … ; 0.06847203698973385 0.06665759371631662 … 0.061325153143808986 0.06665759371631662; 0.07642471016971165 0.07259829028446758 … 0.0666575937163166 0.0734866993470392;;; … ;;; 0.06328495229885998 0.06591651445952597 … 0.03394064888052089 0.049875934859991755; 0.06591651445952595 0.06297790960105337 … 0.04975639788527906 0.060870204571464234; … ; 0.0339406488805209 0.04975639788527906 … 0.009696353214075248 0.016831338792593336; 0.049875934859991755 0.060870204571464234 … 0.01683133879259333 0.03098572188505229;;; 0.076847549359629 0.07642471016971165 … 0.04778466667102117 0.06587895342303375; 0.07642471016971164 0.0734866993470392 … 0.06188804119996617 0.07259829028446758; … ; 0.04778466667102119 0.06188804119996617 … 0.009696353214075241 0.025710010675307062; 0.06587895342303376 0.07259829028446758 … 0.025710010675307062 0.04657864264981038;;; 0.08747419134079733 0.08486944834426065 … 0.06587895342303375 0.08089966872163662; 0.08486944834426063 0.08163768629014236 … 0.07259829028446758 0.08163768629014234; … ; 0.06587895342303378 0.07259829028446758 … 0.025710010675307062 0.04657864264981038; 0.08089966872163662 0.08163768629014234 … 0.04657864264981038 0.06744471469774659;;;;], eigenvalues = [[-0.16677707596308508, 0.26427771782987725, 0.264277717829911, 0.26427771782994197, 0.35732037190447813, 0.3573203719045033, 0.357320371904525], [-0.11613218761084493, 0.07040532320002967, 0.22624813603021648, 0.2262481360302175, 0.33611784894601177, 0.393437977617987, 0.39343797761798815], [-0.0958893814364133, 0.08764319967957271, 0.17312704142740792, 0.17312704142741467, 0.29197248922129554, 0.33773212507288686, 0.5327646516179652], [-0.045051463485954714, 0.022269526239801885, 0.09831189251533029, 0.18446409322115986, 0.3229270151624628, 0.48024696043568393, 0.5024422335167424]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2897120818381845, n_iter = 14, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.6836189691357685 - 0.6675715471979781im -1.212749172002708e-15 + 9.687944913292838e-15im … 2.656693660964396e-10 - 4.1418361291140836e-11im -2.1696018189061863e-11 + 3.3827611032162138e-12im; 0.06889115451174731 - 0.06727398840877603im 0.02554572089576768 - 0.2765923795678897im … -0.3216817447106439 + 0.09003533253008951im 0.020242861871416138 - 0.13783360625838859im; … ; 0.008438254339158766 - 0.008240172902108565im -0.03792630994901121 + 0.017800828028027755im … -0.02516026902200264 + 0.007336901679031622im -0.029079196681710242 + 0.017688916425637066im; -0.0688911545117415 + 0.06727398840877448im -0.3457612613270537 - 0.10231832693691567im … 0.1143785315932283 - 0.029584337099874226im -0.25983532741205145 + 0.28357804151742966im], [-0.35006498660199575 - 0.8602382541258131im -0.15109239236175095 - 0.12660670782476524im … 2.9251570335502044e-12 + 5.9134909746234545e-12im -3.641582604519398e-12 + 3.436163484230764e-12im; -0.023864604809352558 - 0.05864409970238062im 0.006724696462262023 + 0.005634907667418562im … -1.835005555590523e-12 + 3.938236118909189e-12im 1.8795636038830256e-11 - 4.253986707013866e-12im; … ; -0.0029214591482255264 - 0.00717909820563311im -0.06611560792379587 - 0.055401065031939964im … 0.07760110917075956 - 0.07750189289727308im -0.00023714400000017096 + 0.0069051750857072654im; 0.04256694617830256 + 0.10460262198550832im 0.06952562485959592 + 0.05825846249001106im … 0.3293824860560409 - 0.3289613567013235im -0.0010065715970418482 + 0.029309423036932857im], [0.906821442753994 + 0.22263338510516803im -5.898519920272759e-15 - 2.9616306654798107e-15im … -3.6140819051117466e-11 + 2.600382700946823e-11im -6.693524345463187e-10 + 1.2513522886221395e-9im; 0.06676586762917186 + 0.016391662590844232im 0.05041629760159442 + 0.02699866638236223im … 0.020225184454808042 - 0.015002224331443584im -2.1496413608418913e-5 - 0.0018098320788624543im; … ; 0.013470262794694477 + 0.0033070790597225044im -2.6528078383298925e-16 + 1.0150261652086475e-15im … -3.060851783122581e-11 + 3.6027614271111764e-11im -0.01038037314454986 + 0.06414577856006277im; -0.14879021109507104 - 0.03652942774048903im 0.2531179240829711 + 0.13554835862235284im … -0.30668484061740153 + 0.2274864186639233im -0.024354294135032477 + 0.15114980383283977im], [-0.010769599087366917 - 0.8089409706518066im 4.208599861312933e-16 - 1.1058241449978097e-15im … 0.18198679473831098 + 0.04485152542025332im 4.266654088560945e-7 - 1.1806773928612459e-6im; -0.005158061835752976 - 0.38743945008972036im -0.0799825984715019 - 0.6214608841575778im … -0.17304348356522573 - 0.04264678601707752im -1.9393942268355148e-7 + 8.867004150847566e-7im; … ; -0.00015167307141786238 - 0.011392676795044104im -0.00020980768861617394 - 0.001630195494552345im … 0.01570621759846137 + 0.0038705315321589592im 0.018232505364781045 - 0.040361485770334084im; 0.0008676745375215088 + 0.06517396579933718im -0.0015937022897722318 - 0.012382988962771999im … 0.1314231049408037 + 0.03238841627681958im 0.19375795699217752 - 0.4289245673905947im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16677707596308508, 0.26427771782987725, 0.264277717829911, 0.26427771782994197, 0.35732037190447813, 0.3573203719045033, 0.357320371904525], [-0.11613218761084493, 0.07040532320002967, 0.22624813603021648, 0.2262481360302175, 0.33611784894601177, 0.393437977617987, 0.39343797761798815], [-0.0958893814364133, 0.08764319967957271, 0.17312704142740792, 0.17312704142741467, 0.29197248922129554, 0.33773212507288686, 0.5327646516179652], [-0.045051463485954714, 0.022269526239801885, 0.09831189251533029, 0.18446409322115986, 0.3229270151624628, 0.48024696043568393, 0.5024422335167424]], X = [[0.6836189691357685 - 0.6675715471979781im -1.212749172002708e-15 + 9.687944913292838e-15im … 2.656693660964396e-10 - 4.1418361291140836e-11im -2.1696018189061863e-11 + 3.3827611032162138e-12im; 0.06889115451174731 - 0.06727398840877603im 0.02554572089576768 - 0.2765923795678897im … -0.3216817447106439 + 0.09003533253008951im 0.020242861871416138 - 0.13783360625838859im; … ; 0.008438254339158766 - 0.008240172902108565im -0.03792630994901121 + 0.017800828028027755im … -0.02516026902200264 + 0.007336901679031622im -0.029079196681710242 + 0.017688916425637066im; -0.0688911545117415 + 0.06727398840877448im -0.3457612613270537 - 0.10231832693691567im … 0.1143785315932283 - 0.029584337099874226im -0.25983532741205145 + 0.28357804151742966im], [-0.35006498660199575 - 0.8602382541258131im -0.15109239236175095 - 0.12660670782476524im … 2.9251570335502044e-12 + 5.9134909746234545e-12im -3.641582604519398e-12 + 3.436163484230764e-12im; -0.023864604809352558 - 0.05864409970238062im 0.006724696462262023 + 0.005634907667418562im … -1.835005555590523e-12 + 3.938236118909189e-12im 1.8795636038830256e-11 - 4.253986707013866e-12im; … ; -0.0029214591482255264 - 0.00717909820563311im -0.06611560792379587 - 0.055401065031939964im … 0.07760110917075956 - 0.07750189289727308im -0.00023714400000017096 + 0.0069051750857072654im; 0.04256694617830256 + 0.10460262198550832im 0.06952562485959592 + 0.05825846249001106im … 0.3293824860560409 - 0.3289613567013235im -0.0010065715970418482 + 0.029309423036932857im], [0.906821442753994 + 0.22263338510516803im -5.898519920272759e-15 - 2.9616306654798107e-15im … -3.6140819051117466e-11 + 2.600382700946823e-11im -6.693524345463187e-10 + 1.2513522886221395e-9im; 0.06676586762917186 + 0.016391662590844232im 0.05041629760159442 + 0.02699866638236223im … 0.020225184454808042 - 0.015002224331443584im -2.1496413608418913e-5 - 0.0018098320788624543im; … ; 0.013470262794694477 + 0.0033070790597225044im -2.6528078383298925e-16 + 1.0150261652086475e-15im … -3.060851783122581e-11 + 3.6027614271111764e-11im -0.01038037314454986 + 0.06414577856006277im; -0.14879021109507104 - 0.03652942774048903im 0.2531179240829711 + 0.13554835862235284im … -0.30668484061740153 + 0.2274864186639233im -0.024354294135032477 + 0.15114980383283977im], [-0.010769599087366917 - 0.8089409706518066im 4.208599861312933e-16 - 1.1058241449978097e-15im … 0.18198679473831098 + 0.04485152542025332im 4.266654088560945e-7 - 1.1806773928612459e-6im; -0.005158061835752976 - 0.38743945008972036im -0.0799825984715019 - 0.6214608841575778im … -0.17304348356522573 - 0.04264678601707752im -1.9393942268355148e-7 + 8.867004150847566e-7im; … ; -0.00015167307141786238 - 0.011392676795044104im -0.00020980768861617394 - 0.001630195494552345im … 0.01570621759846137 + 0.0038705315321589592im 0.018232505364781045 - 0.040361485770334084im; 0.0008676745375215088 + 0.06517396579933718im -0.0015937022897722318 - 0.012382988962771999im … 0.1314231049408037 + 0.03238841627681958im 0.19375795699217752 - 0.4289245673905947im]], residual_norms = [[1.4319059508569462e-13, 1.289128254381962e-13, 1.2529410283089843e-13, 6.073585710368828e-14, 8.996306998308138e-11, 1.2575022591706263e-9, 1.0270066792323511e-10], [1.1759762171148712e-13, 1.2780940147892045e-13, 1.197446802358828e-13, 4.6034353676946495e-14, 1.3120140392855342e-10, 2.4655643059532783e-10, 2.2415647499949164e-10], [6.660203442585725e-14, 1.0509724485151574e-13, 2.3799901124160346e-13, 8.094099983658068e-14, 1.6958577188032598e-11, 5.08699147523093e-10, 1.0987853796315717e-7], [1.4308448538289074e-13, 7.680148407198063e-14, 1.0714001444404211e-13, 8.739537044639059e-14, 1.257899678664564e-9, 1.1543734400356093e-5, 4.778727262107426e-6]], iterations = [33, 22, 22, 20], converged = 1, n_matvec = 665)], stage = :finalize, algorithm = &quot;SCF&quot;, occupation_threshold = 1.0e-6)</code></pre><h2 id="Direct-minimization"><a class="docs-heading-anchor" href="#Direct-minimization">Direct minimization</a><a id="Direct-minimization-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-minimization" title="Permalink"></a></h2><pre><code class="language-julia hljs">scfres_dm = direct_minimization(basis; tol)

# Newton algorithm</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3915556371438472 0.3785174210074714 … 0.3446996003702696 0.3785174210074714; 0.37851742100747127 0.3664584407571992 … 0.3273572818109392 0.363649542720645; … ; 0.3446996003702696 0.32735728181093926 … 0.3075192695197804 0.3343805320907545; 0.3785174210074713 0.36364954272064504 … 0.3343805320907545 0.3664584407571992;;; 0.3785174210074713 0.36645844075719924 … 0.3273572818109392 0.36364954272064504; 0.3664584407571992 0.35102886353088525 … 0.31119401354226245 0.3519170664467544; … ; 0.3273572818109392 0.31119401354226245 … 0.2982412284983384 0.3214260029053961; 0.36364954272064504 0.35191706644675447 … 0.3214260029053961 0.3519170664467544;;; 0.34469960037026964 0.33438053209075463 … 0.2865351538373415 0.32735728181093926; 0.3343805320907545 0.31861604787245423 … 0.2780589188946991 0.3214260029053961; … ; 0.2865351538373415 0.27805891889469914 … 0.25590185778811325 0.2780589188946991; 0.32735728181093926 0.32142600290539614 … 0.2780589188946991 0.3111940135422624;;; … ;;; 0.3048747493788079 0.28303666903833735 … 0.28556433241425255 0.3009573706146544; 0.28303666903833724 0.258984316288206 … 0.27263300136596164 0.285414196707195; … ; 0.28556433241425255 0.2726330013659616 … 0.27716038924736097 0.2812108738904061; 0.3009573706146544 0.28541419670719503 … 0.2812108738904061 0.2930827263759613;;; 0.34469960037026964 0.32735728181093926 … 0.30751926951978037 0.33438053209075463; 0.32735728181093915 0.31119401354226234 … 0.29824122849833845 0.3214260029053961; … ; 0.30751926951978037 0.2982412284983384 … 0.27716038924736097 0.29313119157843737; 0.33438053209075463 0.32142600290539614 … 0.29313119157843737 0.31861604787245423;;; 0.3785174210074713 0.36364954272064504 … 0.3343805320907546 0.36645844075719924; 0.3636495427206449 0.35191706644675436 … 0.3214260029053961 0.3519170664467544; … ; 0.33438053209075463 0.3214260029053961 … 0.2931311915784374 0.3186160478724543; 0.3664584407571992 0.3519170664467544 … 0.3186160478724543 0.3510288635308853]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5033081923456447 -0.4966565572591999 … -0.47719190099722886 -0.4966565572592; -0.4966565572591999 -0.484818208747289 … -0.47638044579293476 -0.49204131119909633; … ; -0.47719190099722886 -0.47638044579293476 … -0.41228807090639 -0.4550700815917571; -0.4966565572591999 -0.49204131119909633 … -0.4550700815917571 -0.484818208747289;;; -0.4966565572591999 -0.484818208747289 … -0.47638044579293476 -0.49204131119909633; -0.484818208747289 -0.45837440795599893 … -0.47065601572870497 -0.4861790252051403; … ; -0.47638044579293476 -0.47065601572870497 … -0.4463984364612438 -0.46889439641930736; -0.49204131119909633 -0.4861790252051403 … -0.46889439641930736 -0.4861790252051403;;; -0.4771919009972288 -0.4550700815917571 … -0.4605141234426624 -0.47638044579293476; -0.4550700815917571 -0.4090661824786075 … -0.4567199083405067 -0.46889439641930736; … ; -0.46051412344266246 -0.4567199083405067 … -0.44514495661990156 -0.4567199083405067; -0.4763804457929347 -0.46889439641930736 … -0.4567199083405067 -0.47065601572870497;;; … ;;; -0.44947595086877024 -0.45514997222338727 … -0.3712598626424337 -0.4177457152321039; -0.45514997222338727 -0.4488035110153222 … -0.4174380107307283 -0.44412609932140096; … ; -0.37125986264243366 -0.41743801073072834 … -0.2536569833244609 -0.29979809109222055; -0.4177457152321038 -0.44412609932140096 … -0.2997980910922206 -0.36106343268057767;;; -0.4771919009972288 -0.4763804457929347 … -0.41228807090639 -0.45507008159175716; -0.4763804457929347 -0.470656015728705 … -0.4463984364612438 -0.4688943964193074; … ; -0.41228807090639 -0.4463984364612438 … -0.2536569833244609 -0.34106330233758364; -0.4550700815917571 -0.46889439641930736 … -0.3410633023375837 -0.4090661824786075;;; -0.4966565572591999 -0.49204131119909633 … -0.4550700815917571 -0.484818208747289; -0.49204131119909633 -0.4861790252051403 … -0.46889439641930736 -0.4861790252051403; … ; -0.4550700815917571 -0.46889439641930736 … -0.3410633023375837 -0.4090661824786075; -0.484818208747289 -0.4861790252051403 … -0.4090661824786075 -0.4583744079559989])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41291392118936554 -0.48683674420298034 … -0.7027113225513847 -0.48683674420298056; -0.48683674420298023 -0.7744303949677325 … -0.41363732837679035 -0.38233074972406766; … ; -0.7027113225513849 -0.4136373283767905 … -2.3967616825192946 -1.295806758106428; -0.48683674420298007 -0.3823307497240675 … -1.295806758106428 -0.7744303949677322;;; -0.4868367442029803 -0.7744303949677325 … -0.41363732837679035 -0.3823307497240679; -0.7744303949677322 -1.4814477483198583 … -0.3245845693745928 -0.4499193965026572; … ; -0.41363732837679046 -0.3245845693745932 … -1.0113572985506347 -0.637327779130672; -0.38233074972406744 -0.44991939650265717 … -0.6373277791306717 -0.4499193965026571;;; -0.7027113225513846 -1.295806758106428 … -0.2982034893221661 -0.4136373283767905; -1.295806758106428 -2.9196723935838946 … -0.3537295846096107 -0.6373277791306717; … ; -0.2982034893221661 -0.35372958460961124 … -0.49037260805859983 -0.3537295846096112; -0.41363732837679024 -0.6373277791306717 … -0.35372958460961057 -0.3245845693745929;;; … ;;; -1.0166744211938714 -0.5332878142525384 … -3.6361382570506837 -1.9987602619837235; -0.5332878142525382 -0.3217412474260284 … -1.466733940688178 -0.906193894088937; … ; -3.6361382570506837 -1.4667339406881783 … -10.988177824396626 -8.087376168134185; -1.998760261983723 -0.9061938940889369 … -8.087376168134185 -4.647878371071521;;; -0.7027113225513846 -0.41363732837679024 … -2.396761682519295 -1.295806758106428; -0.41363732837679024 -0.32458456937459323 … -1.0113572985506347 -0.6373277791306717; … ; -2.396761682519295 -1.0113572985506352 … -11.002806190805732 -6.077304186322608; -1.2958067581064276 -0.6373277791306715 … -6.077304186322608 -2.9196723935838946;;; -0.48683674420298034 -0.3823307497240678 … -1.295806758106428 -0.7744303949677325; -0.38233074972406766 -0.44991939650265733 … -0.6373277791306717 -0.4499193965026572; … ; -1.295806758106428 -0.6373277791306718 … -6.077304186322607 -2.919672393583894; -0.7744303949677322 -0.44991939650265705 … -2.919672393583894 -1.4814477483198583]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.19401141427570667 - 0.20127664731892833im -0.059922492882826556 - 0.02587930073994234im … 0.0428175331234382 + 0.08086818457163394im -0.05992249262111883 - 0.025879299803493676im; -0.028792884900252728 - 0.11140894823665907im 0.14281253942929012 + 0.09539756663517086im … -0.00014470412364967834 + 0.027168820661946008im -0.034408483768039774 - 0.048889498448472624im; … ; 0.07408449021763523 - 0.005038839688246121im 0.019127979279402095 - 0.02578353174024666im … 0.026968276208669255 + 0.0279781682223591im 0.10540494701992448 + 0.07296198852587285im; -0.028792886558179444 - 0.11140894928003606im -0.034408485335577235 - 0.04888950011253648im … 0.09988382925670365 + 0.08813144569036059im 0.1428125403633517 + 0.09539756594201053im;;; -0.11133260221285735 - 0.17411841036497727im 0.04657010702414508 + 0.022277479911196288im … 0.008707747599232426 + 0.03389446161167034im -0.058472321836307614 - 0.06717197314978654im; 0.08286765275799476 - 0.07745125542897396im 0.22234138943777573 + 0.12680011670464725im … -0.0031704682961041395 - 0.0035440363087264237im -0.006089635458200252 - 0.08067283951397371im; … ; 0.024641755288949796 - 0.00988476594457596im 0.0005276878941717622 - 0.013704847728855569im … 0.032708689818121375 + 0.03385302357354544im 0.05139692257794506 + 0.03604562023535141im; -0.04939671859473904 - 0.09210750306511101im -0.026696255621023898 - 0.02405545540521261im … 0.044356407638655136 + 0.05538967385209484im 0.027941906813649605 + 0.017455831359647667im;;; -0.008819408412354094 - 0.06802498878647958im 0.05076678406976484 + 0.031450702963960006im … -0.004661086850958043 - 0.006708038714213649im -0.023120819781275684 - 0.05788201187901883im; 0.06585228564073788 - 0.009997224850168884im 0.10582433562016702 + 0.09659468292483708im … -0.002822886014010894 - 0.02144059205949212im 0.007363900915951446 - 0.05127682410622937im; … ; -0.0020507668057889758 - 0.013879982231287889im -0.007312791334967473 - 0.009104425704537579im … 0.015690426612586836 + 0.01748217575352781im 0.012118153664075575 + 0.0056582143876846135im; -0.02645949562527928 - 0.0487088873499142im -0.007995112090670964 - 0.009077415371575668im … 0.009279736155533437 + 0.013456862959716884im -0.009277922740019892 - 0.02115464973652756im;;; … ;;; 0.0059289131521977675 - 0.006326049101380996im -0.005437027596466821 - 0.02418962586878837im … 0.0007960203862474456 + 0.014023726503600013im 0.016417381656206473 + 0.025590833587290036im; -0.008102101336053723 - 0.016867245799393943im -0.007989466300038012 - 0.017593773598365715im … 0.002817536977002038 + 0.007751353898347312im 0.0002875704177181253 + 0.002050222485851824im; … ; -0.005320440407151141 + 0.030828909959074488im 0.0038899485297618397 + 0.0048048676934526295im … -0.0744280293964901 - 0.017762891723740938im -0.04409782822296669 + 0.02845178418785335im; 0.017785748381920062 + 0.021831200388860245im 0.005503700081428162 - 0.012281269471107244im … -0.03577932995852563 + 0.005596428989317428im 0.0057012590687903295 + 0.047058171859417394im;;; -0.008819407166850658 - 0.06802498897148959im -0.02312081842736363 - 0.057882011997767574im … 0.026968274901991964 + 0.027978167915425657im 0.05076678321680428 + 0.03145070187960859im; -0.02645949414200305 - 0.04870888715600448im -0.00927792150559151 - 0.021154649760257542im … 0.004084673976121748 + 0.012105958165557998im -0.00799511214432809 - 0.009077415489942758im; … ; 0.026968275512343497 + 0.02797816857469877im 0.014880136143875225 - 0.017554937891452703im … -0.1203179921812216 - 0.02049791516411105im -0.022716826392476956 + 0.06277361965583328im; 0.06585228586262096 - 0.009997225190568598im 0.00736390141646109 - 0.051276824078719335im … -0.007631324556880257 + 0.021325691750692006im 0.10582433489147716 + 0.09659468152223849im;;; -0.11133259982229186 - 0.17411841054886695im -0.0584723200913137 - 0.06717197407386069im … 0.0598848315410767 + 0.05774224989687553im 0.046570107662906104 + 0.0222774792307848im; -0.049396715281423066 - 0.09210750232747im 0.027941907943283727 + 0.01745583124962325im … 0.0036321994198437093 + 0.024449499865736787im -0.026696254465321777 - 0.02405545466377695im; … ; 0.08049145194989024 + 0.0011248656640010586im 0.026031727921081108 - 0.037093962341738305im … -0.04763032055093595 - 0.009063503670087835im 0.08176050012053071 + 0.07831220756027144im; 0.08286765369904184 - 0.07745125624011784im -0.006089635233198373 - 0.08067284022162755im … 0.09083610337404388 + 0.05337667766303712im 0.22234139093168903 + 0.12680011484064937im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3915556371438472 0.3785174210074714 … 0.3446996003702696 0.3785174210074714; 0.37851742100747127 0.3664584407571992 … 0.3273572818109392 0.363649542720645; … ; 0.3446996003702696 0.32735728181093926 … 0.3075192695197804 0.3343805320907545; 0.3785174210074713 0.36364954272064504 … 0.3343805320907545 0.3664584407571992;;; 0.3785174210074713 0.36645844075719924 … 0.3273572818109392 0.36364954272064504; 0.3664584407571992 0.35102886353088525 … 0.31119401354226245 0.3519170664467544; … ; 0.3273572818109392 0.31119401354226245 … 0.2982412284983384 0.3214260029053961; 0.36364954272064504 0.35191706644675447 … 0.3214260029053961 0.3519170664467544;;; 0.34469960037026964 0.33438053209075463 … 0.2865351538373415 0.32735728181093926; 0.3343805320907545 0.31861604787245423 … 0.2780589188946991 0.3214260029053961; … ; 0.2865351538373415 0.27805891889469914 … 0.25590185778811325 0.2780589188946991; 0.32735728181093926 0.32142600290539614 … 0.2780589188946991 0.3111940135422624;;; … ;;; 0.3048747493788079 0.28303666903833735 … 0.28556433241425255 0.3009573706146544; 0.28303666903833724 0.258984316288206 … 0.27263300136596164 0.285414196707195; … ; 0.28556433241425255 0.2726330013659616 … 0.27716038924736097 0.2812108738904061; 0.3009573706146544 0.28541419670719503 … 0.2812108738904061 0.2930827263759613;;; 0.34469960037026964 0.32735728181093926 … 0.30751926951978037 0.33438053209075463; 0.32735728181093915 0.31119401354226234 … 0.29824122849833845 0.3214260029053961; … ; 0.30751926951978037 0.2982412284983384 … 0.27716038924736097 0.29313119157843737; 0.33438053209075463 0.32142600290539614 … 0.29313119157843737 0.31861604787245423;;; 0.3785174210074713 0.36364954272064504 … 0.3343805320907546 0.36645844075719924; 0.3636495427206449 0.35191706644675436 … 0.3214260029053961 0.3519170664467544; … ; 0.33438053209075463 0.3214260029053961 … 0.2931311915784374 0.3186160478724543; 0.3664584407571992 0.3519170664467544 … 0.3186160478724543 0.3510288635308853]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5033081923456447 -0.4966565572591999 … -0.47719190099722886 -0.4966565572592; -0.4966565572591999 -0.484818208747289 … -0.47638044579293476 -0.49204131119909633; … ; -0.47719190099722886 -0.47638044579293476 … -0.41228807090639 -0.4550700815917571; -0.4966565572591999 -0.49204131119909633 … -0.4550700815917571 -0.484818208747289;;; -0.4966565572591999 -0.484818208747289 … -0.47638044579293476 -0.49204131119909633; -0.484818208747289 -0.45837440795599893 … -0.47065601572870497 -0.4861790252051403; … ; -0.47638044579293476 -0.47065601572870497 … -0.4463984364612438 -0.46889439641930736; -0.49204131119909633 -0.4861790252051403 … -0.46889439641930736 -0.4861790252051403;;; -0.4771919009972288 -0.4550700815917571 … -0.4605141234426624 -0.47638044579293476; -0.4550700815917571 -0.4090661824786075 … -0.4567199083405067 -0.46889439641930736; … ; -0.46051412344266246 -0.4567199083405067 … -0.44514495661990156 -0.4567199083405067; -0.4763804457929347 -0.46889439641930736 … -0.4567199083405067 -0.47065601572870497;;; … ;;; -0.44947595086877024 -0.45514997222338727 … -0.3712598626424337 -0.4177457152321039; -0.45514997222338727 -0.4488035110153222 … -0.4174380107307283 -0.44412609932140096; … ; -0.37125986264243366 -0.41743801073072834 … -0.2536569833244609 -0.29979809109222055; -0.4177457152321038 -0.44412609932140096 … -0.2997980910922206 -0.36106343268057767;;; -0.4771919009972288 -0.4763804457929347 … -0.41228807090639 -0.45507008159175716; -0.4763804457929347 -0.470656015728705 … -0.4463984364612438 -0.4688943964193074; … ; -0.41228807090639 -0.4463984364612438 … -0.2536569833244609 -0.34106330233758364; -0.4550700815917571 -0.46889439641930736 … -0.3410633023375837 -0.4090661824786075;;; -0.4966565572591999 -0.49204131119909633 … -0.4550700815917571 -0.484818208747289; -0.49204131119909633 -0.4861790252051403 … -0.46889439641930736 -0.4861790252051403; … ; -0.4550700815917571 -0.46889439641930736 … -0.3410633023375837 -0.4090661824786075; -0.484818208747289 -0.4861790252051403 … -0.4090661824786075 -0.4583744079559989])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41291392118936554 -0.48683674420298034 … -0.7027113225513847 -0.48683674420298056; -0.48683674420298023 -0.7744303949677325 … -0.41363732837679035 -0.38233074972406766; … ; -0.7027113225513849 -0.4136373283767905 … -2.3967616825192946 -1.295806758106428; -0.48683674420298007 -0.3823307497240675 … -1.295806758106428 -0.7744303949677322;;; -0.4868367442029803 -0.7744303949677325 … -0.41363732837679035 -0.3823307497240679; -0.7744303949677322 -1.4814477483198583 … -0.3245845693745928 -0.4499193965026572; … ; -0.41363732837679046 -0.3245845693745932 … -1.0113572985506347 -0.637327779130672; -0.38233074972406744 -0.44991939650265717 … -0.6373277791306717 -0.4499193965026571;;; -0.7027113225513846 -1.295806758106428 … -0.2982034893221661 -0.4136373283767905; -1.295806758106428 -2.9196723935838946 … -0.3537295846096107 -0.6373277791306717; … ; -0.2982034893221661 -0.35372958460961124 … -0.49037260805859983 -0.3537295846096112; -0.41363732837679024 -0.6373277791306717 … -0.35372958460961057 -0.3245845693745929;;; … ;;; -1.0166744211938714 -0.5332878142525384 … -3.6361382570506837 -1.9987602619837235; -0.5332878142525382 -0.3217412474260284 … -1.466733940688178 -0.906193894088937; … ; -3.6361382570506837 -1.4667339406881783 … -10.988177824396626 -8.087376168134185; -1.998760261983723 -0.9061938940889369 … -8.087376168134185 -4.647878371071521;;; -0.7027113225513846 -0.41363732837679024 … -2.396761682519295 -1.295806758106428; -0.41363732837679024 -0.32458456937459323 … -1.0113572985506347 -0.6373277791306717; … ; -2.396761682519295 -1.0113572985506352 … -11.002806190805732 -6.077304186322608; -1.2958067581064276 -0.6373277791306715 … -6.077304186322608 -2.9196723935838946;;; -0.48683674420298034 -0.3823307497240678 … -1.295806758106428 -0.7744303949677325; -0.38233074972406766 -0.44991939650265733 … -0.6373277791306717 -0.4499193965026572; … ; -1.295806758106428 -0.6373277791306718 … -6.077304186322607 -2.919672393583894; -0.7744303949677322 -0.44991939650265705 … -2.919672393583894 -1.4814477483198583]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.20755966096940215 + 0.006974830373702761im -0.0074475845566025125 + 0.04382030745294123im … 0.0014733873602102185 + 0.025129986050596985im -0.11834818457651192 + 0.022766712576744137im; -0.06399128961321651 + 0.002307294772204796im 0.04162532267302308 + 0.029505477361845937im … 0.0012923220048077838 + 0.006756846545370459im -0.04232057464591364 - 0.0005492052500202626im; … ; -0.16174744893576606 + 0.0049532681848423275im -0.11548140988768307 + 0.0009708658031507829im … 0.05400876788858021 + 0.006332137645388539im 0.006746591943809919 + 0.025431688366555398im; -0.31586836745583674 + 0.009970091074363243im -0.15197691625166765 + 0.02423408756753894im … 0.012352638813998715 + 0.0326777746136636im -0.13731113152523278 + 0.04534053460176488im;;; 0.09712299139404793 + 0.030085173255786142im 0.29618880154636873 + 0.06326913116333006im … -0.013113926391885352 + 0.009224630738921592im -0.007962584395379781 + 0.012392822960969652im; 0.11603604858338204 + 0.019731778915056827im 0.19096581214440594 + 0.026875104604393706im … 0.0028482241786328376 + 0.0014930786564035408im 0.022593020712874 + 0.0024079405614504407im; … ; -0.1217458116583906 + 0.0017936822163497677im -0.042070264617779726 + 0.00848895013274675im … -0.01910975985510703 + 0.006118031787560632im -0.08147001764894019 + 0.007497010400895246im; -0.10511232289165492 + 0.018078517549155026im 0.09256586266631563 + 0.04245886240229535im … -0.039602446412616676 + 0.01315089504601197im -0.11326640151925368 + 0.016331116208429357im;;; 0.15620644141874848 + 0.0227334947470643im 0.17016782950507725 + 0.022567018960159113im … 0.010013439829093678 + 0.003069241044910374im 0.05827720704115948 + 0.007899180217621024im; 0.06130428506361731 + 0.004969442159246149im 0.0010514769773112371 - 0.017117294817275287im … 0.012989553253997796 + 0.00040822677179932414im 0.037582345632678905 + 0.0027544196522268057im; … ; -0.01234292607957312 + 0.004854188428277912im 0.030442420690991193 + 0.009928495467949877im … -0.0220012217550532 + 0.0022882717766460918im -0.032158664183396836 + 0.0024998836530586094im; 0.07324650386965471 + 0.016501387197573745im 0.12781049348968374 + 0.024181598729861153im … -0.013329556741286752 + 0.004080713541521813im 0.005422168745460226 + 0.006817111392124917im;;; … ;;; 0.03245919556254326 + 0.006441829025691282im 0.02042952902209675 + 0.0026796401419988507im … -0.01487969450470846 - 0.005138782717447981im 0.01872598741307937 + 0.005471104365631989im; 0.023053630718847702 + 0.004035948248200771im 0.009548001084335197 + 0.0015477641037084146im … 0.007349553479864464 + 0.002770588395710699im 0.023697925544543964 + 0.00601949675767619im; … ; -0.0029237229250525087 - 0.006566040017591528im 0.010092915534515686 - 0.001164737282558382im … -0.08980825748034674 - 0.03913409475842741im -0.05213065382567496 - 0.025479449964707072im; 0.019271832921483257 + 0.0022268157471518916im 0.018852410493109126 + 0.0014749659893107912im … -0.06089017173912037 - 0.02617247314614328im -0.015637269827215153 - 0.008369240083223636im;;; 0.06235807199982894 + 0.01713290596443142im 0.012052991347092059 + 0.0059190072711377065im … 0.038885465305396855 + 0.01206403381787646im 0.09673309264517228 + 0.03100781236598299im; 0.01757649598175852 + 0.004617953430515045im -0.006703324335111063 + 0.002747655481803167im … 0.03131582520874529 + 0.01050310073725819im 0.042691389668053095 + 0.012106430013143554im; … ; 0.07348012085284886 + 0.0037746145032061867im 0.023146961317101884 + 0.0005676967255605454im … -0.07193219856805157 - 0.06159716091441182im 0.061335722853113235 - 0.017662391325019736im; 0.0925725727498085 + 0.022141048213072525im 0.022217892211217193 + 0.005030918560317229im … 0.003642416490839968 - 0.016345067447526618im 0.1261019695553439 + 0.029107185041990526im;;; -0.07284077209308815 + 0.01678940632068657im -0.056138011643647276 + 0.018720568626532333im … 0.07539008375257193 + 0.03381117351419531im 0.07711424424604543 + 0.05166555587489706im; -0.04736362855616082 + 0.00011318997625608266im -0.03649776376074632 + 0.01016939590520512im … 0.031026570284680803 + 0.01363858040989082im 0.009604935071489703 + 0.009874679167928939im; … ; 0.06898289680836187 + 0.017257075344196064im -0.030056064855495945 + 0.0007438915956635447im … 0.09699423794209278 - 0.02234606501449589im 0.2267602418697302 + 0.02688821295919721im; -0.037746991712828214 + 0.032262986100406524im -0.07133907111190146 + 0.010824046451875954im … 0.12177097435632317 + 0.02967605279748322im 0.17431418536905696 + 0.07025063602088484im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3915556371438472 0.3785174210074714 … 0.3446996003702696 0.3785174210074714; 0.37851742100747127 0.3664584407571992 … 0.3273572818109392 0.363649542720645; … ; 0.3446996003702696 0.32735728181093926 … 0.3075192695197804 0.3343805320907545; 0.3785174210074713 0.36364954272064504 … 0.3343805320907545 0.3664584407571992;;; 0.3785174210074713 0.36645844075719924 … 0.3273572818109392 0.36364954272064504; 0.3664584407571992 0.35102886353088525 … 0.31119401354226245 0.3519170664467544; … ; 0.3273572818109392 0.31119401354226245 … 0.2982412284983384 0.3214260029053961; 0.36364954272064504 0.35191706644675447 … 0.3214260029053961 0.3519170664467544;;; 0.34469960037026964 0.33438053209075463 … 0.2865351538373415 0.32735728181093926; 0.3343805320907545 0.31861604787245423 … 0.2780589188946991 0.3214260029053961; … ; 0.2865351538373415 0.27805891889469914 … 0.25590185778811325 0.2780589188946991; 0.32735728181093926 0.32142600290539614 … 0.2780589188946991 0.3111940135422624;;; … ;;; 0.3048747493788079 0.28303666903833735 … 0.28556433241425255 0.3009573706146544; 0.28303666903833724 0.258984316288206 … 0.27263300136596164 0.285414196707195; … ; 0.28556433241425255 0.2726330013659616 … 0.27716038924736097 0.2812108738904061; 0.3009573706146544 0.28541419670719503 … 0.2812108738904061 0.2930827263759613;;; 0.34469960037026964 0.32735728181093926 … 0.30751926951978037 0.33438053209075463; 0.32735728181093915 0.31119401354226234 … 0.29824122849833845 0.3214260029053961; … ; 0.30751926951978037 0.2982412284983384 … 0.27716038924736097 0.29313119157843737; 0.33438053209075463 0.32142600290539614 … 0.29313119157843737 0.31861604787245423;;; 0.3785174210074713 0.36364954272064504 … 0.3343805320907546 0.36645844075719924; 0.3636495427206449 0.35191706644675436 … 0.3214260029053961 0.3519170664467544; … ; 0.33438053209075463 0.3214260029053961 … 0.2931311915784374 0.3186160478724543; 0.3664584407571992 0.3519170664467544 … 0.3186160478724543 0.3510288635308853]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5033081923456447 -0.4966565572591999 … -0.47719190099722886 -0.4966565572592; -0.4966565572591999 -0.484818208747289 … -0.47638044579293476 -0.49204131119909633; … ; -0.47719190099722886 -0.47638044579293476 … -0.41228807090639 -0.4550700815917571; -0.4966565572591999 -0.49204131119909633 … -0.4550700815917571 -0.484818208747289;;; -0.4966565572591999 -0.484818208747289 … -0.47638044579293476 -0.49204131119909633; -0.484818208747289 -0.45837440795599893 … -0.47065601572870497 -0.4861790252051403; … ; -0.47638044579293476 -0.47065601572870497 … -0.4463984364612438 -0.46889439641930736; -0.49204131119909633 -0.4861790252051403 … -0.46889439641930736 -0.4861790252051403;;; -0.4771919009972288 -0.4550700815917571 … -0.4605141234426624 -0.47638044579293476; -0.4550700815917571 -0.4090661824786075 … -0.4567199083405067 -0.46889439641930736; … ; -0.46051412344266246 -0.4567199083405067 … -0.44514495661990156 -0.4567199083405067; -0.4763804457929347 -0.46889439641930736 … -0.4567199083405067 -0.47065601572870497;;; … ;;; -0.44947595086877024 -0.45514997222338727 … -0.3712598626424337 -0.4177457152321039; -0.45514997222338727 -0.4488035110153222 … -0.4174380107307283 -0.44412609932140096; … ; -0.37125986264243366 -0.41743801073072834 … -0.2536569833244609 -0.29979809109222055; -0.4177457152321038 -0.44412609932140096 … -0.2997980910922206 -0.36106343268057767;;; -0.4771919009972288 -0.4763804457929347 … -0.41228807090639 -0.45507008159175716; -0.4763804457929347 -0.470656015728705 … -0.4463984364612438 -0.4688943964193074; … ; -0.41228807090639 -0.4463984364612438 … -0.2536569833244609 -0.34106330233758364; -0.4550700815917571 -0.46889439641930736 … -0.3410633023375837 -0.4090661824786075;;; -0.4966565572591999 -0.49204131119909633 … -0.4550700815917571 -0.484818208747289; -0.49204131119909633 -0.4861790252051403 … -0.46889439641930736 -0.4861790252051403; … ; -0.4550700815917571 -0.46889439641930736 … -0.3410633023375837 -0.4090661824786075; -0.484818208747289 -0.4861790252051403 … -0.4090661824786075 -0.4583744079559989])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41291392118936554 -0.48683674420298034 … -0.7027113225513847 -0.48683674420298056; -0.48683674420298023 -0.7744303949677325 … -0.41363732837679035 -0.38233074972406766; … ; -0.7027113225513849 -0.4136373283767905 … -2.3967616825192946 -1.295806758106428; -0.48683674420298007 -0.3823307497240675 … -1.295806758106428 -0.7744303949677322;;; -0.4868367442029803 -0.7744303949677325 … -0.41363732837679035 -0.3823307497240679; -0.7744303949677322 -1.4814477483198583 … -0.3245845693745928 -0.4499193965026572; … ; -0.41363732837679046 -0.3245845693745932 … -1.0113572985506347 -0.637327779130672; -0.38233074972406744 -0.44991939650265717 … -0.6373277791306717 -0.4499193965026571;;; -0.7027113225513846 -1.295806758106428 … -0.2982034893221661 -0.4136373283767905; -1.295806758106428 -2.9196723935838946 … -0.3537295846096107 -0.6373277791306717; … ; -0.2982034893221661 -0.35372958460961124 … -0.49037260805859983 -0.3537295846096112; -0.41363732837679024 -0.6373277791306717 … -0.35372958460961057 -0.3245845693745929;;; … ;;; -1.0166744211938714 -0.5332878142525384 … -3.6361382570506837 -1.9987602619837235; -0.5332878142525382 -0.3217412474260284 … -1.466733940688178 -0.906193894088937; … ; -3.6361382570506837 -1.4667339406881783 … -10.988177824396626 -8.087376168134185; -1.998760261983723 -0.9061938940889369 … -8.087376168134185 -4.647878371071521;;; -0.7027113225513846 -0.41363732837679024 … -2.396761682519295 -1.295806758106428; -0.41363732837679024 -0.32458456937459323 … -1.0113572985506347 -0.6373277791306717; … ; -2.396761682519295 -1.0113572985506352 … -11.002806190805732 -6.077304186322608; -1.2958067581064276 -0.6373277791306715 … -6.077304186322608 -2.9196723935838946;;; -0.48683674420298034 -0.3823307497240678 … -1.295806758106428 -0.7744303949677325; -0.38233074972406766 -0.44991939650265733 … -0.6373277791306717 -0.4499193965026572; … ; -1.295806758106428 -0.6373277791306718 … -6.077304186322607 -2.919672393583894; -0.7744303949677322 -0.44991939650265705 … -2.919672393583894 -1.4814477483198583]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.12099969633063369 - 0.07535767970577198im 0.10440978036979029 - 0.034066681413262655im … -0.12389390881309252 - 0.06658036482227608im -0.11317859401776051 - 0.12707828483049582im; 0.10480519450704091 - 0.02342255627374519im 0.009684817061556609 + 0.002733776221268456im … -0.028553062586940015 - 0.04093316298533228im 0.016720964438795536 - 0.06033782199314953im; … ; -0.12183562296805106 - 0.011173517844850208im -0.02681602432573872 + 0.005826043858633251im … -0.011945742187664324 + 0.007439716076505901im -0.17682733262751718 - 0.0349260549542775im; -0.11052008109506645 - 0.055513968515351717im 0.01856280329354042 - 0.010757496012215102im … -0.17673177058978934 - 0.032353627103521104im -0.3264589655116613 - 0.09215103239195076im;;; 0.19775340367775374 - 0.1103402915182922im 0.0937764179703473 - 0.06790453215844444im … -0.05878311120800517 - 0.04681389420883704im 0.016674909954149286 - 0.11648609087529253im; 0.095545245901807 - 0.020289578962278523im -0.03101496341411225 + 0.03368697556072241im … -0.00666030254499211 - 0.03216247576190934im 0.05027818935748263 - 0.04841686547961182im; … ; -0.057256586157316075 - 0.005721476867051431im -0.005767818959051265 - 0.008137775327777649im … -0.055318978494497684 + 0.004736858054945286im -0.10858830328856615 - 0.004788473112512858im; 0.018201714623636987 - 0.0753861473780489im 0.050096978079477925 - 0.0532948813146569im … -0.10907304504775464 - 0.017837201612740102im -0.14250348113206407 - 0.06031156342209732im;;; 0.09646493445437436 - 0.05937198797402149im 0.02851022784503459 + 0.002404471611756687im … -0.005030871574372127 - 0.028193943007670846im 0.04796453458905475 - 0.05609632206421716im; 0.029698703996703414 + 0.03439697640445198im -0.03999550739897195 + 0.10297827977725318im … 0.010489456996009228 - 0.016751440363920303im 0.03772805761178505 - 0.01211537434666611im; … ; -0.004580071184970985 - 0.01605888034355605im 0.010479477415222146 - 0.017020080928021365im … -0.0322373923803842 + 0.0005787294503316704im -0.03262136546679247 - 0.0077003729429279055im; 0.04801585382735303 - 0.054714864317372616im 0.036876009090886855 - 0.035051608876747534im … -0.03289246662574803 - 0.014998125474807972im -0.005380177274392637 - 0.039062009703207765im;;; … ;;; -0.015109030043029645 - 0.02010446448843083im 0.0024461338819857783 - 0.00907588174956623im … -0.002184096521761433 + 0.015238400651868598im -0.02378659135323786 - 0.012649338593889775im; 0.002353720165285229 - 0.01156355959031271im 0.008649676229080482 - 0.0026633934268699526im … -0.007647608505347654 - 0.003116798501304924im -0.008485956045046924 - 0.01396385314283419im; … ; -0.0026552265210908147 + 0.0025560871678618462im -0.007835440948146748 - 0.008173046504342644im … 0.07930877224083349 + 0.08219256856238157im 0.0393175406976205 + 0.047227102623492556im; -0.02391372515210588 - 0.016071644219640163im -0.008427879468420756 - 0.012400494486922146im … 0.03968193386586548 + 0.057036174487034644im -0.008441573118778124 + 0.013264648795783365im;;; -0.018796111627792923 - 0.04634442944201804im 0.01765977602620239 - 0.007931441251900383im … -0.029607786184396717 - 0.011980725263545433im -0.07411002356647707 - 0.06834180717027091im; 0.01737611737253426 - 0.015567227530076791im 0.017408601870769775 + 0.0015344491524755463im … -0.015139996405042856 - 0.019522105502625717im -0.00955588985012538 - 0.03284537496924618im; … ; -0.030332931438402898 - 0.03150085820458592im -0.015028170970079649 - 0.01651188584159284im … 0.16780623244763432 + 0.12557828348375122im 0.03479111134264176 + 0.018687482436924727im; -0.0738893078254257 - 0.06240037782600482im -0.008990840931429812 - 0.017634865511226012im … 0.03597958758896376 + 0.050679986888574745im -0.10383463604000027 - 0.06252283252641477im;;; 0.017309695628598083 - 0.06921748986300016im 0.05186202479226536 - 0.004937956245025582im … -0.09147141606706036 - 0.058375394451308835im -0.15685377950204735 - 0.1386510379246894im; 0.05146829289797231 - 0.015536796378675im 0.021729176281251497 + 0.0050656608906432905im … -0.025972113093488396 - 0.03687802287175601im -0.006012919958089136 - 0.052242554203490464im; … ; -0.09129020462299 - 0.05349737898776098im -0.024923663621891315 - 0.008654888996364334im … 0.1391912489884789 + 0.0517246963304956im -0.07112158789953275 - 0.061807108369209274im; -0.15508495142510426 - 0.09103608513003765im -0.004397475515745101 - 0.00875652379905191im … -0.06959478326555327 - 0.020707164858018733im -0.28989889642191746 - 0.12854425901402555im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3915556371438472 0.3785174210074714 … 0.3446996003702696 0.3785174210074714; 0.37851742100747127 0.3664584407571992 … 0.3273572818109392 0.363649542720645; … ; 0.3446996003702696 0.32735728181093926 … 0.3075192695197804 0.3343805320907545; 0.3785174210074713 0.36364954272064504 … 0.3343805320907545 0.3664584407571992;;; 0.3785174210074713 0.36645844075719924 … 0.3273572818109392 0.36364954272064504; 0.3664584407571992 0.35102886353088525 … 0.31119401354226245 0.3519170664467544; … ; 0.3273572818109392 0.31119401354226245 … 0.2982412284983384 0.3214260029053961; 0.36364954272064504 0.35191706644675447 … 0.3214260029053961 0.3519170664467544;;; 0.34469960037026964 0.33438053209075463 … 0.2865351538373415 0.32735728181093926; 0.3343805320907545 0.31861604787245423 … 0.2780589188946991 0.3214260029053961; … ; 0.2865351538373415 0.27805891889469914 … 0.25590185778811325 0.2780589188946991; 0.32735728181093926 0.32142600290539614 … 0.2780589188946991 0.3111940135422624;;; … ;;; 0.3048747493788079 0.28303666903833735 … 0.28556433241425255 0.3009573706146544; 0.28303666903833724 0.258984316288206 … 0.27263300136596164 0.285414196707195; … ; 0.28556433241425255 0.2726330013659616 … 0.27716038924736097 0.2812108738904061; 0.3009573706146544 0.28541419670719503 … 0.2812108738904061 0.2930827263759613;;; 0.34469960037026964 0.32735728181093926 … 0.30751926951978037 0.33438053209075463; 0.32735728181093915 0.31119401354226234 … 0.29824122849833845 0.3214260029053961; … ; 0.30751926951978037 0.2982412284983384 … 0.27716038924736097 0.29313119157843737; 0.33438053209075463 0.32142600290539614 … 0.29313119157843737 0.31861604787245423;;; 0.3785174210074713 0.36364954272064504 … 0.3343805320907546 0.36645844075719924; 0.3636495427206449 0.35191706644675436 … 0.3214260029053961 0.3519170664467544; … ; 0.33438053209075463 0.3214260029053961 … 0.2931311915784374 0.3186160478724543; 0.3664584407571992 0.3519170664467544 … 0.3186160478724543 0.3510288635308853]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5033081923456447 -0.4966565572591999 … -0.47719190099722886 -0.4966565572592; -0.4966565572591999 -0.484818208747289 … -0.47638044579293476 -0.49204131119909633; … ; -0.47719190099722886 -0.47638044579293476 … -0.41228807090639 -0.4550700815917571; -0.4966565572591999 -0.49204131119909633 … -0.4550700815917571 -0.484818208747289;;; -0.4966565572591999 -0.484818208747289 … -0.47638044579293476 -0.49204131119909633; -0.484818208747289 -0.45837440795599893 … -0.47065601572870497 -0.4861790252051403; … ; -0.47638044579293476 -0.47065601572870497 … -0.4463984364612438 -0.46889439641930736; -0.49204131119909633 -0.4861790252051403 … -0.46889439641930736 -0.4861790252051403;;; -0.4771919009972288 -0.4550700815917571 … -0.4605141234426624 -0.47638044579293476; -0.4550700815917571 -0.4090661824786075 … -0.4567199083405067 -0.46889439641930736; … ; -0.46051412344266246 -0.4567199083405067 … -0.44514495661990156 -0.4567199083405067; -0.4763804457929347 -0.46889439641930736 … -0.4567199083405067 -0.47065601572870497;;; … ;;; -0.44947595086877024 -0.45514997222338727 … -0.3712598626424337 -0.4177457152321039; -0.45514997222338727 -0.4488035110153222 … -0.4174380107307283 -0.44412609932140096; … ; -0.37125986264243366 -0.41743801073072834 … -0.2536569833244609 -0.29979809109222055; -0.4177457152321038 -0.44412609932140096 … -0.2997980910922206 -0.36106343268057767;;; -0.4771919009972288 -0.4763804457929347 … -0.41228807090639 -0.45507008159175716; -0.4763804457929347 -0.470656015728705 … -0.4463984364612438 -0.4688943964193074; … ; -0.41228807090639 -0.4463984364612438 … -0.2536569833244609 -0.34106330233758364; -0.4550700815917571 -0.46889439641930736 … -0.3410633023375837 -0.4090661824786075;;; -0.4966565572591999 -0.49204131119909633 … -0.4550700815917571 -0.484818208747289; -0.49204131119909633 -0.4861790252051403 … -0.46889439641930736 -0.4861790252051403; … ; -0.4550700815917571 -0.46889439641930736 … -0.3410633023375837 -0.4090661824786075; -0.484818208747289 -0.4861790252051403 … -0.4090661824786075 -0.4583744079559989])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41291392118936554 -0.48683674420298034 … -0.7027113225513847 -0.48683674420298056; -0.48683674420298023 -0.7744303949677325 … -0.41363732837679035 -0.38233074972406766; … ; -0.7027113225513849 -0.4136373283767905 … -2.3967616825192946 -1.295806758106428; -0.48683674420298007 -0.3823307497240675 … -1.295806758106428 -0.7744303949677322;;; -0.4868367442029803 -0.7744303949677325 … -0.41363732837679035 -0.3823307497240679; -0.7744303949677322 -1.4814477483198583 … -0.3245845693745928 -0.4499193965026572; … ; -0.41363732837679046 -0.3245845693745932 … -1.0113572985506347 -0.637327779130672; -0.38233074972406744 -0.44991939650265717 … -0.6373277791306717 -0.4499193965026571;;; -0.7027113225513846 -1.295806758106428 … -0.2982034893221661 -0.4136373283767905; -1.295806758106428 -2.9196723935838946 … -0.3537295846096107 -0.6373277791306717; … ; -0.2982034893221661 -0.35372958460961124 … -0.49037260805859983 -0.3537295846096112; -0.41363732837679024 -0.6373277791306717 … -0.35372958460961057 -0.3245845693745929;;; … ;;; -1.0166744211938714 -0.5332878142525384 … -3.6361382570506837 -1.9987602619837235; -0.5332878142525382 -0.3217412474260284 … -1.466733940688178 -0.906193894088937; … ; -3.6361382570506837 -1.4667339406881783 … -10.988177824396626 -8.087376168134185; -1.998760261983723 -0.9061938940889369 … -8.087376168134185 -4.647878371071521;;; -0.7027113225513846 -0.41363732837679024 … -2.396761682519295 -1.295806758106428; -0.41363732837679024 -0.32458456937459323 … -1.0113572985506347 -0.6373277791306717; … ; -2.396761682519295 -1.0113572985506352 … -11.002806190805732 -6.077304186322608; -1.2958067581064276 -0.6373277791306715 … -6.077304186322608 -2.9196723935838946;;; -0.48683674420298034 -0.3823307497240678 … -1.295806758106428 -0.7744303949677325; -0.38233074972406766 -0.44991939650265733 … -0.6373277791306717 -0.4499193965026572; … ; -1.295806758106428 -0.6373277791306718 … -6.077304186322607 -2.919672393583894; -0.7744303949677322 -0.44991939650265705 … -2.919672393583894 -1.4814477483198583]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[-0.21171622368562348 - 0.09402179098320859im -0.08302195882898891 + 0.02314130588271994im … -0.0973874182564532 - 0.19636658636572346im -0.23399953032597662 - 0.3171126336822182im; -0.01904298039690206 + 0.06406928212542208im 0.04921058965294914 + 0.039308786457942405im … -0.058024921509288924 - 0.1381543354031818im -0.08861098418173066 - 0.15656016478744933im; … ; -0.00489860923827154 - 0.019318400171757014im -0.021035642545560233 + 0.0037857616499057775im … 0.05110038969953337 + 0.0522156732720013im 0.034698574091823586 - 0.020420652739887322im; -0.13828598569231482 - 0.07485825562011073im -0.07561214661130658 + 0.008949544042120899im … 0.01783330623196296 - 0.020412971690487915im -0.08160679620166453 - 0.1926693590545492im;;; -0.07293680804382545 + 0.08155836716362268im 0.022072568285181393 + 0.06436304177158086im … -0.06513054312325466 - 0.14079936204740987im -0.12308968731823507 - 0.14826368916456376im; 0.11121784739317359 + 0.24595351875674443im 0.13851138765941207 + 0.09854855309617719im … -0.023309187637753612 - 0.06764512124518451im 0.009091568146188321 + 0.04934031076446402im; … ; -0.02517161769348964 - 0.017087247647364193im -0.02344332223554623 + 0.0027362301882037487im … 0.009452449886472045 - 0.008576574527043142im -0.008487105756479242 - 0.03777664349537152im; -0.08798023051425427 - 0.021613974479731027im -0.0391587537639002 + 0.016282149116147292im … -0.028088040472004472 - 0.07951283666968656im -0.07943642721673734 - 0.12337661866198163im;;; 0.023735395382624674 + 0.09602237754533693im 0.04691941298139858 + 0.03813270650841624im … -0.018424000183868413 - 0.034879895512894644im -0.009877577288657038 + 0.023832718301591484im; 0.08071520752864052 + 0.1531970134297544im 0.07427720865755263 + 0.01579978233972389im … 0.0032781674747597734 + 0.008988875137406042im 0.03462831075181155 + 0.09837208239291828im; … ; -0.016248937162041482 - 0.003748100477094181im -0.010521001304519903 + 0.004358551117965515im … -0.004490497459585941 - 0.01878426654046985im -0.012979287546687594 - 0.02066127254541798im; -0.019837889428702384 + 0.01845515886185753im 0.00013805802544509193 + 0.01714642727973903im … -0.01871108656355113 - 0.04103356898513019im -0.0275968795705799 - 0.025002660146893348im;;; … ;;; -0.0006242646942459643 + 0.00036395705345649665im -0.0016362194847178158 + 0.010646313831742676im … 0.01577627574122501 + 0.011326281131272618im 0.005501783948077999 - 0.004466927752936351im; -0.00533022118821065 + 0.007608381051223294im -0.0017141258347817654 + 0.011094433342811752im … -0.002375754899952982 + 0.004858536905677762im -0.007697899282023203 + 0.0005516501453428843im; … ; 0.01148029618233359 - 0.012027587927506307im 0.00788474639096205 - 0.005889670136833355im … -0.0068199668207790665 + 0.0003479744706072779im 0.007551362756548994 - 0.004542802531555471im; 0.01410826581045379 - 0.010192470599177422im 0.005525945031277954 + 0.0017899605374999314im … 0.02561031542306141 + 0.013777907112778234im 0.024810158502106428 - 0.00598283325104431im;;; -0.026267368797875217 + 0.007352599713115122im -0.017168569114637912 + 0.023188657650653813im … 0.02431504617835111 + 0.04762153190404514im -0.012901254467419587 - 0.0128128260463332im; -0.017045065637682176 + 0.011122628586760136im -0.005867071285128906 + 0.013530754597948575im … -0.015276188953547334 + 0.0034297854103260087im -0.02771809736193914 - 0.012186648292248161im; … ; 0.034026277753188075 - 0.00780169616610947im 0.012530170433323159 + 0.001007527342078293im … 0.0312192058614143 + 0.04783564731153961im 0.050740678480571115 + 0.013528355238734155im; 0.024281638540824452 - 0.0020108026563664064im -0.00114664665445951 + 0.014868263587964827im … 0.08927875609827801 + 0.09805806603675447im 0.0742772081723998 + 0.015799781677505686im;;; -0.14628330058889943 - 0.04850678646631267im -0.06411019812388849 + 0.020714694260487672im … -0.01599266138869688 - 0.004905577584050856im -0.12308599864375827 - 0.16953690951140965im; -0.04292465621813064 - 0.006107239392973706im -0.006222286228303294 + 0.006453835395039062im … -0.04257971697641251 - 0.05643858444697399im -0.07676846686997243 - 0.10291507626907839im; … ; 0.037378033428068974 - 0.0048164549001011815im 0.0015250342579967175 + 0.006662928024472378im … 0.08140354573633202 + 0.11071074255577433im 0.0870143689142115 + 0.027832958709546225im; -0.02821517015579427 - 0.02481208012215081im -0.03786183176381173 + 0.018581977542530062im … 0.12186534806885371 + 0.15614695801854456im 0.06516489451325469 - 0.03151660134976312im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852646686729846), converged = true, ρ = [0.09132316919710252 0.08747419135990275 … 0.0768475493765143 0.08747419135990277; 0.08747419135990275 0.08089966874140088 … 0.07642471018331834 0.08486944836083882; … ; 0.0768475493765143 0.07642471018331834 … 0.04778466668328159 0.06587895343978477; 0.08747419135990275 0.08486944836083882 … 0.06587895343978477 0.08089966874140088;;; 0.08747419135990275 0.08089966874140087 … 0.07642471018331834 0.08486944836083882; 0.08089966874140087 0.06744471471739694 … 0.07348669935868317 0.08163768630620465; … ; 0.07642471018331834 0.07348669935868317 … 0.06188804121123999 0.07259829029842307; 0.08486944836083882 0.08163768630620465 … 0.07259829029842307 0.08163768630620465;;; 0.07684754937651428 0.06587895343978477 … 0.06847203699938603 0.07642471018331834; 0.06587895343978477 0.04657864266445792 … 0.06665759372549633 0.07259829029842307; … ; 0.06847203699938605 0.06665759372549633 … 0.061325153151156366 0.06665759372549632; 0.07642471018331833 0.07259829029842307 … 0.06665759372549633 0.07348669935868317;;; … ;;; 0.06328495231160064 0.06591651446982362 … 0.03394064888784831 0.0498759348713972; 0.06591651446982362 0.06297790960908206 … 0.04975639789199509 0.06087020458153891; … ; 0.033940648887848306 0.0497563978919951 … 0.009696353219179362 0.016831338798618242; 0.04987593487139718 0.06087020458153891 … 0.01683133879861825 0.030985721894190656;;; 0.07684754937651427 0.07642471018331833 … 0.04778466668328158 0.06587895343978478; 0.07642471018331833 0.07348669935868318 … 0.06188804121123999 0.07259829029842309; … ; 0.047784666683281574 0.06188804121123999 … 0.009696353219179362 0.025710010684384395; 0.06587895343978477 0.07259829029842307 … 0.025710010684384402 0.04657864266445793;;; 0.08747419135990275 0.08486944836083882 … 0.06587895343978477 0.08089966874140088; 0.08486944836083882 0.08163768630620466 … 0.07259829029842307 0.08163768630620465; … ; 0.06587895343978477 0.07259829029842307 … 0.025710010684384405 0.04657864266445792; 0.08089966874140087 0.08163768630620465 … 0.04657864266445792 0.06744471471739692;;;;], ψ = Matrix{ComplexF64}[[0.6631128691531878 + 0.6879447568089485im 6.872702407179077e-11 - 9.33422783511162e-12im -7.00389607422025e-11 + 2.8514746119867596e-11im 3.3454017334122454e-11 - 6.518742923927734e-11im; 0.06682466852586263 + 0.06932708222305856im 0.14966877825344574 - 0.17257561337575453im -0.18413827130827937 + 0.06326385833836481im 0.06722319250203646 + 0.3969909572160204im; … ; 0.008185137159613347 + 0.00849164977946532im -0.0225339857872221 + 0.027175275828560996im -0.030135786560690818 - 0.005632518204346173im 0.00171379830829059 - 0.0363234678413259im; -0.06682466875306078 - 0.06932708213524094im -0.07094394555766516 + 0.09347635712892507im -0.4791742943654072 + 0.008120255861455122im 0.08400165889785961 + 0.04137615256851677im], [-0.9282064262485248 + 0.031435314589702446im -0.19703509506569902 + 0.005944809068161666im 1.0617132173429411e-11 + 8.896974823535686e-11im 1.2612202671125061e-9 - 3.5561192879285386e-11im; -0.06327762086954318 + 0.0021430061577199693im 0.008769477337335033 - 0.0002645866794039782im 2.3721464029180517e-11 + 1.059366604855283e-10im 1.1629754156222694e-9 - 4.353645395582806e-11im; … ; -0.0077463250153849755 + 0.00026234282518607793im -0.08621939792420896 + 0.002601353315138789im -0.05848049118932387 - 0.04347596088263733im -0.0620440479467995 - 0.02209530132703623im; 0.11286736590614418 - 0.0038224483114400742im 0.09066629956606989 - 0.00273552225197074im -0.36623321525019176 - 0.27226756399074303im -0.38854993936454946 - 0.1383714989973262im], [-0.7926046234058791 + 0.4936280628126133im -9.275037404776754e-10 + 2.1540838557321251e-10im 1.8536283619141614e-11 - 1.3941982290877064e-10im -5.067708752637401e-10 - 4.755936616751555e-10im; -0.05835651091787942 + 0.03634398587685311im -0.05503958139366841 - 0.015536268246433397im 0.001870130010784548 - 0.03514755794796106im 0.001738829903212235 - 0.012019928054102878im; … ; -0.01177364381650192 + 0.007332534755978599im -5.577178684157413e-10 + 1.7084007472578655e-10im 0.008396799399250407 + 0.11676620701228042im -0.03501807157614456 - 0.053242880306505im; 0.13004964775037603 - 0.0809939202921088im -0.27632938311078037 - 0.0780007302452821im 0.0913645313805111 + 0.19341779504583015im -0.21303367534866322 - 0.5821772793291431im], [-0.7214193183803832 - 0.36613610229176174im 1.9319323918409737e-11 - 6.003392227782456e-12im 0.0855299741439423 - 0.4878061950193366im -2.476573113252556e-11 - 5.24778415167404e-11im; -0.3455212607799095 - 0.17535960630748432im 0.30778019443956356 + 0.5457858536336729im -0.09304371703609726 + 0.5306595943139022im -1.564235824202953e-10 - 2.0129770073040731e-10im; … ; -0.010160070362459209 - 0.005156458326137257im 0.0008073587052460931 + 0.0014316870908100024im -0.0036051193250132224 + 0.0205612077012935im 0.001411869599144344 - 0.00909074080445741im; 0.05812260664740946 + 0.029498495224885766im 0.006132708996506635 + 0.01087511708136447im -0.0217898841822538 + 0.1242750379432028im 0.027423872759177154 - 0.17657673397069057im]], eigenvalues = Any[[-0.1667770759351978, 0.26427771787013227, 0.26427771787013254, 0.26427771787013277], [-0.11613218758077595, 0.07040532322893356, 0.22624813606640803, 0.22624813606640845], [-0.0958893814062318, 0.08764319971704687, 0.17312704145764338, 0.1731270414576435], [-0.045051463451880824, 0.022269526273632156, 0.09831189253557147, 0.18446409325284693]], occupation = [[2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0], [2.0, 2.0, 2.0, 2.0]], εF = nothing, optim_res =  * Status: failure (line search failed)

 * Candidate solution
    Final objective value:     -7.852647e+00

 * Found with
    Algorithm:     L-BFGS

 * Convergence measures
    |x - x&#39;|               = 4.44e-16 ≤ 1.0e-12
    |x - x&#39;|/|x&#39;|          = 6.26e-16 ≰ 0.0e+00
    |f(x) - f(x&#39;)|         = 2.66e-15 ≰ 0.0e+00
    |f(x) - f(x&#39;)|/|f(x&#39;)| = 3.39e-16 ≰ -1.0e+00
    |g(x)|                 = 1.89e-09 ≰ -1.0e+00

 * Work counters
    Seconds run:   1  (vs limit Inf)
    Iterations:    45
    f(x) calls:    60
    ∇f(x) calls:   46
)</code></pre><p>Start not too far from the solution to ensure convergence: We run first a very crude SCF to get close and then switch to Newton.</p><pre><code class="language-julia hljs">scfres_start = self_consistent_field(basis; tol=1e-1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(ham = Hamiltonian(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), HamiltonianBlock[DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.3929099205015699 0.37961600700668163 … 0.3451180468199211 0.37961600700668163; 0.3796160070066816 0.3670478025350055 … 0.3281063807892543 0.3648018763395091; … ; 0.345118046819921 0.32810638078925425 … 0.3066067748260316 0.33417370519332734; 0.37961600700668163 0.3648018763395091 … 0.3341737051933273 0.3670478025350055;;; 0.37961600700668163 0.3670478025350055 … 0.3281063807892543 0.3648018763395091; 0.36704780253500546 0.35098886127355133 … 0.3120216834379011 0.35282323397277; … ; 0.32810638078925425 0.3120216834379011 … 0.29773985235164446 0.3216779077942187; 0.3648018763395091 0.35282323397277 … 0.3216779077942186 0.35282323397276993;;; 0.345118046819921 0.3341737051933273 … 0.28723403977143475 0.3281063807892542; 0.3341737051933273 0.3178524147643304 … 0.278539258611823 0.3216779077942187; … ; 0.28723403977143463 0.27853925861182294 … 0.2558025712707147 0.27853925861182294; 0.3281063807892542 0.3216779077942187 … 0.2785392586118229 0.31202168343790104;;; … ;;; 0.3044609073239789 0.2830894584712657 … 0.2841747134041312 0.3000057214145358; 0.28308945847126565 0.25938982496878416 … 0.2714365246128547 0.2848664091624828; … ; 0.28417471340413114 0.2714365246128548 … 0.2757498114741449 0.27979015648403416; 0.30000572141453585 0.2848664091624828 … 0.27979015648403405 0.29182513278411487;;; 0.34511804681992103 0.32810638078925425 … 0.3066067748260317 0.33417370519332734; 0.3281063807892542 0.3120216834379011 … 0.29773985235164446 0.3216779077942187; … ; 0.30660677482603166 0.29773985235164446 … 0.2757498114741449 0.29189745491400587; 0.33417370519332734 0.3216779077942187 … 0.29189745491400576 0.31785241476433035;;; 0.37961600700668163 0.3648018763395091 … 0.33417370519332734 0.3670478025350055; 0.36480187633950906 0.35282323397277 … 0.3216779077942187 0.35282323397277; … ; 0.3341737051933273 0.3216779077942187 … 0.2918974549140058 0.3178524147643304; 0.3670478025350055 0.35282323397277 … 0.3178524147643303 0.3509888612735513]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.5045049116223854 -0.49774616596481036 … -0.4779203949262477 -0.49774616596481036; -0.49774616596481036 -0.4857354495620394 … -0.47718202891836525 -0.49309493918375613; … ; -0.47792039492624777 -0.47718202891836525 … -0.4121807552064548 -0.45553155365906306; -0.49774616596481036 -0.49309493918375613 … -0.45553155365906306 -0.4857354495620394;;; -0.49774616596481036 -0.48573544956203935 … -0.47718202891836525 -0.49309493918375613; -0.4857354495620394 -0.4590958674100087 … -0.47146746550561525 -0.4871168010607545; … ; -0.47718202891836525 -0.4714674655056152 … -0.4464112773557565 -0.46944868237177456; -0.49309493918375613 -0.4871168010607545 … -0.46944868237177456 -0.4871168010607545;;; -0.4779203949262477 -0.45553155365906306 … -0.46122404069229306 -0.47718202891836525; -0.45553155365906306 -0.40929483553603757 … -0.4572967061937511 -0.46944868237177456; … ; -0.46122404069229306 -0.45729670619375107 … -0.4452991296988025 -0.45729670619375107; -0.47718202891836525 -0.46944868237177456 … -0.45729670619375107 -0.47146746550561525;;; … ;;; -0.44956537535451113 -0.4554416938420045 … -0.3704206016330848 -0.417483708240233; -0.4554416938420045 -0.44928493263939534 … -0.4166809502019725 -0.4440194043099741; … ; -0.37042060163308477 -0.4166809502019725 … -0.2527948327631474 -0.29895928121015275; -0.41748370824023295 -0.4440194043099741 … -0.2989592812101527 -0.36058815965331903;;; -0.4779203949262477 -0.47718202891836525 … -0.4121807552064548 -0.45553155365906306; -0.47718202891836525 -0.4714674655056152 … -0.44641127735575653 -0.46944868237177456; … ; -0.4121807552064548 -0.4464112773557565 … -0.2527948327631474 -0.34075130199417203; -0.45553155365906306 -0.46944868237177456 … -0.340751301994172 -0.4092948355360376;;; -0.49774616596481036 -0.49309493918375613 … -0.45553155365906306 -0.48573544956203935; -0.49309493918375613 -0.4871168010607545 … -0.46944868237177456 -0.4871168010607545; … ; -0.45553155365906306 -0.4694486823717745 … -0.34075130199417203 -0.40929483553603757; -0.48573544956203935 -0.4871168010607545 … -0.4092948355360375 -0.4590958674100087])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [0.0, 0.5625437115174675, 2.25017484606987, 2.25017484606987, 0.5625437115174675, 0.5625437115174675, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276  …  3.7502914101164504, 3.7502914101164504, 2.0626602755640477, 1.5001165640465801, 0.7500582820232901, 2.0626602755640477, 4.50034969213974, 3.5627768396106276, 1.5001165640465801, 0.5625437115174675]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), [-0.41275635710838354 -0.48682776690938057 … -0.703021370030752 -0.4868277669093807; -0.4868277669093804 -0.7747582740046766 … -0.41368981252390574 -0.38223204408986333; … ; -0.7030213700307524 -0.413689812523906 … -2.3975668615131083 -1.2964750570711612; -0.48682776690938023 -0.3822320440898632 … -1.2964750570711612 -0.7747582740046763;;; -0.48682776690938045 -0.7747582740046766 … -0.41368981252390574 -0.3822320440898636; -0.7747582740046765 -1.4822092100312023 … -0.3245683492558644 -0.44995100483225586; … ; -0.4136898125239059 -0.32456834925586475 … -1.0118715155918414 -0.6376301601943166; -0.38223204408986317 -0.44995100483225586 … -0.6376301601943164 -0.4499510048322558;;; -0.7030213700307522 -1.2964750570711616 … -0.2982145206377035 -0.4136898125239061; -1.2964750570711612 -2.920664679749449 … -0.35382604274573126 -0.6376301601943164; … ; -0.2982145206377036 -0.3538260427457318 … -0.4906260676548993 -0.3538260427457317; -0.41368981252390585 -0.6376301601943164 … -0.35382604274573115 -0.32456834925586453;;; … ;;; -1.0171776877344414 -0.5335267464382272 … -3.6366886150514564 -1.999449904191971; -0.5335267464382271 -0.3218171603695234 … -1.4671733569125291 -0.9066349866222223; … ; -3.6366886150514564 -1.4671733569125291 … -10.98872625160853 -8.08795807565849; -1.9994499041919709 -0.9066349866222223 … -8.08795807565849 -4.648660691636109;;; -0.7030213700307522 -0.4136898125239058 … -2.3975668615131087 -1.2964750570711612; -0.41368981252390574 -0.32456834925586464 … -1.0118715155918416 -0.6376301601943164; … ; -2.3975668615131087 -1.0118715155918419 … -11.003354618017635 -6.078225922643628; -1.2964750570711612 -0.6376301601943162 … -6.078225922643628 -2.920664679749449;;; -0.4868277669093805 -0.3822320440898635 … -1.2964750570711612 -0.7747582740046766; -0.38223204408986333 -0.4499510048322559 … -0.6376301601943163 -0.44995100483225586; … ; -1.2964750570711612 -0.6376301601943164 … -6.078225922643627 -2.9206646797494487; -0.7747582740046762 -0.4499510048322557 … -2.920664679749448 -1.4822092100312023]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([     0,      0,      0], spin = 1, num. G vectors =   137), ComplexF64[0.11164094023604486 + 0.0im 0.1729534009156557 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.07139183057793365 - 0.07139183057793365im 0.10318729458139622 - 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im 0.035578676822652595 - 0.035578676822652595im; … ; -0.08538801146445177 + 0.0im -0.10864081623630145 + 0.0im … 0.0 + 0.08076812854291712im 0.0 - 0.0im; -0.07139183057793365 + 0.07139183057793365im -0.10318729458139622 + 0.10318729458139622im … -0.035578676822652595 + 0.035578676822652595im -0.035578676822652595 + 0.035578676822652595im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.3929099205015699 0.37961600700668163 … 0.3451180468199211 0.37961600700668163; 0.3796160070066816 0.3670478025350055 … 0.3281063807892543 0.3648018763395091; … ; 0.345118046819921 0.32810638078925425 … 0.3066067748260316 0.33417370519332734; 0.37961600700668163 0.3648018763395091 … 0.3341737051933273 0.3670478025350055;;; 0.37961600700668163 0.3670478025350055 … 0.3281063807892543 0.3648018763395091; 0.36704780253500546 0.35098886127355133 … 0.3120216834379011 0.35282323397277; … ; 0.32810638078925425 0.3120216834379011 … 0.29773985235164446 0.3216779077942187; 0.3648018763395091 0.35282323397277 … 0.3216779077942186 0.35282323397276993;;; 0.345118046819921 0.3341737051933273 … 0.28723403977143475 0.3281063807892542; 0.3341737051933273 0.3178524147643304 … 0.278539258611823 0.3216779077942187; … ; 0.28723403977143463 0.27853925861182294 … 0.2558025712707147 0.27853925861182294; 0.3281063807892542 0.3216779077942187 … 0.2785392586118229 0.31202168343790104;;; … ;;; 0.3044609073239789 0.2830894584712657 … 0.2841747134041312 0.3000057214145358; 0.28308945847126565 0.25938982496878416 … 0.2714365246128547 0.2848664091624828; … ; 0.28417471340413114 0.2714365246128548 … 0.2757498114741449 0.27979015648403416; 0.30000572141453585 0.2848664091624828 … 0.27979015648403405 0.29182513278411487;;; 0.34511804681992103 0.32810638078925425 … 0.3066067748260317 0.33417370519332734; 0.3281063807892542 0.3120216834379011 … 0.29773985235164446 0.3216779077942187; … ; 0.30660677482603166 0.29773985235164446 … 0.2757498114741449 0.29189745491400587; 0.33417370519332734 0.3216779077942187 … 0.29189745491400576 0.31785241476433035;;; 0.37961600700668163 0.3648018763395091 … 0.33417370519332734 0.3670478025350055; 0.36480187633950906 0.35282323397277 … 0.3216779077942187 0.35282323397277; … ; 0.3341737051933273 0.3216779077942187 … 0.2918974549140058 0.3178524147643304; 0.3670478025350055 0.35282323397277 … 0.3178524147643303 0.3509888612735513]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.5045049116223854 -0.49774616596481036 … -0.4779203949262477 -0.49774616596481036; -0.49774616596481036 -0.4857354495620394 … -0.47718202891836525 -0.49309493918375613; … ; -0.47792039492624777 -0.47718202891836525 … -0.4121807552064548 -0.45553155365906306; -0.49774616596481036 -0.49309493918375613 … -0.45553155365906306 -0.4857354495620394;;; -0.49774616596481036 -0.48573544956203935 … -0.47718202891836525 -0.49309493918375613; -0.4857354495620394 -0.4590958674100087 … -0.47146746550561525 -0.4871168010607545; … ; -0.47718202891836525 -0.4714674655056152 … -0.4464112773557565 -0.46944868237177456; -0.49309493918375613 -0.4871168010607545 … -0.46944868237177456 -0.4871168010607545;;; -0.4779203949262477 -0.45553155365906306 … -0.46122404069229306 -0.47718202891836525; -0.45553155365906306 -0.40929483553603757 … -0.4572967061937511 -0.46944868237177456; … ; -0.46122404069229306 -0.45729670619375107 … -0.4452991296988025 -0.45729670619375107; -0.47718202891836525 -0.46944868237177456 … -0.45729670619375107 -0.47146746550561525;;; … ;;; -0.44956537535451113 -0.4554416938420045 … -0.3704206016330848 -0.417483708240233; -0.4554416938420045 -0.44928493263939534 … -0.4166809502019725 -0.4440194043099741; … ; -0.37042060163308477 -0.4166809502019725 … -0.2527948327631474 -0.29895928121015275; -0.41748370824023295 -0.4440194043099741 … -0.2989592812101527 -0.36058815965331903;;; -0.4779203949262477 -0.47718202891836525 … -0.4121807552064548 -0.45553155365906306; -0.47718202891836525 -0.4714674655056152 … -0.44641127735575653 -0.46944868237177456; … ; -0.4121807552064548 -0.4464112773557565 … -0.2527948327631474 -0.34075130199417203; -0.45553155365906306 -0.46944868237177456 … -0.340751301994172 -0.4092948355360376;;; -0.49774616596481036 -0.49309493918375613 … -0.45553155365906306 -0.48573544956203935; -0.49309493918375613 -0.4871168010607545 … -0.46944868237177456 -0.4871168010607545; … ; -0.45553155365906306 -0.4694486823717745 … -0.34075130199417203 -0.40929483553603757; -0.48573544956203935 -0.4871168010607545 … -0.4092948355360375 -0.4590958674100087])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [0.06250485683527418, 1.000077709364387, 3.062737984928434, 4.000310837457548, 1.562621420881854, 0.2500194273410967, 0.5000388546821934, 1.0625825661996608, 2.750213700752063, 2.7502137007520635  …  2.5001942734109663, 4.5628545489750145, 3.062737984928434, 1.7501359913876768, 1.5626214208818543, 1.062582566199661, 2.750213700752063, 2.750213700752064, 1.0625825661996608, 0.5000388546821934]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), [-0.41275635710838354 -0.48682776690938057 … -0.703021370030752 -0.4868277669093807; -0.4868277669093804 -0.7747582740046766 … -0.41368981252390574 -0.38223204408986333; … ; -0.7030213700307524 -0.413689812523906 … -2.3975668615131083 -1.2964750570711612; -0.48682776690938023 -0.3822320440898632 … -1.2964750570711612 -0.7747582740046763;;; -0.48682776690938045 -0.7747582740046766 … -0.41368981252390574 -0.3822320440898636; -0.7747582740046765 -1.4822092100312023 … -0.3245683492558644 -0.44995100483225586; … ; -0.4136898125239059 -0.32456834925586475 … -1.0118715155918414 -0.6376301601943166; -0.38223204408986317 -0.44995100483225586 … -0.6376301601943164 -0.4499510048322558;;; -0.7030213700307522 -1.2964750570711616 … -0.2982145206377035 -0.4136898125239061; -1.2964750570711612 -2.920664679749449 … -0.35382604274573126 -0.6376301601943164; … ; -0.2982145206377036 -0.3538260427457318 … -0.4906260676548993 -0.3538260427457317; -0.41368981252390585 -0.6376301601943164 … -0.35382604274573115 -0.32456834925586453;;; … ;;; -1.0171776877344414 -0.5335267464382272 … -3.6366886150514564 -1.999449904191971; -0.5335267464382271 -0.3218171603695234 … -1.4671733569125291 -0.9066349866222223; … ; -3.6366886150514564 -1.4671733569125291 … -10.98872625160853 -8.08795807565849; -1.9994499041919709 -0.9066349866222223 … -8.08795807565849 -4.648660691636109;;; -0.7030213700307522 -0.4136898125239058 … -2.3975668615131087 -1.2964750570711612; -0.41368981252390574 -0.32456834925586464 … -1.0118715155918416 -0.6376301601943164; … ; -2.3975668615131087 -1.0118715155918419 … -11.003354618017635 -6.078225922643628; -1.2964750570711612 -0.6376301601943162 … -6.078225922643628 -2.920664679749449;;; -0.4868277669093805 -0.3822320440898635 … -1.2964750570711612 -0.7747582740046766; -0.38223204408986333 -0.4499510048322559 … -0.6376301601943163 -0.44995100483225586; … ; -1.2964750570711612 -0.6376301601943164 … -6.078225922643627 -2.9206646797494487; -0.7747582740046762 -0.4499510048322557 … -2.920664679749448 -1.4822092100312023]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,      0,      0], spin = 1, num. G vectors =   144), ComplexF64[0.10663902257822168 - 0.028573839981478756im 0.16397423109777803 - 0.0439367628021639im … -0.0048810168633526265 + 0.01821620292663248im 0.0048810168633526265 - 0.01821620292663248im; 0.04668482831007231 - 0.08086049457567514im 0.06370661418591363 - 0.11034309254819058im … -0.05243363114037364 + 0.030272571053484264im 0.05243363114037364 - 0.030272571053484264im; … ; -0.08918635851135279 + 0.023897412738989543im -0.12067576411442682 + 0.03233497354046929im … -0.019302751901532963 + 0.07203885082241784im -0.0038605503803065926 + 0.014407770164483566im; -0.051048693065027635 + 0.08841893004861681im -0.0743729428832569 + 0.128817715782219im … -0.02947884616601673 + 0.017019619769349337im -0.05895769233203346 + 0.034039239538698675im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.3929099205015699 0.37961600700668163 … 0.3451180468199211 0.37961600700668163; 0.3796160070066816 0.3670478025350055 … 0.3281063807892543 0.3648018763395091; … ; 0.345118046819921 0.32810638078925425 … 0.3066067748260316 0.33417370519332734; 0.37961600700668163 0.3648018763395091 … 0.3341737051933273 0.3670478025350055;;; 0.37961600700668163 0.3670478025350055 … 0.3281063807892543 0.3648018763395091; 0.36704780253500546 0.35098886127355133 … 0.3120216834379011 0.35282323397277; … ; 0.32810638078925425 0.3120216834379011 … 0.29773985235164446 0.3216779077942187; 0.3648018763395091 0.35282323397277 … 0.3216779077942186 0.35282323397276993;;; 0.345118046819921 0.3341737051933273 … 0.28723403977143475 0.3281063807892542; 0.3341737051933273 0.3178524147643304 … 0.278539258611823 0.3216779077942187; … ; 0.28723403977143463 0.27853925861182294 … 0.2558025712707147 0.27853925861182294; 0.3281063807892542 0.3216779077942187 … 0.2785392586118229 0.31202168343790104;;; … ;;; 0.3044609073239789 0.2830894584712657 … 0.2841747134041312 0.3000057214145358; 0.28308945847126565 0.25938982496878416 … 0.2714365246128547 0.2848664091624828; … ; 0.28417471340413114 0.2714365246128548 … 0.2757498114741449 0.27979015648403416; 0.30000572141453585 0.2848664091624828 … 0.27979015648403405 0.29182513278411487;;; 0.34511804681992103 0.32810638078925425 … 0.3066067748260317 0.33417370519332734; 0.3281063807892542 0.3120216834379011 … 0.29773985235164446 0.3216779077942187; … ; 0.30660677482603166 0.29773985235164446 … 0.2757498114741449 0.29189745491400587; 0.33417370519332734 0.3216779077942187 … 0.29189745491400576 0.31785241476433035;;; 0.37961600700668163 0.3648018763395091 … 0.33417370519332734 0.3670478025350055; 0.36480187633950906 0.35282323397277 … 0.3216779077942187 0.35282323397277; … ; 0.3341737051933273 0.3216779077942187 … 0.2918974549140058 0.3178524147643304; 0.3670478025350055 0.35282323397277 … 0.3178524147643303 0.3509888612735513]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.5045049116223854 -0.49774616596481036 … -0.4779203949262477 -0.49774616596481036; -0.49774616596481036 -0.4857354495620394 … -0.47718202891836525 -0.49309493918375613; … ; -0.47792039492624777 -0.47718202891836525 … -0.4121807552064548 -0.45553155365906306; -0.49774616596481036 -0.49309493918375613 … -0.45553155365906306 -0.4857354495620394;;; -0.49774616596481036 -0.48573544956203935 … -0.47718202891836525 -0.49309493918375613; -0.4857354495620394 -0.4590958674100087 … -0.47146746550561525 -0.4871168010607545; … ; -0.47718202891836525 -0.4714674655056152 … -0.4464112773557565 -0.46944868237177456; -0.49309493918375613 -0.4871168010607545 … -0.46944868237177456 -0.4871168010607545;;; -0.4779203949262477 -0.45553155365906306 … -0.46122404069229306 -0.47718202891836525; -0.45553155365906306 -0.40929483553603757 … -0.4572967061937511 -0.46944868237177456; … ; -0.46122404069229306 -0.45729670619375107 … -0.4452991296988025 -0.45729670619375107; -0.47718202891836525 -0.46944868237177456 … -0.45729670619375107 -0.47146746550561525;;; … ;;; -0.44956537535451113 -0.4554416938420045 … -0.3704206016330848 -0.417483708240233; -0.4554416938420045 -0.44928493263939534 … -0.4166809502019725 -0.4440194043099741; … ; -0.37042060163308477 -0.4166809502019725 … -0.2527948327631474 -0.29895928121015275; -0.41748370824023295 -0.4440194043099741 … -0.2989592812101527 -0.36058815965331903;;; -0.4779203949262477 -0.47718202891836525 … -0.4121807552064548 -0.45553155365906306; -0.47718202891836525 -0.4714674655056152 … -0.44641127735575653 -0.46944868237177456; … ; -0.4121807552064548 -0.4464112773557565 … -0.2527948327631474 -0.34075130199417203; -0.45553155365906306 -0.46944868237177456 … -0.340751301994172 -0.4092948355360376;;; -0.49774616596481036 -0.49309493918375613 … -0.45553155365906306 -0.48573544956203935; -0.49309493918375613 -0.4871168010607545 … -0.46944868237177456 -0.4871168010607545; … ; -0.45553155365906306 -0.4694486823717745 … -0.34075130199417203 -0.40929483553603757; -0.48573544956203935 -0.4871168010607545 … -0.4092948355360375 -0.4590958674100087])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [0.0833398091136989, 0.8959029479722631, 2.8335535098657623, 4.396174930747617, 1.8334758005013758, 0.3958640932900698, 0.8959029479722631, 1.3334369458191824, 2.8960583667010367, 3.39609722138323  …  1.89598065733665, 3.833631219230149, 2.8335535098657623, 1.3959418026544566, 1.0834175184780857, 0.8333980911369889, 2.3960195120188432, 2.8960583667010367, 1.0834175184780857, 0.3958640932900698]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), [-0.41275635710838354 -0.48682776690938057 … -0.703021370030752 -0.4868277669093807; -0.4868277669093804 -0.7747582740046766 … -0.41368981252390574 -0.38223204408986333; … ; -0.7030213700307524 -0.413689812523906 … -2.3975668615131083 -1.2964750570711612; -0.48682776690938023 -0.3822320440898632 … -1.2964750570711612 -0.7747582740046763;;; -0.48682776690938045 -0.7747582740046766 … -0.41368981252390574 -0.3822320440898636; -0.7747582740046765 -1.4822092100312023 … -0.3245683492558644 -0.44995100483225586; … ; -0.4136898125239059 -0.32456834925586475 … -1.0118715155918414 -0.6376301601943166; -0.38223204408986317 -0.44995100483225586 … -0.6376301601943164 -0.4499510048322558;;; -0.7030213700307522 -1.2964750570711616 … -0.2982145206377035 -0.4136898125239061; -1.2964750570711612 -2.920664679749449 … -0.35382604274573126 -0.6376301601943164; … ; -0.2982145206377036 -0.3538260427457318 … -0.4906260676548993 -0.3538260427457317; -0.41368981252390585 -0.6376301601943164 … -0.35382604274573115 -0.32456834925586453;;; … ;;; -1.0171776877344414 -0.5335267464382272 … -3.6366886150514564 -1.999449904191971; -0.5335267464382271 -0.3218171603695234 … -1.4671733569125291 -0.9066349866222223; … ; -3.6366886150514564 -1.4671733569125291 … -10.98872625160853 -8.08795807565849; -1.9994499041919709 -0.9066349866222223 … -8.08795807565849 -4.648660691636109;;; -0.7030213700307522 -0.4136898125239058 … -2.3975668615131087 -1.2964750570711612; -0.41368981252390574 -0.32456834925586464 … -1.0118715155918416 -0.6376301601943164; … ; -2.3975668615131087 -1.0118715155918419 … -11.003354618017635 -6.078225922643628; -1.2964750570711612 -0.6376301601943162 … -6.078225922643628 -2.920664679749449;;; -0.4868277669093805 -0.3822320440898635 … -1.2964750570711612 -0.7747582740046766; -0.38223204408986333 -0.4499510048322559 … -0.6376301601943163 -0.44995100483225586; … ; -1.2964750570711612 -0.6376301601943164 … -6.078225922643627 -2.9206646797494487; -0.7747582740046762 -0.4499510048322557 … -2.920664679749448 -1.4822092100312023]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([ 0.333,  0.333,      0], spin = 1, num. G vectors =   141), ComplexF64[0.09525460347564817 - 0.05499527095821653im 0.14610260131202302 - 0.08435237619680104im … -0.018766875445216862 + 0.032505181770432406im 5.2088543048880615e-19 - 9.022000305289992e-19im; 0.024619950292842606 - 0.09188290537270884im 0.03407002323540016 - 0.12715105772956556im … -0.07491066001757686 + 0.02007225085619212im 0.04494639601054611 - 0.012043350513715271im; … ; -0.07966512642409461 + 0.045994682185976576im -0.10748648020277889 + 0.06205734827931975im … -0.02968662889946843 + 0.05141874955932189im 0.0 - 0.0im; -0.026921300372532365 + 0.10047166079611371im -0.039739321889381986 + 0.14830916834950758im … -0.016846285674482424 + 0.0045139486419415575im -0.05053885702344723 + 0.013541845925824664im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],)), DFTK.DftHamiltonianBlock(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), Any[DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.30116136598756804 -0.36869760795125184 … -0.5702190219244254 -0.36869760795125195; -0.3686976079512516 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456163; … ; -0.5702190219244256 -0.264614164394795 … -2.291992881132685 -1.1751172086054253; -0.3686976079512515 -0.2539389812456162 … -1.1751172086054256 -0.6560706269776425;;; -0.3686976079512517 -0.6560706269776427 … -0.2646141643947948 -0.2539389812456166; -0.6560706269776425 -1.3741022038947448 … -0.1651225671881503 -0.31565743774427135; … ; -0.2646141643947949 -0.16512256718815066 … -0.8632000905877295 -0.4898593856167607; -0.25393898124561615 -0.31565743774427135 … -0.48985938561676046 -0.31565743774427124;;; -0.5702190219244254 -1.1751172086054258 … -0.1242245197168452 -0.264614164394795; -1.1751172086054256 -2.8292222589777416 … -0.1750685951638031 -0.48985938561676046; … ; -0.1242245197168452 -0.1750685951638037 … -0.30112950922681153 -0.17506859516380358; -0.2646141643947948 -0.48985938561676046 … -0.17506859516380294 -0.1651225671881503;;; … ;;; -0.8720732197039092 -0.36117451106748844 … -3.5504427268225025 -1.881971917366274; -0.3611745110674882 -0.13192205269891222 … -1.3219289313234115 -0.747481991474731; … ; -3.5504427268225025 -1.3219289313234115 … -11.011681230319526 -8.06878895093237; -1.8819719173662737 -0.747481991474731 … -8.06878895093237 -4.5798976647669045;;; -0.5702190219244254 -0.2646141643947948 … -2.2919928811326855 -1.1751172086054256; -0.2646141643947947 -0.16512256718815055 … -0.8632000905877295 -0.48985938561676046; … ; -2.2919928811326855 -0.8632000905877297 … -11.026309596728632 -6.029372075563462; -1.1751172086054253 -0.4898593856167603 … -6.029372075563462 -2.8292222589777416;;; -0.3686976079512518 -0.2539389812456165 … -1.1751172086054256 -0.6560706269776427; -0.25393898124561626 -0.3156574377442714 … -0.4898593856167604 -0.31565743774427135; … ; -1.1751172086054256 -0.48985938561676057 … -6.029372075563461 -2.829222258977741; -0.6560706269776424 -0.3156574377442712 … -2.829222258977741 -1.3741022038947448]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.NoopOperator{Float64}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142)), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.3929099205015699 0.37961600700668163 … 0.3451180468199211 0.37961600700668163; 0.3796160070066816 0.3670478025350055 … 0.3281063807892543 0.3648018763395091; … ; 0.345118046819921 0.32810638078925425 … 0.3066067748260316 0.33417370519332734; 0.37961600700668163 0.3648018763395091 … 0.3341737051933273 0.3670478025350055;;; 0.37961600700668163 0.3670478025350055 … 0.3281063807892543 0.3648018763395091; 0.36704780253500546 0.35098886127355133 … 0.3120216834379011 0.35282323397277; … ; 0.32810638078925425 0.3120216834379011 … 0.29773985235164446 0.3216779077942187; 0.3648018763395091 0.35282323397277 … 0.3216779077942186 0.35282323397276993;;; 0.345118046819921 0.3341737051933273 … 0.28723403977143475 0.3281063807892542; 0.3341737051933273 0.3178524147643304 … 0.278539258611823 0.3216779077942187; … ; 0.28723403977143463 0.27853925861182294 … 0.2558025712707147 0.27853925861182294; 0.3281063807892542 0.3216779077942187 … 0.2785392586118229 0.31202168343790104;;; … ;;; 0.3044609073239789 0.2830894584712657 … 0.2841747134041312 0.3000057214145358; 0.28308945847126565 0.25938982496878416 … 0.2714365246128547 0.2848664091624828; … ; 0.28417471340413114 0.2714365246128548 … 0.2757498114741449 0.27979015648403416; 0.30000572141453585 0.2848664091624828 … 0.27979015648403405 0.29182513278411487;;; 0.34511804681992103 0.32810638078925425 … 0.3066067748260317 0.33417370519332734; 0.3281063807892542 0.3120216834379011 … 0.29773985235164446 0.3216779077942187; … ; 0.30660677482603166 0.29773985235164446 … 0.2757498114741449 0.29189745491400587; 0.33417370519332734 0.3216779077942187 … 0.29189745491400576 0.31785241476433035;;; 0.37961600700668163 0.3648018763395091 … 0.33417370519332734 0.3670478025350055; 0.36480187633950906 0.35282323397277 … 0.3216779077942187 0.35282323397277; … ; 0.3341737051933273 0.3216779077942187 … 0.2918974549140058 0.3178524147643304; 0.3670478025350055 0.35282323397277 … 0.3178524147643303 0.3509888612735513]), DFTK.RealSpaceMultiplication{Float64, SubArray{Float64, 3, Array{Float64, 4}, Tuple{Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Base.Slice{Base.OneTo{Int64}}, Int64}, true}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.5045049116223854 -0.49774616596481036 … -0.4779203949262477 -0.49774616596481036; -0.49774616596481036 -0.4857354495620394 … -0.47718202891836525 -0.49309493918375613; … ; -0.47792039492624777 -0.47718202891836525 … -0.4121807552064548 -0.45553155365906306; -0.49774616596481036 -0.49309493918375613 … -0.45553155365906306 -0.4857354495620394;;; -0.49774616596481036 -0.48573544956203935 … -0.47718202891836525 -0.49309493918375613; -0.4857354495620394 -0.4590958674100087 … -0.47146746550561525 -0.4871168010607545; … ; -0.47718202891836525 -0.4714674655056152 … -0.4464112773557565 -0.46944868237177456; -0.49309493918375613 -0.4871168010607545 … -0.46944868237177456 -0.4871168010607545;;; -0.4779203949262477 -0.45553155365906306 … -0.46122404069229306 -0.47718202891836525; -0.45553155365906306 -0.40929483553603757 … -0.4572967061937511 -0.46944868237177456; … ; -0.46122404069229306 -0.45729670619375107 … -0.4452991296988025 -0.45729670619375107; -0.47718202891836525 -0.46944868237177456 … -0.45729670619375107 -0.47146746550561525;;; … ;;; -0.44956537535451113 -0.4554416938420045 … -0.3704206016330848 -0.417483708240233; -0.4554416938420045 -0.44928493263939534 … -0.4166809502019725 -0.4440194043099741; … ; -0.37042060163308477 -0.4166809502019725 … -0.2527948327631474 -0.29895928121015275; -0.41748370824023295 -0.4440194043099741 … -0.2989592812101527 -0.36058815965331903;;; -0.4779203949262477 -0.47718202891836525 … -0.4121807552064548 -0.45553155365906306; -0.47718202891836525 -0.4714674655056152 … -0.44641127735575653 -0.46944868237177456; … ; -0.4121807552064548 -0.4464112773557565 … -0.2527948327631474 -0.34075130199417203; -0.45553155365906306 -0.46944868237177456 … -0.340751301994172 -0.4092948355360376;;; -0.49774616596481036 -0.49309493918375613 … -0.45553155365906306 -0.48573544956203935; -0.49309493918375613 -0.4871168010607545 … -0.46944868237177456 -0.4871168010607545; … ; -0.45553155365906306 -0.4694486823717745 … -0.34075130199417203 -0.40929483553603757; -0.48573544956203935 -0.4871168010607545 … -0.4092948355360375 -0.4590958674100087])], DFTK.FourierMultiplication{Float64, Vector{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [0.1666796182273978, 0.22918447506267198, 1.4167767549328811, 3.7294564578380256, 3.416932173661655, 1.2292621844270586, 1.2292621844270586, 0.9167379002506877, 1.729301039109252, 3.6669516010027516  …  4.729534167202412, 4.417009883026042, 2.2293398937914453, 1.1667573275917844, 0.41669904556849446, 1.2292621844270588, 3.1669127463205577, 4.729534167202412, 2.1668350369561713, 0.7292233297448653]), DFTK.RealSpaceMultiplication{Float64, Array{Float64, 3}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), [-0.41275635710838354 -0.48682776690938057 … -0.703021370030752 -0.4868277669093807; -0.4868277669093804 -0.7747582740046766 … -0.41368981252390574 -0.38223204408986333; … ; -0.7030213700307524 -0.413689812523906 … -2.3975668615131083 -1.2964750570711612; -0.48682776690938023 -0.3822320440898632 … -1.2964750570711612 -0.7747582740046763;;; -0.48682776690938045 -0.7747582740046766 … -0.41368981252390574 -0.3822320440898636; -0.7747582740046765 -1.4822092100312023 … -0.3245683492558644 -0.44995100483225586; … ; -0.4136898125239059 -0.32456834925586475 … -1.0118715155918414 -0.6376301601943166; -0.38223204408986317 -0.44995100483225586 … -0.6376301601943164 -0.4499510048322558;;; -0.7030213700307522 -1.2964750570711616 … -0.2982145206377035 -0.4136898125239061; -1.2964750570711612 -2.920664679749449 … -0.35382604274573126 -0.6376301601943164; … ; -0.2982145206377036 -0.3538260427457318 … -0.4906260676548993 -0.3538260427457317; -0.41368981252390585 -0.6376301601943164 … -0.35382604274573115 -0.32456834925586453;;; … ;;; -1.0171776877344414 -0.5335267464382272 … -3.6366886150514564 -1.999449904191971; -0.5335267464382271 -0.3218171603695234 … -1.4671733569125291 -0.9066349866222223; … ; -3.6366886150514564 -1.4671733569125291 … -10.98872625160853 -8.08795807565849; -1.9994499041919709 -0.9066349866222223 … -8.08795807565849 -4.648660691636109;;; -0.7030213700307522 -0.4136898125239058 … -2.3975668615131087 -1.2964750570711612; -0.41368981252390574 -0.32456834925586464 … -1.0118715155918416 -0.6376301601943164; … ; -2.3975668615131087 -1.0118715155918419 … -11.003354618017635 -6.078225922643628; -1.2964750570711612 -0.6376301601943162 … -6.078225922643628 -2.920664679749449;;; -0.4868277669093805 -0.3822320440898635 … -1.2964750570711612 -0.7747582740046766; -0.38223204408986333 -0.4499510048322559 … -0.6376301601943163 -0.44995100483225586; … ; -1.2964750570711612 -0.6376301601943164 … -6.078225922643627 -2.9206646797494487; -0.7747582740046762 -0.4499510048322557 … -2.920664679749448 -1.4822092100312023]), DFTK.NonlocalOperator{Float64, Matrix{ComplexF64}, Matrix{Float64}}(PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), KPoint([-0.333,  0.333,      0], spin = 1, num. G vectors =   142), ComplexF64[0.10836454158744746 + 0.0im 0.16454392299317003 + 0.0im … -0.0 - 1.0216068167279948e-18im 0.0 + 0.03680726463308285im; 0.0757741533540503 - 0.0757741533540503im 0.1141835519100639 - 0.1141835519100639im … -0.03847188688271061 + 0.03847188688271061im 0.012823962294236874 - 0.012823962294236874im; … ; -0.07579695351601741 + 0.0im -0.08711072462387971 + 0.0im … 0.0 + 0.06907686686237845im 0.0 - 0.02302562228745948im; -0.0692966484992815 + 0.0692966484992815im -0.09802716364420207 + 0.09802716364420207im … -0.03421471645670587 + 0.03421471645670587im -0.011404905485568627 + 0.011404905485568627im], [5.90692831 -1.26189397 … 0.0 0.0; -1.26189397 3.25819622 … 0.0 0.0; … ; 0.0 0.0 … 2.72701346 0.0; 0.0 0.0 … 0.0 2.72701346]), nothing, (ψ_reals = Array{ComplexF64, 3}[[0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; … ;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im;;; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; … ; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im; 0.0 + 0.0im 0.0 + 0.0im … 0.0 + 0.0im 0.0 + 0.0im]],))]), basis = PlaneWaveBasis(model = Model(lda_x+lda_c_pw, spin_polarization = :none), Ecut = 5.0 Ha, kgrid = [3, 3, 3]), energies = Energies(total = -7.852316932214993), converged = true, occupation_threshold = 1.0e-6, ρ = [0.09202766575874555 0.08809698341616827 … 0.07722851329093565 0.08809698341616827; 0.08809698341616827 0.08139661858780943 … 0.07684239560838711 0.08545937626162348; … ; 0.07722851329093566 0.0768423956083871 … 0.04774415667462469 0.06609611849756579; 0.08809698341616826 0.08545937626162348 … 0.06609611849756579 0.08139661858780943;;; 0.08809698341616826 0.08139661858780942 … 0.07684239560838711 0.08545937626162349; 0.08139661858780943 0.06778992023837817 … 0.07389840450499528 0.08214893367891558; … ; 0.07684239560838711 0.07389840450499527 … 0.06189382570287422 0.07287703091194024; 0.08545937626162348 0.08214893367891557 … 0.07287703091194024 0.08214893367891558;;; 0.07722851329093565 0.0660961184975658 … 0.06881522487567518 0.07684239560838711; 0.0660961184975658 0.04666353954864339 … 0.06693128792094619 0.07287703091194024; … ; 0.06881522487567518 0.06693128792094616 … 0.06139419711459063 0.06693128792094616; 0.07684239560838708 0.07287703091194024 … 0.06693128792094616 0.07389840450499528;;; … ;;; 0.06332586114116821 0.06605379299119815 … 0.033690444764097986 0.04977413807262551; 0.06605379299119815 0.06319762795978585 … 0.04946312791768571 0.060822695784189605; … ; 0.03369044476409798 0.04946312791768571 … 0.009587761256469996 0.016676814942529972; 0.04977413807262549 0.060822695784189605 … 0.01667681494252996 0.03085245205408446;;; 0.07722851329093565 0.07684239560838711 … 0.0477441566746247 0.0660961184975658; 0.07684239560838711 0.07389840450499527 … 0.06189382570287423 0.07287703091194024; … ; 0.047744156674624685 0.06189382570287422 … 0.009587761256469996 0.025632985810566652; 0.06609611849756579 0.07287703091194024 … 0.02563298581056664 0.0466635395486434;;; 0.08809698341616826 0.08545937626162348 … 0.0660961184975658 0.08139661858780942; 0.08545937626162348 0.08214893367891558 … 0.07287703091194024 0.08214893367891558; … ; 0.0660961184975658 0.07287703091194023 … 0.025632985810566652 0.046663539548643385; 0.0813966185878094 0.08214893367891557 … 0.04666353954864338 0.06778992023837818;;;;], α = 0.8, eigenvalues = [[-0.16684298015466312, 0.2643619961004527, 0.2643818631622156, 0.26447125322228204, 0.3573651455996913, 0.35736686274258744, 0.35840852584635297], [-0.11616965975078612, 0.07033579905129933, 0.22631379936473134, 0.22631529027260472, 0.33641343800624135, 0.3933822183887913, 0.3933869355873389], [-0.09592632694775333, 0.08793401057785434, 0.1730061944841014, 0.1730334008709684, 0.2914862852032693, 0.337357648938998, 0.5340041444505027], [-0.044914273667892884, 0.022401913314156207, 0.09786327992420642, 0.18449353124953227, 0.3248260092574737, 0.4954558464978012, 0.5031334640339084]], occupation = [[2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0], [2.0, 2.0, 2.0, 2.0, 0.0, 0.0, 0.0]], εF = 0.2900212363462511, n_iter = 2, n_ep_extra = 3, ψ = Matrix{ComplexF64}[[0.46007278848639793 + 0.838797916338446im 9.735839271527238e-5 - 1.0667716548203704e-5im … 0.00010183131792178857 - 9.66046518814308e-5im 0.0014358077207969897 + 0.00010812967232848731im; 0.04589274723497249 + 0.08285554514478324im 0.14862409764986542 - 0.24902996051248377im … 0.011173855125457204 + 0.1292600642077187im -0.139641938012325 - 0.5678480055489016im; … ; 0.005524910490081345 + 0.010331309501459638im 0.018350227444348197 - 0.0041149888484343575im … -0.02763062823808323 + 0.05073177153209794im -0.035927321035777914 - 0.06626147102068011im; -0.045754166829429635 - 0.08328813623972212im 0.3271332612915708 - 0.2900574860186515im … -0.23887691143001974 + 0.2908990145302103im -0.15281826836490167 + 0.004704413192160893im], [-0.09771546202915792 - 0.9242846537261438im -0.03564493959937513 - 0.1932688947935254im … 7.219854283720638e-5 - 4.856385556767048e-5im 0.00010734448014647758 - 5.4937685147350116e-5im; -0.006570690327599259 - 0.06218377459690418im 0.0022026759788938794 + 0.011211369299374607im … 0.0004324311227266621 - 7.870583260371246e-5im 0.0005564889737209148 - 0.00017462303069592402im; … ; -0.0008605528358578975 - 0.007975284506482386im -0.015563211140071991 - 0.08426241769234111im … 0.01739131816500511 - 0.06287101583657285im 0.08203810339440444 + 0.000835359929877117im; 0.011810641009696064 + 0.11167967454628436im 0.016071184476151582 + 0.08720075740066612im … 0.07798704973513296 - 0.27668837917682376im 0.3656459924598474 + 0.0033840943404065274im], [-0.28730327797341626 - 0.8892455553889183im -0.00010227303974245385 - 1.963258635643287e-5im … 0.0005442331832699668 + 5.0746231828569964e-5im -0.00020714037491194684 - 0.00032271518828408234im; -0.020657252940000162 - 0.06406701363311146im -0.059580469953797864 - 0.0020650619523684983im … 0.0080820847505868 + 0.002858543206373347im 0.0016683595158968451 + 0.005915990930674634im; … ; -0.004436515701234726 - 0.01380890487400886im 3.217495128050017e-5 + 3.738402716234704e-5im … -0.006496215019226187 - 0.0025133697229230353im 0.006942579436580369 + 0.06359004978628739im; 0.04677433988167976 + 0.1448268750399527im -0.28644745755106515 - 0.009835413961728122im … -0.36195237249876777 - 0.11948213328616222im 0.01500049731473654 + 0.14781609751836608im], [-0.49844054589243547 - 0.6381127865717038im -0.00021063140152699072 + 0.00011058175128542924im … 0.21702599677414947 - 0.09359853263437032im 0.0042725083329898 - 0.0026059818092815574im; -0.23830662877956435 - 0.30507627017463784im -0.5362259776136328 + 0.3253415226275645im … -0.19862488157666064 + 0.08541951394984605im -0.0036120674642516363 + 0.0019227996242165996im; … ; -0.006943944801091083 - 0.008898010730208726im -0.001189189545613502 + 0.000670836967445651im … 0.008279793947218441 - 0.006806606093727313im -0.030851007010058145 + 0.03345630127674141im; 0.03922428353506574 + 0.05018596430838715im -0.011652838738000718 + 0.007072785723738609im … 0.317117371386319 - 0.13968800387864397im -0.32682337484147345 + 0.35742628404886084im]], diagonalization = NamedTuple{(:λ, :X, :residual_norms, :iterations, :converged, :n_matvec), Tuple{Vector{Vector{Float64}}, Vector{Matrix{ComplexF64}}, Vector{Vector{Float64}}, Vector{Int64}, Bool, Int64}}[(λ = [[-0.16684298015466312, 0.2643619961004527, 0.2643818631622156, 0.26447125322228204, 0.3573651455996913, 0.35736686274258744, 0.35840852584635297], [-0.11616965975078612, 0.07033579905129933, 0.22631379936473134, 0.22631529027260472, 0.33641343800624135, 0.3933822183887913, 0.3933869355873389], [-0.09592632694775333, 0.08793401057785434, 0.1730061944841014, 0.1730334008709684, 0.2914862852032693, 0.337357648938998, 0.5340041444505027], [-0.044914273667892884, 0.022401913314156207, 0.09786327992420642, 0.18449353124953227, 0.3248260092574737, 0.4954558464978012, 0.5031334640339084]], X = [[0.46007278848639793 + 0.838797916338446im 9.735839271527238e-5 - 1.0667716548203704e-5im … 0.00010183131792178857 - 9.66046518814308e-5im 0.0014358077207969897 + 0.00010812967232848731im; 0.04589274723497249 + 0.08285554514478324im 0.14862409764986542 - 0.24902996051248377im … 0.011173855125457204 + 0.1292600642077187im -0.139641938012325 - 0.5678480055489016im; … ; 0.005524910490081345 + 0.010331309501459638im 0.018350227444348197 - 0.0041149888484343575im … -0.02763062823808323 + 0.05073177153209794im -0.035927321035777914 - 0.06626147102068011im; -0.045754166829429635 - 0.08328813623972212im 0.3271332612915708 - 0.2900574860186515im … -0.23887691143001974 + 0.2908990145302103im -0.15281826836490167 + 0.004704413192160893im], [-0.09771546202915792 - 0.9242846537261438im -0.03564493959937513 - 0.1932688947935254im … 7.219854283720638e-5 - 4.856385556767048e-5im 0.00010734448014647758 - 5.4937685147350116e-5im; -0.006570690327599259 - 0.06218377459690418im 0.0022026759788938794 + 0.011211369299374607im … 0.0004324311227266621 - 7.870583260371246e-5im 0.0005564889737209148 - 0.00017462303069592402im; … ; -0.0008605528358578975 - 0.007975284506482386im -0.015563211140071991 - 0.08426241769234111im … 0.01739131816500511 - 0.06287101583657285im 0.08203810339440444 + 0.000835359929877117im; 0.011810641009696064 + 0.11167967454628436im 0.016071184476151582 + 0.08720075740066612im … 0.07798704973513296 - 0.27668837917682376im 0.3656459924598474 + 0.0033840943404065274im], [-0.28730327797341626 - 0.8892455553889183im -0.00010227303974245385 - 1.963258635643287e-5im … 0.0005442331832699668 + 5.0746231828569964e-5im -0.00020714037491194684 - 0.00032271518828408234im; -0.020657252940000162 - 0.06406701363311146im -0.059580469953797864 - 0.0020650619523684983im … 0.0080820847505868 + 0.002858543206373347im 0.0016683595158968451 + 0.005915990930674634im; … ; -0.004436515701234726 - 0.01380890487400886im 3.217495128050017e-5 + 3.738402716234704e-5im … -0.006496215019226187 - 0.0025133697229230353im 0.006942579436580369 + 0.06359004978628739im; 0.04677433988167976 + 0.1448268750399527im -0.28644745755106515 - 0.009835413961728122im … -0.36195237249876777 - 0.11948213328616222im 0.01500049731473654 + 0.14781609751836608im], [-0.49844054589243547 - 0.6381127865717038im -0.00021063140152699072 + 0.00011058175128542924im … 0.21702599677414947 - 0.09359853263437032im 0.0042725083329898 - 0.0026059818092815574im; -0.23830662877956435 - 0.30507627017463784im -0.5362259776136328 + 0.3253415226275645im … -0.19862488157666064 + 0.08541951394984605im -0.0036120674642516363 + 0.0019227996242165996im; … ; -0.006943944801091083 - 0.008898010730208726im -0.001189189545613502 + 0.000670836967445651im … 0.008279793947218441 - 0.006806606093727313im -0.030851007010058145 + 0.03345630127674141im; 0.03922428353506574 + 0.05018596430838715im -0.011652838738000718 + 0.007072785723738609im … 0.317117371386319 - 0.13968800387864397im -0.32682337484147345 + 0.35742628404886084im]], residual_norms = [[0.012639622244532332, 0.006561000887006608, 0.007849965190571672, 0.0116128447147233, 0.0037933325319717387, 0.004046832348757144, 0.02129212475583121], [0.004021297242622966, 0.00662430794665833, 0.005948978487859674, 0.006059197255587117, 0.0074474339962070655, 0.011221839623958835, 0.011610319383104629], [0.005861634294466691, 0.005680596809875657, 0.004480970916785169, 0.007421059076359244, 0.008031781663718653, 0.019315219662907276, 0.02861720354205596], [0.004804147135629665, 0.004786213507430202, 0.008171905606458835, 0.012512243678095484, 0.04154291809746173, 0.061368618972036985, 0.018571769316031887]], iterations = [1, 1, 1, 1], converged = 1, n_matvec = 56)], stage = :finalize, algorithm = &quot;SCF&quot;, norm_Δρ = 0.0027595455988111764)</code></pre><p>Remove the virtual orbitals (which Newton cannot treat yet)</p><pre><code class="language-julia hljs">ψ, _ = DFTK.select_occupied_orbitals(basis, scfres_start.ψ, scfres_start.occupation)
scfres_newton = newton(basis, ψ; tol)

# Comparison of results

println(&quot;|ρ_newton - ρ_scf|  = &quot;, norm(scfres_newton.ρ - scfres_scf.ρ))
println(&quot;|ρ_newton - ρ_scfv| = &quot;, norm(scfres_newton.ρ - scfres_scfv.ρ))
println(&quot;|ρ_newton - ρ_dm|   = &quot;, norm(scfres_newton.ρ - scfres_dm.ρ))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">n     Energy            log10(ΔE)   log10(Δρ)
---   ---------------   ---------   ---------
  1   -7.852646686701                   -2.54
  2   -7.852646686730      -10.54       -5.82
  3   -7.852646686730   +  -14.57      -12.41
|ρ_newton - ρ_scf|  = 2.526759933508151e-13
|ρ_newton - ρ_scfv| = 1.0320229823871453e-13
|ρ_newton - ρ_dm|   = 4.5133048582664974e-10</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../scf_callbacks/">« Monitoring self-consistent field calculations</a><a class="docs-footer-nextpage" href="../gross_pitaevskii/">Gross-Pitaevskii equation in one dimension »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Saturday 17 September 2022 13:14">Saturday 17 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
